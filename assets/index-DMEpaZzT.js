(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}})();function M0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ub(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function a(){var o=!1;try{o=this instanceof a}catch{}return o?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var o=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(r,a,o.get?o:{enumerable:!0,get:function(){return e[a]}})}),r}var $f={exports:{}},il={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gx;function Wb(){if(Gx)return il;Gx=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,o,c){var d=null;if(c!==void 0&&(d=""+c),o.key!==void 0&&(d=""+o.key),"key"in o){c={};for(var f in o)f!=="key"&&(c[f]=o[f])}else c=o;return o=c.ref,{$$typeof:e,type:a,key:d,ref:o!==void 0?o:null,props:c}}return il.Fragment=t,il.jsx=r,il.jsxs=r,il}var Yx;function $b(){return Yx||(Yx=1,$f.exports=Wb()),$f.exports}var i=$b(),Hf={exports:{}},jt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vx;function Hb(){if(Vx)return jt;Vx=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),d=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.iterator;function b(k){return k===null||typeof k!="object"?null:(k=y&&k[y]||k["@@iterator"],typeof k=="function"?k:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,_={};function T(k,J,O){this.props=k,this.context=J,this.refs=_,this.updater=O||v}T.prototype.isReactComponent={},T.prototype.setState=function(k,J){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,J,"setState")},T.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function M(){}M.prototype=T.prototype;function F(k,J,O){this.props=k,this.context=J,this.refs=_,this.updater=O||v}var A=F.prototype=new M;A.constructor=F,w(A,T.prototype),A.isPureReactComponent=!0;var U=Array.isArray,V={H:null,A:null,T:null,S:null,V:null},te=Object.prototype.hasOwnProperty;function N(k,J,O,K,Y,H){return O=H.ref,{$$typeof:e,type:k,key:J,ref:O!==void 0?O:null,props:H}}function re(k,J){return N(k.type,J,void 0,void 0,void 0,k.props)}function L(k){return typeof k=="object"&&k!==null&&k.$$typeof===e}function X(k){var J={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(O){return J[O]})}var le=/\/+/g;function ge(k,J){return typeof k=="object"&&k!==null&&k.key!=null?X(""+k.key):J.toString(36)}function Re(){}function fe(k){switch(k.status){case"fulfilled":return k.value;case"rejected":throw k.reason;default:switch(typeof k.status=="string"?k.then(Re,Re):(k.status="pending",k.then(function(J){k.status==="pending"&&(k.status="fulfilled",k.value=J)},function(J){k.status==="pending"&&(k.status="rejected",k.reason=J)})),k.status){case"fulfilled":return k.value;case"rejected":throw k.reason}}throw k}function Ae(k,J,O,K,Y){var H=typeof k;(H==="undefined"||H==="boolean")&&(k=null);var pe=!1;if(k===null)pe=!0;else switch(H){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(k.$$typeof){case e:case t:pe=!0;break;case x:return pe=k._init,Ae(pe(k._payload),J,O,K,Y)}}if(pe)return Y=Y(k),pe=K===""?"."+ge(k,0):K,U(Y)?(O="",pe!=null&&(O=pe.replace(le,"$&/")+"/"),Ae(Y,J,O,"",function(De){return De})):Y!=null&&(L(Y)&&(Y=re(Y,O+(Y.key==null||k&&k.key===Y.key?"":(""+Y.key).replace(le,"$&/")+"/")+pe)),J.push(Y)),1;pe=0;var Ge=K===""?".":K+":";if(U(k))for(var He=0;He<k.length;He++)K=k[He],H=Ge+ge(K,He),pe+=Ae(K,J,O,H,Y);else if(He=b(k),typeof He=="function")for(k=He.call(k),He=0;!(K=k.next()).done;)K=K.value,H=Ge+ge(K,He++),pe+=Ae(K,J,O,H,Y);else if(H==="object"){if(typeof k.then=="function")return Ae(fe(k),J,O,K,Y);throw J=String(k),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return pe}function ee(k,J,O){if(k==null)return k;var K=[],Y=0;return Ae(k,K,"","",function(H){return J.call(O,H,Y++)}),K}function ye(k){if(k._status===-1){var J=k._result;J=J(),J.then(function(O){(k._status===0||k._status===-1)&&(k._status=1,k._result=O)},function(O){(k._status===0||k._status===-1)&&(k._status=2,k._result=O)}),k._status===-1&&(k._status=0,k._result=J)}if(k._status===1)return k._result.default;throw k._result}var ae=typeof reportError=="function"?reportError:function(k){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof k=="object"&&k!==null&&typeof k.message=="string"?String(k.message):String(k),error:k});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",k);return}console.error(k)};function Se(){}return jt.Children={map:ee,forEach:function(k,J,O){ee(k,function(){J.apply(this,arguments)},O)},count:function(k){var J=0;return ee(k,function(){J++}),J},toArray:function(k){return ee(k,function(J){return J})||[]},only:function(k){if(!L(k))throw Error("React.Children.only expected to receive a single React element child.");return k}},jt.Component=T,jt.Fragment=r,jt.Profiler=o,jt.PureComponent=F,jt.StrictMode=a,jt.Suspense=p,jt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=V,jt.__COMPILER_RUNTIME={__proto__:null,c:function(k){return V.H.useMemoCache(k)}},jt.cache=function(k){return function(){return k.apply(null,arguments)}},jt.cloneElement=function(k,J,O){if(k==null)throw Error("The argument must be a React element, but you passed "+k+".");var K=w({},k.props),Y=k.key,H=void 0;if(J!=null)for(pe in J.ref!==void 0&&(H=void 0),J.key!==void 0&&(Y=""+J.key),J)!te.call(J,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&J.ref===void 0||(K[pe]=J[pe]);var pe=arguments.length-2;if(pe===1)K.children=O;else if(1<pe){for(var Ge=Array(pe),He=0;He<pe;He++)Ge[He]=arguments[He+2];K.children=Ge}return N(k.type,Y,void 0,void 0,H,K)},jt.createContext=function(k){return k={$$typeof:d,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null},k.Provider=k,k.Consumer={$$typeof:c,_context:k},k},jt.createElement=function(k,J,O){var K,Y={},H=null;if(J!=null)for(K in J.key!==void 0&&(H=""+J.key),J)te.call(J,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(Y[K]=J[K]);var pe=arguments.length-2;if(pe===1)Y.children=O;else if(1<pe){for(var Ge=Array(pe),He=0;He<pe;He++)Ge[He]=arguments[He+2];Y.children=Ge}if(k&&k.defaultProps)for(K in pe=k.defaultProps,pe)Y[K]===void 0&&(Y[K]=pe[K]);return N(k,H,void 0,void 0,null,Y)},jt.createRef=function(){return{current:null}},jt.forwardRef=function(k){return{$$typeof:f,render:k}},jt.isValidElement=L,jt.lazy=function(k){return{$$typeof:x,_payload:{_status:-1,_result:k},_init:ye}},jt.memo=function(k,J){return{$$typeof:h,type:k,compare:J===void 0?null:J}},jt.startTransition=function(k){var J=V.T,O={};V.T=O;try{var K=k(),Y=V.S;Y!==null&&Y(O,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(Se,ae)}catch(H){ae(H)}finally{V.T=J}},jt.unstable_useCacheRefresh=function(){return V.H.useCacheRefresh()},jt.use=function(k){return V.H.use(k)},jt.useActionState=function(k,J,O){return V.H.useActionState(k,J,O)},jt.useCallback=function(k,J){return V.H.useCallback(k,J)},jt.useContext=function(k){return V.H.useContext(k)},jt.useDebugValue=function(){},jt.useDeferredValue=function(k,J){return V.H.useDeferredValue(k,J)},jt.useEffect=function(k,J,O){var K=V.H;if(typeof O=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return K.useEffect(k,J)},jt.useId=function(){return V.H.useId()},jt.useImperativeHandle=function(k,J,O){return V.H.useImperativeHandle(k,J,O)},jt.useInsertionEffect=function(k,J){return V.H.useInsertionEffect(k,J)},jt.useLayoutEffect=function(k,J){return V.H.useLayoutEffect(k,J)},jt.useMemo=function(k,J){return V.H.useMemo(k,J)},jt.useOptimistic=function(k,J){return V.H.useOptimistic(k,J)},jt.useReducer=function(k,J,O){return V.H.useReducer(k,J,O)},jt.useRef=function(k){return V.H.useRef(k)},jt.useState=function(k){return V.H.useState(k)},jt.useSyncExternalStore=function(k,J,O){return V.H.useSyncExternalStore(k,J,O)},jt.useTransition=function(){return V.H.useTransition()},jt.version="19.1.1",jt}var Xx;function B0(){return Xx||(Xx=1,Hf.exports=Hb()),Hf.exports}var j=B0();const _1=M0(j);var qf={exports:{}},ol={},Gf={exports:{}},Yf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx;function qb(){return Kx||(Kx=1,(function(e){function t(ee,ye){var ae=ee.length;ee.push(ye);e:for(;0<ae;){var Se=ae-1>>>1,k=ee[Se];if(0<o(k,ye))ee[Se]=ye,ee[ae]=k,ae=Se;else break e}}function r(ee){return ee.length===0?null:ee[0]}function a(ee){if(ee.length===0)return null;var ye=ee[0],ae=ee.pop();if(ae!==ye){ee[0]=ae;e:for(var Se=0,k=ee.length,J=k>>>1;Se<J;){var O=2*(Se+1)-1,K=ee[O],Y=O+1,H=ee[Y];if(0>o(K,ae))Y<k&&0>o(H,K)?(ee[Se]=H,ee[Y]=ae,Se=Y):(ee[Se]=K,ee[O]=ae,Se=O);else if(Y<k&&0>o(H,ae))ee[Se]=H,ee[Y]=ae,Se=Y;else break e}}return ye}function o(ee,ye){var ae=ee.sortIndex-ye.sortIndex;return ae!==0?ae:ee.id-ye.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var d=Date,f=d.now();e.unstable_now=function(){return d.now()-f}}var p=[],h=[],x=1,y=null,b=3,v=!1,w=!1,_=!1,T=!1,M=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;function U(ee){for(var ye=r(h);ye!==null;){if(ye.callback===null)a(h);else if(ye.startTime<=ee)a(h),ye.sortIndex=ye.expirationTime,t(p,ye);else break;ye=r(h)}}function V(ee){if(_=!1,U(ee),!w)if(r(p)!==null)w=!0,te||(te=!0,ge());else{var ye=r(h);ye!==null&&Ae(V,ye.startTime-ee)}}var te=!1,N=-1,re=5,L=-1;function X(){return T?!0:!(e.unstable_now()-L<re)}function le(){if(T=!1,te){var ee=e.unstable_now();L=ee;var ye=!0;try{e:{w=!1,_&&(_=!1,F(N),N=-1),v=!0;var ae=b;try{t:{for(U(ee),y=r(p);y!==null&&!(y.expirationTime>ee&&X());){var Se=y.callback;if(typeof Se=="function"){y.callback=null,b=y.priorityLevel;var k=Se(y.expirationTime<=ee);if(ee=e.unstable_now(),typeof k=="function"){y.callback=k,U(ee),ye=!0;break t}y===r(p)&&a(p),U(ee)}else a(p);y=r(p)}if(y!==null)ye=!0;else{var J=r(h);J!==null&&Ae(V,J.startTime-ee),ye=!1}}break e}finally{y=null,b=ae,v=!1}ye=void 0}}finally{ye?ge():te=!1}}}var ge;if(typeof A=="function")ge=function(){A(le)};else if(typeof MessageChannel<"u"){var Re=new MessageChannel,fe=Re.port2;Re.port1.onmessage=le,ge=function(){fe.postMessage(null)}}else ge=function(){M(le,0)};function Ae(ee,ye){N=M(function(){ee(e.unstable_now())},ye)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_next=function(ee){switch(b){case 1:case 2:case 3:var ye=3;break;default:ye=b}var ae=b;b=ye;try{return ee()}finally{b=ae}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(ee,ye){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ae=b;b=ee;try{return ye()}finally{b=ae}},e.unstable_scheduleCallback=function(ee,ye,ae){var Se=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Se+ae:Se):ae=Se,ee){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=ae+k,ee={id:x++,callback:ye,priorityLevel:ee,startTime:ae,expirationTime:k,sortIndex:-1},ae>Se?(ee.sortIndex=ae,t(h,ee),r(p)===null&&ee===r(h)&&(_?(F(N),N=-1):_=!0,Ae(V,ae-Se))):(ee.sortIndex=k,t(p,ee),w||v||(w=!0,te||(te=!0,ge()))),ee},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(ee){var ye=b;return function(){var ae=b;b=ye;try{return ee.apply(this,arguments)}finally{b=ae}}}})(Yf)),Yf}var Qx;function Gb(){return Qx||(Qx=1,Gf.exports=qb()),Gf.exports}var Vf={exports:{}},an={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jx;function Yb(){if(Jx)return an;Jx=1;var e=B0();function t(p){var h="https://react.dev/errors/"+p;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)h+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},o=Symbol.for("react.portal");function c(p,h,x){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:y==null?null:""+y,children:p,containerInfo:h,implementation:x}}var d=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(p,h){if(p==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,an.createPortal=function(p,h){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return c(p,h,null,x)},an.flushSync=function(p){var h=d.T,x=a.p;try{if(d.T=null,a.p=2,p)return p()}finally{d.T=h,a.p=x,a.d.f()}},an.preconnect=function(p,h){typeof p=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,a.d.C(p,h))},an.prefetchDNS=function(p){typeof p=="string"&&a.d.D(p)},an.preinit=function(p,h){if(typeof p=="string"&&h&&typeof h.as=="string"){var x=h.as,y=f(x,h.crossOrigin),b=typeof h.integrity=="string"?h.integrity:void 0,v=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;x==="style"?a.d.S(p,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:y,integrity:b,fetchPriority:v}):x==="script"&&a.d.X(p,{crossOrigin:y,integrity:b,fetchPriority:v,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},an.preinitModule=function(p,h){if(typeof p=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var x=f(h.as,h.crossOrigin);a.d.M(p,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&a.d.M(p)},an.preload=function(p,h){if(typeof p=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var x=h.as,y=f(x,h.crossOrigin);a.d.L(p,x,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},an.preloadModule=function(p,h){if(typeof p=="string")if(h){var x=f(h.as,h.crossOrigin);a.d.m(p,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else a.d.m(p)},an.requestFormReset=function(p){a.d.r(p)},an.unstable_batchedUpdates=function(p,h){return p(h)},an.useFormState=function(p,h,x){return d.H.useFormState(p,h,x)},an.useFormStatus=function(){return d.H.useHostTransitionStatus()},an.version="19.1.1",an}var Zx;function Vb(){if(Zx)return Vf.exports;Zx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Vf.exports=Yb(),Vf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var em;function Xb(){if(em)return ol;em=1;var e=Gb(),t=B0(),r=Vb();function a(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function c(n){var s=n,l=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(l=s.return),n=s.return;while(n)}return s.tag===3?l:null}function d(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function f(n){if(c(n)!==n)throw Error(a(188))}function p(n){var s=n.alternate;if(!s){if(s=c(n),s===null)throw Error(a(188));return s!==n?null:n}for(var l=n,u=s;;){var g=l.return;if(g===null)break;var m=g.alternate;if(m===null){if(u=g.return,u!==null){l=u;continue}break}if(g.child===m.child){for(m=g.child;m;){if(m===l)return f(g),n;if(m===u)return f(g),s;m=m.sibling}throw Error(a(188))}if(l.return!==u.return)l=g,u=m;else{for(var E=!1,D=g.child;D;){if(D===l){E=!0,l=g,u=m;break}if(D===u){E=!0,u=g,l=m;break}D=D.sibling}if(!E){for(D=m.child;D;){if(D===l){E=!0,l=m,u=g;break}if(D===u){E=!0,u=m,l=g;break}D=D.sibling}if(!E)throw Error(a(189))}}if(l.alternate!==u)throw Error(a(190))}if(l.tag!==3)throw Error(a(188));return l.stateNode.current===l?n:s}function h(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=h(n),s!==null)return s;n=n.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),F=Symbol.for("react.consumer"),A=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),re=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),le=Symbol.iterator;function ge(n){return n===null||typeof n!="object"?null:(n=le&&n[le]||n["@@iterator"],typeof n=="function"?n:null)}var Re=Symbol.for("react.client.reference");function fe(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===Re?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case T:return"Profiler";case _:return"StrictMode";case V:return"Suspense";case te:return"SuspenseList";case L:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case v:return"Portal";case A:return(n.displayName||"Context")+".Provider";case F:return(n._context.displayName||"Context")+".Consumer";case U:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case N:return s=n.displayName||null,s!==null?s:fe(n.type)||"Memo";case re:s=n._payload,n=n._init;try{return fe(n(s))}catch{}}return null}var Ae=Array.isArray,ee=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},Se=[],k=-1;function J(n){return{current:n}}function O(n){0>k||(n.current=Se[k],Se[k]=null,k--)}function K(n,s){k++,Se[k]=n.current,n.current=s}var Y=J(null),H=J(null),pe=J(null),Ge=J(null);function He(n,s){switch(K(pe,s),K(H,n),K(Y,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?bx(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=bx(s),n=_x(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}O(Y),K(Y,n)}function De(){O(Y),O(H),O(pe)}function Be(n){n.memoizedState!==null&&K(Ge,n);var s=Y.current,l=_x(s,n.type);s!==l&&(K(H,n),K(Y,l))}function rt(n){H.current===n&&(O(Y),O(H)),Ge.current===n&&(O(Ge),tl._currentValue=ae)}var de=Object.prototype.hasOwnProperty,$e=e.unstable_scheduleCallback,z=e.unstable_cancelCallback,be=e.unstable_shouldYield,Ke=e.unstable_requestPaint,je=e.unstable_now,dt=e.unstable_getCurrentPriorityLevel,We=e.unstable_ImmediatePriority,ot=e.unstable_UserBlockingPriority,Ne=e.unstable_NormalPriority,tt=e.unstable_LowPriority,mt=e.unstable_IdlePriority,ht=e.log,St=e.unstable_setDisableYieldValue,It=null,Tt=null;function oe(n){if(typeof ht=="function"&&St(n),Tt&&typeof Tt.setStrictMode=="function")try{Tt.setStrictMode(It,n)}catch{}}var Le=Math.clz32?Math.clz32:qt,lt=Math.log,Ct=Math.LN2;function qt(n){return n>>>=0,n===0?32:31-(lt(n)/Ct|0)|0}var dr=256,er=4194304;function Pt(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function ut(n,s,l){var u=n.pendingLanes;if(u===0)return 0;var g=0,m=n.suspendedLanes,E=n.pingedLanes;n=n.warmLanes;var D=u&134217727;return D!==0?(u=D&~m,u!==0?g=Pt(u):(E&=D,E!==0?g=Pt(E):l||(l=D&~n,l!==0&&(g=Pt(l))))):(D=u&~m,D!==0?g=Pt(D):E!==0?g=Pt(E):l||(l=u&~n,l!==0&&(g=Pt(l)))),g===0?0:s!==0&&s!==g&&(s&m)===0&&(m=g&-g,l=s&-s,m>=l||m===32&&(l&4194048)!==0)?s:g}function Yt(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function wt(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function se(){var n=dr;return dr<<=1,(dr&4194048)===0&&(dr=256),n}function _e(){var n=er;return er<<=1,(er&62914560)===0&&(er=4194304),n}function gt(n){for(var s=[],l=0;31>l;l++)s.push(n);return s}function pt(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Lt(n,s,l,u,g,m){var E=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var D=n.entanglements,Z=n.expirationTimes,ve=n.hiddenUpdates;for(l=E&~l;0<l;){var Fe=31-Le(l),Ue=1<<Fe;D[Fe]=0,Z[Fe]=-1;var Ee=ve[Fe];if(Ee!==null)for(ve[Fe]=null,Fe=0;Fe<Ee.length;Fe++){var ke=Ee[Fe];ke!==null&&(ke.lane&=-536870913)}l&=~Ue}u!==0&&zt(n,u,0),m!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=m&~(E&~s))}function zt(n,s,l){n.pendingLanes|=s,n.suspendedLanes&=~s;var u=31-Le(s);n.entangledLanes|=s,n.entanglements[u]=n.entanglements[u]|1073741824|l&4194090}function Et(n,s){var l=n.entangledLanes|=s;for(n=n.entanglements;l;){var u=31-Le(l),g=1<<u;g&s|n[u]&s&&(n[u]|=s),l&=~g}}function Lr(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function In(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Dr(){var n=ye.p;return n!==0?n:(n=window.event,n===void 0?32:zx(n.type))}function fr(n,s){var l=ye.p;try{return ye.p=n,s()}finally{ye.p=l}}var hr=Math.random().toString(36).slice(2),Gt="__reactFiber$"+hr,yr="__reactProps$"+hr,Gr="__reactContainer$"+hr,ma="__reactEvents$"+hr,ya="__reactListeners$"+hr,C="__reactHandles$"+hr,q="__reactResources$"+hr,I="__reactMarker$"+hr;function P(n){delete n[Gt],delete n[yr],delete n[ma],delete n[ya],delete n[C]}function W(n){var s=n[Gt];if(s)return s;for(var l=n.parentNode;l;){if(s=l[Gr]||l[Gt]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(n=Ex(n);n!==null;){if(l=n[Gt])return l;n=Ex(n)}return s}n=l,l=n.parentNode}return null}function G(n){if(n=n[Gt]||n[Gr]){var s=n.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return n}return null}function me(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(a(33))}function Me(n){var s=n[q];return s||(s=n[q]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ce(n){n[I]=!0}var we=new Set,Te={};function Ye(n,s){Je(n,s),Je(n+"Capture",s)}function Je(n,s){for(Te[n]=s,n=0;n<s.length;n++)we.add(s[n])}var ct=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Qe={},at={};function bt(n){return de.call(at,n)?!0:de.call(Qe,n)?!1:ct.test(n)?at[n]=!0:(Qe[n]=!0,!1)}function B(n,s,l){if(bt(s))if(l===null)n.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+l)}}function S(n,s,l){if(l===null)n.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+l)}}function Q(n,s,l,u){if(u===null)n.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(s,l,""+u)}}var ne,Ce;function Ve(n){if(ne===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);ne=s&&s[1]||"",Ce=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ne+n+Ce}var ze=!1;function Xe(n,s){if(!n||ze)return"";ze=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var Ue=function(){throw Error()};if(Object.defineProperty(Ue.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ue,[])}catch(ke){var Ee=ke}Reflect.construct(n,[],Ue)}else{try{Ue.call()}catch(ke){Ee=ke}n.call(Ue.prototype)}}else{try{throw Error()}catch(ke){Ee=ke}(Ue=n())&&typeof Ue.catch=="function"&&Ue.catch(function(){})}}catch(ke){if(ke&&Ee&&typeof ke.stack=="string")return[ke.stack,Ee.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=u.DetermineComponentFrameRoot(),E=m[0],D=m[1];if(E&&D){var Z=E.split(`
`),ve=D.split(`
`);for(g=u=0;u<Z.length&&!Z[u].includes("DetermineComponentFrameRoot");)u++;for(;g<ve.length&&!ve[g].includes("DetermineComponentFrameRoot");)g++;if(u===Z.length||g===ve.length)for(u=Z.length-1,g=ve.length-1;1<=u&&0<=g&&Z[u]!==ve[g];)g--;for(;1<=u&&0<=g;u--,g--)if(Z[u]!==ve[g]){if(u!==1||g!==1)do if(u--,g--,0>g||Z[u]!==ve[g]){var Fe=`
`+Z[u].replace(" at new "," at ");return n.displayName&&Fe.includes("<anonymous>")&&(Fe=Fe.replace("<anonymous>",n.displayName)),Fe}while(1<=u&&0<=g);break}}}finally{ze=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?Ve(l):""}function nt(n){switch(n.tag){case 26:case 27:case 5:return Ve(n.type);case 16:return Ve("Lazy");case 13:return Ve("Suspense");case 19:return Ve("SuspenseList");case 0:case 15:return Xe(n.type,!1);case 11:return Xe(n.type.render,!1);case 1:return Xe(n.type,!0);case 31:return Ve("Activity");default:return""}}function st(n){try{var s="";do s+=nt(n),n=n.return;while(n);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function it(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Bt(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function or(n){var s=Bt(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,s),u=""+n[s];if(!n.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var g=l.get,m=l.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return g.call(this)},set:function(E){u=""+E,m.call(this,E)}}),Object.defineProperty(n,s,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(E){u=""+E},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function rn(n){n._valueTracker||(n._valueTracker=or(n))}function wr(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var l=s.getValue(),u="";return n&&(u=Bt(n)?n.checked?"true":"false":n.value),n=u,n!==l?(s.setValue(n),!0):!1}function xr(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var zd=/[\n"\\]/g;function ln(n){return n.replace(zd,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function ni(n,s,l,u,g,m,E,D){n.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?n.type=E:n.removeAttribute("type"),s!=null?E==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+it(s)):n.value!==""+it(s)&&(n.value=""+it(s)):E!=="submit"&&E!=="reset"||n.removeAttribute("value"),s!=null?gn(n,E,it(s)):l!=null?gn(n,E,it(l)):u!=null&&n.removeAttribute("value"),g==null&&m!=null&&(n.defaultChecked=!!m),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?n.name=""+it(D):n.removeAttribute("name")}function tr(n,s,l,u,g,m,E,D){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(n.type=m),s!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||s!=null))return;l=l!=null?""+it(l):"",s=s!=null?""+it(s):l,D||s===n.value||(n.value=s),n.defaultValue=s}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=D?n.checked:!!u,n.defaultChecked=!!u,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(n.name=E)}function gn(n,s,l){s==="number"&&xr(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function va(n,s,l,u){if(n=n.options,s){s={};for(var g=0;g<l.length;g++)s["$"+l[g]]=!0;for(l=0;l<n.length;l++)g=s.hasOwnProperty("$"+n[l].value),n[l].selected!==g&&(n[l].selected=g),g&&u&&(n[l].defaultSelected=!0)}else{for(l=""+it(l),s=null,g=0;g<n.length;g++){if(n[g].value===l){n[g].selected=!0,u&&(n[g].defaultSelected=!0);return}s!==null||n[g].disabled||(s=n[g])}s!==null&&(s.selected=!0)}}function yh(n,s,l){if(s!=null&&(s=""+it(s),s!==n.value&&(n.value=s),l==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=l!=null?""+it(l):""}function vh(n,s,l,u){if(s==null){if(u!=null){if(l!=null)throw Error(a(92));if(Ae(u)){if(1<u.length)throw Error(a(93));u=u[0]}l=u}l==null&&(l=""),s=l}l=it(s),n.defaultValue=l,u=n.textContent,u===l&&u!==""&&u!==null&&(n.value=u)}function ai(n,s){if(s){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=s;return}}n.textContent=s}var Lv=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bh(n,s,l){var u=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":u?n.setProperty(s,l):typeof l!="number"||l===0||Lv.has(s)?s==="float"?n.cssFloat=l:n[s]=(""+l).trim():n[s]=l+"px"}function _h(n,s,l){if(s!=null&&typeof s!="object")throw Error(a(62));if(n=n.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var g in s)u=s[g],s.hasOwnProperty(g)&&l[g]!==u&&bh(n,g,u)}else for(var m in s)s.hasOwnProperty(m)&&bh(n,m,s[m])}function Ud(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pv=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zv=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Wl(n){return zv.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var Wd=null;function $d(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var si=null,ii=null;function Sh(n){var s=G(n);if(s&&(n=s.stateNode)){var l=n[yr]||null;e:switch(n=s.stateNode,s.type){case"input":if(ni(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+ln(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var u=l[s];if(u!==n&&u.form===n.form){var g=u[yr]||null;if(!g)throw Error(a(90));ni(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<l.length;s++)u=l[s],u.form===n.form&&wr(u)}break e;case"textarea":yh(n,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&va(n,!!l.multiple,s,!1)}}}var Hd=!1;function wh(n,s,l){if(Hd)return n(s,l);Hd=!0;try{var u=n(s);return u}finally{if(Hd=!1,(si!==null||ii!==null)&&(jc(),si&&(s=si,n=ii,ii=si=null,Sh(s),n)))for(s=0;s<n.length;s++)Sh(n[s])}}function po(n,s){var l=n.stateNode;if(l===null)return null;var u=l[yr]||null;if(u===null)return null;l=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(a(231,s,typeof l));return l}var ba=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qd=!1;if(ba)try{var go={};Object.defineProperty(go,"passive",{get:function(){qd=!0}}),window.addEventListener("test",go,go),window.removeEventListener("test",go,go)}catch{qd=!1}var Ga=null,Gd=null,$l=null;function Th(){if($l)return $l;var n,s=Gd,l=s.length,u,g="value"in Ga?Ga.value:Ga.textContent,m=g.length;for(n=0;n<l&&s[n]===g[n];n++);var E=l-n;for(u=1;u<=E&&s[l-u]===g[m-u];u++);return $l=g.slice(n,1<u?1-u:void 0)}function Hl(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function ql(){return!0}function Eh(){return!1}function xn(n){function s(l,u,g,m,E){this._reactName=l,this._targetInst=g,this.type=u,this.nativeEvent=m,this.target=E,this.currentTarget=null;for(var D in n)n.hasOwnProperty(D)&&(l=n[D],this[D]=l?l(m):m[D]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?ql:Eh,this.isPropagationStopped=Eh,this}return x(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),s}var Es={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gl=xn(Es),xo=x({},Es,{view:0,detail:0}),Uv=xn(xo),Yd,Vd,mo,Yl=x({},xo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kd,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==mo&&(mo&&n.type==="mousemove"?(Yd=n.screenX-mo.screenX,Vd=n.screenY-mo.screenY):Vd=Yd=0,mo=n),Yd)},movementY:function(n){return"movementY"in n?n.movementY:Vd}}),kh=xn(Yl),Wv=x({},Yl,{dataTransfer:0}),$v=xn(Wv),Hv=x({},xo,{relatedTarget:0}),Xd=xn(Hv),qv=x({},Es,{animationName:0,elapsedTime:0,pseudoElement:0}),Gv=xn(qv),Yv=x({},Es,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Vv=xn(Yv),Xv=x({},Es,{data:0}),jh=xn(Xv),Kv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Jv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zv(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=Jv[n])?!!s[n]:!1}function Kd(){return Zv}var e2=x({},xo,{key:function(n){if(n.key){var s=Kv[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Hl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Qv[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kd,charCode:function(n){return n.type==="keypress"?Hl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Hl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),t2=xn(e2),r2=x({},Yl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ch=xn(r2),n2=x({},xo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kd}),a2=xn(n2),s2=x({},Es,{propertyName:0,elapsedTime:0,pseudoElement:0}),i2=xn(s2),o2=x({},Yl,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),l2=xn(o2),c2=x({},Es,{newState:0,oldState:0}),d2=xn(c2),u2=[9,13,27,32],Qd=ba&&"CompositionEvent"in window,yo=null;ba&&"documentMode"in document&&(yo=document.documentMode);var f2=ba&&"TextEvent"in window&&!yo,Ah=ba&&(!Qd||yo&&8<yo&&11>=yo),Rh=" ",Dh=!1;function Nh(n,s){switch(n){case"keyup":return u2.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oh(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var oi=!1;function h2(n,s){switch(n){case"compositionend":return Oh(s);case"keypress":return s.which!==32?null:(Dh=!0,Rh);case"textInput":return n=s.data,n===Rh&&Dh?null:n;default:return null}}function p2(n,s){if(oi)return n==="compositionend"||!Qd&&Nh(n,s)?(n=Th(),$l=Gd=Ga=null,oi=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Ah&&s.locale!=="ko"?null:s.data;default:return null}}var g2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mh(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!g2[n.type]:s==="textarea"}function Bh(n,s,l,u){si?ii?ii.push(u):ii=[u]:si=u,s=Oc(s,"onChange"),0<s.length&&(l=new Gl("onChange","change",null,l,u),n.push({event:l,listeners:s}))}var vo=null,bo=null;function x2(n){gx(n,0)}function Vl(n){var s=me(n);if(wr(s))return n}function Ih(n,s){if(n==="change")return s}var Fh=!1;if(ba){var Jd;if(ba){var Zd="oninput"in document;if(!Zd){var Lh=document.createElement("div");Lh.setAttribute("oninput","return;"),Zd=typeof Lh.oninput=="function"}Jd=Zd}else Jd=!1;Fh=Jd&&(!document.documentMode||9<document.documentMode)}function Ph(){vo&&(vo.detachEvent("onpropertychange",zh),bo=vo=null)}function zh(n){if(n.propertyName==="value"&&Vl(bo)){var s=[];Bh(s,bo,n,$d(n)),wh(x2,s)}}function m2(n,s,l){n==="focusin"?(Ph(),vo=s,bo=l,vo.attachEvent("onpropertychange",zh)):n==="focusout"&&Ph()}function y2(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Vl(bo)}function v2(n,s){if(n==="click")return Vl(s)}function b2(n,s){if(n==="input"||n==="change")return Vl(s)}function _2(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var Tn=typeof Object.is=="function"?Object.is:_2;function _o(n,s){if(Tn(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var l=Object.keys(n),u=Object.keys(s);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var g=l[u];if(!de.call(s,g)||!Tn(n[g],s[g]))return!1}return!0}function Uh(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Wh(n,s){var l=Uh(n);n=0;for(var u;l;){if(l.nodeType===3){if(u=n+l.textContent.length,n<=s&&u>=s)return{node:l,offset:s-n};n=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Uh(l)}}function $h(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?$h(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function Hh(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=xr(n.document);s instanceof n.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)n=s.contentWindow;else break;s=xr(n.document)}return s}function eu(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var S2=ba&&"documentMode"in document&&11>=document.documentMode,li=null,tu=null,So=null,ru=!1;function qh(n,s,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;ru||li==null||li!==xr(u)||(u=li,"selectionStart"in u&&eu(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),So&&_o(So,u)||(So=u,u=Oc(tu,"onSelect"),0<u.length&&(s=new Gl("onSelect","select",null,s,l),n.push({event:s,listeners:u}),s.target=li)))}function ks(n,s){var l={};return l[n.toLowerCase()]=s.toLowerCase(),l["Webkit"+n]="webkit"+s,l["Moz"+n]="moz"+s,l}var ci={animationend:ks("Animation","AnimationEnd"),animationiteration:ks("Animation","AnimationIteration"),animationstart:ks("Animation","AnimationStart"),transitionrun:ks("Transition","TransitionRun"),transitionstart:ks("Transition","TransitionStart"),transitioncancel:ks("Transition","TransitionCancel"),transitionend:ks("Transition","TransitionEnd")},nu={},Gh={};ba&&(Gh=document.createElement("div").style,"AnimationEvent"in window||(delete ci.animationend.animation,delete ci.animationiteration.animation,delete ci.animationstart.animation),"TransitionEvent"in window||delete ci.transitionend.transition);function js(n){if(nu[n])return nu[n];if(!ci[n])return n;var s=ci[n],l;for(l in s)if(s.hasOwnProperty(l)&&l in Gh)return nu[n]=s[l];return n}var Yh=js("animationend"),Vh=js("animationiteration"),Xh=js("animationstart"),w2=js("transitionrun"),T2=js("transitionstart"),E2=js("transitioncancel"),Kh=js("transitionend"),Qh=new Map,au="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");au.push("scrollEnd");function Vn(n,s){Qh.set(n,s),Ye(s,[n])}var Jh=new WeakMap;function Fn(n,s){if(typeof n=="object"&&n!==null){var l=Jh.get(n);return l!==void 0?l:(s={value:n,source:s,stack:st(s)},Jh.set(n,s),s)}return{value:n,source:s,stack:st(s)}}var Ln=[],di=0,su=0;function Xl(){for(var n=di,s=su=di=0;s<n;){var l=Ln[s];Ln[s++]=null;var u=Ln[s];Ln[s++]=null;var g=Ln[s];Ln[s++]=null;var m=Ln[s];if(Ln[s++]=null,u!==null&&g!==null){var E=u.pending;E===null?g.next=g:(g.next=E.next,E.next=g),u.pending=g}m!==0&&Zh(l,g,m)}}function Kl(n,s,l,u){Ln[di++]=n,Ln[di++]=s,Ln[di++]=l,Ln[di++]=u,su|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function iu(n,s,l,u){return Kl(n,s,l,u),Ql(n)}function ui(n,s){return Kl(n,null,null,s),Ql(n)}function Zh(n,s,l){n.lanes|=l;var u=n.alternate;u!==null&&(u.lanes|=l);for(var g=!1,m=n.return;m!==null;)m.childLanes|=l,u=m.alternate,u!==null&&(u.childLanes|=l),m.tag===22&&(n=m.stateNode,n===null||n._visibility&1||(g=!0)),n=m,m=m.return;return n.tag===3?(m=n.stateNode,g&&s!==null&&(g=31-Le(l),n=m.hiddenUpdates,u=n[g],u===null?n[g]=[s]:u.push(s),s.lane=l|536870912),m):null}function Ql(n){if(50<Yo)throw Yo=0,hf=null,Error(a(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var fi={};function k2(n,s,l,u){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function En(n,s,l,u){return new k2(n,s,l,u)}function ou(n){return n=n.prototype,!(!n||!n.isReactComponent)}function _a(n,s){var l=n.alternate;return l===null?(l=En(n.tag,s,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=s,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,s=n.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function ep(n,s){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,s=l.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function Jl(n,s,l,u,g,m){var E=0;if(u=n,typeof n=="function")ou(n)&&(E=1);else if(typeof n=="string")E=Cb(n,l,Y.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case L:return n=En(31,l,s,g),n.elementType=L,n.lanes=m,n;case w:return Cs(l.children,g,m,s);case _:E=8,g|=24;break;case T:return n=En(12,l,s,g|2),n.elementType=T,n.lanes=m,n;case V:return n=En(13,l,s,g),n.elementType=V,n.lanes=m,n;case te:return n=En(19,l,s,g),n.elementType=te,n.lanes=m,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case M:case A:E=10;break e;case F:E=9;break e;case U:E=11;break e;case N:E=14;break e;case re:E=16,u=null;break e}E=29,l=Error(a(130,n===null?"null":typeof n,"")),u=null}return s=En(E,l,s,g),s.elementType=n,s.type=u,s.lanes=m,s}function Cs(n,s,l,u){return n=En(7,n,u,s),n.lanes=l,n}function lu(n,s,l){return n=En(6,n,null,s),n.lanes=l,n}function cu(n,s,l){return s=En(4,n.children!==null?n.children:[],n.key,s),s.lanes=l,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var hi=[],pi=0,Zl=null,ec=0,Pn=[],zn=0,As=null,Sa=1,wa="";function Rs(n,s){hi[pi++]=ec,hi[pi++]=Zl,Zl=n,ec=s}function tp(n,s,l){Pn[zn++]=Sa,Pn[zn++]=wa,Pn[zn++]=As,As=n;var u=Sa;n=wa;var g=32-Le(u)-1;u&=~(1<<g),l+=1;var m=32-Le(s)+g;if(30<m){var E=g-g%5;m=(u&(1<<E)-1).toString(32),u>>=E,g-=E,Sa=1<<32-Le(s)+g|l<<g|u,wa=m+n}else Sa=1<<m|l<<g|u,wa=n}function du(n){n.return!==null&&(Rs(n,1),tp(n,1,0))}function uu(n){for(;n===Zl;)Zl=hi[--pi],hi[pi]=null,ec=hi[--pi],hi[pi]=null;for(;n===As;)As=Pn[--zn],Pn[zn]=null,wa=Pn[--zn],Pn[zn]=null,Sa=Pn[--zn],Pn[zn]=null}var cn=null,vr=null,$t=!1,Ds=null,oa=!1,fu=Error(a(519));function Ns(n){var s=Error(a(418,""));throw Eo(Fn(s,n)),fu}function rp(n){var s=n.stateNode,l=n.type,u=n.memoizedProps;switch(s[Gt]=n,s[yr]=u,l){case"dialog":Ot("cancel",s),Ot("close",s);break;case"iframe":case"object":case"embed":Ot("load",s);break;case"video":case"audio":for(l=0;l<Xo.length;l++)Ot(Xo[l],s);break;case"source":Ot("error",s);break;case"img":case"image":case"link":Ot("error",s),Ot("load",s);break;case"details":Ot("toggle",s);break;case"input":Ot("invalid",s),tr(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),rn(s);break;case"select":Ot("invalid",s);break;case"textarea":Ot("invalid",s),vh(s,u.value,u.defaultValue,u.children),rn(s)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||u.suppressHydrationWarning===!0||vx(s.textContent,l)?(u.popover!=null&&(Ot("beforetoggle",s),Ot("toggle",s)),u.onScroll!=null&&Ot("scroll",s),u.onScrollEnd!=null&&Ot("scrollend",s),u.onClick!=null&&(s.onclick=Mc),s=!0):s=!1,s||Ns(n)}function np(n){for(cn=n.return;cn;)switch(cn.tag){case 5:case 13:oa=!1;return;case 27:case 3:oa=!0;return;default:cn=cn.return}}function wo(n){if(n!==cn)return!1;if(!$t)return np(n),$t=!0,!1;var s=n.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||Af(n.type,n.memoizedProps)),l=!l),l&&vr&&Ns(n),np(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));e:{for(n=n.nextSibling,s=0;n;){if(n.nodeType===8)if(l=n.data,l==="/$"){if(s===0){vr=Kn(n.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;n=n.nextSibling}vr=null}}else s===27?(s=vr,ls(n.type)?(n=Of,Of=null,vr=n):vr=s):vr=cn?Kn(n.stateNode.nextSibling):null;return!0}function To(){vr=cn=null,$t=!1}function ap(){var n=Ds;return n!==null&&(vn===null?vn=n:vn.push.apply(vn,n),Ds=null),n}function Eo(n){Ds===null?Ds=[n]:Ds.push(n)}var hu=J(null),Os=null,Ta=null;function Ya(n,s,l){K(hu,s._currentValue),s._currentValue=l}function Ea(n){n._currentValue=hu.current,O(hu)}function pu(n,s,l){for(;n!==null;){var u=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),n===l)break;n=n.return}}function gu(n,s,l,u){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var m=g.dependencies;if(m!==null){var E=g.child;m=m.firstContext;e:for(;m!==null;){var D=m;m=g;for(var Z=0;Z<s.length;Z++)if(D.context===s[Z]){m.lanes|=l,D=m.alternate,D!==null&&(D.lanes|=l),pu(m.return,l,n),u||(E=null);break e}m=D.next}}else if(g.tag===18){if(E=g.return,E===null)throw Error(a(341));E.lanes|=l,m=E.alternate,m!==null&&(m.lanes|=l),pu(E,l,n),E=null}else E=g.child;if(E!==null)E.return=g;else for(E=g;E!==null;){if(E===n){E=null;break}if(g=E.sibling,g!==null){g.return=E.return,E=g;break}E=E.return}g=E}}function ko(n,s,l,u){n=null;for(var g=s,m=!1;g!==null;){if(!m){if((g.flags&524288)!==0)m=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var E=g.alternate;if(E===null)throw Error(a(387));if(E=E.memoizedProps,E!==null){var D=g.type;Tn(g.pendingProps.value,E.value)||(n!==null?n.push(D):n=[D])}}else if(g===Ge.current){if(E=g.alternate,E===null)throw Error(a(387));E.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(tl):n=[tl])}g=g.return}n!==null&&gu(s,n,l,u),s.flags|=262144}function tc(n){for(n=n.firstContext;n!==null;){if(!Tn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ms(n){Os=n,Ta=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function nn(n){return sp(Os,n)}function rc(n,s){return Os===null&&Ms(n),sp(n,s)}function sp(n,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},Ta===null){if(n===null)throw Error(a(308));Ta=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else Ta=Ta.next=s;return l}var j2=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(l,u){n.push(u)}};this.abort=function(){s.aborted=!0,n.forEach(function(l){return l()})}},C2=e.unstable_scheduleCallback,A2=e.unstable_NormalPriority,Nr={$$typeof:A,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xu(){return{controller:new j2,data:new Map,refCount:0}}function jo(n){n.refCount--,n.refCount===0&&C2(A2,function(){n.controller.abort()})}var Co=null,mu=0,gi=0,xi=null;function R2(n,s){if(Co===null){var l=Co=[];mu=0,gi=bf(),xi={status:"pending",value:void 0,then:function(u){l.push(u)}}}return mu++,s.then(ip,ip),s}function ip(){if(--mu===0&&Co!==null){xi!==null&&(xi.status="fulfilled");var n=Co;Co=null,gi=0,xi=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function D2(n,s){var l=[],u={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return n.then(function(){u.status="fulfilled",u.value=s;for(var g=0;g<l.length;g++)(0,l[g])(s)},function(g){for(u.status="rejected",u.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),u}var op=ee.S;ee.S=function(n,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&R2(n,s),op!==null&&op(n,s)};var Bs=J(null);function yu(){var n=Bs.current;return n!==null?n:lr.pooledCache}function nc(n,s){s===null?K(Bs,Bs.current):K(Bs,s.pool)}function lp(){var n=yu();return n===null?null:{parent:Nr._currentValue,pool:n}}var Ao=Error(a(460)),cp=Error(a(474)),ac=Error(a(542)),vu={then:function(){}};function dp(n){return n=n.status,n==="fulfilled"||n==="rejected"}function sc(){}function up(n,s,l){switch(l=n[l],l===void 0?n.push(s):l!==s&&(s.then(sc,sc),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,hp(n),n;default:if(typeof s.status=="string")s.then(sc,sc);else{if(n=lr,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=s,n.status="pending",n.then(function(u){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=u}},function(u){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,hp(n),n}throw Ro=s,Ao}}var Ro=null;function fp(){if(Ro===null)throw Error(a(459));var n=Ro;return Ro=null,n}function hp(n){if(n===Ao||n===ac)throw Error(a(483))}var Va=!1;function bu(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _u(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Xa(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ka(n,s,l){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(Vt&2)!==0){var g=u.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),u.pending=s,s=Ql(n),Zh(n,null,l),s}return Kl(n,u,s,l),Ql(n)}function Do(n,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var u=s.lanes;u&=n.pendingLanes,l|=u,s.lanes=l,Et(n,l)}}function Su(n,s){var l=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var g=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var E={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?g=m=E:m=m.next=E,l=l.next}while(l!==null);m===null?g=m=s:m=m.next=s}else g=m=s;l={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:m,shared:u.shared,callbacks:u.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=s:n.next=s,l.lastBaseUpdate=s}var wu=!1;function No(){if(wu){var n=xi;if(n!==null)throw n}}function Oo(n,s,l,u){wu=!1;var g=n.updateQueue;Va=!1;var m=g.firstBaseUpdate,E=g.lastBaseUpdate,D=g.shared.pending;if(D!==null){g.shared.pending=null;var Z=D,ve=Z.next;Z.next=null,E===null?m=ve:E.next=ve,E=Z;var Fe=n.alternate;Fe!==null&&(Fe=Fe.updateQueue,D=Fe.lastBaseUpdate,D!==E&&(D===null?Fe.firstBaseUpdate=ve:D.next=ve,Fe.lastBaseUpdate=Z))}if(m!==null){var Ue=g.baseState;E=0,Fe=ve=Z=null,D=m;do{var Ee=D.lane&-536870913,ke=Ee!==D.lane;if(ke?(Ft&Ee)===Ee:(u&Ee)===Ee){Ee!==0&&Ee===gi&&(wu=!0),Fe!==null&&(Fe=Fe.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var _t=n,yt=D;Ee=s;var ar=l;switch(yt.tag){case 1:if(_t=yt.payload,typeof _t=="function"){Ue=_t.call(ar,Ue,Ee);break e}Ue=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=yt.payload,Ee=typeof _t=="function"?_t.call(ar,Ue,Ee):_t,Ee==null)break e;Ue=x({},Ue,Ee);break e;case 2:Va=!0}}Ee=D.callback,Ee!==null&&(n.flags|=64,ke&&(n.flags|=8192),ke=g.callbacks,ke===null?g.callbacks=[Ee]:ke.push(Ee))}else ke={lane:Ee,tag:D.tag,payload:D.payload,callback:D.callback,next:null},Fe===null?(ve=Fe=ke,Z=Ue):Fe=Fe.next=ke,E|=Ee;if(D=D.next,D===null){if(D=g.shared.pending,D===null)break;ke=D,D=ke.next,ke.next=null,g.lastBaseUpdate=ke,g.shared.pending=null}}while(!0);Fe===null&&(Z=Ue),g.baseState=Z,g.firstBaseUpdate=ve,g.lastBaseUpdate=Fe,m===null&&(g.shared.lanes=0),as|=E,n.lanes=E,n.memoizedState=Ue}}function pp(n,s){if(typeof n!="function")throw Error(a(191,n));n.call(s)}function gp(n,s){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)pp(l[n],s)}var mi=J(null),ic=J(0);function xp(n,s){n=Na,K(ic,n),K(mi,s),Na=n|s.baseLanes}function Tu(){K(ic,Na),K(mi,mi.current)}function Eu(){Na=ic.current,O(mi),O(ic)}var Qa=0,Rt=null,rr=null,kr=null,oc=!1,yi=!1,Is=!1,lc=0,Mo=0,vi=null,N2=0;function Tr(){throw Error(a(321))}function ku(n,s){if(s===null)return!1;for(var l=0;l<s.length&&l<n.length;l++)if(!Tn(n[l],s[l]))return!1;return!0}function ju(n,s,l,u,g,m){return Qa=m,Rt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ee.H=n===null||n.memoizedState===null?Zp:eg,Is=!1,m=l(u,g),Is=!1,yi&&(m=yp(s,l,u,g)),mp(n),m}function mp(n){ee.H=pc;var s=rr!==null&&rr.next!==null;if(Qa=0,kr=rr=Rt=null,oc=!1,Mo=0,vi=null,s)throw Error(a(300));n===null||Pr||(n=n.dependencies,n!==null&&tc(n)&&(Pr=!0))}function yp(n,s,l,u){Rt=n;var g=0;do{if(yi&&(vi=null),Mo=0,yi=!1,25<=g)throw Error(a(301));if(g+=1,kr=rr=null,n.updateQueue!=null){var m=n.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}ee.H=P2,m=s(l,u)}while(yi);return m}function O2(){var n=ee.H,s=n.useState()[0];return s=typeof s.then=="function"?Bo(s):s,n=n.useState()[0],(rr!==null?rr.memoizedState:null)!==n&&(Rt.flags|=1024),s}function Cu(){var n=lc!==0;return lc=0,n}function Au(n,s,l){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~l}function Ru(n){if(oc){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}oc=!1}Qa=0,kr=rr=Rt=null,yi=!1,Mo=lc=0,vi=null}function mn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?Rt.memoizedState=kr=n:kr=kr.next=n,kr}function jr(){if(rr===null){var n=Rt.alternate;n=n!==null?n.memoizedState:null}else n=rr.next;var s=kr===null?Rt.memoizedState:kr.next;if(s!==null)kr=s,rr=n;else{if(n===null)throw Rt.alternate===null?Error(a(467)):Error(a(310));rr=n,n={memoizedState:rr.memoizedState,baseState:rr.baseState,baseQueue:rr.baseQueue,queue:rr.queue,next:null},kr===null?Rt.memoizedState=kr=n:kr=kr.next=n}return kr}function Du(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Bo(n){var s=Mo;return Mo+=1,vi===null&&(vi=[]),n=up(vi,n,s),s=Rt,(kr===null?s.memoizedState:kr.next)===null&&(s=s.alternate,ee.H=s===null||s.memoizedState===null?Zp:eg),n}function cc(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Bo(n);if(n.$$typeof===A)return nn(n)}throw Error(a(438,String(n)))}function Nu(n){var s=null,l=Rt.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var u=Rt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=Du(),Rt.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(n),u=0;u<n;u++)l[u]=X;return s.index++,l}function ka(n,s){return typeof s=="function"?s(n):s}function dc(n){var s=jr();return Ou(s,rr,n)}function Ou(n,s,l){var u=n.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=l;var g=n.baseQueue,m=u.pending;if(m!==null){if(g!==null){var E=g.next;g.next=m.next,m.next=E}s.baseQueue=g=m,u.pending=null}if(m=n.baseState,g===null)n.memoizedState=m;else{s=g.next;var D=E=null,Z=null,ve=s,Fe=!1;do{var Ue=ve.lane&-536870913;if(Ue!==ve.lane?(Ft&Ue)===Ue:(Qa&Ue)===Ue){var Ee=ve.revertLane;if(Ee===0)Z!==null&&(Z=Z.next={lane:0,revertLane:0,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null}),Ue===gi&&(Fe=!0);else if((Qa&Ee)===Ee){ve=ve.next,Ee===gi&&(Fe=!0);continue}else Ue={lane:0,revertLane:ve.revertLane,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},Z===null?(D=Z=Ue,E=m):Z=Z.next=Ue,Rt.lanes|=Ee,as|=Ee;Ue=ve.action,Is&&l(m,Ue),m=ve.hasEagerState?ve.eagerState:l(m,Ue)}else Ee={lane:Ue,revertLane:ve.revertLane,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null},Z===null?(D=Z=Ee,E=m):Z=Z.next=Ee,Rt.lanes|=Ue,as|=Ue;ve=ve.next}while(ve!==null&&ve!==s);if(Z===null?E=m:Z.next=D,!Tn(m,n.memoizedState)&&(Pr=!0,Fe&&(l=xi,l!==null)))throw l;n.memoizedState=m,n.baseState=E,n.baseQueue=Z,u.lastRenderedState=m}return g===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function Mu(n){var s=jr(),l=s.queue;if(l===null)throw Error(a(311));l.lastRenderedReducer=n;var u=l.dispatch,g=l.pending,m=s.memoizedState;if(g!==null){l.pending=null;var E=g=g.next;do m=n(m,E.action),E=E.next;while(E!==g);Tn(m,s.memoizedState)||(Pr=!0),s.memoizedState=m,s.baseQueue===null&&(s.baseState=m),l.lastRenderedState=m}return[m,u]}function vp(n,s,l){var u=Rt,g=jr(),m=$t;if(m){if(l===void 0)throw Error(a(407));l=l()}else l=s();var E=!Tn((rr||g).memoizedState,l);E&&(g.memoizedState=l,Pr=!0),g=g.queue;var D=Sp.bind(null,u,g,n);if(Io(2048,8,D,[n]),g.getSnapshot!==s||E||kr!==null&&kr.memoizedState.tag&1){if(u.flags|=2048,bi(9,uc(),_p.bind(null,u,g,l,s),null),lr===null)throw Error(a(349));m||(Qa&124)!==0||bp(u,s,l)}return l}function bp(n,s,l){n.flags|=16384,n={getSnapshot:s,value:l},s=Rt.updateQueue,s===null?(s=Du(),Rt.updateQueue=s,s.stores=[n]):(l=s.stores,l===null?s.stores=[n]:l.push(n))}function _p(n,s,l,u){s.value=l,s.getSnapshot=u,wp(s)&&Tp(n)}function Sp(n,s,l){return l(function(){wp(s)&&Tp(n)})}function wp(n){var s=n.getSnapshot;n=n.value;try{var l=s();return!Tn(n,l)}catch{return!0}}function Tp(n){var s=ui(n,2);s!==null&&Rn(s,n,2)}function Bu(n){var s=mn();if(typeof n=="function"){var l=n;if(n=l(),Is){oe(!0);try{l()}finally{oe(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:n},s}function Ep(n,s,l,u){return n.baseState=l,Ou(n,rr,typeof u=="function"?u:ka)}function M2(n,s,l,u,g){if(hc(n))throw Error(a(485));if(n=s.action,n!==null){var m={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){m.listeners.push(E)}};ee.T!==null?l(!0):m.isTransition=!1,u(m),l=s.pending,l===null?(m.next=s.pending=m,kp(s,m)):(m.next=l.next,s.pending=l.next=m)}}function kp(n,s){var l=s.action,u=s.payload,g=n.state;if(s.isTransition){var m=ee.T,E={};ee.T=E;try{var D=l(g,u),Z=ee.S;Z!==null&&Z(E,D),jp(n,s,D)}catch(ve){Iu(n,s,ve)}finally{ee.T=m}}else try{m=l(g,u),jp(n,s,m)}catch(ve){Iu(n,s,ve)}}function jp(n,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){Cp(n,s,u)},function(u){return Iu(n,s,u)}):Cp(n,s,l)}function Cp(n,s,l){s.status="fulfilled",s.value=l,Ap(s),n.state=l,s=n.pending,s!==null&&(l=s.next,l===s?n.pending=null:(l=l.next,s.next=l,kp(n,l)))}function Iu(n,s,l){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=l,Ap(s),s=s.next;while(s!==u)}n.action=null}function Ap(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function Rp(n,s){return s}function Dp(n,s){if($t){var l=lr.formState;if(l!==null){e:{var u=Rt;if($t){if(vr){t:{for(var g=vr,m=oa;g.nodeType!==8;){if(!m){g=null;break t}if(g=Kn(g.nextSibling),g===null){g=null;break t}}m=g.data,g=m==="F!"||m==="F"?g:null}if(g){vr=Kn(g.nextSibling),u=g.data==="F!";break e}}Ns(u)}u=!1}u&&(s=l[0])}}return l=mn(),l.memoizedState=l.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Rp,lastRenderedState:s},l.queue=u,l=Kp.bind(null,Rt,u),u.dispatch=l,u=Bu(!1),m=Uu.bind(null,Rt,!1,u.queue),u=mn(),g={state:s,dispatch:null,action:n,pending:null},u.queue=g,l=M2.bind(null,Rt,g,m,l),g.dispatch=l,u.memoizedState=n,[s,l,!1]}function Np(n){var s=jr();return Op(s,rr,n)}function Op(n,s,l){if(s=Ou(n,s,Rp)[0],n=dc(ka)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=Bo(s)}catch(E){throw E===Ao?ac:E}else u=s;s=jr();var g=s.queue,m=g.dispatch;return l!==s.memoizedState&&(Rt.flags|=2048,bi(9,uc(),B2.bind(null,g,l),null)),[u,m,n]}function B2(n,s){n.action=s}function Mp(n){var s=jr(),l=rr;if(l!==null)return Op(s,l,n);jr(),s=s.memoizedState,l=jr();var u=l.queue.dispatch;return l.memoizedState=n,[s,u,!1]}function bi(n,s,l,u){return n={tag:n,create:l,deps:u,inst:s,next:null},s=Rt.updateQueue,s===null&&(s=Du(),Rt.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=n.next=n:(u=l.next,l.next=n,n.next=u,s.lastEffect=n),n}function uc(){return{destroy:void 0,resource:void 0}}function Bp(){return jr().memoizedState}function fc(n,s,l,u){var g=mn();u=u===void 0?null:u,Rt.flags|=n,g.memoizedState=bi(1|s,uc(),l,u)}function Io(n,s,l,u){var g=jr();u=u===void 0?null:u;var m=g.memoizedState.inst;rr!==null&&u!==null&&ku(u,rr.memoizedState.deps)?g.memoizedState=bi(s,m,l,u):(Rt.flags|=n,g.memoizedState=bi(1|s,m,l,u))}function Ip(n,s){fc(8390656,8,n,s)}function Fp(n,s){Io(2048,8,n,s)}function Lp(n,s){return Io(4,2,n,s)}function Pp(n,s){return Io(4,4,n,s)}function zp(n,s){if(typeof s=="function"){n=n();var l=s(n);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function Up(n,s,l){l=l!=null?l.concat([n]):null,Io(4,4,zp.bind(null,s,n),l)}function Fu(){}function Wp(n,s){var l=jr();s=s===void 0?null:s;var u=l.memoizedState;return s!==null&&ku(s,u[1])?u[0]:(l.memoizedState=[n,s],n)}function $p(n,s){var l=jr();s=s===void 0?null:s;var u=l.memoizedState;if(s!==null&&ku(s,u[1]))return u[0];if(u=n(),Is){oe(!0);try{n()}finally{oe(!1)}}return l.memoizedState=[u,s],u}function Lu(n,s,l){return l===void 0||(Qa&1073741824)!==0?n.memoizedState=s:(n.memoizedState=l,n=Gg(),Rt.lanes|=n,as|=n,l)}function Hp(n,s,l,u){return Tn(l,s)?l:mi.current!==null?(n=Lu(n,l,u),Tn(n,s)||(Pr=!0),n):(Qa&42)===0?(Pr=!0,n.memoizedState=l):(n=Gg(),Rt.lanes|=n,as|=n,s)}function qp(n,s,l,u,g){var m=ye.p;ye.p=m!==0&&8>m?m:8;var E=ee.T,D={};ee.T=D,Uu(n,!1,s,l);try{var Z=g(),ve=ee.S;if(ve!==null&&ve(D,Z),Z!==null&&typeof Z=="object"&&typeof Z.then=="function"){var Fe=D2(Z,u);Fo(n,s,Fe,An(n))}else Fo(n,s,u,An(n))}catch(Ue){Fo(n,s,{then:function(){},status:"rejected",reason:Ue},An())}finally{ye.p=m,ee.T=E}}function I2(){}function Pu(n,s,l,u){if(n.tag!==5)throw Error(a(476));var g=Gp(n).queue;qp(n,g,s,ae,l===null?I2:function(){return Yp(n),l(u)})}function Gp(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:ae},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:l},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function Yp(n){var s=Gp(n).next.queue;Fo(n,s,{},An())}function zu(){return nn(tl)}function Vp(){return jr().memoizedState}function Xp(){return jr().memoizedState}function F2(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var l=An();n=Xa(l);var u=Ka(s,n,l);u!==null&&(Rn(u,s,l),Do(u,s,l)),s={cache:xu()},n.payload=s;return}s=s.return}}function L2(n,s,l){var u=An();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},hc(n)?Qp(s,l):(l=iu(n,s,l,u),l!==null&&(Rn(l,n,u),Jp(l,s,u)))}function Kp(n,s,l){var u=An();Fo(n,s,l,u)}function Fo(n,s,l,u){var g={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(hc(n))Qp(s,g);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=s.lastRenderedReducer,m!==null))try{var E=s.lastRenderedState,D=m(E,l);if(g.hasEagerState=!0,g.eagerState=D,Tn(D,E))return Kl(n,s,g,0),lr===null&&Xl(),!1}catch{}finally{}if(l=iu(n,s,g,u),l!==null)return Rn(l,n,u),Jp(l,s,u),!0}return!1}function Uu(n,s,l,u){if(u={lane:2,revertLane:bf(),action:u,hasEagerState:!1,eagerState:null,next:null},hc(n)){if(s)throw Error(a(479))}else s=iu(n,l,u,2),s!==null&&Rn(s,n,2)}function hc(n){var s=n.alternate;return n===Rt||s!==null&&s===Rt}function Qp(n,s){yi=oc=!0;var l=n.pending;l===null?s.next=s:(s.next=l.next,l.next=s),n.pending=s}function Jp(n,s,l){if((l&4194048)!==0){var u=s.lanes;u&=n.pendingLanes,l|=u,s.lanes=l,Et(n,l)}}var pc={readContext:nn,use:cc,useCallback:Tr,useContext:Tr,useEffect:Tr,useImperativeHandle:Tr,useLayoutEffect:Tr,useInsertionEffect:Tr,useMemo:Tr,useReducer:Tr,useRef:Tr,useState:Tr,useDebugValue:Tr,useDeferredValue:Tr,useTransition:Tr,useSyncExternalStore:Tr,useId:Tr,useHostTransitionStatus:Tr,useFormState:Tr,useActionState:Tr,useOptimistic:Tr,useMemoCache:Tr,useCacheRefresh:Tr},Zp={readContext:nn,use:cc,useCallback:function(n,s){return mn().memoizedState=[n,s===void 0?null:s],n},useContext:nn,useEffect:Ip,useImperativeHandle:function(n,s,l){l=l!=null?l.concat([n]):null,fc(4194308,4,zp.bind(null,s,n),l)},useLayoutEffect:function(n,s){return fc(4194308,4,n,s)},useInsertionEffect:function(n,s){fc(4,2,n,s)},useMemo:function(n,s){var l=mn();s=s===void 0?null:s;var u=n();if(Is){oe(!0);try{n()}finally{oe(!1)}}return l.memoizedState=[u,s],u},useReducer:function(n,s,l){var u=mn();if(l!==void 0){var g=l(s);if(Is){oe(!0);try{l(s)}finally{oe(!1)}}}else g=s;return u.memoizedState=u.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},u.queue=n,n=n.dispatch=L2.bind(null,Rt,n),[u.memoizedState,n]},useRef:function(n){var s=mn();return n={current:n},s.memoizedState=n},useState:function(n){n=Bu(n);var s=n.queue,l=Kp.bind(null,Rt,s);return s.dispatch=l,[n.memoizedState,l]},useDebugValue:Fu,useDeferredValue:function(n,s){var l=mn();return Lu(l,n,s)},useTransition:function(){var n=Bu(!1);return n=qp.bind(null,Rt,n.queue,!0,!1),mn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,l){var u=Rt,g=mn();if($t){if(l===void 0)throw Error(a(407));l=l()}else{if(l=s(),lr===null)throw Error(a(349));(Ft&124)!==0||bp(u,s,l)}g.memoizedState=l;var m={value:l,getSnapshot:s};return g.queue=m,Ip(Sp.bind(null,u,m,n),[n]),u.flags|=2048,bi(9,uc(),_p.bind(null,u,m,l,s),null),l},useId:function(){var n=mn(),s=lr.identifierPrefix;if($t){var l=wa,u=Sa;l=(u&~(1<<32-Le(u)-1)).toString(32)+l,s=""+s+"R"+l,l=lc++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=N2++,s=""+s+"r"+l.toString(32)+"";return n.memoizedState=s},useHostTransitionStatus:zu,useFormState:Dp,useActionState:Dp,useOptimistic:function(n){var s=mn();s.memoizedState=s.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=Uu.bind(null,Rt,!0,l),l.dispatch=s,[n,s]},useMemoCache:Nu,useCacheRefresh:function(){return mn().memoizedState=F2.bind(null,Rt)}},eg={readContext:nn,use:cc,useCallback:Wp,useContext:nn,useEffect:Fp,useImperativeHandle:Up,useInsertionEffect:Lp,useLayoutEffect:Pp,useMemo:$p,useReducer:dc,useRef:Bp,useState:function(){return dc(ka)},useDebugValue:Fu,useDeferredValue:function(n,s){var l=jr();return Hp(l,rr.memoizedState,n,s)},useTransition:function(){var n=dc(ka)[0],s=jr().memoizedState;return[typeof n=="boolean"?n:Bo(n),s]},useSyncExternalStore:vp,useId:Vp,useHostTransitionStatus:zu,useFormState:Np,useActionState:Np,useOptimistic:function(n,s){var l=jr();return Ep(l,rr,n,s)},useMemoCache:Nu,useCacheRefresh:Xp},P2={readContext:nn,use:cc,useCallback:Wp,useContext:nn,useEffect:Fp,useImperativeHandle:Up,useInsertionEffect:Lp,useLayoutEffect:Pp,useMemo:$p,useReducer:Mu,useRef:Bp,useState:function(){return Mu(ka)},useDebugValue:Fu,useDeferredValue:function(n,s){var l=jr();return rr===null?Lu(l,n,s):Hp(l,rr.memoizedState,n,s)},useTransition:function(){var n=Mu(ka)[0],s=jr().memoizedState;return[typeof n=="boolean"?n:Bo(n),s]},useSyncExternalStore:vp,useId:Vp,useHostTransitionStatus:zu,useFormState:Mp,useActionState:Mp,useOptimistic:function(n,s){var l=jr();return rr!==null?Ep(l,rr,n,s):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:Nu,useCacheRefresh:Xp},_i=null,Lo=0;function gc(n){var s=Lo;return Lo+=1,_i===null&&(_i=[]),up(_i,n,s)}function Po(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function xc(n,s){throw s.$$typeof===y?Error(a(525)):(n=Object.prototype.toString.call(s),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function tg(n){var s=n._init;return s(n._payload)}function rg(n){function s(ue,ie){if(n){var xe=ue.deletions;xe===null?(ue.deletions=[ie],ue.flags|=16):xe.push(ie)}}function l(ue,ie){if(!n)return null;for(;ie!==null;)s(ue,ie),ie=ie.sibling;return null}function u(ue){for(var ie=new Map;ue!==null;)ue.key!==null?ie.set(ue.key,ue):ie.set(ue.index,ue),ue=ue.sibling;return ie}function g(ue,ie){return ue=_a(ue,ie),ue.index=0,ue.sibling=null,ue}function m(ue,ie,xe){return ue.index=xe,n?(xe=ue.alternate,xe!==null?(xe=xe.index,xe<ie?(ue.flags|=67108866,ie):xe):(ue.flags|=67108866,ie)):(ue.flags|=1048576,ie)}function E(ue){return n&&ue.alternate===null&&(ue.flags|=67108866),ue}function D(ue,ie,xe,Pe){return ie===null||ie.tag!==6?(ie=lu(xe,ue.mode,Pe),ie.return=ue,ie):(ie=g(ie,xe),ie.return=ue,ie)}function Z(ue,ie,xe,Pe){var ft=xe.type;return ft===w?Fe(ue,ie,xe.props.children,Pe,xe.key):ie!==null&&(ie.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===re&&tg(ft)===ie.type)?(ie=g(ie,xe.props),Po(ie,xe),ie.return=ue,ie):(ie=Jl(xe.type,xe.key,xe.props,null,ue.mode,Pe),Po(ie,xe),ie.return=ue,ie)}function ve(ue,ie,xe,Pe){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==xe.containerInfo||ie.stateNode.implementation!==xe.implementation?(ie=cu(xe,ue.mode,Pe),ie.return=ue,ie):(ie=g(ie,xe.children||[]),ie.return=ue,ie)}function Fe(ue,ie,xe,Pe,ft){return ie===null||ie.tag!==7?(ie=Cs(xe,ue.mode,Pe,ft),ie.return=ue,ie):(ie=g(ie,xe),ie.return=ue,ie)}function Ue(ue,ie,xe){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=lu(""+ie,ue.mode,xe),ie.return=ue,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case b:return xe=Jl(ie.type,ie.key,ie.props,null,ue.mode,xe),Po(xe,ie),xe.return=ue,xe;case v:return ie=cu(ie,ue.mode,xe),ie.return=ue,ie;case re:var Pe=ie._init;return ie=Pe(ie._payload),Ue(ue,ie,xe)}if(Ae(ie)||ge(ie))return ie=Cs(ie,ue.mode,xe,null),ie.return=ue,ie;if(typeof ie.then=="function")return Ue(ue,gc(ie),xe);if(ie.$$typeof===A)return Ue(ue,rc(ue,ie),xe);xc(ue,ie)}return null}function Ee(ue,ie,xe,Pe){var ft=ie!==null?ie.key:null;if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return ft!==null?null:D(ue,ie,""+xe,Pe);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case b:return xe.key===ft?Z(ue,ie,xe,Pe):null;case v:return xe.key===ft?ve(ue,ie,xe,Pe):null;case re:return ft=xe._init,xe=ft(xe._payload),Ee(ue,ie,xe,Pe)}if(Ae(xe)||ge(xe))return ft!==null?null:Fe(ue,ie,xe,Pe,null);if(typeof xe.then=="function")return Ee(ue,ie,gc(xe),Pe);if(xe.$$typeof===A)return Ee(ue,ie,rc(ue,xe),Pe);xc(ue,xe)}return null}function ke(ue,ie,xe,Pe,ft){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number"||typeof Pe=="bigint")return ue=ue.get(xe)||null,D(ie,ue,""+Pe,ft);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case b:return ue=ue.get(Pe.key===null?xe:Pe.key)||null,Z(ie,ue,Pe,ft);case v:return ue=ue.get(Pe.key===null?xe:Pe.key)||null,ve(ie,ue,Pe,ft);case re:var Dt=Pe._init;return Pe=Dt(Pe._payload),ke(ue,ie,xe,Pe,ft)}if(Ae(Pe)||ge(Pe))return ue=ue.get(xe)||null,Fe(ie,ue,Pe,ft,null);if(typeof Pe.then=="function")return ke(ue,ie,xe,gc(Pe),ft);if(Pe.$$typeof===A)return ke(ue,ie,xe,rc(ie,Pe),ft);xc(ie,Pe)}return null}function _t(ue,ie,xe,Pe){for(var ft=null,Dt=null,xt=ie,vt=ie=0,Ur=null;xt!==null&&vt<xe.length;vt++){xt.index>vt?(Ur=xt,xt=null):Ur=xt.sibling;var Ut=Ee(ue,xt,xe[vt],Pe);if(Ut===null){xt===null&&(xt=Ur);break}n&&xt&&Ut.alternate===null&&s(ue,xt),ie=m(Ut,ie,vt),Dt===null?ft=Ut:Dt.sibling=Ut,Dt=Ut,xt=Ur}if(vt===xe.length)return l(ue,xt),$t&&Rs(ue,vt),ft;if(xt===null){for(;vt<xe.length;vt++)xt=Ue(ue,xe[vt],Pe),xt!==null&&(ie=m(xt,ie,vt),Dt===null?ft=xt:Dt.sibling=xt,Dt=xt);return $t&&Rs(ue,vt),ft}for(xt=u(xt);vt<xe.length;vt++)Ur=ke(xt,ue,vt,xe[vt],Pe),Ur!==null&&(n&&Ur.alternate!==null&&xt.delete(Ur.key===null?vt:Ur.key),ie=m(Ur,ie,vt),Dt===null?ft=Ur:Dt.sibling=Ur,Dt=Ur);return n&&xt.forEach(function(hs){return s(ue,hs)}),$t&&Rs(ue,vt),ft}function yt(ue,ie,xe,Pe){if(xe==null)throw Error(a(151));for(var ft=null,Dt=null,xt=ie,vt=ie=0,Ur=null,Ut=xe.next();xt!==null&&!Ut.done;vt++,Ut=xe.next()){xt.index>vt?(Ur=xt,xt=null):Ur=xt.sibling;var hs=Ee(ue,xt,Ut.value,Pe);if(hs===null){xt===null&&(xt=Ur);break}n&&xt&&hs.alternate===null&&s(ue,xt),ie=m(hs,ie,vt),Dt===null?ft=hs:Dt.sibling=hs,Dt=hs,xt=Ur}if(Ut.done)return l(ue,xt),$t&&Rs(ue,vt),ft;if(xt===null){for(;!Ut.done;vt++,Ut=xe.next())Ut=Ue(ue,Ut.value,Pe),Ut!==null&&(ie=m(Ut,ie,vt),Dt===null?ft=Ut:Dt.sibling=Ut,Dt=Ut);return $t&&Rs(ue,vt),ft}for(xt=u(xt);!Ut.done;vt++,Ut=xe.next())Ut=ke(xt,ue,vt,Ut.value,Pe),Ut!==null&&(n&&Ut.alternate!==null&&xt.delete(Ut.key===null?vt:Ut.key),ie=m(Ut,ie,vt),Dt===null?ft=Ut:Dt.sibling=Ut,Dt=Ut);return n&&xt.forEach(function(zb){return s(ue,zb)}),$t&&Rs(ue,vt),ft}function ar(ue,ie,xe,Pe){if(typeof xe=="object"&&xe!==null&&xe.type===w&&xe.key===null&&(xe=xe.props.children),typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case b:e:{for(var ft=xe.key;ie!==null;){if(ie.key===ft){if(ft=xe.type,ft===w){if(ie.tag===7){l(ue,ie.sibling),Pe=g(ie,xe.props.children),Pe.return=ue,ue=Pe;break e}}else if(ie.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===re&&tg(ft)===ie.type){l(ue,ie.sibling),Pe=g(ie,xe.props),Po(Pe,xe),Pe.return=ue,ue=Pe;break e}l(ue,ie);break}else s(ue,ie);ie=ie.sibling}xe.type===w?(Pe=Cs(xe.props.children,ue.mode,Pe,xe.key),Pe.return=ue,ue=Pe):(Pe=Jl(xe.type,xe.key,xe.props,null,ue.mode,Pe),Po(Pe,xe),Pe.return=ue,ue=Pe)}return E(ue);case v:e:{for(ft=xe.key;ie!==null;){if(ie.key===ft)if(ie.tag===4&&ie.stateNode.containerInfo===xe.containerInfo&&ie.stateNode.implementation===xe.implementation){l(ue,ie.sibling),Pe=g(ie,xe.children||[]),Pe.return=ue,ue=Pe;break e}else{l(ue,ie);break}else s(ue,ie);ie=ie.sibling}Pe=cu(xe,ue.mode,Pe),Pe.return=ue,ue=Pe}return E(ue);case re:return ft=xe._init,xe=ft(xe._payload),ar(ue,ie,xe,Pe)}if(Ae(xe))return _t(ue,ie,xe,Pe);if(ge(xe)){if(ft=ge(xe),typeof ft!="function")throw Error(a(150));return xe=ft.call(xe),yt(ue,ie,xe,Pe)}if(typeof xe.then=="function")return ar(ue,ie,gc(xe),Pe);if(xe.$$typeof===A)return ar(ue,ie,rc(ue,xe),Pe);xc(ue,xe)}return typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint"?(xe=""+xe,ie!==null&&ie.tag===6?(l(ue,ie.sibling),Pe=g(ie,xe),Pe.return=ue,ue=Pe):(l(ue,ie),Pe=lu(xe,ue.mode,Pe),Pe.return=ue,ue=Pe),E(ue)):l(ue,ie)}return function(ue,ie,xe,Pe){try{Lo=0;var ft=ar(ue,ie,xe,Pe);return _i=null,ft}catch(xt){if(xt===Ao||xt===ac)throw xt;var Dt=En(29,xt,null,ue.mode);return Dt.lanes=Pe,Dt.return=ue,Dt}finally{}}}var Si=rg(!0),ng=rg(!1),Un=J(null),la=null;function Ja(n){var s=n.alternate;K(Or,Or.current&1),K(Un,n),la===null&&(s===null||mi.current!==null||s.memoizedState!==null)&&(la=n)}function ag(n){if(n.tag===22){if(K(Or,Or.current),K(Un,n),la===null){var s=n.alternate;s!==null&&s.memoizedState!==null&&(la=n)}}else Za()}function Za(){K(Or,Or.current),K(Un,Un.current)}function ja(n){O(Un),la===n&&(la=null),O(Or)}var Or=J(0);function mc(n){for(var s=n;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Nf(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Wu(n,s,l,u){s=n.memoizedState,l=l(u,s),l=l==null?s:x({},s,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var $u={enqueueSetState:function(n,s,l){n=n._reactInternals;var u=An(),g=Xa(u);g.payload=s,l!=null&&(g.callback=l),s=Ka(n,g,u),s!==null&&(Rn(s,n,u),Do(s,n,u))},enqueueReplaceState:function(n,s,l){n=n._reactInternals;var u=An(),g=Xa(u);g.tag=1,g.payload=s,l!=null&&(g.callback=l),s=Ka(n,g,u),s!==null&&(Rn(s,n,u),Do(s,n,u))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var l=An(),u=Xa(l);u.tag=2,s!=null&&(u.callback=s),s=Ka(n,u,l),s!==null&&(Rn(s,n,l),Do(s,n,l))}};function sg(n,s,l,u,g,m,E){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,m,E):s.prototype&&s.prototype.isPureReactComponent?!_o(l,u)||!_o(g,m):!0}function ig(n,s,l,u){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,u),s.state!==n&&$u.enqueueReplaceState(s,s.state,null)}function Fs(n,s){var l=s;if("ref"in s){l={};for(var u in s)u!=="ref"&&(l[u]=s[u])}if(n=n.defaultProps){l===s&&(l=x({},l));for(var g in n)l[g]===void 0&&(l[g]=n[g])}return l}var yc=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function og(n){yc(n)}function lg(n){console.error(n)}function cg(n){yc(n)}function vc(n,s){try{var l=n.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function dg(n,s,l){try{var u=n.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Hu(n,s,l){return l=Xa(l),l.tag=3,l.payload={element:null},l.callback=function(){vc(n,s)},l}function ug(n){return n=Xa(n),n.tag=3,n}function fg(n,s,l,u){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var m=u.value;n.payload=function(){return g(m)},n.callback=function(){dg(s,l,u)}}var E=l.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(n.callback=function(){dg(s,l,u),typeof g!="function"&&(ss===null?ss=new Set([this]):ss.add(this));var D=u.stack;this.componentDidCatch(u.value,{componentStack:D!==null?D:""})})}function z2(n,s,l,u,g){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=l.alternate,s!==null&&ko(s,l,g,!0),l=Un.current,l!==null){switch(l.tag){case 13:return la===null?gf():l.alternate===null&&br===0&&(br=3),l.flags&=-257,l.flags|=65536,l.lanes=g,u===vu?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([u]):s.add(u),mf(n,u,g)),!1;case 22:return l.flags|=65536,u===vu?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([u]):l.add(u)),mf(n,u,g)),!1}throw Error(a(435,l.tag))}return mf(n,u,g),gf(),!1}if($t)return s=Un.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,u!==fu&&(n=Error(a(422),{cause:u}),Eo(Fn(n,l)))):(u!==fu&&(s=Error(a(423),{cause:u}),Eo(Fn(s,l))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,u=Fn(u,l),g=Hu(n.stateNode,u,g),Su(n,g),br!==4&&(br=2)),!1;var m=Error(a(520),{cause:u});if(m=Fn(m,l),Go===null?Go=[m]:Go.push(m),br!==4&&(br=2),s===null)return!0;u=Fn(u,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,n=g&-g,l.lanes|=n,n=Hu(l.stateNode,u,n),Su(l,n),!1;case 1:if(s=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ss===null||!ss.has(m))))return l.flags|=65536,g&=-g,l.lanes|=g,g=ug(g),fg(g,n,l,u),Su(l,g),!1}l=l.return}while(l!==null);return!1}var hg=Error(a(461)),Pr=!1;function Yr(n,s,l,u){s.child=n===null?ng(s,null,l,u):Si(s,n.child,l,u)}function pg(n,s,l,u,g){l=l.render;var m=s.ref;if("ref"in u){var E={};for(var D in u)D!=="ref"&&(E[D]=u[D])}else E=u;return Ms(s),u=ju(n,s,l,E,m,g),D=Cu(),n!==null&&!Pr?(Au(n,s,g),Ca(n,s,g)):($t&&D&&du(s),s.flags|=1,Yr(n,s,u,g),s.child)}function gg(n,s,l,u,g){if(n===null){var m=l.type;return typeof m=="function"&&!ou(m)&&m.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=m,xg(n,s,m,u,g)):(n=Jl(l.type,null,u,s,s.mode,g),n.ref=s.ref,n.return=s,s.child=n)}if(m=n.child,!Ju(n,g)){var E=m.memoizedProps;if(l=l.compare,l=l!==null?l:_o,l(E,u)&&n.ref===s.ref)return Ca(n,s,g)}return s.flags|=1,n=_a(m,u),n.ref=s.ref,n.return=s,s.child=n}function xg(n,s,l,u,g){if(n!==null){var m=n.memoizedProps;if(_o(m,u)&&n.ref===s.ref)if(Pr=!1,s.pendingProps=u=m,Ju(n,g))(n.flags&131072)!==0&&(Pr=!0);else return s.lanes=n.lanes,Ca(n,s,g)}return qu(n,s,l,u,g)}function mg(n,s,l){var u=s.pendingProps,g=u.children,m=n!==null?n.memoizedState:null;if(u.mode==="hidden"){if((s.flags&128)!==0){if(u=m!==null?m.baseLanes|l:l,n!==null){for(g=s.child=n.child,m=0;g!==null;)m=m|g.lanes|g.childLanes,g=g.sibling;s.childLanes=m&~u}else s.childLanes=0,s.child=null;return yg(n,s,u,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&nc(s,m!==null?m.cachePool:null),m!==null?xp(s,m):Tu(),ag(s);else return s.lanes=s.childLanes=536870912,yg(n,s,m!==null?m.baseLanes|l:l,l)}else m!==null?(nc(s,m.cachePool),xp(s,m),Za(),s.memoizedState=null):(n!==null&&nc(s,null),Tu(),Za());return Yr(n,s,g,l),s.child}function yg(n,s,l,u){var g=yu();return g=g===null?null:{parent:Nr._currentValue,pool:g},s.memoizedState={baseLanes:l,cachePool:g},n!==null&&nc(s,null),Tu(),ag(s),n!==null&&ko(n,s,u,!0),null}function bc(n,s){var l=s.ref;if(l===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(a(284));(n===null||n.ref!==l)&&(s.flags|=4194816)}}function qu(n,s,l,u,g){return Ms(s),l=ju(n,s,l,u,void 0,g),u=Cu(),n!==null&&!Pr?(Au(n,s,g),Ca(n,s,g)):($t&&u&&du(s),s.flags|=1,Yr(n,s,l,g),s.child)}function vg(n,s,l,u,g,m){return Ms(s),s.updateQueue=null,l=yp(s,u,l,g),mp(n),u=Cu(),n!==null&&!Pr?(Au(n,s,m),Ca(n,s,m)):($t&&u&&du(s),s.flags|=1,Yr(n,s,l,m),s.child)}function bg(n,s,l,u,g){if(Ms(s),s.stateNode===null){var m=fi,E=l.contextType;typeof E=="object"&&E!==null&&(m=nn(E)),m=new l(u,m),s.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=$u,s.stateNode=m,m._reactInternals=s,m=s.stateNode,m.props=u,m.state=s.memoizedState,m.refs={},bu(s),E=l.contextType,m.context=typeof E=="object"&&E!==null?nn(E):fi,m.state=s.memoizedState,E=l.getDerivedStateFromProps,typeof E=="function"&&(Wu(s,l,E,u),m.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(E=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),E!==m.state&&$u.enqueueReplaceState(m,m.state,null),Oo(s,u,m,g),No(),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(n===null){m=s.stateNode;var D=s.memoizedProps,Z=Fs(l,D);m.props=Z;var ve=m.context,Fe=l.contextType;E=fi,typeof Fe=="object"&&Fe!==null&&(E=nn(Fe));var Ue=l.getDerivedStateFromProps;Fe=typeof Ue=="function"||typeof m.getSnapshotBeforeUpdate=="function",D=s.pendingProps!==D,Fe||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(D||ve!==E)&&ig(s,m,u,E),Va=!1;var Ee=s.memoizedState;m.state=Ee,Oo(s,u,m,g),No(),ve=s.memoizedState,D||Ee!==ve||Va?(typeof Ue=="function"&&(Wu(s,l,Ue,u),ve=s.memoizedState),(Z=Va||sg(s,l,Z,u,Ee,ve,E))?(Fe||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(s.flags|=4194308)):(typeof m.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=ve),m.props=u,m.state=ve,m.context=E,u=Z):(typeof m.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{m=s.stateNode,_u(n,s),E=s.memoizedProps,Fe=Fs(l,E),m.props=Fe,Ue=s.pendingProps,Ee=m.context,ve=l.contextType,Z=fi,typeof ve=="object"&&ve!==null&&(Z=nn(ve)),D=l.getDerivedStateFromProps,(ve=typeof D=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(E!==Ue||Ee!==Z)&&ig(s,m,u,Z),Va=!1,Ee=s.memoizedState,m.state=Ee,Oo(s,u,m,g),No();var ke=s.memoizedState;E!==Ue||Ee!==ke||Va||n!==null&&n.dependencies!==null&&tc(n.dependencies)?(typeof D=="function"&&(Wu(s,l,D,u),ke=s.memoizedState),(Fe=Va||sg(s,l,Fe,u,Ee,ke,Z)||n!==null&&n.dependencies!==null&&tc(n.dependencies))?(ve||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(u,ke,Z),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(u,ke,Z)),typeof m.componentDidUpdate=="function"&&(s.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof m.componentDidUpdate!="function"||E===n.memoizedProps&&Ee===n.memoizedState||(s.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&Ee===n.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=ke),m.props=u,m.state=ke,m.context=Z,u=Fe):(typeof m.componentDidUpdate!="function"||E===n.memoizedProps&&Ee===n.memoizedState||(s.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&Ee===n.memoizedState||(s.flags|=1024),u=!1)}return m=u,bc(n,s),u=(s.flags&128)!==0,m||u?(m=s.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:m.render(),s.flags|=1,n!==null&&u?(s.child=Si(s,n.child,null,g),s.child=Si(s,null,l,g)):Yr(n,s,l,g),s.memoizedState=m.state,n=s.child):n=Ca(n,s,g),n}function _g(n,s,l,u){return To(),s.flags|=256,Yr(n,s,l,u),s.child}var Gu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yu(n){return{baseLanes:n,cachePool:lp()}}function Vu(n,s,l){return n=n!==null?n.childLanes&~l:0,s&&(n|=Wn),n}function Sg(n,s,l){var u=s.pendingProps,g=!1,m=(s.flags&128)!==0,E;if((E=m)||(E=n!==null&&n.memoizedState===null?!1:(Or.current&2)!==0),E&&(g=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,n===null){if($t){if(g?Ja(s):Za(),$t){var D=vr,Z;if(Z=D){e:{for(Z=D,D=oa;Z.nodeType!==8;){if(!D){D=null;break e}if(Z=Kn(Z.nextSibling),Z===null){D=null;break e}}D=Z}D!==null?(s.memoizedState={dehydrated:D,treeContext:As!==null?{id:Sa,overflow:wa}:null,retryLane:536870912,hydrationErrors:null},Z=En(18,null,null,0),Z.stateNode=D,Z.return=s,s.child=Z,cn=s,vr=null,Z=!0):Z=!1}Z||Ns(s)}if(D=s.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return Nf(D)?s.lanes=32:s.lanes=536870912,null;ja(s)}return D=u.children,u=u.fallback,g?(Za(),g=s.mode,D=_c({mode:"hidden",children:D},g),u=Cs(u,g,l,null),D.return=s,u.return=s,D.sibling=u,s.child=D,g=s.child,g.memoizedState=Yu(l),g.childLanes=Vu(n,E,l),s.memoizedState=Gu,u):(Ja(s),Xu(s,D))}if(Z=n.memoizedState,Z!==null&&(D=Z.dehydrated,D!==null)){if(m)s.flags&256?(Ja(s),s.flags&=-257,s=Ku(n,s,l)):s.memoizedState!==null?(Za(),s.child=n.child,s.flags|=128,s=null):(Za(),g=u.fallback,D=s.mode,u=_c({mode:"visible",children:u.children},D),g=Cs(g,D,l,null),g.flags|=2,u.return=s,g.return=s,u.sibling=g,s.child=u,Si(s,n.child,null,l),u=s.child,u.memoizedState=Yu(l),u.childLanes=Vu(n,E,l),s.memoizedState=Gu,s=g);else if(Ja(s),Nf(D)){if(E=D.nextSibling&&D.nextSibling.dataset,E)var ve=E.dgst;E=ve,u=Error(a(419)),u.stack="",u.digest=E,Eo({value:u,source:null,stack:null}),s=Ku(n,s,l)}else if(Pr||ko(n,s,l,!1),E=(l&n.childLanes)!==0,Pr||E){if(E=lr,E!==null&&(u=l&-l,u=(u&42)!==0?1:Lr(u),u=(u&(E.suspendedLanes|l))!==0?0:u,u!==0&&u!==Z.retryLane))throw Z.retryLane=u,ui(n,u),Rn(E,n,u),hg;D.data==="$?"||gf(),s=Ku(n,s,l)}else D.data==="$?"?(s.flags|=192,s.child=n.child,s=null):(n=Z.treeContext,vr=Kn(D.nextSibling),cn=s,$t=!0,Ds=null,oa=!1,n!==null&&(Pn[zn++]=Sa,Pn[zn++]=wa,Pn[zn++]=As,Sa=n.id,wa=n.overflow,As=s),s=Xu(s,u.children),s.flags|=4096);return s}return g?(Za(),g=u.fallback,D=s.mode,Z=n.child,ve=Z.sibling,u=_a(Z,{mode:"hidden",children:u.children}),u.subtreeFlags=Z.subtreeFlags&65011712,ve!==null?g=_a(ve,g):(g=Cs(g,D,l,null),g.flags|=2),g.return=s,u.return=s,u.sibling=g,s.child=u,u=g,g=s.child,D=n.child.memoizedState,D===null?D=Yu(l):(Z=D.cachePool,Z!==null?(ve=Nr._currentValue,Z=Z.parent!==ve?{parent:ve,pool:ve}:Z):Z=lp(),D={baseLanes:D.baseLanes|l,cachePool:Z}),g.memoizedState=D,g.childLanes=Vu(n,E,l),s.memoizedState=Gu,u):(Ja(s),l=n.child,n=l.sibling,l=_a(l,{mode:"visible",children:u.children}),l.return=s,l.sibling=null,n!==null&&(E=s.deletions,E===null?(s.deletions=[n],s.flags|=16):E.push(n)),s.child=l,s.memoizedState=null,l)}function Xu(n,s){return s=_c({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function _c(n,s){return n=En(22,n,null,s),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function Ku(n,s,l){return Si(s,n.child,null,l),n=Xu(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function wg(n,s,l){n.lanes|=s;var u=n.alternate;u!==null&&(u.lanes|=s),pu(n.return,s,l)}function Qu(n,s,l,u,g){var m=n.memoizedState;m===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:g}:(m.isBackwards=s,m.rendering=null,m.renderingStartTime=0,m.last=u,m.tail=l,m.tailMode=g)}function Tg(n,s,l){var u=s.pendingProps,g=u.revealOrder,m=u.tail;if(Yr(n,s,u.children,l),u=Or.current,(u&2)!==0)u=u&1|2,s.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&wg(n,l,s);else if(n.tag===19)wg(n,l,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}u&=1}switch(K(Or,u),g){case"forwards":for(l=s.child,g=null;l!==null;)n=l.alternate,n!==null&&mc(n)===null&&(g=l),l=l.sibling;l=g,l===null?(g=s.child,s.child=null):(g=l.sibling,l.sibling=null),Qu(s,!1,g,l,m);break;case"backwards":for(l=null,g=s.child,s.child=null;g!==null;){if(n=g.alternate,n!==null&&mc(n)===null){s.child=g;break}n=g.sibling,g.sibling=l,l=g,g=n}Qu(s,!0,l,null,m);break;case"together":Qu(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ca(n,s,l){if(n!==null&&(s.dependencies=n.dependencies),as|=s.lanes,(l&s.childLanes)===0)if(n!==null){if(ko(n,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(a(153));if(s.child!==null){for(n=s.child,l=_a(n,n.pendingProps),s.child=l,l.return=s;n.sibling!==null;)n=n.sibling,l=l.sibling=_a(n,n.pendingProps),l.return=s;l.sibling=null}return s.child}function Ju(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&tc(n)))}function U2(n,s,l){switch(s.tag){case 3:He(s,s.stateNode.containerInfo),Ya(s,Nr,n.memoizedState.cache),To();break;case 27:case 5:Be(s);break;case 4:He(s,s.stateNode.containerInfo);break;case 10:Ya(s,s.type,s.memoizedProps.value);break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(Ja(s),s.flags|=128,null):(l&s.child.childLanes)!==0?Sg(n,s,l):(Ja(s),n=Ca(n,s,l),n!==null?n.sibling:null);Ja(s);break;case 19:var g=(n.flags&128)!==0;if(u=(l&s.childLanes)!==0,u||(ko(n,s,l,!1),u=(l&s.childLanes)!==0),g){if(u)return Tg(n,s,l);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),K(Or,Or.current),u)break;return null;case 22:case 23:return s.lanes=0,mg(n,s,l);case 24:Ya(s,Nr,n.memoizedState.cache)}return Ca(n,s,l)}function Eg(n,s,l){if(n!==null)if(n.memoizedProps!==s.pendingProps)Pr=!0;else{if(!Ju(n,l)&&(s.flags&128)===0)return Pr=!1,U2(n,s,l);Pr=(n.flags&131072)!==0}else Pr=!1,$t&&(s.flags&1048576)!==0&&tp(s,ec,s.index);switch(s.lanes=0,s.tag){case 16:e:{n=s.pendingProps;var u=s.elementType,g=u._init;if(u=g(u._payload),s.type=u,typeof u=="function")ou(u)?(n=Fs(u,n),s.tag=1,s=bg(null,s,u,n,l)):(s.tag=0,s=qu(null,s,u,n,l));else{if(u!=null){if(g=u.$$typeof,g===U){s.tag=11,s=pg(null,s,u,n,l);break e}else if(g===N){s.tag=14,s=gg(null,s,u,n,l);break e}}throw s=fe(u)||u,Error(a(306,s,""))}}return s;case 0:return qu(n,s,s.type,s.pendingProps,l);case 1:return u=s.type,g=Fs(u,s.pendingProps),bg(n,s,u,g,l);case 3:e:{if(He(s,s.stateNode.containerInfo),n===null)throw Error(a(387));u=s.pendingProps;var m=s.memoizedState;g=m.element,_u(n,s),Oo(s,u,null,l);var E=s.memoizedState;if(u=E.cache,Ya(s,Nr,u),u!==m.cache&&gu(s,[Nr],l,!0),No(),u=E.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=m,s.memoizedState=m,s.flags&256){s=_g(n,s,u,l);break e}else if(u!==g){g=Fn(Error(a(424)),s),Eo(g),s=_g(n,s,u,l);break e}else{switch(n=s.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(vr=Kn(n.firstChild),cn=s,$t=!0,Ds=null,oa=!0,l=ng(s,null,u,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(To(),u===g){s=Ca(n,s,l);break e}Yr(n,s,u,l)}s=s.child}return s;case 26:return bc(n,s),n===null?(l=Ax(s.type,null,s.pendingProps,null))?s.memoizedState=l:$t||(l=s.type,n=s.pendingProps,u=Bc(pe.current).createElement(l),u[Gt]=s,u[yr]=n,Xr(u,l,n),ce(u),s.stateNode=u):s.memoizedState=Ax(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return Be(s),n===null&&$t&&(u=s.stateNode=kx(s.type,s.pendingProps,pe.current),cn=s,oa=!0,g=vr,ls(s.type)?(Of=g,vr=Kn(u.firstChild)):vr=g),Yr(n,s,s.pendingProps.children,l),bc(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&$t&&((g=u=vr)&&(u=gb(u,s.type,s.pendingProps,oa),u!==null?(s.stateNode=u,cn=s,vr=Kn(u.firstChild),oa=!1,g=!0):g=!1),g||Ns(s)),Be(s),g=s.type,m=s.pendingProps,E=n!==null?n.memoizedProps:null,u=m.children,Af(g,m)?u=null:E!==null&&Af(g,E)&&(s.flags|=32),s.memoizedState!==null&&(g=ju(n,s,O2,null,null,l),tl._currentValue=g),bc(n,s),Yr(n,s,u,l),s.child;case 6:return n===null&&$t&&((n=l=vr)&&(l=xb(l,s.pendingProps,oa),l!==null?(s.stateNode=l,cn=s,vr=null,n=!0):n=!1),n||Ns(s)),null;case 13:return Sg(n,s,l);case 4:return He(s,s.stateNode.containerInfo),u=s.pendingProps,n===null?s.child=Si(s,null,u,l):Yr(n,s,u,l),s.child;case 11:return pg(n,s,s.type,s.pendingProps,l);case 7:return Yr(n,s,s.pendingProps,l),s.child;case 8:return Yr(n,s,s.pendingProps.children,l),s.child;case 12:return Yr(n,s,s.pendingProps.children,l),s.child;case 10:return u=s.pendingProps,Ya(s,s.type,u.value),Yr(n,s,u.children,l),s.child;case 9:return g=s.type._context,u=s.pendingProps.children,Ms(s),g=nn(g),u=u(g),s.flags|=1,Yr(n,s,u,l),s.child;case 14:return gg(n,s,s.type,s.pendingProps,l);case 15:return xg(n,s,s.type,s.pendingProps,l);case 19:return Tg(n,s,l);case 31:return u=s.pendingProps,l=s.mode,u={mode:u.mode,children:u.children},n===null?(l=_c(u,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=_a(n.child,u),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return mg(n,s,l);case 24:return Ms(s),u=nn(Nr),n===null?(g=yu(),g===null&&(g=lr,m=xu(),g.pooledCache=m,m.refCount++,m!==null&&(g.pooledCacheLanes|=l),g=m),s.memoizedState={parent:u,cache:g},bu(s),Ya(s,Nr,g)):((n.lanes&l)!==0&&(_u(n,s),Oo(s,null,null,l),No()),g=n.memoizedState,m=s.memoizedState,g.parent!==u?(g={parent:u,cache:u},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Ya(s,Nr,u)):(u=m.cache,Ya(s,Nr,u),u!==g.cache&&gu(s,[Nr],l,!0))),Yr(n,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(a(156,s.tag))}function Aa(n){n.flags|=4}function kg(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Mx(s)){if(s=Un.current,s!==null&&((Ft&4194048)===Ft?la!==null:(Ft&62914560)!==Ft&&(Ft&536870912)===0||s!==la))throw Ro=vu,cp;n.flags|=8192}}function Sc(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?_e():536870912,n.lanes|=s,ki|=s)}function zo(n,s){if(!$t)switch(n.tailMode){case"hidden":s=n.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function mr(n){var s=n.alternate!==null&&n.alternate.child===n.child,l=0,u=0;if(s)for(var g=n.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=u,n.childLanes=l,s}function W2(n,s,l){var u=s.pendingProps;switch(uu(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mr(s),null;case 1:return mr(s),null;case 3:return l=s.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Ea(Nr),De(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(wo(s)?Aa(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,ap())),mr(s),null;case 26:return l=s.memoizedState,n===null?(Aa(s),l!==null?(mr(s),kg(s,l)):(mr(s),s.flags&=-16777217)):l?l!==n.memoizedState?(Aa(s),mr(s),kg(s,l)):(mr(s),s.flags&=-16777217):(n.memoizedProps!==u&&Aa(s),mr(s),s.flags&=-16777217),null;case 27:rt(s),l=pe.current;var g=s.type;if(n!==null&&s.stateNode!=null)n.memoizedProps!==u&&Aa(s);else{if(!u){if(s.stateNode===null)throw Error(a(166));return mr(s),null}n=Y.current,wo(s)?rp(s):(n=kx(g,u,l),s.stateNode=n,Aa(s))}return mr(s),null;case 5:if(rt(s),l=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==u&&Aa(s);else{if(!u){if(s.stateNode===null)throw Error(a(166));return mr(s),null}if(n=Y.current,wo(s))rp(s);else{switch(g=Bc(pe.current),n){case 1:n=g.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:n=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":n=g.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":n=g.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":n=g.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof u.is=="string"?g.createElement("select",{is:u.is}):g.createElement("select"),u.multiple?n.multiple=!0:u.size&&(n.size=u.size);break;default:n=typeof u.is=="string"?g.createElement(l,{is:u.is}):g.createElement(l)}}n[Gt]=s,n[yr]=u;e:for(g=s.child;g!==null;){if(g.tag===5||g.tag===6)n.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===s)break e;for(;g.sibling===null;){if(g.return===null||g.return===s)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}s.stateNode=n;e:switch(Xr(n,l,u),l){case"button":case"input":case"select":case"textarea":n=!!u.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&Aa(s)}}return mr(s),s.flags&=-16777217,null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==u&&Aa(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(a(166));if(n=pe.current,wo(s)){if(n=s.stateNode,l=s.memoizedProps,u=null,g=cn,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}n[Gt]=s,n=!!(n.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||vx(n.nodeValue,l)),n||Ns(s)}else n=Bc(n).createTextNode(u),n[Gt]=s,s.stateNode=n}return mr(s),null;case 13:if(u=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=wo(s),u!==null&&u.dehydrated!==null){if(n===null){if(!g)throw Error(a(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(a(317));g[Gt]=s}else To(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;mr(s),g=!1}else g=ap(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(ja(s),s):(ja(s),null)}if(ja(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=u!==null,n=n!==null&&n.memoizedState!==null,l){u=s.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool);var m=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==g&&(u.flags|=2048)}return l!==n&&l&&(s.child.flags|=8192),Sc(s,s.updateQueue),mr(s),null;case 4:return De(),n===null&&Tf(s.stateNode.containerInfo),mr(s),null;case 10:return Ea(s.type),mr(s),null;case 19:if(O(Or),g=s.memoizedState,g===null)return mr(s),null;if(u=(s.flags&128)!==0,m=g.rendering,m===null)if(u)zo(g,!1);else{if(br!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(m=mc(n),m!==null){for(s.flags|=128,zo(g,!1),n=m.updateQueue,s.updateQueue=n,Sc(s,n),s.subtreeFlags=0,n=l,l=s.child;l!==null;)ep(l,n),l=l.sibling;return K(Or,Or.current&1|2),s.child}n=n.sibling}g.tail!==null&&je()>Ec&&(s.flags|=128,u=!0,zo(g,!1),s.lanes=4194304)}else{if(!u)if(n=mc(m),n!==null){if(s.flags|=128,u=!0,n=n.updateQueue,s.updateQueue=n,Sc(s,n),zo(g,!0),g.tail===null&&g.tailMode==="hidden"&&!m.alternate&&!$t)return mr(s),null}else 2*je()-g.renderingStartTime>Ec&&l!==536870912&&(s.flags|=128,u=!0,zo(g,!1),s.lanes=4194304);g.isBackwards?(m.sibling=s.child,s.child=m):(n=g.last,n!==null?n.sibling=m:s.child=m,g.last=m)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=je(),s.sibling=null,n=Or.current,K(Or,u?n&1|2:n&1),s):(mr(s),null);case 22:case 23:return ja(s),Eu(),u=s.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(l&536870912)!==0&&(s.flags&128)===0&&(mr(s),s.subtreeFlags&6&&(s.flags|=8192)):mr(s),l=s.updateQueue,l!==null&&Sc(s,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==l&&(s.flags|=2048),n!==null&&O(Bs),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),Ea(Nr),mr(s),null;case 25:return null;case 30:return null}throw Error(a(156,s.tag))}function $2(n,s){switch(uu(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return Ea(Nr),De(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return rt(s),null;case 13:if(ja(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(a(340));To()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return O(Or),null;case 4:return De(),null;case 10:return Ea(s.type),null;case 22:case 23:return ja(s),Eu(),n!==null&&O(Bs),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return Ea(Nr),null;case 25:return null;default:return null}}function jg(n,s){switch(uu(s),s.tag){case 3:Ea(Nr),De();break;case 26:case 27:case 5:rt(s);break;case 4:De();break;case 13:ja(s);break;case 19:O(Or);break;case 10:Ea(s.type);break;case 22:case 23:ja(s),Eu(),n!==null&&O(Bs);break;case 24:Ea(Nr)}}function Uo(n,s){try{var l=s.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var g=u.next;l=g;do{if((l.tag&n)===n){u=void 0;var m=l.create,E=l.inst;u=m(),E.destroy=u}l=l.next}while(l!==g)}}catch(D){ir(s,s.return,D)}}function es(n,s,l){try{var u=s.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var m=g.next;u=m;do{if((u.tag&n)===n){var E=u.inst,D=E.destroy;if(D!==void 0){E.destroy=void 0,g=s;var Z=l,ve=D;try{ve()}catch(Fe){ir(g,Z,Fe)}}}u=u.next}while(u!==m)}}catch(Fe){ir(s,s.return,Fe)}}function Cg(n){var s=n.updateQueue;if(s!==null){var l=n.stateNode;try{gp(s,l)}catch(u){ir(n,n.return,u)}}}function Ag(n,s,l){l.props=Fs(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(u){ir(n,s,u)}}function Wo(n,s){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof l=="function"?n.refCleanup=l(u):l.current=u}}catch(g){ir(n,s,g)}}function ca(n,s){var l=n.ref,u=n.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(g){ir(n,s,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){ir(n,s,g)}else l.current=null}function Rg(n){var s=n.type,l=n.memoizedProps,u=n.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(g){ir(n,n.return,g)}}function Zu(n,s,l){try{var u=n.stateNode;db(u,n.type,l,s),u[yr]=s}catch(g){ir(n,n.return,g)}}function Dg(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&ls(n.type)||n.tag===4}function ef(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Dg(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&ls(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function tf(n,s,l){var u=n.tag;if(u===5||u===6)n=n.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(n),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Mc));else if(u!==4&&(u===27&&ls(n.type)&&(l=n.stateNode,s=null),n=n.child,n!==null))for(tf(n,s,l),n=n.sibling;n!==null;)tf(n,s,l),n=n.sibling}function wc(n,s,l){var u=n.tag;if(u===5||u===6)n=n.stateNode,s?l.insertBefore(n,s):l.appendChild(n);else if(u!==4&&(u===27&&ls(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(wc(n,s,l),n=n.sibling;n!==null;)wc(n,s,l),n=n.sibling}function Ng(n){var s=n.stateNode,l=n.memoizedProps;try{for(var u=n.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);Xr(s,u,l),s[Gt]=n,s[yr]=l}catch(m){ir(n,n.return,m)}}var Ra=!1,Er=!1,rf=!1,Og=typeof WeakSet=="function"?WeakSet:Set,zr=null;function H2(n,s){if(n=n.containerInfo,jf=Uc,n=Hh(n),eu(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var g=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break e}var E=0,D=-1,Z=-1,ve=0,Fe=0,Ue=n,Ee=null;t:for(;;){for(var ke;Ue!==l||g!==0&&Ue.nodeType!==3||(D=E+g),Ue!==m||u!==0&&Ue.nodeType!==3||(Z=E+u),Ue.nodeType===3&&(E+=Ue.nodeValue.length),(ke=Ue.firstChild)!==null;)Ee=Ue,Ue=ke;for(;;){if(Ue===n)break t;if(Ee===l&&++ve===g&&(D=E),Ee===m&&++Fe===u&&(Z=E),(ke=Ue.nextSibling)!==null)break;Ue=Ee,Ee=Ue.parentNode}Ue=ke}l=D===-1||Z===-1?null:{start:D,end:Z}}else l=null}l=l||{start:0,end:0}}else l=null;for(Cf={focusedElem:n,selectionRange:l},Uc=!1,zr=s;zr!==null;)if(s=zr,n=s.child,(s.subtreeFlags&1024)!==0&&n!==null)n.return=s,zr=n;else for(;zr!==null;){switch(s=zr,m=s.alternate,n=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&m!==null){n=void 0,l=s,g=m.memoizedProps,m=m.memoizedState,u=l.stateNode;try{var _t=Fs(l.type,g,l.elementType===l.type);n=u.getSnapshotBeforeUpdate(_t,m),u.__reactInternalSnapshotBeforeUpdate=n}catch(yt){ir(l,l.return,yt)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,l=n.nodeType,l===9)Df(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Df(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=s.sibling,n!==null){n.return=s.return,zr=n;break}zr=s.return}}function Mg(n,s,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:ts(n,l),u&4&&Uo(5,l);break;case 1:if(ts(n,l),u&4)if(n=l.stateNode,s===null)try{n.componentDidMount()}catch(E){ir(l,l.return,E)}else{var g=Fs(l.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(g,s,n.__reactInternalSnapshotBeforeUpdate)}catch(E){ir(l,l.return,E)}}u&64&&Cg(l),u&512&&Wo(l,l.return);break;case 3:if(ts(n,l),u&64&&(n=l.updateQueue,n!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{gp(n,s)}catch(E){ir(l,l.return,E)}}break;case 27:s===null&&u&4&&Ng(l);case 26:case 5:ts(n,l),s===null&&u&4&&Rg(l),u&512&&Wo(l,l.return);break;case 12:ts(n,l);break;case 13:ts(n,l),u&4&&Fg(n,l),u&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=Z2.bind(null,l),mb(n,l))));break;case 22:if(u=l.memoizedState!==null||Ra,!u){s=s!==null&&s.memoizedState!==null||Er,g=Ra;var m=Er;Ra=u,(Er=s)&&!m?rs(n,l,(l.subtreeFlags&8772)!==0):ts(n,l),Ra=g,Er=m}break;case 30:break;default:ts(n,l)}}function Bg(n){var s=n.alternate;s!==null&&(n.alternate=null,Bg(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&P(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var pr=null,yn=!1;function Da(n,s,l){for(l=l.child;l!==null;)Ig(n,s,l),l=l.sibling}function Ig(n,s,l){if(Tt&&typeof Tt.onCommitFiberUnmount=="function")try{Tt.onCommitFiberUnmount(It,l)}catch{}switch(l.tag){case 26:Er||ca(l,s),Da(n,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Er||ca(l,s);var u=pr,g=yn;ls(l.type)&&(pr=l.stateNode,yn=!1),Da(n,s,l),Qo(l.stateNode),pr=u,yn=g;break;case 5:Er||ca(l,s);case 6:if(u=pr,g=yn,pr=null,Da(n,s,l),pr=u,yn=g,pr!==null)if(yn)try{(pr.nodeType===9?pr.body:pr.nodeName==="HTML"?pr.ownerDocument.body:pr).removeChild(l.stateNode)}catch(m){ir(l,s,m)}else try{pr.removeChild(l.stateNode)}catch(m){ir(l,s,m)}break;case 18:pr!==null&&(yn?(n=pr,Tx(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),sl(n)):Tx(pr,l.stateNode));break;case 4:u=pr,g=yn,pr=l.stateNode.containerInfo,yn=!0,Da(n,s,l),pr=u,yn=g;break;case 0:case 11:case 14:case 15:Er||es(2,l,s),Er||es(4,l,s),Da(n,s,l);break;case 1:Er||(ca(l,s),u=l.stateNode,typeof u.componentWillUnmount=="function"&&Ag(l,s,u)),Da(n,s,l);break;case 21:Da(n,s,l);break;case 22:Er=(u=Er)||l.memoizedState!==null,Da(n,s,l),Er=u;break;default:Da(n,s,l)}}function Fg(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{sl(n)}catch(l){ir(s,s.return,l)}}function q2(n){switch(n.tag){case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new Og),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new Og),s;default:throw Error(a(435,n.tag))}}function nf(n,s){var l=q2(n);s.forEach(function(u){var g=eb.bind(null,n,u);l.has(u)||(l.add(u),u.then(g,g))})}function kn(n,s){var l=s.deletions;if(l!==null)for(var u=0;u<l.length;u++){var g=l[u],m=n,E=s,D=E;e:for(;D!==null;){switch(D.tag){case 27:if(ls(D.type)){pr=D.stateNode,yn=!1;break e}break;case 5:pr=D.stateNode,yn=!1;break e;case 3:case 4:pr=D.stateNode.containerInfo,yn=!0;break e}D=D.return}if(pr===null)throw Error(a(160));Ig(m,E,g),pr=null,yn=!1,m=g.alternate,m!==null&&(m.return=null),g.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Lg(s,n),s=s.sibling}var Xn=null;function Lg(n,s){var l=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:kn(s,n),jn(n),u&4&&(es(3,n,n.return),Uo(3,n),es(5,n,n.return));break;case 1:kn(s,n),jn(n),u&512&&(Er||l===null||ca(l,l.return)),u&64&&Ra&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var g=Xn;if(kn(s,n),jn(n),u&512&&(Er||l===null||ca(l,l.return)),u&4){var m=l!==null?l.memoizedState:null;if(u=n.memoizedState,l===null)if(u===null)if(n.stateNode===null){e:{u=n.type,l=n.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":m=g.getElementsByTagName("title")[0],(!m||m[I]||m[Gt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=g.createElement(u),g.head.insertBefore(m,g.querySelector("head > title"))),Xr(m,u,l),m[Gt]=n,ce(m),u=m;break e;case"link":var E=Nx("link","href",g).get(u+(l.href||""));if(E){for(var D=0;D<E.length;D++)if(m=E[D],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){E.splice(D,1);break t}}m=g.createElement(u),Xr(m,u,l),g.head.appendChild(m);break;case"meta":if(E=Nx("meta","content",g).get(u+(l.content||""))){for(D=0;D<E.length;D++)if(m=E[D],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){E.splice(D,1);break t}}m=g.createElement(u),Xr(m,u,l),g.head.appendChild(m);break;default:throw Error(a(468,u))}m[Gt]=n,ce(m),u=m}n.stateNode=u}else Ox(g,n.type,n.stateNode);else n.stateNode=Dx(g,u,n.memoizedProps);else m!==u?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,u===null?Ox(g,n.type,n.stateNode):Dx(g,u,n.memoizedProps)):u===null&&n.stateNode!==null&&Zu(n,n.memoizedProps,l.memoizedProps)}break;case 27:kn(s,n),jn(n),u&512&&(Er||l===null||ca(l,l.return)),l!==null&&u&4&&Zu(n,n.memoizedProps,l.memoizedProps);break;case 5:if(kn(s,n),jn(n),u&512&&(Er||l===null||ca(l,l.return)),n.flags&32){g=n.stateNode;try{ai(g,"")}catch(ke){ir(n,n.return,ke)}}u&4&&n.stateNode!=null&&(g=n.memoizedProps,Zu(n,g,l!==null?l.memoizedProps:g)),u&1024&&(rf=!0);break;case 6:if(kn(s,n),jn(n),u&4){if(n.stateNode===null)throw Error(a(162));u=n.memoizedProps,l=n.stateNode;try{l.nodeValue=u}catch(ke){ir(n,n.return,ke)}}break;case 3:if(Lc=null,g=Xn,Xn=Ic(s.containerInfo),kn(s,n),Xn=g,jn(n),u&4&&l!==null&&l.memoizedState.isDehydrated)try{sl(s.containerInfo)}catch(ke){ir(n,n.return,ke)}rf&&(rf=!1,Pg(n));break;case 4:u=Xn,Xn=Ic(n.stateNode.containerInfo),kn(s,n),jn(n),Xn=u;break;case 12:kn(s,n),jn(n);break;case 13:kn(s,n),jn(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(df=je()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,nf(n,u)));break;case 22:g=n.memoizedState!==null;var Z=l!==null&&l.memoizedState!==null,ve=Ra,Fe=Er;if(Ra=ve||g,Er=Fe||Z,kn(s,n),Er=Fe,Ra=ve,jn(n),u&8192)e:for(s=n.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(l===null||Z||Ra||Er||Ls(n)),l=null,s=n;;){if(s.tag===5||s.tag===26){if(l===null){Z=l=s;try{if(m=Z.stateNode,g)E=m.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{D=Z.stateNode;var Ue=Z.memoizedProps.style,Ee=Ue!=null&&Ue.hasOwnProperty("display")?Ue.display:null;D.style.display=Ee==null||typeof Ee=="boolean"?"":(""+Ee).trim()}}catch(ke){ir(Z,Z.return,ke)}}}else if(s.tag===6){if(l===null){Z=s;try{Z.stateNode.nodeValue=g?"":Z.memoizedProps}catch(ke){ir(Z,Z.return,ke)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=n.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,nf(n,l))));break;case 19:kn(s,n),jn(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,nf(n,u)));break;case 30:break;case 21:break;default:kn(s,n),jn(n)}}function jn(n){var s=n.flags;if(s&2){try{for(var l,u=n.return;u!==null;){if(Dg(u)){l=u;break}u=u.return}if(l==null)throw Error(a(160));switch(l.tag){case 27:var g=l.stateNode,m=ef(n);wc(n,m,g);break;case 5:var E=l.stateNode;l.flags&32&&(ai(E,""),l.flags&=-33);var D=ef(n);wc(n,D,E);break;case 3:case 4:var Z=l.stateNode.containerInfo,ve=ef(n);tf(n,ve,Z);break;default:throw Error(a(161))}}catch(Fe){ir(n,n.return,Fe)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function Pg(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;Pg(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function ts(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Mg(n,s.alternate,s),s=s.sibling}function Ls(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:es(4,s,s.return),Ls(s);break;case 1:ca(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&Ag(s,s.return,l),Ls(s);break;case 27:Qo(s.stateNode);case 26:case 5:ca(s,s.return),Ls(s);break;case 22:s.memoizedState===null&&Ls(s);break;case 30:Ls(s);break;default:Ls(s)}n=n.sibling}}function rs(n,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,g=n,m=s,E=m.flags;switch(m.tag){case 0:case 11:case 15:rs(g,m,l),Uo(4,m);break;case 1:if(rs(g,m,l),u=m,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(ve){ir(u,u.return,ve)}if(u=m,g=u.updateQueue,g!==null){var D=u.stateNode;try{var Z=g.shared.hiddenCallbacks;if(Z!==null)for(g.shared.hiddenCallbacks=null,g=0;g<Z.length;g++)pp(Z[g],D)}catch(ve){ir(u,u.return,ve)}}l&&E&64&&Cg(m),Wo(m,m.return);break;case 27:Ng(m);case 26:case 5:rs(g,m,l),l&&u===null&&E&4&&Rg(m),Wo(m,m.return);break;case 12:rs(g,m,l);break;case 13:rs(g,m,l),l&&E&4&&Fg(g,m);break;case 22:m.memoizedState===null&&rs(g,m,l),Wo(m,m.return);break;case 30:break;default:rs(g,m,l)}s=s.sibling}}function af(n,s){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&jo(l))}function sf(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&jo(n))}function da(n,s,l,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)zg(n,s,l,u),s=s.sibling}function zg(n,s,l,u){var g=s.flags;switch(s.tag){case 0:case 11:case 15:da(n,s,l,u),g&2048&&Uo(9,s);break;case 1:da(n,s,l,u);break;case 3:da(n,s,l,u),g&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&jo(n)));break;case 12:if(g&2048){da(n,s,l,u),n=s.stateNode;try{var m=s.memoizedProps,E=m.id,D=m.onPostCommit;typeof D=="function"&&D(E,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(Z){ir(s,s.return,Z)}}else da(n,s,l,u);break;case 13:da(n,s,l,u);break;case 23:break;case 22:m=s.stateNode,E=s.alternate,s.memoizedState!==null?m._visibility&2?da(n,s,l,u):$o(n,s):m._visibility&2?da(n,s,l,u):(m._visibility|=2,wi(n,s,l,u,(s.subtreeFlags&10256)!==0)),g&2048&&af(E,s);break;case 24:da(n,s,l,u),g&2048&&sf(s.alternate,s);break;default:da(n,s,l,u)}}function wi(n,s,l,u,g){for(g=g&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var m=n,E=s,D=l,Z=u,ve=E.flags;switch(E.tag){case 0:case 11:case 15:wi(m,E,D,Z,g),Uo(8,E);break;case 23:break;case 22:var Fe=E.stateNode;E.memoizedState!==null?Fe._visibility&2?wi(m,E,D,Z,g):$o(m,E):(Fe._visibility|=2,wi(m,E,D,Z,g)),g&&ve&2048&&af(E.alternate,E);break;case 24:wi(m,E,D,Z,g),g&&ve&2048&&sf(E.alternate,E);break;default:wi(m,E,D,Z,g)}s=s.sibling}}function $o(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=n,u=s,g=u.flags;switch(u.tag){case 22:$o(l,u),g&2048&&af(u.alternate,u);break;case 24:$o(l,u),g&2048&&sf(u.alternate,u);break;default:$o(l,u)}s=s.sibling}}var Ho=8192;function Ti(n){if(n.subtreeFlags&Ho)for(n=n.child;n!==null;)Ug(n),n=n.sibling}function Ug(n){switch(n.tag){case 26:Ti(n),n.flags&Ho&&n.memoizedState!==null&&Rb(Xn,n.memoizedState,n.memoizedProps);break;case 5:Ti(n);break;case 3:case 4:var s=Xn;Xn=Ic(n.stateNode.containerInfo),Ti(n),Xn=s;break;case 22:n.memoizedState===null&&(s=n.alternate,s!==null&&s.memoizedState!==null?(s=Ho,Ho=16777216,Ti(n),Ho=s):Ti(n));break;default:Ti(n)}}function Wg(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function qo(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var u=s[l];zr=u,Hg(u,n)}Wg(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)$g(n),n=n.sibling}function $g(n){switch(n.tag){case 0:case 11:case 15:qo(n),n.flags&2048&&es(9,n,n.return);break;case 3:qo(n);break;case 12:qo(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,Tc(n)):qo(n);break;default:qo(n)}}function Tc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var u=s[l];zr=u,Hg(u,n)}Wg(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:es(8,s,s.return),Tc(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Tc(s));break;default:Tc(s)}n=n.sibling}}function Hg(n,s){for(;zr!==null;){var l=zr;switch(l.tag){case 0:case 11:case 15:es(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:jo(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,zr=u;else e:for(l=n;zr!==null;){u=zr;var g=u.sibling,m=u.return;if(Bg(u),u===l){zr=null;break e}if(g!==null){g.return=m,zr=g;break e}zr=m}}}var G2={getCacheForType:function(n){var s=nn(Nr),l=s.data.get(n);return l===void 0&&(l=n(),s.data.set(n,l)),l}},Y2=typeof WeakMap=="function"?WeakMap:Map,Vt=0,lr=null,Nt=null,Ft=0,Xt=0,Cn=null,ns=!1,Ei=!1,of=!1,Na=0,br=0,as=0,Ps=0,lf=0,Wn=0,ki=0,Go=null,vn=null,cf=!1,df=0,Ec=1/0,kc=null,ss=null,Vr=0,is=null,ji=null,Ci=0,uf=0,ff=null,qg=null,Yo=0,hf=null;function An(){if((Vt&2)!==0&&Ft!==0)return Ft&-Ft;if(ee.T!==null){var n=gi;return n!==0?n:bf()}return Dr()}function Gg(){Wn===0&&(Wn=(Ft&536870912)===0||$t?se():536870912);var n=Un.current;return n!==null&&(n.flags|=32),Wn}function Rn(n,s,l){(n===lr&&(Xt===2||Xt===9)||n.cancelPendingCommit!==null)&&(Ai(n,0),os(n,Ft,Wn,!1)),pt(n,l),((Vt&2)===0||n!==lr)&&(n===lr&&((Vt&2)===0&&(Ps|=l),br===4&&os(n,Ft,Wn,!1)),ua(n))}function Yg(n,s,l){if((Vt&6)!==0)throw Error(a(327));var u=!l&&(s&124)===0&&(s&n.expiredLanes)===0||Yt(n,s),g=u?K2(n,s):xf(n,s,!0),m=u;do{if(g===0){Ei&&!u&&os(n,s,0,!1);break}else{if(l=n.current.alternate,m&&!V2(l)){g=xf(n,s,!1),m=!1;continue}if(g===2){if(m=s,n.errorRecoveryDisabledLanes&m)var E=0;else E=n.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var D=n;g=Go;var Z=D.current.memoizedState.isDehydrated;if(Z&&(Ai(D,E).flags|=256),E=xf(D,E,!1),E!==2){if(of&&!Z){D.errorRecoveryDisabledLanes|=m,Ps|=m,g=4;break e}m=vn,vn=g,m!==null&&(vn===null?vn=m:vn.push.apply(vn,m))}g=E}if(m=!1,g!==2)continue}}if(g===1){Ai(n,0),os(n,s,0,!0);break}e:{switch(u=n,m=g,m){case 0:case 1:throw Error(a(345));case 4:if((s&4194048)!==s)break;case 6:os(u,s,Wn,!ns);break e;case 2:vn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((s&62914560)===s&&(g=df+300-je(),10<g)){if(os(u,s,Wn,!ns),ut(u,0,!0)!==0)break e;u.timeoutHandle=Sx(Vg.bind(null,u,l,vn,kc,cf,s,Wn,Ps,ki,ns,m,2,-0,0),g);break e}Vg(u,l,vn,kc,cf,s,Wn,Ps,ki,ns,m,0,-0,0)}}break}while(!0);ua(n)}function Vg(n,s,l,u,g,m,E,D,Z,ve,Fe,Ue,Ee,ke){if(n.timeoutHandle=-1,Ue=s.subtreeFlags,(Ue&8192||(Ue&16785408)===16785408)&&(el={stylesheets:null,count:0,unsuspend:Ab},Ug(s),Ue=Db(),Ue!==null)){n.cancelPendingCommit=Ue(tx.bind(null,n,s,m,l,u,g,E,D,Z,Fe,1,Ee,ke)),os(n,m,E,!ve);return}tx(n,s,m,l,u,g,E,D,Z)}function V2(n){for(var s=n;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var g=l[u],m=g.getSnapshot;g=g.value;try{if(!Tn(m(),g))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function os(n,s,l,u){s&=~lf,s&=~Ps,n.suspendedLanes|=s,n.pingedLanes&=~s,u&&(n.warmLanes|=s),u=n.expirationTimes;for(var g=s;0<g;){var m=31-Le(g),E=1<<m;u[m]=-1,g&=~E}l!==0&&zt(n,l,s)}function jc(){return(Vt&6)===0?(Vo(0),!1):!0}function pf(){if(Nt!==null){if(Xt===0)var n=Nt.return;else n=Nt,Ta=Os=null,Ru(n),_i=null,Lo=0,n=Nt;for(;n!==null;)jg(n.alternate,n),n=n.return;Nt=null}}function Ai(n,s){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,fb(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),pf(),lr=n,Nt=l=_a(n.current,null),Ft=s,Xt=0,Cn=null,ns=!1,Ei=Yt(n,s),of=!1,ki=Wn=lf=Ps=as=br=0,vn=Go=null,cf=!1,(s&8)!==0&&(s|=s&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=s;0<u;){var g=31-Le(u),m=1<<g;s|=n[g],u&=~m}return Na=s,Xl(),l}function Xg(n,s){Rt=null,ee.H=pc,s===Ao||s===ac?(s=fp(),Xt=3):s===cp?(s=fp(),Xt=4):Xt=s===hg?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Cn=s,Nt===null&&(br=1,vc(n,Fn(s,n.current)))}function Kg(){var n=ee.H;return ee.H=pc,n===null?pc:n}function Qg(){var n=ee.A;return ee.A=G2,n}function gf(){br=4,ns||(Ft&4194048)!==Ft&&Un.current!==null||(Ei=!0),(as&134217727)===0&&(Ps&134217727)===0||lr===null||os(lr,Ft,Wn,!1)}function xf(n,s,l){var u=Vt;Vt|=2;var g=Kg(),m=Qg();(lr!==n||Ft!==s)&&(kc=null,Ai(n,s)),s=!1;var E=br;e:do try{if(Xt!==0&&Nt!==null){var D=Nt,Z=Cn;switch(Xt){case 8:pf(),E=6;break e;case 3:case 2:case 9:case 6:Un.current===null&&(s=!0);var ve=Xt;if(Xt=0,Cn=null,Ri(n,D,Z,ve),l&&Ei){E=0;break e}break;default:ve=Xt,Xt=0,Cn=null,Ri(n,D,Z,ve)}}X2(),E=br;break}catch(Fe){Xg(n,Fe)}while(!0);return s&&n.shellSuspendCounter++,Ta=Os=null,Vt=u,ee.H=g,ee.A=m,Nt===null&&(lr=null,Ft=0,Xl()),E}function X2(){for(;Nt!==null;)Jg(Nt)}function K2(n,s){var l=Vt;Vt|=2;var u=Kg(),g=Qg();lr!==n||Ft!==s?(kc=null,Ec=je()+500,Ai(n,s)):Ei=Yt(n,s);e:do try{if(Xt!==0&&Nt!==null){s=Nt;var m=Cn;t:switch(Xt){case 1:Xt=0,Cn=null,Ri(n,s,m,1);break;case 2:case 9:if(dp(m)){Xt=0,Cn=null,Zg(s);break}s=function(){Xt!==2&&Xt!==9||lr!==n||(Xt=7),ua(n)},m.then(s,s);break e;case 3:Xt=7;break e;case 4:Xt=5;break e;case 7:dp(m)?(Xt=0,Cn=null,Zg(s)):(Xt=0,Cn=null,Ri(n,s,m,7));break;case 5:var E=null;switch(Nt.tag){case 26:E=Nt.memoizedState;case 5:case 27:var D=Nt;if(!E||Mx(E)){Xt=0,Cn=null;var Z=D.sibling;if(Z!==null)Nt=Z;else{var ve=D.return;ve!==null?(Nt=ve,Cc(ve)):Nt=null}break t}}Xt=0,Cn=null,Ri(n,s,m,5);break;case 6:Xt=0,Cn=null,Ri(n,s,m,6);break;case 8:pf(),br=6;break e;default:throw Error(a(462))}}Q2();break}catch(Fe){Xg(n,Fe)}while(!0);return Ta=Os=null,ee.H=u,ee.A=g,Vt=l,Nt!==null?0:(lr=null,Ft=0,Xl(),br)}function Q2(){for(;Nt!==null&&!be();)Jg(Nt)}function Jg(n){var s=Eg(n.alternate,n,Na);n.memoizedProps=n.pendingProps,s===null?Cc(n):Nt=s}function Zg(n){var s=n,l=s.alternate;switch(s.tag){case 15:case 0:s=vg(l,s,s.pendingProps,s.type,void 0,Ft);break;case 11:s=vg(l,s,s.pendingProps,s.type.render,s.ref,Ft);break;case 5:Ru(s);default:jg(l,s),s=Nt=ep(s,Na),s=Eg(l,s,Na)}n.memoizedProps=n.pendingProps,s===null?Cc(n):Nt=s}function Ri(n,s,l,u){Ta=Os=null,Ru(s),_i=null,Lo=0;var g=s.return;try{if(z2(n,g,s,l,Ft)){br=1,vc(n,Fn(l,n.current)),Nt=null;return}}catch(m){if(g!==null)throw Nt=g,m;br=1,vc(n,Fn(l,n.current)),Nt=null;return}s.flags&32768?($t||u===1?n=!0:Ei||(Ft&536870912)!==0?n=!1:(ns=n=!0,(u===2||u===9||u===3||u===6)&&(u=Un.current,u!==null&&u.tag===13&&(u.flags|=16384))),ex(s,n)):Cc(s)}function Cc(n){var s=n;do{if((s.flags&32768)!==0){ex(s,ns);return}n=s.return;var l=W2(s.alternate,s,Na);if(l!==null){Nt=l;return}if(s=s.sibling,s!==null){Nt=s;return}Nt=s=n}while(s!==null);br===0&&(br=5)}function ex(n,s){do{var l=$2(n.alternate,n);if(l!==null){l.flags&=32767,Nt=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(n=n.sibling,n!==null)){Nt=n;return}Nt=n=l}while(n!==null);br=6,Nt=null}function tx(n,s,l,u,g,m,E,D,Z){n.cancelPendingCommit=null;do Ac();while(Vr!==0);if((Vt&6)!==0)throw Error(a(327));if(s!==null){if(s===n.current)throw Error(a(177));if(m=s.lanes|s.childLanes,m|=su,Lt(n,l,m,E,D,Z),n===lr&&(Nt=lr=null,Ft=0),ji=s,is=n,Ci=l,uf=m,ff=g,qg=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,tb(Ne,function(){return ix(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=ee.T,ee.T=null,g=ye.p,ye.p=2,E=Vt,Vt|=4;try{H2(n,s,l)}finally{Vt=E,ye.p=g,ee.T=u}}Vr=1,rx(),nx(),ax()}}function rx(){if(Vr===1){Vr=0;var n=is,s=ji,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=ee.T,ee.T=null;var u=ye.p;ye.p=2;var g=Vt;Vt|=4;try{Lg(s,n);var m=Cf,E=Hh(n.containerInfo),D=m.focusedElem,Z=m.selectionRange;if(E!==D&&D&&D.ownerDocument&&$h(D.ownerDocument.documentElement,D)){if(Z!==null&&eu(D)){var ve=Z.start,Fe=Z.end;if(Fe===void 0&&(Fe=ve),"selectionStart"in D)D.selectionStart=ve,D.selectionEnd=Math.min(Fe,D.value.length);else{var Ue=D.ownerDocument||document,Ee=Ue&&Ue.defaultView||window;if(Ee.getSelection){var ke=Ee.getSelection(),_t=D.textContent.length,yt=Math.min(Z.start,_t),ar=Z.end===void 0?yt:Math.min(Z.end,_t);!ke.extend&&yt>ar&&(E=ar,ar=yt,yt=E);var ue=Wh(D,yt),ie=Wh(D,ar);if(ue&&ie&&(ke.rangeCount!==1||ke.anchorNode!==ue.node||ke.anchorOffset!==ue.offset||ke.focusNode!==ie.node||ke.focusOffset!==ie.offset)){var xe=Ue.createRange();xe.setStart(ue.node,ue.offset),ke.removeAllRanges(),yt>ar?(ke.addRange(xe),ke.extend(ie.node,ie.offset)):(xe.setEnd(ie.node,ie.offset),ke.addRange(xe))}}}}for(Ue=[],ke=D;ke=ke.parentNode;)ke.nodeType===1&&Ue.push({element:ke,left:ke.scrollLeft,top:ke.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<Ue.length;D++){var Pe=Ue[D];Pe.element.scrollLeft=Pe.left,Pe.element.scrollTop=Pe.top}}Uc=!!jf,Cf=jf=null}finally{Vt=g,ye.p=u,ee.T=l}}n.current=s,Vr=2}}function nx(){if(Vr===2){Vr=0;var n=is,s=ji,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=ee.T,ee.T=null;var u=ye.p;ye.p=2;var g=Vt;Vt|=4;try{Mg(n,s.alternate,s)}finally{Vt=g,ye.p=u,ee.T=l}}Vr=3}}function ax(){if(Vr===4||Vr===3){Vr=0,Ke();var n=is,s=ji,l=Ci,u=qg;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Vr=5:(Vr=0,ji=is=null,sx(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(ss=null),In(l),s=s.stateNode,Tt&&typeof Tt.onCommitFiberRoot=="function")try{Tt.onCommitFiberRoot(It,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=ee.T,g=ye.p,ye.p=2,ee.T=null;try{for(var m=n.onRecoverableError,E=0;E<u.length;E++){var D=u[E];m(D.value,{componentStack:D.stack})}}finally{ee.T=s,ye.p=g}}(Ci&3)!==0&&Ac(),ua(n),g=n.pendingLanes,(l&4194090)!==0&&(g&42)!==0?n===hf?Yo++:(Yo=0,hf=n):Yo=0,Vo(0)}}function sx(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,jo(s)))}function Ac(n){return rx(),nx(),ax(),ix()}function ix(){if(Vr!==5)return!1;var n=is,s=uf;uf=0;var l=In(Ci),u=ee.T,g=ye.p;try{ye.p=32>l?32:l,ee.T=null,l=ff,ff=null;var m=is,E=Ci;if(Vr=0,ji=is=null,Ci=0,(Vt&6)!==0)throw Error(a(331));var D=Vt;if(Vt|=4,$g(m.current),zg(m,m.current,E,l),Vt=D,Vo(0,!1),Tt&&typeof Tt.onPostCommitFiberRoot=="function")try{Tt.onPostCommitFiberRoot(It,m)}catch{}return!0}finally{ye.p=g,ee.T=u,sx(n,s)}}function ox(n,s,l){s=Fn(l,s),s=Hu(n.stateNode,s,2),n=Ka(n,s,2),n!==null&&(pt(n,2),ua(n))}function ir(n,s,l){if(n.tag===3)ox(n,n,l);else for(;s!==null;){if(s.tag===3){ox(s,n,l);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ss===null||!ss.has(u))){n=Fn(l,n),l=ug(2),u=Ka(s,l,2),u!==null&&(fg(l,u,s,n),pt(u,2),ua(u));break}}s=s.return}}function mf(n,s,l){var u=n.pingCache;if(u===null){u=n.pingCache=new Y2;var g=new Set;u.set(s,g)}else g=u.get(s),g===void 0&&(g=new Set,u.set(s,g));g.has(l)||(of=!0,g.add(l),n=J2.bind(null,n,s,l),s.then(n,n))}function J2(n,s,l){var u=n.pingCache;u!==null&&u.delete(s),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,lr===n&&(Ft&l)===l&&(br===4||br===3&&(Ft&62914560)===Ft&&300>je()-df?(Vt&2)===0&&Ai(n,0):lf|=l,ki===Ft&&(ki=0)),ua(n)}function lx(n,s){s===0&&(s=_e()),n=ui(n,s),n!==null&&(pt(n,s),ua(n))}function Z2(n){var s=n.memoizedState,l=0;s!==null&&(l=s.retryLane),lx(n,l)}function eb(n,s){var l=0;switch(n.tag){case 13:var u=n.stateNode,g=n.memoizedState;g!==null&&(l=g.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(s),lx(n,l)}function tb(n,s){return $e(n,s)}var Rc=null,Di=null,yf=!1,Dc=!1,vf=!1,zs=0;function ua(n){n!==Di&&n.next===null&&(Di===null?Rc=Di=n:Di=Di.next=n),Dc=!0,yf||(yf=!0,nb())}function Vo(n,s){if(!vf&&Dc){vf=!0;do for(var l=!1,u=Rc;u!==null;){if(n!==0){var g=u.pendingLanes;if(g===0)var m=0;else{var E=u.suspendedLanes,D=u.pingedLanes;m=(1<<31-Le(42|n)+1)-1,m&=g&~(E&~D),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,fx(u,m))}else m=Ft,m=ut(u,u===lr?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(m&3)===0||Yt(u,m)||(l=!0,fx(u,m));u=u.next}while(l);vf=!1}}function rb(){cx()}function cx(){Dc=yf=!1;var n=0;zs!==0&&(ub()&&(n=zs),zs=0);for(var s=je(),l=null,u=Rc;u!==null;){var g=u.next,m=dx(u,s);m===0?(u.next=null,l===null?Rc=g:l.next=g,g===null&&(Di=l)):(l=u,(n!==0||(m&3)!==0)&&(Dc=!0)),u=g}Vo(n)}function dx(n,s){for(var l=n.suspendedLanes,u=n.pingedLanes,g=n.expirationTimes,m=n.pendingLanes&-62914561;0<m;){var E=31-Le(m),D=1<<E,Z=g[E];Z===-1?((D&l)===0||(D&u)!==0)&&(g[E]=wt(D,s)):Z<=s&&(n.expiredLanes|=D),m&=~D}if(s=lr,l=Ft,l=ut(n,n===s?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,l===0||n===s&&(Xt===2||Xt===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&z(u),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||Yt(n,l)){if(s=l&-l,s===n.callbackPriority)return s;switch(u!==null&&z(u),In(l)){case 2:case 8:l=ot;break;case 32:l=Ne;break;case 268435456:l=mt;break;default:l=Ne}return u=ux.bind(null,n),l=$e(l,u),n.callbackPriority=s,n.callbackNode=l,s}return u!==null&&u!==null&&z(u),n.callbackPriority=2,n.callbackNode=null,2}function ux(n,s){if(Vr!==0&&Vr!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(Ac()&&n.callbackNode!==l)return null;var u=Ft;return u=ut(n,n===lr?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(Yg(n,u,s),dx(n,je()),n.callbackNode!=null&&n.callbackNode===l?ux.bind(null,n):null)}function fx(n,s){if(Ac())return null;Yg(n,s,!0)}function nb(){hb(function(){(Vt&6)!==0?$e(We,rb):cx()})}function bf(){return zs===0&&(zs=se()),zs}function hx(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Wl(""+n)}function px(n,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,n.id&&l.setAttribute("form",n.id),s.parentNode.insertBefore(l,s),n=new FormData(n),l.parentNode.removeChild(l),n}function ab(n,s,l,u,g){if(s==="submit"&&l&&l.stateNode===g){var m=hx((g[yr]||null).action),E=u.submitter;E&&(s=(s=E[yr]||null)?hx(s.formAction):E.getAttribute("formAction"),s!==null&&(m=s,E=null));var D=new Gl("action","action",null,u,g);n.push({event:D,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(zs!==0){var Z=E?px(g,E):new FormData(g);Pu(l,{pending:!0,data:Z,method:g.method,action:m},null,Z)}}else typeof m=="function"&&(D.preventDefault(),Z=E?px(g,E):new FormData(g),Pu(l,{pending:!0,data:Z,method:g.method,action:m},m,Z))},currentTarget:g}]})}}for(var _f=0;_f<au.length;_f++){var Sf=au[_f],sb=Sf.toLowerCase(),ib=Sf[0].toUpperCase()+Sf.slice(1);Vn(sb,"on"+ib)}Vn(Yh,"onAnimationEnd"),Vn(Vh,"onAnimationIteration"),Vn(Xh,"onAnimationStart"),Vn("dblclick","onDoubleClick"),Vn("focusin","onFocus"),Vn("focusout","onBlur"),Vn(w2,"onTransitionRun"),Vn(T2,"onTransitionStart"),Vn(E2,"onTransitionCancel"),Vn(Kh,"onTransitionEnd"),Je("onMouseEnter",["mouseout","mouseover"]),Je("onMouseLeave",["mouseout","mouseover"]),Je("onPointerEnter",["pointerout","pointerover"]),Je("onPointerLeave",["pointerout","pointerover"]),Ye("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ye("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ye("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ye("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ye("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ob=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xo));function gx(n,s){s=(s&4)!==0;for(var l=0;l<n.length;l++){var u=n[l],g=u.event;u=u.listeners;e:{var m=void 0;if(s)for(var E=u.length-1;0<=E;E--){var D=u[E],Z=D.instance,ve=D.currentTarget;if(D=D.listener,Z!==m&&g.isPropagationStopped())break e;m=D,g.currentTarget=ve;try{m(g)}catch(Fe){yc(Fe)}g.currentTarget=null,m=Z}else for(E=0;E<u.length;E++){if(D=u[E],Z=D.instance,ve=D.currentTarget,D=D.listener,Z!==m&&g.isPropagationStopped())break e;m=D,g.currentTarget=ve;try{m(g)}catch(Fe){yc(Fe)}g.currentTarget=null,m=Z}}}}function Ot(n,s){var l=s[ma];l===void 0&&(l=s[ma]=new Set);var u=n+"__bubble";l.has(u)||(xx(s,n,2,!1),l.add(u))}function wf(n,s,l){var u=0;s&&(u|=4),xx(l,n,u,s)}var Nc="_reactListening"+Math.random().toString(36).slice(2);function Tf(n){if(!n[Nc]){n[Nc]=!0,we.forEach(function(l){l!=="selectionchange"&&(ob.has(l)||wf(l,!1,n),wf(l,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[Nc]||(s[Nc]=!0,wf("selectionchange",!1,s))}}function xx(n,s,l,u){switch(zx(s)){case 2:var g=Mb;break;case 8:g=Bb;break;default:g=Lf}l=g.bind(null,s,l,n),g=void 0,!qd||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),u?g!==void 0?n.addEventListener(s,l,{capture:!0,passive:g}):n.addEventListener(s,l,!0):g!==void 0?n.addEventListener(s,l,{passive:g}):n.addEventListener(s,l,!1)}function Ef(n,s,l,u,g){var m=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var E=u.tag;if(E===3||E===4){var D=u.stateNode.containerInfo;if(D===g)break;if(E===4)for(E=u.return;E!==null;){var Z=E.tag;if((Z===3||Z===4)&&E.stateNode.containerInfo===g)return;E=E.return}for(;D!==null;){if(E=W(D),E===null)return;if(Z=E.tag,Z===5||Z===6||Z===26||Z===27){u=m=E;continue e}D=D.parentNode}}u=u.return}wh(function(){var ve=m,Fe=$d(l),Ue=[];e:{var Ee=Qh.get(n);if(Ee!==void 0){var ke=Gl,_t=n;switch(n){case"keypress":if(Hl(l)===0)break e;case"keydown":case"keyup":ke=t2;break;case"focusin":_t="focus",ke=Xd;break;case"focusout":_t="blur",ke=Xd;break;case"beforeblur":case"afterblur":ke=Xd;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=kh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=$v;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=a2;break;case Yh:case Vh:case Xh:ke=Gv;break;case Kh:ke=i2;break;case"scroll":case"scrollend":ke=Uv;break;case"wheel":ke=l2;break;case"copy":case"cut":case"paste":ke=Vv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=Ch;break;case"toggle":case"beforetoggle":ke=d2}var yt=(s&4)!==0,ar=!yt&&(n==="scroll"||n==="scrollend"),ue=yt?Ee!==null?Ee+"Capture":null:Ee;yt=[];for(var ie=ve,xe;ie!==null;){var Pe=ie;if(xe=Pe.stateNode,Pe=Pe.tag,Pe!==5&&Pe!==26&&Pe!==27||xe===null||ue===null||(Pe=po(ie,ue),Pe!=null&&yt.push(Ko(ie,Pe,xe))),ar)break;ie=ie.return}0<yt.length&&(Ee=new ke(Ee,_t,null,l,Fe),Ue.push({event:Ee,listeners:yt}))}}if((s&7)===0){e:{if(Ee=n==="mouseover"||n==="pointerover",ke=n==="mouseout"||n==="pointerout",Ee&&l!==Wd&&(_t=l.relatedTarget||l.fromElement)&&(W(_t)||_t[Gr]))break e;if((ke||Ee)&&(Ee=Fe.window===Fe?Fe:(Ee=Fe.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,ke?(_t=l.relatedTarget||l.toElement,ke=ve,_t=_t?W(_t):null,_t!==null&&(ar=c(_t),yt=_t.tag,_t!==ar||yt!==5&&yt!==27&&yt!==6)&&(_t=null)):(ke=null,_t=ve),ke!==_t)){if(yt=kh,Pe="onMouseLeave",ue="onMouseEnter",ie="mouse",(n==="pointerout"||n==="pointerover")&&(yt=Ch,Pe="onPointerLeave",ue="onPointerEnter",ie="pointer"),ar=ke==null?Ee:me(ke),xe=_t==null?Ee:me(_t),Ee=new yt(Pe,ie+"leave",ke,l,Fe),Ee.target=ar,Ee.relatedTarget=xe,Pe=null,W(Fe)===ve&&(yt=new yt(ue,ie+"enter",_t,l,Fe),yt.target=xe,yt.relatedTarget=ar,Pe=yt),ar=Pe,ke&&_t)t:{for(yt=ke,ue=_t,ie=0,xe=yt;xe;xe=Ni(xe))ie++;for(xe=0,Pe=ue;Pe;Pe=Ni(Pe))xe++;for(;0<ie-xe;)yt=Ni(yt),ie--;for(;0<xe-ie;)ue=Ni(ue),xe--;for(;ie--;){if(yt===ue||ue!==null&&yt===ue.alternate)break t;yt=Ni(yt),ue=Ni(ue)}yt=null}else yt=null;ke!==null&&mx(Ue,Ee,ke,yt,!1),_t!==null&&ar!==null&&mx(Ue,ar,_t,yt,!0)}}e:{if(Ee=ve?me(ve):window,ke=Ee.nodeName&&Ee.nodeName.toLowerCase(),ke==="select"||ke==="input"&&Ee.type==="file")var ft=Ih;else if(Mh(Ee))if(Fh)ft=b2;else{ft=y2;var Dt=m2}else ke=Ee.nodeName,!ke||ke.toLowerCase()!=="input"||Ee.type!=="checkbox"&&Ee.type!=="radio"?ve&&Ud(ve.elementType)&&(ft=Ih):ft=v2;if(ft&&(ft=ft(n,ve))){Bh(Ue,ft,l,Fe);break e}Dt&&Dt(n,Ee,ve),n==="focusout"&&ve&&Ee.type==="number"&&ve.memoizedProps.value!=null&&gn(Ee,"number",Ee.value)}switch(Dt=ve?me(ve):window,n){case"focusin":(Mh(Dt)||Dt.contentEditable==="true")&&(li=Dt,tu=ve,So=null);break;case"focusout":So=tu=li=null;break;case"mousedown":ru=!0;break;case"contextmenu":case"mouseup":case"dragend":ru=!1,qh(Ue,l,Fe);break;case"selectionchange":if(S2)break;case"keydown":case"keyup":qh(Ue,l,Fe)}var xt;if(Qd)e:{switch(n){case"compositionstart":var vt="onCompositionStart";break e;case"compositionend":vt="onCompositionEnd";break e;case"compositionupdate":vt="onCompositionUpdate";break e}vt=void 0}else oi?Nh(n,l)&&(vt="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(vt="onCompositionStart");vt&&(Ah&&l.locale!=="ko"&&(oi||vt!=="onCompositionStart"?vt==="onCompositionEnd"&&oi&&(xt=Th()):(Ga=Fe,Gd="value"in Ga?Ga.value:Ga.textContent,oi=!0)),Dt=Oc(ve,vt),0<Dt.length&&(vt=new jh(vt,n,null,l,Fe),Ue.push({event:vt,listeners:Dt}),xt?vt.data=xt:(xt=Oh(l),xt!==null&&(vt.data=xt)))),(xt=f2?h2(n,l):p2(n,l))&&(vt=Oc(ve,"onBeforeInput"),0<vt.length&&(Dt=new jh("onBeforeInput","beforeinput",null,l,Fe),Ue.push({event:Dt,listeners:vt}),Dt.data=xt)),ab(Ue,n,ve,l,Fe)}gx(Ue,s)})}function Ko(n,s,l){return{instance:n,listener:s,currentTarget:l}}function Oc(n,s){for(var l=s+"Capture",u=[];n!==null;){var g=n,m=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||m===null||(g=po(n,l),g!=null&&u.unshift(Ko(n,g,m)),g=po(n,s),g!=null&&u.push(Ko(n,g,m))),n.tag===3)return u;n=n.return}return[]}function Ni(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function mx(n,s,l,u,g){for(var m=s._reactName,E=[];l!==null&&l!==u;){var D=l,Z=D.alternate,ve=D.stateNode;if(D=D.tag,Z!==null&&Z===u)break;D!==5&&D!==26&&D!==27||ve===null||(Z=ve,g?(ve=po(l,m),ve!=null&&E.unshift(Ko(l,ve,Z))):g||(ve=po(l,m),ve!=null&&E.push(Ko(l,ve,Z)))),l=l.return}E.length!==0&&n.push({event:s,listeners:E})}var lb=/\r\n?/g,cb=/\u0000|\uFFFD/g;function yx(n){return(typeof n=="string"?n:""+n).replace(lb,`
`).replace(cb,"")}function vx(n,s){return s=yx(s),yx(n)===s}function Mc(){}function nr(n,s,l,u,g,m){switch(l){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||ai(n,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&ai(n,""+u);break;case"className":S(n,"class",u);break;case"tabIndex":S(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":S(n,l,u);break;case"style":_h(n,u,m);break;case"data":if(s!=="object"){S(n,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||l!=="href")){n.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(l);break}u=Wl(""+u),n.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(s!=="input"&&nr(n,s,"name",g.name,g,null),nr(n,s,"formEncType",g.formEncType,g,null),nr(n,s,"formMethod",g.formMethod,g,null),nr(n,s,"formTarget",g.formTarget,g,null)):(nr(n,s,"encType",g.encType,g,null),nr(n,s,"method",g.method,g,null),nr(n,s,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(l);break}u=Wl(""+u),n.setAttribute(l,u);break;case"onClick":u!=null&&(n.onclick=Mc);break;case"onScroll":u!=null&&Ot("scroll",n);break;case"onScrollEnd":u!=null&&Ot("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(a(60));n.innerHTML=l}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}l=Wl(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,""+u):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":u===!0?n.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(l,u):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(l,u):n.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(l):n.setAttribute(l,u);break;case"popover":Ot("beforetoggle",n),Ot("toggle",n),B(n,"popover",u);break;case"xlinkActuate":Q(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Q(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Q(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Q(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Q(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Q(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Q(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Q(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Q(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":B(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Pv.get(l)||l,B(n,l,u))}}function kf(n,s,l,u,g,m){switch(l){case"style":_h(n,u,m);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(a(60));n.innerHTML=l}}break;case"children":typeof u=="string"?ai(n,u):(typeof u=="number"||typeof u=="bigint")&&ai(n,""+u);break;case"onScroll":u!=null&&Ot("scroll",n);break;case"onScrollEnd":u!=null&&Ot("scrollend",n);break;case"onClick":u!=null&&(n.onclick=Mc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Te.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),s=l.slice(2,g?l.length-7:void 0),m=n[yr]||null,m=m!=null?m[l]:null,typeof m=="function"&&n.removeEventListener(s,m,g),typeof u=="function")){typeof m!="function"&&m!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(s,u,g);break e}l in n?n[l]=u:u===!0?n.setAttribute(l,""):B(n,l,u)}}}function Xr(n,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",n),Ot("load",n);var u=!1,g=!1,m;for(m in l)if(l.hasOwnProperty(m)){var E=l[m];if(E!=null)switch(m){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:nr(n,s,m,E,l,null)}}g&&nr(n,s,"srcSet",l.srcSet,l,null),u&&nr(n,s,"src",l.src,l,null);return;case"input":Ot("invalid",n);var D=m=E=g=null,Z=null,ve=null;for(u in l)if(l.hasOwnProperty(u)){var Fe=l[u];if(Fe!=null)switch(u){case"name":g=Fe;break;case"type":E=Fe;break;case"checked":Z=Fe;break;case"defaultChecked":ve=Fe;break;case"value":m=Fe;break;case"defaultValue":D=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(a(137,s));break;default:nr(n,s,u,Fe,l,null)}}tr(n,m,D,Z,ve,E,g,!1),rn(n);return;case"select":Ot("invalid",n),u=E=m=null;for(g in l)if(l.hasOwnProperty(g)&&(D=l[g],D!=null))switch(g){case"value":m=D;break;case"defaultValue":E=D;break;case"multiple":u=D;default:nr(n,s,g,D,l,null)}s=m,l=E,n.multiple=!!u,s!=null?va(n,!!u,s,!1):l!=null&&va(n,!!u,l,!0);return;case"textarea":Ot("invalid",n),m=g=u=null;for(E in l)if(l.hasOwnProperty(E)&&(D=l[E],D!=null))switch(E){case"value":u=D;break;case"defaultValue":g=D;break;case"children":m=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(a(91));break;default:nr(n,s,E,D,l,null)}vh(n,u,g,m),rn(n);return;case"option":for(Z in l)if(l.hasOwnProperty(Z)&&(u=l[Z],u!=null))switch(Z){case"selected":n.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:nr(n,s,Z,u,l,null)}return;case"dialog":Ot("beforetoggle",n),Ot("toggle",n),Ot("cancel",n),Ot("close",n);break;case"iframe":case"object":Ot("load",n);break;case"video":case"audio":for(u=0;u<Xo.length;u++)Ot(Xo[u],n);break;case"image":Ot("error",n),Ot("load",n);break;case"details":Ot("toggle",n);break;case"embed":case"source":case"link":Ot("error",n),Ot("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ve in l)if(l.hasOwnProperty(ve)&&(u=l[ve],u!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,s));default:nr(n,s,ve,u,l,null)}return;default:if(Ud(s)){for(Fe in l)l.hasOwnProperty(Fe)&&(u=l[Fe],u!==void 0&&kf(n,s,Fe,u,l,void 0));return}}for(D in l)l.hasOwnProperty(D)&&(u=l[D],u!=null&&nr(n,s,D,u,l,null))}function db(n,s,l,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,m=null,E=null,D=null,Z=null,ve=null,Fe=null;for(ke in l){var Ue=l[ke];if(l.hasOwnProperty(ke)&&Ue!=null)switch(ke){case"checked":break;case"value":break;case"defaultValue":Z=Ue;default:u.hasOwnProperty(ke)||nr(n,s,ke,null,u,Ue)}}for(var Ee in u){var ke=u[Ee];if(Ue=l[Ee],u.hasOwnProperty(Ee)&&(ke!=null||Ue!=null))switch(Ee){case"type":m=ke;break;case"name":g=ke;break;case"checked":ve=ke;break;case"defaultChecked":Fe=ke;break;case"value":E=ke;break;case"defaultValue":D=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(a(137,s));break;default:ke!==Ue&&nr(n,s,Ee,ke,u,Ue)}}ni(n,E,D,Z,ve,Fe,m,g);return;case"select":ke=E=D=Ee=null;for(m in l)if(Z=l[m],l.hasOwnProperty(m)&&Z!=null)switch(m){case"value":break;case"multiple":ke=Z;default:u.hasOwnProperty(m)||nr(n,s,m,null,u,Z)}for(g in u)if(m=u[g],Z=l[g],u.hasOwnProperty(g)&&(m!=null||Z!=null))switch(g){case"value":Ee=m;break;case"defaultValue":D=m;break;case"multiple":E=m;default:m!==Z&&nr(n,s,g,m,u,Z)}s=D,l=E,u=ke,Ee!=null?va(n,!!l,Ee,!1):!!u!=!!l&&(s!=null?va(n,!!l,s,!0):va(n,!!l,l?[]:"",!1));return;case"textarea":ke=Ee=null;for(D in l)if(g=l[D],l.hasOwnProperty(D)&&g!=null&&!u.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:nr(n,s,D,null,u,g)}for(E in u)if(g=u[E],m=l[E],u.hasOwnProperty(E)&&(g!=null||m!=null))switch(E){case"value":Ee=g;break;case"defaultValue":ke=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(a(91));break;default:g!==m&&nr(n,s,E,g,u,m)}yh(n,Ee,ke);return;case"option":for(var _t in l)if(Ee=l[_t],l.hasOwnProperty(_t)&&Ee!=null&&!u.hasOwnProperty(_t))switch(_t){case"selected":n.selected=!1;break;default:nr(n,s,_t,null,u,Ee)}for(Z in u)if(Ee=u[Z],ke=l[Z],u.hasOwnProperty(Z)&&Ee!==ke&&(Ee!=null||ke!=null))switch(Z){case"selected":n.selected=Ee&&typeof Ee!="function"&&typeof Ee!="symbol";break;default:nr(n,s,Z,Ee,u,ke)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var yt in l)Ee=l[yt],l.hasOwnProperty(yt)&&Ee!=null&&!u.hasOwnProperty(yt)&&nr(n,s,yt,null,u,Ee);for(ve in u)if(Ee=u[ve],ke=l[ve],u.hasOwnProperty(ve)&&Ee!==ke&&(Ee!=null||ke!=null))switch(ve){case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(a(137,s));break;default:nr(n,s,ve,Ee,u,ke)}return;default:if(Ud(s)){for(var ar in l)Ee=l[ar],l.hasOwnProperty(ar)&&Ee!==void 0&&!u.hasOwnProperty(ar)&&kf(n,s,ar,void 0,u,Ee);for(Fe in u)Ee=u[Fe],ke=l[Fe],!u.hasOwnProperty(Fe)||Ee===ke||Ee===void 0&&ke===void 0||kf(n,s,Fe,Ee,u,ke);return}}for(var ue in l)Ee=l[ue],l.hasOwnProperty(ue)&&Ee!=null&&!u.hasOwnProperty(ue)&&nr(n,s,ue,null,u,Ee);for(Ue in u)Ee=u[Ue],ke=l[Ue],!u.hasOwnProperty(Ue)||Ee===ke||Ee==null&&ke==null||nr(n,s,Ue,Ee,u,ke)}var jf=null,Cf=null;function Bc(n){return n.nodeType===9?n:n.ownerDocument}function bx(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _x(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function Af(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Rf=null;function ub(){var n=window.event;return n&&n.type==="popstate"?n===Rf?!1:(Rf=n,!0):(Rf=null,!1)}var Sx=typeof setTimeout=="function"?setTimeout:void 0,fb=typeof clearTimeout=="function"?clearTimeout:void 0,wx=typeof Promise=="function"?Promise:void 0,hb=typeof queueMicrotask=="function"?queueMicrotask:typeof wx<"u"?function(n){return wx.resolve(null).then(n).catch(pb)}:Sx;function pb(n){setTimeout(function(){throw n})}function ls(n){return n==="head"}function Tx(n,s){var l=s,u=0,g=0;do{var m=l.nextSibling;if(n.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(0<u&&8>u){l=u;var E=n.ownerDocument;if(l&1&&Qo(E.documentElement),l&2&&Qo(E.body),l&4)for(l=E.head,Qo(l),E=l.firstChild;E;){var D=E.nextSibling,Z=E.nodeName;E[I]||Z==="SCRIPT"||Z==="STYLE"||Z==="LINK"&&E.rel.toLowerCase()==="stylesheet"||l.removeChild(E),E=D}}if(g===0){n.removeChild(m),sl(s);return}g--}else l==="$"||l==="$?"||l==="$!"?g++:u=l.charCodeAt(0)-48;else u=0;l=m}while(l);sl(s)}function Df(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Df(l),P(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function gb(n,s,l,u){for(;n.nodeType===1;){var g=l;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[I])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(m=n.getAttribute("rel"),m==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(m!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(m=n.getAttribute("src"),(m!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&m&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var m=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===m)return n}else return n;if(n=Kn(n.nextSibling),n===null)break}return null}function xb(n,s,l){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=Kn(n.nextSibling),n===null))return null;return n}function Nf(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function mb(n,s){var l=n.ownerDocument;if(n.data!=="$?"||l.readyState==="complete")s();else{var u=function(){s(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function Kn(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return n}var Of=null;function Ex(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return n;s--}else l==="/$"&&s++}n=n.previousSibling}return null}function kx(n,s,l){switch(s=Bc(l),n){case"html":if(n=s.documentElement,!n)throw Error(a(452));return n;case"head":if(n=s.head,!n)throw Error(a(453));return n;case"body":if(n=s.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function Qo(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);P(n)}var $n=new Map,jx=new Set;function Ic(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Oa=ye.d;ye.d={f:yb,r:vb,D:bb,C:_b,L:Sb,m:wb,X:Eb,S:Tb,M:kb};function yb(){var n=Oa.f(),s=jc();return n||s}function vb(n){var s=G(n);s!==null&&s.tag===5&&s.type==="form"?Yp(s):Oa.r(n)}var Oi=typeof document>"u"?null:document;function Cx(n,s,l){var u=Oi;if(u&&typeof s=="string"&&s){var g=ln(s);g='link[rel="'+n+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),jx.has(g)||(jx.add(g),n={rel:n,crossOrigin:l,href:s},u.querySelector(g)===null&&(s=u.createElement("link"),Xr(s,"link",n),ce(s),u.head.appendChild(s)))}}function bb(n){Oa.D(n),Cx("dns-prefetch",n,null)}function _b(n,s){Oa.C(n,s),Cx("preconnect",n,s)}function Sb(n,s,l){Oa.L(n,s,l);var u=Oi;if(u&&n&&s){var g='link[rel="preload"][as="'+ln(s)+'"]';s==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+ln(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+ln(l.imageSizes)+'"]')):g+='[href="'+ln(n)+'"]';var m=g;switch(s){case"style":m=Mi(n);break;case"script":m=Bi(n)}$n.has(m)||(n=x({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:n,as:s},l),$n.set(m,n),u.querySelector(g)!==null||s==="style"&&u.querySelector(Jo(m))||s==="script"&&u.querySelector(Zo(m))||(s=u.createElement("link"),Xr(s,"link",n),ce(s),u.head.appendChild(s)))}}function wb(n,s){Oa.m(n,s);var l=Oi;if(l&&n){var u=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+ln(u)+'"][href="'+ln(n)+'"]',m=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Bi(n)}if(!$n.has(m)&&(n=x({rel:"modulepreload",href:n},s),$n.set(m,n),l.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Zo(m)))return}u=l.createElement("link"),Xr(u,"link",n),ce(u),l.head.appendChild(u)}}}function Tb(n,s,l){Oa.S(n,s,l);var u=Oi;if(u&&n){var g=Me(u).hoistableStyles,m=Mi(n);s=s||"default";var E=g.get(m);if(!E){var D={loading:0,preload:null};if(E=u.querySelector(Jo(m)))D.loading=5;else{n=x({rel:"stylesheet",href:n,"data-precedence":s},l),(l=$n.get(m))&&Mf(n,l);var Z=E=u.createElement("link");ce(Z),Xr(Z,"link",n),Z._p=new Promise(function(ve,Fe){Z.onload=ve,Z.onerror=Fe}),Z.addEventListener("load",function(){D.loading|=1}),Z.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Fc(E,s,u)}E={type:"stylesheet",instance:E,count:1,state:D},g.set(m,E)}}}function Eb(n,s){Oa.X(n,s);var l=Oi;if(l&&n){var u=Me(l).hoistableScripts,g=Bi(n),m=u.get(g);m||(m=l.querySelector(Zo(g)),m||(n=x({src:n,async:!0},s),(s=$n.get(g))&&Bf(n,s),m=l.createElement("script"),ce(m),Xr(m,"link",n),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(g,m))}}function kb(n,s){Oa.M(n,s);var l=Oi;if(l&&n){var u=Me(l).hoistableScripts,g=Bi(n),m=u.get(g);m||(m=l.querySelector(Zo(g)),m||(n=x({src:n,async:!0,type:"module"},s),(s=$n.get(g))&&Bf(n,s),m=l.createElement("script"),ce(m),Xr(m,"link",n),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(g,m))}}function Ax(n,s,l,u){var g=(g=pe.current)?Ic(g):null;if(!g)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=Mi(l.href),l=Me(g).hoistableStyles,u=l.get(s),u||(u={type:"style",instance:null,count:0,state:null},l.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=Mi(l.href);var m=Me(g).hoistableStyles,E=m.get(n);if(E||(g=g.ownerDocument||g,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(n,E),(m=g.querySelector(Jo(n)))&&!m._p&&(E.instance=m,E.state.loading=5),$n.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},$n.set(n,l),m||jb(g,n,l,E.state))),s&&u===null)throw Error(a(528,""));return E}if(s&&u!==null)throw Error(a(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Bi(l),l=Me(g).hoistableScripts,u=l.get(s),u||(u={type:"script",instance:null,count:0,state:null},l.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function Mi(n){return'href="'+ln(n)+'"'}function Jo(n){return'link[rel="stylesheet"]['+n+"]"}function Rx(n){return x({},n,{"data-precedence":n.precedence,precedence:null})}function jb(n,s,l,u){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=n.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),Xr(s,"link",l),ce(s),n.head.appendChild(s))}function Bi(n){return'[src="'+ln(n)+'"]'}function Zo(n){return"script[async]"+n}function Dx(n,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var u=n.querySelector('style[data-href~="'+ln(l.href)+'"]');if(u)return s.instance=u,ce(u),u;var g=x({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),ce(u),Xr(u,"style",g),Fc(u,l.precedence,n),s.instance=u;case"stylesheet":g=Mi(l.href);var m=n.querySelector(Jo(g));if(m)return s.state.loading|=4,s.instance=m,ce(m),m;u=Rx(l),(g=$n.get(g))&&Mf(u,g),m=(n.ownerDocument||n).createElement("link"),ce(m);var E=m;return E._p=new Promise(function(D,Z){E.onload=D,E.onerror=Z}),Xr(m,"link",u),s.state.loading|=4,Fc(m,l.precedence,n),s.instance=m;case"script":return m=Bi(l.src),(g=n.querySelector(Zo(m)))?(s.instance=g,ce(g),g):(u=l,(g=$n.get(m))&&(u=x({},l),Bf(u,g)),n=n.ownerDocument||n,g=n.createElement("script"),ce(g),Xr(g,"link",u),n.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(a(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,Fc(u,l.precedence,n));return s.instance}function Fc(n,s,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,m=g,E=0;E<u.length;E++){var D=u[E];if(D.dataset.precedence===s)m=D;else if(m!==g)break}m?m.parentNode.insertBefore(n,m.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(n,s.firstChild))}function Mf(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function Bf(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var Lc=null;function Nx(n,s,l){if(Lc===null){var u=new Map,g=Lc=new Map;g.set(l,u)}else g=Lc,u=g.get(l),u||(u=new Map,g.set(l,u));if(u.has(n))return u;for(u.set(n,null),l=l.getElementsByTagName(n),g=0;g<l.length;g++){var m=l[g];if(!(m[I]||m[Gt]||n==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var E=m.getAttribute(s)||"";E=n+E;var D=u.get(E);D?D.push(m):u.set(E,[m])}}return u}function Ox(n,s,l){n=n.ownerDocument||n,n.head.insertBefore(l,s==="title"?n.querySelector("head > title"):null)}function Cb(n,s,l){if(l===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return n=s.disabled,typeof s.precedence=="string"&&n==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Mx(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var el=null;function Ab(){}function Rb(n,s,l){if(el===null)throw Error(a(475));var u=el;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var g=Mi(l.href),m=n.querySelector(Jo(g));if(m){n=m._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(u.count++,u=Pc.bind(u),n.then(u,u)),s.state.loading|=4,s.instance=m,ce(m);return}m=n.ownerDocument||n,l=Rx(l),(g=$n.get(g))&&Mf(l,g),m=m.createElement("link"),ce(m);var E=m;E._p=new Promise(function(D,Z){E.onload=D,E.onerror=Z}),Xr(m,"link",l),s.instance=m}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(s,n),(n=s.state.preload)&&(s.state.loading&3)===0&&(u.count++,s=Pc.bind(u),n.addEventListener("load",s),n.addEventListener("error",s))}}function Db(){if(el===null)throw Error(a(475));var n=el;return n.stylesheets&&n.count===0&&If(n,n.stylesheets),0<n.count?function(s){var l=setTimeout(function(){if(n.stylesheets&&If(n,n.stylesheets),n.unsuspend){var u=n.unsuspend;n.unsuspend=null,u()}},6e4);return n.unsuspend=s,function(){n.unsuspend=null,clearTimeout(l)}}:null}function Pc(){if(this.count--,this.count===0){if(this.stylesheets)If(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var zc=null;function If(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,zc=new Map,s.forEach(Nb,n),zc=null,Pc.call(n))}function Nb(n,s){if(!(s.state.loading&4)){var l=zc.get(n);if(l)var u=l.get(null);else{l=new Map,zc.set(n,l);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<g.length;m++){var E=g[m];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(l.set(E.dataset.precedence,E),u=E)}u&&l.set(null,u)}g=s.instance,E=g.getAttribute("data-precedence"),m=l.get(E)||u,m===u&&l.set(null,g),l.set(E,g),this.count++,u=Pc.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),m?m.parentNode.insertBefore(g,m.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),s.state.loading|=4}}var tl={$$typeof:A,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function Ob(n,s,l,u,g,m,E,D){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.hiddenUpdates=gt(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=m,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function Bx(n,s,l,u,g,m,E,D,Z,ve,Fe,Ue){return n=new Ob(n,s,l,E,D,Z,ve,Ue),s=1,m===!0&&(s|=24),m=En(3,null,null,s),n.current=m,m.stateNode=n,s=xu(),s.refCount++,n.pooledCache=s,s.refCount++,m.memoizedState={element:u,isDehydrated:l,cache:s},bu(m),n}function Ix(n){return n?(n=fi,n):fi}function Fx(n,s,l,u,g,m){g=Ix(g),u.context===null?u.context=g:u.pendingContext=g,u=Xa(s),u.payload={element:l},m=m===void 0?null:m,m!==null&&(u.callback=m),l=Ka(n,u,s),l!==null&&(Rn(l,n,s),Do(l,n,s))}function Lx(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<s?l:s}}function Ff(n,s){Lx(n,s),(n=n.alternate)&&Lx(n,s)}function Px(n){if(n.tag===13){var s=ui(n,67108864);s!==null&&Rn(s,n,67108864),Ff(n,67108864)}}var Uc=!0;function Mb(n,s,l,u){var g=ee.T;ee.T=null;var m=ye.p;try{ye.p=2,Lf(n,s,l,u)}finally{ye.p=m,ee.T=g}}function Bb(n,s,l,u){var g=ee.T;ee.T=null;var m=ye.p;try{ye.p=8,Lf(n,s,l,u)}finally{ye.p=m,ee.T=g}}function Lf(n,s,l,u){if(Uc){var g=Pf(u);if(g===null)Ef(n,s,u,Wc,l),Ux(n,u);else if(Fb(g,n,s,l,u))u.stopPropagation();else if(Ux(n,u),s&4&&-1<Ib.indexOf(n)){for(;g!==null;){var m=G(g);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var E=Pt(m.pendingLanes);if(E!==0){var D=m;for(D.pendingLanes|=2,D.entangledLanes|=2;E;){var Z=1<<31-Le(E);D.entanglements[1]|=Z,E&=~Z}ua(m),(Vt&6)===0&&(Ec=je()+500,Vo(0))}}break;case 13:D=ui(m,2),D!==null&&Rn(D,m,2),jc(),Ff(m,2)}if(m=Pf(u),m===null&&Ef(n,s,u,Wc,l),m===g)break;g=m}g!==null&&u.stopPropagation()}else Ef(n,s,u,null,l)}}function Pf(n){return n=$d(n),zf(n)}var Wc=null;function zf(n){if(Wc=null,n=W(n),n!==null){var s=c(n);if(s===null)n=null;else{var l=s.tag;if(l===13){if(n=d(s),n!==null)return n;n=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return Wc=n,null}function zx(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(dt()){case We:return 2;case ot:return 8;case Ne:case tt:return 32;case mt:return 268435456;default:return 32}default:return 32}}var Uf=!1,cs=null,ds=null,us=null,rl=new Map,nl=new Map,fs=[],Ib="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ux(n,s){switch(n){case"focusin":case"focusout":cs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":us=null;break;case"pointerover":case"pointerout":rl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":nl.delete(s.pointerId)}}function al(n,s,l,u,g,m){return n===null||n.nativeEvent!==m?(n={blockedOn:s,domEventName:l,eventSystemFlags:u,nativeEvent:m,targetContainers:[g]},s!==null&&(s=G(s),s!==null&&Px(s)),n):(n.eventSystemFlags|=u,s=n.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),n)}function Fb(n,s,l,u,g){switch(s){case"focusin":return cs=al(cs,n,s,l,u,g),!0;case"dragenter":return ds=al(ds,n,s,l,u,g),!0;case"mouseover":return us=al(us,n,s,l,u,g),!0;case"pointerover":var m=g.pointerId;return rl.set(m,al(rl.get(m)||null,n,s,l,u,g)),!0;case"gotpointercapture":return m=g.pointerId,nl.set(m,al(nl.get(m)||null,n,s,l,u,g)),!0}return!1}function Wx(n){var s=W(n.target);if(s!==null){var l=c(s);if(l!==null){if(s=l.tag,s===13){if(s=d(l),s!==null){n.blockedOn=s,fr(n.priority,function(){if(l.tag===13){var u=An();u=Lr(u);var g=ui(l,u);g!==null&&Rn(g,l,u),Ff(l,u)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function $c(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var l=Pf(n.nativeEvent);if(l===null){l=n.nativeEvent;var u=new l.constructor(l.type,l);Wd=u,l.target.dispatchEvent(u),Wd=null}else return s=G(l),s!==null&&Px(s),n.blockedOn=l,!1;s.shift()}return!0}function $x(n,s,l){$c(n)&&l.delete(s)}function Lb(){Uf=!1,cs!==null&&$c(cs)&&(cs=null),ds!==null&&$c(ds)&&(ds=null),us!==null&&$c(us)&&(us=null),rl.forEach($x),nl.forEach($x)}function Hc(n,s){n.blockedOn===s&&(n.blockedOn=null,Uf||(Uf=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Lb)))}var qc=null;function Hx(n){qc!==n&&(qc=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){qc===n&&(qc=null);for(var s=0;s<n.length;s+=3){var l=n[s],u=n[s+1],g=n[s+2];if(typeof u!="function"){if(zf(u||l)===null)continue;break}var m=G(l);m!==null&&(n.splice(s,3),s-=3,Pu(m,{pending:!0,data:g,method:l.method,action:u},u,g))}}))}function sl(n){function s(Z){return Hc(Z,n)}cs!==null&&Hc(cs,n),ds!==null&&Hc(ds,n),us!==null&&Hc(us,n),rl.forEach(s),nl.forEach(s);for(var l=0;l<fs.length;l++){var u=fs[l];u.blockedOn===n&&(u.blockedOn=null)}for(;0<fs.length&&(l=fs[0],l.blockedOn===null);)Wx(l),l.blockedOn===null&&fs.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var g=l[u],m=l[u+1],E=g[yr]||null;if(typeof m=="function")E||Hx(l);else if(E){var D=null;if(m&&m.hasAttribute("formAction")){if(g=m,E=m[yr]||null)D=E.formAction;else if(zf(g)!==null)continue}else D=E.action;typeof D=="function"?l[u+1]=D:(l.splice(u,3),u-=3),Hx(l)}}}function Wf(n){this._internalRoot=n}Gc.prototype.render=Wf.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(a(409));var l=s.current,u=An();Fx(l,u,n,s,null,null)},Gc.prototype.unmount=Wf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;Fx(n.current,2,null,n,null,null),jc(),s[Gr]=null}};function Gc(n){this._internalRoot=n}Gc.prototype.unstable_scheduleHydration=function(n){if(n){var s=Dr();n={blockedOn:null,target:n,priority:s};for(var l=0;l<fs.length&&s!==0&&s<fs[l].priority;l++);fs.splice(l,0,n),l===0&&Wx(n)}};var qx=t.version;if(qx!=="19.1.1")throw Error(a(527,qx,"19.1.1"));ye.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=p(s),n=n!==null?h(n):null,n=n===null?null:n.stateNode,n};var Pb={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:ee,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yc.isDisabled&&Yc.supportsFiber)try{It=Yc.inject(Pb),Tt=Yc}catch{}}return ol.createRoot=function(n,s){if(!o(n))throw Error(a(299));var l=!1,u="",g=og,m=lg,E=cg,D=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(m=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(D=s.unstable_transitionCallbacks)),s=Bx(n,1,!1,null,null,l,u,g,m,E,D,null),n[Gr]=s.current,Tf(n),new Wf(s)},ol.hydrateRoot=function(n,s,l){if(!o(n))throw Error(a(299));var u=!1,g="",m=og,E=lg,D=cg,Z=null,ve=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(E=l.onCaughtError),l.onRecoverableError!==void 0&&(D=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(Z=l.unstable_transitionCallbacks),l.formState!==void 0&&(ve=l.formState)),s=Bx(n,1,!0,s,l??null,u,g,m,E,D,Z,ve),s.context=Ix(null),l=s.current,u=An(),u=Lr(u),g=Xa(u),g.callback=null,Ka(l,g,u),l=u,s.current.lanes=l,pt(s,l),ua(s),n[Gr]=s.current,Tf(n),new Gc(s)},ol.version="19.1.1",ol}var tm;function Kb(){if(tm)return qf.exports;tm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),qf.exports=Xb(),qf.exports}var Qb=Kb();const Jb=M0(Qb);/**
 * react-router v7.9.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var rm="popstate";function Zb(e={}){function t(a,o){let{pathname:c,search:d,hash:f}=a.location;return g0("",{pathname:c,search:d,hash:f},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(a,o){return typeof o=="string"?o:wl(o)}return t_(t,r,null,e)}function gr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Gn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function e_(){return Math.random().toString(36).substring(2,10)}function nm(e,t){return{usr:e.state,key:e.key,idx:t}}function g0(e,t,r=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?so(t):t,state:r,key:t&&t.key||a||e_()}}function wl({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function so(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function t_(e,t,r,a={}){let{window:o=document.defaultView,v5Compat:c=!1}=a,d=o.history,f="POP",p=null,h=x();h==null&&(h=0,d.replaceState({...d.state,idx:h},""));function x(){return(d.state||{idx:null}).idx}function y(){f="POP";let T=x(),M=T==null?null:T-h;h=T,p&&p({action:f,location:_.location,delta:M})}function b(T,M){f="PUSH";let F=g0(_.location,T,M);h=x()+1;let A=nm(F,h),U=_.createHref(F);try{d.pushState(A,"",U)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;o.location.assign(U)}c&&p&&p({action:f,location:_.location,delta:1})}function v(T,M){f="REPLACE";let F=g0(_.location,T,M);h=x();let A=nm(F,h),U=_.createHref(F);d.replaceState(A,"",U),c&&p&&p({action:f,location:_.location,delta:0})}function w(T){return r_(T)}let _={get action(){return f},get location(){return e(o,d)},listen(T){if(p)throw new Error("A history only accepts one active listener");return o.addEventListener(rm,y),p=T,()=>{o.removeEventListener(rm,y),p=null}},createHref(T){return t(o,T)},createURL:w,encodeLocation(T){let M=w(T);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:b,replace:v,go(T){return d.go(T)}};return _}function r_(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),gr(r,"No window.location.(origin|href) available to create URL");let a=typeof e=="string"?e:wl(e);return a=a.replace(/ $/,"%20"),!t&&a.startsWith("//")&&(a=r+a),new URL(a,r)}function S1(e,t,r="/"){return n_(e,t,r,!1)}function n_(e,t,r,a){let o=typeof t=="string"?so(t):t,c=Wa(o.pathname||"/",r);if(c==null)return null;let d=w1(e);a_(d);let f=null;for(let p=0;f==null&&p<d.length;++p){let h=g_(c);f=h_(d[p],h,a)}return f}function w1(e,t=[],r=[],a="",o=!1){let c=(d,f,p=o,h)=>{let x={relativePath:h===void 0?d.path||"":h,caseSensitive:d.caseSensitive===!0,childrenIndex:f,route:d};if(x.relativePath.startsWith("/")){if(!x.relativePath.startsWith(a)&&p)return;gr(x.relativePath.startsWith(a),`Absolute route path "${x.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),x.relativePath=x.relativePath.slice(a.length)}let y=La([a,x.relativePath]),b=r.concat(x);d.children&&d.children.length>0&&(gr(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),w1(d.children,t,b,y,p)),!(d.path==null&&!d.index)&&t.push({path:y,score:u_(y,d.index),routesMeta:b})};return e.forEach((d,f)=>{if(d.path===""||!d.path?.includes("?"))c(d,f);else for(let p of T1(d.path))c(d,f,!0,p)}),t}function T1(e){let t=e.split("/");if(t.length===0)return[];let[r,...a]=t,o=r.endsWith("?"),c=r.replace(/\?$/,"");if(a.length===0)return o?[c,""]:[c];let d=T1(a.join("/")),f=[];return f.push(...d.map(p=>p===""?c:[c,p].join("/"))),o&&f.push(...d),f.map(p=>e.startsWith("/")&&p===""?"/":p)}function a_(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:f_(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var s_=/^:[\w-]+$/,i_=3,o_=2,l_=1,c_=10,d_=-2,am=e=>e==="*";function u_(e,t){let r=e.split("/"),a=r.length;return r.some(am)&&(a+=d_),t&&(a+=o_),r.filter(o=>!am(o)).reduce((o,c)=>o+(s_.test(c)?i_:c===""?l_:c_),a)}function f_(e,t){return e.length===t.length&&e.slice(0,-1).every((a,o)=>a===t[o])?e[e.length-1]-t[t.length-1]:0}function h_(e,t,r=!1){let{routesMeta:a}=e,o={},c="/",d=[];for(let f=0;f<a.length;++f){let p=a[f],h=f===a.length-1,x=c==="/"?t:t.slice(c.length)||"/",y=ud({path:p.relativePath,caseSensitive:p.caseSensitive,end:h},x),b=p.route;if(!y&&h&&r&&!a[a.length-1].route.index&&(y=ud({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},x)),!y)return null;Object.assign(o,y.params),d.push({params:o,pathname:La([c,y.pathname]),pathnameBase:v_(La([c,y.pathnameBase])),route:b}),y.pathnameBase!=="/"&&(c=La([c,y.pathnameBase]))}return d}function ud(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=p_(e.path,e.caseSensitive,e.end),o=t.match(r);if(!o)return null;let c=o[0],d=c.replace(/(.)\/+$/,"$1"),f=o.slice(1);return{params:a.reduce((h,{paramName:x,isOptional:y},b)=>{if(x==="*"){let w=f[b]||"";d=c.slice(0,c.length-w.length).replace(/(.)\/+$/,"$1")}const v=f[b];return y&&!v?h[x]=void 0:h[x]=(v||"").replace(/%2F/g,"/"),h},{}),pathname:c,pathnameBase:d,pattern:e}}function p_(e,t=!1,r=!0){Gn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,f,p)=>(a.push({paramName:f,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(a.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),a]}function g_(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Gn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Wa(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&a!=="/"?null:e.slice(r)||"/"}function x_(e,t="/"){let{pathname:r,search:a="",hash:o=""}=typeof e=="string"?so(e):e;return{pathname:r?r.startsWith("/")?r:m_(r,t):t,search:b_(a),hash:__(o)}}function m_(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?r.length>1&&r.pop():o!=="."&&r.push(o)}),r.length>1?r.join("/"):"/"}function Xf(e,t,r,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function y_(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function I0(e){let t=y_(e);return t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase)}function F0(e,t,r,a=!1){let o;typeof e=="string"?o=so(e):(o={...e},gr(!o.pathname||!o.pathname.includes("?"),Xf("?","pathname","search",o)),gr(!o.pathname||!o.pathname.includes("#"),Xf("#","pathname","hash",o)),gr(!o.search||!o.search.includes("#"),Xf("#","search","hash",o)));let c=e===""||o.pathname==="",d=c?"/":o.pathname,f;if(d==null)f=r;else{let y=t.length-1;if(!a&&d.startsWith("..")){let b=d.split("/");for(;b[0]==="..";)b.shift(),y-=1;o.pathname=b.join("/")}f=y>=0?t[y]:"/"}let p=x_(o,f),h=d&&d!=="/"&&d.endsWith("/"),x=(c||d===".")&&r.endsWith("/");return!p.pathname.endsWith("/")&&(h||x)&&(p.pathname+="/"),p}var La=e=>e.join("/").replace(/\/\/+/g,"/"),v_=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),b_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,__=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function S_(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var E1=["POST","PUT","PATCH","DELETE"];new Set(E1);var w_=["GET",...E1];new Set(w_);var io=j.createContext(null);io.displayName="DataRouter";var Ad=j.createContext(null);Ad.displayName="DataRouterState";j.createContext(!1);var k1=j.createContext({isTransitioning:!1});k1.displayName="ViewTransition";var T_=j.createContext(new Map);T_.displayName="Fetchers";var E_=j.createContext(null);E_.displayName="Await";var aa=j.createContext(null);aa.displayName="Navigation";var Nl=j.createContext(null);Nl.displayName="Location";var sa=j.createContext({outlet:null,matches:[],isDataRoute:!1});sa.displayName="Route";var L0=j.createContext(null);L0.displayName="RouteError";function k_(e,{relative:t}={}){gr(oo(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=j.useContext(aa),{hash:o,pathname:c,search:d}=Ol(e,{relative:t}),f=c;return r!=="/"&&(f=c==="/"?r:La([r,c])),a.createHref({pathname:f,search:d,hash:o})}function oo(){return j.useContext(Nl)!=null}function ia(){return gr(oo(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(Nl).location}var j1="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function C1(e){j.useContext(aa).static||j.useLayoutEffect(e)}function Ks(){let{isDataRoute:e}=j.useContext(sa);return e?z_():j_()}function j_(){gr(oo(),"useNavigate() may be used only in the context of a <Router> component.");let e=j.useContext(io),{basename:t,navigator:r}=j.useContext(aa),{matches:a}=j.useContext(sa),{pathname:o}=ia(),c=JSON.stringify(I0(a)),d=j.useRef(!1);return C1(()=>{d.current=!0}),j.useCallback((p,h={})=>{if(Gn(d.current,j1),!d.current)return;if(typeof p=="number"){r.go(p);return}let x=F0(p,JSON.parse(c),o,h.relative==="path");e==null&&t!=="/"&&(x.pathname=x.pathname==="/"?t:La([t,x.pathname])),(h.replace?r.replace:r.push)(x,h.state,h)},[t,r,c,o,e])}j.createContext(null);function C_(){let{matches:e}=j.useContext(sa),t=e[e.length-1];return t?t.params:{}}function Ol(e,{relative:t}={}){let{matches:r}=j.useContext(sa),{pathname:a}=ia(),o=JSON.stringify(I0(r));return j.useMemo(()=>F0(e,JSON.parse(o),a,t==="path"),[e,o,a,t])}function A_(e,t){return A1(e,t)}function A1(e,t,r,a,o){gr(oo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=j.useContext(aa),{matches:d}=j.useContext(sa),f=d[d.length-1],p=f?f.params:{},h=f?f.pathname:"/",x=f?f.pathnameBase:"/",y=f&&f.route;{let F=y&&y.path||"";R1(h,!y||F.endsWith("*")||F.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${F}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${F}"> to <Route path="${F==="/"?"*":`${F}/*`}">.`)}let b=ia(),v;if(t){let F=typeof t=="string"?so(t):t;gr(x==="/"||F.pathname?.startsWith(x),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${x}" but pathname "${F.pathname}" was given in the \`location\` prop.`),v=F}else v=b;let w=v.pathname||"/",_=w;if(x!=="/"){let F=x.replace(/^\//,"").split("/");_="/"+w.replace(/^\//,"").split("/").slice(F.length).join("/")}let T=S1(e,{pathname:_});Gn(y||T!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Gn(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let M=M_(T&&T.map(F=>Object.assign({},F,{params:Object.assign({},p,F.params),pathname:La([x,c.encodeLocation?c.encodeLocation(F.pathname).pathname:F.pathname]),pathnameBase:F.pathnameBase==="/"?x:La([x,c.encodeLocation?c.encodeLocation(F.pathnameBase).pathname:F.pathnameBase])})),d,r,a,o);return t&&M?j.createElement(Nl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},M):M}function R_(){let e=P_(),t=S_(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:a},c={padding:"2px 4px",backgroundColor:a},d=null;return console.error("Error handled by React Router default ErrorBoundary:",e),d=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:c},"ErrorBoundary")," or"," ",j.createElement("code",{style:c},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},t),r?j.createElement("pre",{style:o},r):null,d)}var D_=j.createElement(R_,null),N_=class extends j.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?j.createElement(sa.Provider,{value:this.props.routeContext},j.createElement(L0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function O_({routeContext:e,match:t,children:r}){let a=j.useContext(io);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(sa.Provider,{value:e},r)}function M_(e,t=[],r=null,a=null,o=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let c=e,d=r?.errors;if(d!=null){let h=c.findIndex(x=>x.route.id&&d?.[x.route.id]!==void 0);gr(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,h+1))}let f=!1,p=-1;if(r)for(let h=0;h<c.length;h++){let x=c[h];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(p=h),x.route.id){let{loaderData:y,errors:b}=r,v=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!b||b[x.route.id]===void 0);if(x.route.lazy||v){f=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((h,x,y)=>{let b,v=!1,w=null,_=null;r&&(b=d&&x.route.id?d[x.route.id]:void 0,w=x.route.errorElement||D_,f&&(p<0&&y===0?(R1("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,_=null):p===y&&(v=!0,_=x.route.hydrateFallbackElement||null)));let T=t.concat(c.slice(0,y+1)),M=()=>{let F;return b?F=w:v?F=_:x.route.Component?F=j.createElement(x.route.Component,null):x.route.element?F=x.route.element:F=h,j.createElement(O_,{match:x,routeContext:{outlet:h,matches:T,isDataRoute:r!=null},children:F})};return r&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?j.createElement(N_,{location:r.location,revalidation:r.revalidation,component:w,error:b,children:M(),routeContext:{outlet:null,matches:T,isDataRoute:!0},unstable_onError:a}):M()},null)}function P0(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function B_(e){let t=j.useContext(io);return gr(t,P0(e)),t}function I_(e){let t=j.useContext(Ad);return gr(t,P0(e)),t}function F_(e){let t=j.useContext(sa);return gr(t,P0(e)),t}function z0(e){let t=F_(e),r=t.matches[t.matches.length-1];return gr(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function L_(){return z0("useRouteId")}function P_(){let e=j.useContext(L0),t=I_("useRouteError"),r=z0("useRouteError");return e!==void 0?e:t.errors?.[r]}function z_(){let{router:e}=B_("useNavigate"),t=z0("useNavigate"),r=j.useRef(!1);return C1(()=>{r.current=!0}),j.useCallback(async(o,c={})=>{Gn(r.current,j1),r.current&&(typeof o=="number"?e.navigate(o):await e.navigate(o,{fromRouteId:t,...c}))},[e,t])}var sm={};function R1(e,t,r){!t&&!sm[e]&&(sm[e]=!0,Gn(!1,r))}j.memo(U_);function U_({routes:e,future:t,state:r,unstable_onError:a}){return A1(e,void 0,r,a,t)}function im({to:e,replace:t,state:r,relative:a}){gr(oo(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=j.useContext(aa);Gn(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=j.useContext(sa),{pathname:d}=ia(),f=Ks(),p=F0(e,I0(c),d,a==="path"),h=JSON.stringify(p);return j.useEffect(()=>{f(JSON.parse(h),{replace:t,state:r,relative:a})},[f,h,a,t,r]),null}function Ba(e){gr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function W_({basename:e="/",children:t=null,location:r,navigationType:a="POP",navigator:o,static:c=!1}){gr(!oo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=e.replace(/^\/*/,"/"),f=j.useMemo(()=>({basename:d,navigator:o,static:c,future:{}}),[d,o,c]);typeof r=="string"&&(r=so(r));let{pathname:p="/",search:h="",hash:x="",state:y=null,key:b="default"}=r,v=j.useMemo(()=>{let w=Wa(p,d);return w==null?null:{location:{pathname:w,search:h,hash:x,state:y,key:b},navigationType:a}},[d,p,h,x,y,b,a]);return Gn(v!=null,`<Router basename="${d}"> is not able to match the URL "${p}${h}${x}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:j.createElement(aa.Provider,{value:f},j.createElement(Nl.Provider,{children:t,value:v}))}function $_({children:e,location:t}){return A_(x0(e),t)}function x0(e,t=[]){let r=[];return j.Children.forEach(e,(a,o)=>{if(!j.isValidElement(a))return;let c=[...t,o];if(a.type===j.Fragment){r.push.apply(r,x0(a.props.children,c));return}gr(a.type===Ba,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gr(!a.props.index||!a.props.children,"An index route cannot have child routes.");let d={id:a.props.id||c.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(d.children=x0(a.props.children,c)),r.push(d)}),r}var cd="get",dd="application/x-www-form-urlencoded";function Rd(e){return e!=null&&typeof e.tagName=="string"}function H_(e){return Rd(e)&&e.tagName.toLowerCase()==="button"}function q_(e){return Rd(e)&&e.tagName.toLowerCase()==="form"}function G_(e){return Rd(e)&&e.tagName.toLowerCase()==="input"}function Y_(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function V_(e,t){return e.button===0&&(!t||t==="_self")&&!Y_(e)}function m0(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let a=e[r];return t.concat(Array.isArray(a)?a.map(o=>[r,o]):[[r,a]])},[]))}function X_(e,t){let r=m0(e);return t&&t.forEach((a,o)=>{r.has(o)||t.getAll(o).forEach(c=>{r.append(o,c)})}),r}var Vc=null;function K_(){if(Vc===null)try{new FormData(document.createElement("form"),0),Vc=!1}catch{Vc=!0}return Vc}var Q_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Kf(e){return e!=null&&!Q_.has(e)?(Gn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${dd}"`),null):e}function J_(e,t){let r,a,o,c,d;if(q_(e)){let f=e.getAttribute("action");a=f?Wa(f,t):null,r=e.getAttribute("method")||cd,o=Kf(e.getAttribute("enctype"))||dd,c=new FormData(e)}else if(H_(e)||G_(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let p=e.getAttribute("formaction")||f.getAttribute("action");if(a=p?Wa(p,t):null,r=e.getAttribute("formmethod")||f.getAttribute("method")||cd,o=Kf(e.getAttribute("formenctype"))||Kf(f.getAttribute("enctype"))||dd,c=new FormData(f,e),!K_()){let{name:h,type:x,value:y}=e;if(x==="image"){let b=h?`${h}.`:"";c.append(`${b}x`,"0"),c.append(`${b}y`,"0")}else h&&c.append(h,y)}}else{if(Rd(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=cd,a=null,o=dd,d=e}return c&&o==="text/plain"&&(d=c,c=void 0),{action:a,method:r.toLowerCase(),encType:o,formData:c,body:d}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function U0(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Z_(e,t,r){let a=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return a.pathname==="/"?a.pathname=`_root.${r}`:t&&Wa(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${r}`,a}async function eS(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function tS(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function rS(e,t,r){let a=await Promise.all(e.map(async o=>{let c=t.routes[o.route.id];if(c){let d=await eS(c,r);return d.links?d.links():[]}return[]}));return iS(a.flat(1).filter(tS).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function om(e,t,r,a,o,c){let d=(p,h)=>r[h]?p.route.id!==r[h].route.id:!0,f=(p,h)=>r[h].pathname!==p.pathname||r[h].route.path?.endsWith("*")&&r[h].params["*"]!==p.params["*"];return c==="assets"?t.filter((p,h)=>d(p,h)||f(p,h)):c==="data"?t.filter((p,h)=>{let x=a.routes[p.route.id];if(!x||!x.hasLoader)return!1;if(d(p,h)||f(p,h))return!0;if(p.route.shouldRevalidate){let y=p.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:p.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function nS(e,t,{includeHydrateFallback:r}={}){return aS(e.map(a=>{let o=t.routes[a.route.id];if(!o)return[];let c=[o.module];return o.clientActionModule&&(c=c.concat(o.clientActionModule)),o.clientLoaderModule&&(c=c.concat(o.clientLoaderModule)),r&&o.hydrateFallbackModule&&(c=c.concat(o.hydrateFallbackModule)),o.imports&&(c=c.concat(o.imports)),c}).flat(1))}function aS(e){return[...new Set(e)]}function sS(e){let t={},r=Object.keys(e).sort();for(let a of r)t[a]=e[a];return t}function iS(e,t){let r=new Set;return new Set(t),e.reduce((a,o)=>{let c=JSON.stringify(sS(o));return r.has(c)||(r.add(c),a.push({key:c,link:o})),a},[])}function D1(){let e=j.useContext(io);return U0(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function oS(){let e=j.useContext(Ad);return U0(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var W0=j.createContext(void 0);W0.displayName="FrameworkContext";function N1(){let e=j.useContext(W0);return U0(e,"You must render this element inside a <HydratedRouter> element"),e}function lS(e,t){let r=j.useContext(W0),[a,o]=j.useState(!1),[c,d]=j.useState(!1),{onFocus:f,onBlur:p,onMouseEnter:h,onMouseLeave:x,onTouchStart:y}=t,b=j.useRef(null);j.useEffect(()=>{if(e==="render"&&d(!0),e==="viewport"){let _=M=>{M.forEach(F=>{d(F.isIntersecting)})},T=new IntersectionObserver(_,{threshold:.5});return b.current&&T.observe(b.current),()=>{T.disconnect()}}},[e]),j.useEffect(()=>{if(a){let _=setTimeout(()=>{d(!0)},100);return()=>{clearTimeout(_)}}},[a]);let v=()=>{o(!0)},w=()=>{o(!1),d(!1)};return r?e!=="intent"?[c,b,{}]:[c,b,{onFocus:ll(f,v),onBlur:ll(p,w),onMouseEnter:ll(h,v),onMouseLeave:ll(x,w),onTouchStart:ll(y,v)}]:[!1,b,{}]}function ll(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function cS({page:e,...t}){let{router:r}=D1(),a=j.useMemo(()=>S1(r.routes,e,r.basename),[r.routes,e,r.basename]);return a?j.createElement(uS,{page:e,matches:a,...t}):null}function dS(e){let{manifest:t,routeModules:r}=N1(),[a,o]=j.useState([]);return j.useEffect(()=>{let c=!1;return rS(e,t,r).then(d=>{c||o(d)}),()=>{c=!0}},[e,t,r]),a}function uS({page:e,matches:t,...r}){let a=ia(),{manifest:o,routeModules:c}=N1(),{basename:d}=D1(),{loaderData:f,matches:p}=oS(),h=j.useMemo(()=>om(e,t,p,o,a,"data"),[e,t,p,o,a]),x=j.useMemo(()=>om(e,t,p,o,a,"assets"),[e,t,p,o,a]),y=j.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let w=new Set,_=!1;if(t.forEach(M=>{let F=o.routes[M.route.id];!F||!F.hasLoader||(!h.some(A=>A.route.id===M.route.id)&&M.route.id in f&&c[M.route.id]?.shouldRevalidate||F.hasClientLoader?_=!0:w.add(M.route.id))}),w.size===0)return[];let T=Z_(e,d,"data");return _&&w.size>0&&T.searchParams.set("_routes",t.filter(M=>w.has(M.route.id)).map(M=>M.route.id).join(",")),[T.pathname+T.search]},[d,f,a,o,h,t,e,c]),b=j.useMemo(()=>nS(x,o),[x,o]),v=dS(x);return j.createElement(j.Fragment,null,y.map(w=>j.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...r})),b.map(w=>j.createElement("link",{key:w,rel:"modulepreload",href:w,...r})),v.map(({key:w,link:_})=>j.createElement("link",{key:w,nonce:r.nonce,..._})))}function fS(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var O1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{O1&&(window.__reactRouterVersion="7.9.1")}catch{}function hS({basename:e,children:t,window:r}){let a=j.useRef();a.current==null&&(a.current=Zb({window:r,v5Compat:!0}));let o=a.current,[c,d]=j.useState({action:o.action,location:o.location}),f=j.useCallback(p=>{j.startTransition(()=>d(p))},[d]);return j.useLayoutEffect(()=>o.listen(f),[o,f]),j.createElement(W_,{basename:e,children:t,location:c.location,navigationType:c.action,navigator:o})}var M1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$0=j.forwardRef(function({onClick:t,discover:r="render",prefetch:a="none",relative:o,reloadDocument:c,replace:d,state:f,target:p,to:h,preventScrollReset:x,viewTransition:y,...b},v){let{basename:w}=j.useContext(aa),_=typeof h=="string"&&M1.test(h),T,M=!1;if(typeof h=="string"&&_&&(T=h,O1))try{let L=new URL(window.location.href),X=h.startsWith("//")?new URL(L.protocol+h):new URL(h),le=Wa(X.pathname,w);X.origin===L.origin&&le!=null?h=le+X.search+X.hash:M=!0}catch{Gn(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let F=k_(h,{relative:o}),[A,U,V]=lS(a,b),te=mS(h,{replace:d,state:f,target:p,preventScrollReset:x,relative:o,viewTransition:y});function N(L){t&&t(L),L.defaultPrevented||te(L)}let re=j.createElement("a",{...b,...V,href:T||F,onClick:M||c?t:N,ref:fS(v,U),target:p,"data-discover":!_&&r==="render"?"true":void 0});return A&&!_?j.createElement(j.Fragment,null,re,j.createElement(cS,{page:F})):re});$0.displayName="Link";var pS=j.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:a="",end:o=!1,style:c,to:d,viewTransition:f,children:p,...h},x){let y=Ol(d,{relative:h.relative}),b=ia(),v=j.useContext(Ad),{navigator:w,basename:_}=j.useContext(aa),T=v!=null&&wS(y)&&f===!0,M=w.encodeLocation?w.encodeLocation(y).pathname:y.pathname,F=b.pathname,A=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(F=F.toLowerCase(),A=A?A.toLowerCase():null,M=M.toLowerCase()),A&&_&&(A=Wa(A,_)||A);const U=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let V=F===M||!o&&F.startsWith(M)&&F.charAt(U)==="/",te=A!=null&&(A===M||!o&&A.startsWith(M)&&A.charAt(M.length)==="/"),N={isActive:V,isPending:te,isTransitioning:T},re=V?t:void 0,L;typeof a=="function"?L=a(N):L=[a,V?"active":null,te?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let X=typeof c=="function"?c(N):c;return j.createElement($0,{...h,"aria-current":re,className:L,ref:x,style:X,to:d,viewTransition:f},typeof p=="function"?p(N):p)});pS.displayName="NavLink";var gS=j.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:a,replace:o,state:c,method:d=cd,action:f,onSubmit:p,relative:h,preventScrollReset:x,viewTransition:y,...b},v)=>{let w=_S(),_=SS(f,{relative:h}),T=d.toLowerCase()==="get"?"get":"post",M=typeof f=="string"&&M1.test(f),F=A=>{if(p&&p(A),A.defaultPrevented)return;A.preventDefault();let U=A.nativeEvent.submitter,V=U?.getAttribute("formmethod")||d;w(U||A.currentTarget,{fetcherKey:t,method:V,navigate:r,replace:o,state:c,relative:h,preventScrollReset:x,viewTransition:y})};return j.createElement("form",{ref:v,method:T,action:_,onSubmit:a?p:F,...b,"data-discover":!M&&e==="render"?"true":void 0})});gS.displayName="Form";function xS(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function B1(e){let t=j.useContext(io);return gr(t,xS(e)),t}function mS(e,{target:t,replace:r,state:a,preventScrollReset:o,relative:c,viewTransition:d}={}){let f=Ks(),p=ia(),h=Ol(e,{relative:c});return j.useCallback(x=>{if(V_(x,t)){x.preventDefault();let y=r!==void 0?r:wl(p)===wl(h);f(e,{replace:y,state:a,preventScrollReset:o,relative:c,viewTransition:d})}},[p,f,h,r,a,t,e,o,c,d])}function yS(e){Gn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=j.useRef(m0(e)),r=j.useRef(!1),a=ia(),o=j.useMemo(()=>X_(a.search,r.current?null:t.current),[a.search]),c=Ks(),d=j.useCallback((f,p)=>{const h=m0(typeof f=="function"?f(new URLSearchParams(o)):f);r.current=!0,c("?"+h,p)},[c,o]);return[o,d]}var vS=0,bS=()=>`__${String(++vS)}__`;function _S(){let{router:e}=B1("useSubmit"),{basename:t}=j.useContext(aa),r=L_();return j.useCallback(async(a,o={})=>{let{action:c,method:d,encType:f,formData:p,body:h}=J_(a,t);if(o.navigate===!1){let x=o.fetcherKey||bS();await e.fetch(x,r,o.action||c,{preventScrollReset:o.preventScrollReset,formData:p,body:h,formMethod:o.method||d,formEncType:o.encType||f,flushSync:o.flushSync})}else await e.navigate(o.action||c,{preventScrollReset:o.preventScrollReset,formData:p,body:h,formMethod:o.method||d,formEncType:o.encType||f,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[e,t,r])}function SS(e,{relative:t}={}){let{basename:r}=j.useContext(aa),a=j.useContext(sa);gr(a,"useFormAction must be used inside a RouteContext");let[o]=a.matches.slice(-1),c={...Ol(e||".",{relative:t})},d=ia();if(e==null){c.search=d.search;let f=new URLSearchParams(c.search),p=f.getAll("index");if(p.some(x=>x==="")){f.delete("index"),p.filter(y=>y).forEach(y=>f.append("index",y));let x=f.toString();c.search=x?`?${x}`:""}}return(!e||e===".")&&o.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(c.pathname=c.pathname==="/"?r:La([r,c.pathname])),wl(c)}function wS(e,{relative:t}={}){let r=j.useContext(k1);gr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=B1("useViewTransitionState"),o=Ol(e,{relative:t});if(!r.isTransitioning)return!1;let c=Wa(r.currentLocation.pathname,a)||r.currentLocation.pathname,d=Wa(r.nextLocation.pathname,a)||r.nextLocation.pathname;return ud(o.pathname,d)!=null||ud(o.pathname,c)!=null}const TS="modulepreload",ES=function(e){return"/retailpos/"+e},lm={},Ml=function(t,r,a){let o=Promise.resolve();if(r&&r.length>0){let h=function(x){return Promise.all(x.map(y=>Promise.resolve(y).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};var d=h;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");o=h(r.map(x=>{if(x=ES(x),x in lm)return;lm[x]=!0;const y=x.endsWith(".css"),b=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${b}`))return;const v=document.createElement("link");if(v.rel=y?"stylesheet":TS,y||(v.as="script"),v.crossOrigin="",v.href=x,p&&v.setAttribute("nonce",p),document.head.appendChild(v),y)return new Promise((w,_)=>{v.addEventListener("load",w),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${x}`)))})}))}function c(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return o.then(f=>{for(const p of f||[])p.status==="rejected"&&c(p.reason);return t().catch(c)})},kS=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ml(async()=>{const{default:a}=await Promise.resolve().then(()=>lo);return{default:a}},[]).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)};class H0 extends Error{constructor(t,r="FunctionsError",a){super(t),this.name=r,this.context=a}}class jS extends H0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class cm extends H0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class dm extends H0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var y0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(y0||(y0={}));var CS=function(e,t,r,a){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(x){try{h(a.next(x))}catch(y){d(y)}}function p(x){try{h(a.throw(x))}catch(y){d(y)}}function h(x){x.done?c(x.value):o(x.value).then(f,p)}h((a=a.apply(e,t||[])).next())})};class AS{constructor(t,{headers:r={},customFetch:a,region:o=y0.Any}={}){this.url=t,this.headers=r,this.region=o,this.fetch=kS(a)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var a;return CS(this,void 0,void 0,function*(){try{const{headers:o,method:c,body:d}=r;let f={},{region:p}=r;p||(p=this.region);const h=new URL(`${this.url}/${t}`);p&&p!=="any"&&(f["x-region"]=p,h.searchParams.set("forceFunctionRegion",p));let x;d&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",x=d):typeof d=="string"?(f["Content-Type"]="text/plain",x=d):typeof FormData<"u"&&d instanceof FormData?x=d:(f["Content-Type"]="application/json",x=JSON.stringify(d)));const y=yield this.fetch(h.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:x}).catch(_=>{throw new jS(_)}),b=y.headers.get("x-relay-error");if(b&&b==="true")throw new cm(y);if(!y.ok)throw new dm(y);let v=((a=y.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),w;return v==="application/json"?w=yield y.json():v==="application/octet-stream"?w=yield y.blob():v==="text/event-stream"?w=y:v==="multipart/form-data"?w=yield y.formData():w=yield y.text(),{data:w,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof dm||o instanceof cm?o.context:void 0}}})}}var Wr={},Ii={},Fi={},Li={},Pi={},zi={},RS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},no=RS();const DS=no.fetch,I1=no.fetch.bind(no),F1=no.Headers,NS=no.Request,OS=no.Response,lo=Object.freeze(Object.defineProperty({__proto__:null,Headers:F1,Request:NS,Response:OS,default:I1,fetch:DS},Symbol.toStringTag,{value:"Module"})),MS=Ub(lo);var Xc={},um;function L1(){if(um)return Xc;um=1,Object.defineProperty(Xc,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Xc.default=e,Xc}var fm;function P1(){if(fm)return zi;fm=1;var e=zi&&zi.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(zi,"__esModule",{value:!0});const t=e(MS),r=e(L1());class a{constructor(c){var d,f;this.shouldThrowOnError=!1,this.method=c.method,this.url=c.url,this.headers=new Headers(c.headers),this.schema=c.schema,this.body=c.body,this.shouldThrowOnError=(d=c.shouldThrowOnError)!==null&&d!==void 0?d:!1,this.signal=c.signal,this.isMaybeSingle=(f=c.isMaybeSingle)!==null&&f!==void 0?f:!1,c.fetch?this.fetch=c.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(c,d){return this.headers=new Headers(this.headers),this.headers.set(c,d),this}then(c,d){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let p=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var x,y,b,v;let w=null,_=null,T=null,M=h.status,F=h.statusText;if(h.ok){if(this.method!=="HEAD"){const te=await h.text();te===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((x=this.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?_=te:_=JSON.parse(te))}const U=(y=this.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),V=(b=h.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");U&&V&&V.length>1&&(T=parseInt(V[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(w={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,T=null,M=406,F="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const U=await h.text();try{w=JSON.parse(U),Array.isArray(w)&&h.status===404&&(_=[],w=null,M=200,F="OK")}catch{h.status===404&&U===""?(M=204,F="No Content"):w={message:U}}if(w&&this.isMaybeSingle&&(!((v=w?.details)===null||v===void 0)&&v.includes("0 rows"))&&(w=null,M=200,F="OK"),w&&this.shouldThrowOnError)throw new r.default(w)}return{error:w,data:_,count:T,status:M,statusText:F}});return this.shouldThrowOnError||(p=p.catch(h=>{var x,y,b;return{error:{message:`${(x=h?.name)!==null&&x!==void 0?x:"FetchError"}: ${h?.message}`,details:`${(y=h?.stack)!==null&&y!==void 0?y:""}`,hint:"",code:`${(b=h?.code)!==null&&b!==void 0?b:""}`},data:null,count:null,status:0,statusText:""}})),p.then(c,d)}returns(){return this}overrideTypes(){return this}}return zi.default=a,zi}var hm;function z1(){if(hm)return Pi;hm=1;var e=Pi&&Pi.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Pi,"__esModule",{value:!0});const t=e(P1());class r extends t.default{select(o){let c=!1;const d=(o??"*").split("").map(f=>/\s/.test(f)&&!c?"":(f==='"'&&(c=!c),f)).join("");return this.url.searchParams.set("select",d),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:c=!0,nullsFirst:d,foreignTable:f,referencedTable:p=f}={}){const h=p?`${p}.order`:"order",x=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${x?`${x},`:""}${o}.${c?"asc":"desc"}${d===void 0?"":d?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:c,referencedTable:d=c}={}){const f=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(f,`${o}`),this}range(o,c,{foreignTable:d,referencedTable:f=d}={}){const p=typeof f>"u"?"offset":`${f}.offset`,h=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(p,`${o}`),this.url.searchParams.set(h,`${c-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:c=!1,settings:d=!1,buffers:f=!1,wal:p=!1,format:h="text"}={}){var x;const y=[o?"analyze":null,c?"verbose":null,d?"settings":null,f?"buffers":null,p?"wal":null].filter(Boolean).join("|"),b=(x=this.headers.get("Accept"))!==null&&x!==void 0?x:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${h}; for="${b}"; options=${y};`),h==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return Pi.default=r,Pi}var pm;function q0(){if(pm)return Li;pm=1;var e=Li&&Li.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Li,"__esModule",{value:!0});const t=e(z1());class r extends t.default{eq(o,c){return this.url.searchParams.append(o,`eq.${c}`),this}neq(o,c){return this.url.searchParams.append(o,`neq.${c}`),this}gt(o,c){return this.url.searchParams.append(o,`gt.${c}`),this}gte(o,c){return this.url.searchParams.append(o,`gte.${c}`),this}lt(o,c){return this.url.searchParams.append(o,`lt.${c}`),this}lte(o,c){return this.url.searchParams.append(o,`lte.${c}`),this}like(o,c){return this.url.searchParams.append(o,`like.${c}`),this}likeAllOf(o,c){return this.url.searchParams.append(o,`like(all).{${c.join(",")}}`),this}likeAnyOf(o,c){return this.url.searchParams.append(o,`like(any).{${c.join(",")}}`),this}ilike(o,c){return this.url.searchParams.append(o,`ilike.${c}`),this}ilikeAllOf(o,c){return this.url.searchParams.append(o,`ilike(all).{${c.join(",")}}`),this}ilikeAnyOf(o,c){return this.url.searchParams.append(o,`ilike(any).{${c.join(",")}}`),this}is(o,c){return this.url.searchParams.append(o,`is.${c}`),this}in(o,c){const d=Array.from(new Set(c)).map(f=>typeof f=="string"&&new RegExp("[,()]").test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(o,`in.(${d})`),this}contains(o,c){return typeof c=="string"?this.url.searchParams.append(o,`cs.${c}`):Array.isArray(c)?this.url.searchParams.append(o,`cs.{${c.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(c)}`),this}containedBy(o,c){return typeof c=="string"?this.url.searchParams.append(o,`cd.${c}`):Array.isArray(c)?this.url.searchParams.append(o,`cd.{${c.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(c)}`),this}rangeGt(o,c){return this.url.searchParams.append(o,`sr.${c}`),this}rangeGte(o,c){return this.url.searchParams.append(o,`nxl.${c}`),this}rangeLt(o,c){return this.url.searchParams.append(o,`sl.${c}`),this}rangeLte(o,c){return this.url.searchParams.append(o,`nxr.${c}`),this}rangeAdjacent(o,c){return this.url.searchParams.append(o,`adj.${c}`),this}overlaps(o,c){return typeof c=="string"?this.url.searchParams.append(o,`ov.${c}`):this.url.searchParams.append(o,`ov.{${c.join(",")}}`),this}textSearch(o,c,{config:d,type:f}={}){let p="";f==="plain"?p="pl":f==="phrase"?p="ph":f==="websearch"&&(p="w");const h=d===void 0?"":`(${d})`;return this.url.searchParams.append(o,`${p}fts${h}.${c}`),this}match(o){return Object.entries(o).forEach(([c,d])=>{this.url.searchParams.append(c,`eq.${d}`)}),this}not(o,c,d){return this.url.searchParams.append(o,`not.${c}.${d}`),this}or(o,{foreignTable:c,referencedTable:d=c}={}){const f=d?`${d}.or`:"or";return this.url.searchParams.append(f,`(${o})`),this}filter(o,c,d){return this.url.searchParams.append(o,`${c}.${d}`),this}}return Li.default=r,Li}var gm;function U1(){if(gm)return Fi;gm=1;var e=Fi&&Fi.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Fi,"__esModule",{value:!0});const t=e(q0());class r{constructor(o,{headers:c={},schema:d,fetch:f}){this.url=o,this.headers=new Headers(c),this.schema=d,this.fetch=f}select(o,{head:c=!1,count:d}={}){const f=c?"HEAD":"GET";let p=!1;const h=(o??"*").split("").map(x=>/\s/.test(x)&&!p?"":(x==='"'&&(p=!p),x)).join("");return this.url.searchParams.set("select",h),d&&this.headers.append("Prefer",`count=${d}`),new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:c,defaultToNull:d=!0}={}){var f;const p="POST";if(c&&this.headers.append("Prefer",`count=${c}`),d||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const h=o.reduce((x,y)=>x.concat(Object.keys(y)),[]);if(h.length>0){const x=[...new Set(h)].map(y=>`"${y}"`);this.url.searchParams.set("columns",x.join(","))}}return new t.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(o,{onConflict:c,ignoreDuplicates:d=!1,count:f,defaultToNull:p=!0}={}){var h;const x="POST";if(this.headers.append("Prefer",`resolution=${d?"ignore":"merge"}-duplicates`),c!==void 0&&this.url.searchParams.set("on_conflict",c),f&&this.headers.append("Prefer",`count=${f}`),p||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const y=o.reduce((b,v)=>b.concat(Object.keys(v)),[]);if(y.length>0){const b=[...new Set(y)].map(v=>`"${v}"`);this.url.searchParams.set("columns",b.join(","))}}return new t.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}update(o,{count:c}={}){var d;const f="PATCH";return c&&this.headers.append("Prefer",`count=${c}`),new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}delete({count:o}={}){var c;const d="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}}return Fi.default=r,Fi}var xm;function BS(){if(xm)return Ii;xm=1;var e=Ii&&Ii.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Ii,"__esModule",{value:!0});const t=e(U1()),r=e(q0());class a{constructor(c,{headers:d={},schema:f,fetch:p}={}){this.url=c,this.headers=new Headers(d),this.schemaName=f,this.fetch=p}from(c){const d=new URL(`${this.url}/${c}`);return new t.default(d,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(c){return new a(this.url,{headers:this.headers,schema:c,fetch:this.fetch})}rpc(c,d={},{head:f=!1,get:p=!1,count:h}={}){var x;let y;const b=new URL(`${this.url}/rpc/${c}`);let v;f||p?(y=f?"HEAD":"GET",Object.entries(d).filter(([_,T])=>T!==void 0).map(([_,T])=>[_,Array.isArray(T)?`{${T.join(",")}}`:`${T}`]).forEach(([_,T])=>{b.searchParams.append(_,T)})):(y="POST",v=d);const w=new Headers(this.headers);return h&&w.set("Prefer",`count=${h}`),new r.default({method:y,url:b,headers:w,schema:this.schemaName,body:v,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}}return Ii.default=a,Ii}var mm;function IS(){if(mm)return Wr;mm=1;var e=Wr&&Wr.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.PostgrestError=Wr.PostgrestBuilder=Wr.PostgrestTransformBuilder=Wr.PostgrestFilterBuilder=Wr.PostgrestQueryBuilder=Wr.PostgrestClient=void 0;const t=e(BS());Wr.PostgrestClient=t.default;const r=e(U1());Wr.PostgrestQueryBuilder=r.default;const a=e(q0());Wr.PostgrestFilterBuilder=a.default;const o=e(z1());Wr.PostgrestTransformBuilder=o.default;const c=e(P1());Wr.PostgrestBuilder=c.default;const d=e(L1());return Wr.PostgrestError=d.default,Wr.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:c.default,PostgrestError:d.default},Wr}var FS=IS();const LS=M0(FS),{PostgrestClient:PS,PostgrestQueryBuilder:AN,PostgrestFilterBuilder:RN,PostgrestTransformBuilder:DN,PostgrestBuilder:NN,PostgrestError:ON}=LS;class zS{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const a=r.node,o=parseInt(a.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const a=this.getWebSocketConstructor();return new a(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const US="2.15.5",WS=`realtime-js/${US}`,$S="1.0.0",v0=1e4,HS=1e3,qS=100;var hl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(hl||(hl={}));var Br;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Br||(Br={}));var ea;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ea||(ea={}));var b0;(function(e){e.websocket="websocket"})(b0||(b0={}));var Hs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Hs||(Hs={}));class GS{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),a=new TextDecoder;return this._decodeBroadcast(t,r,a)}_decodeBroadcast(t,r,a){const o=r.getUint8(1),c=r.getUint8(2);let d=this.HEADER_LENGTH+2;const f=a.decode(t.slice(d,d+o));d=d+o;const p=a.decode(t.slice(d,d+c));d=d+c;const h=JSON.parse(a.decode(t.slice(d,t.byteLength)));return{ref:null,topic:f,event:p,payload:h}}}class W1{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var cr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(cr||(cr={}));const ym=(e,t,r={})=>{var a;const o=(a=r.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(t).reduce((c,d)=>(c[d]=YS(d,e,t,o),c),{})},YS=(e,t,r,a)=>{const o=t.find(f=>f.name===e),c=o?.type,d=r[e];return c&&!a.includes(c)?$1(c,d):_0(d)},$1=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return QS(t,r)}switch(e){case cr.bool:return VS(t);case cr.float4:case cr.float8:case cr.int2:case cr.int4:case cr.int8:case cr.numeric:case cr.oid:return XS(t);case cr.json:case cr.jsonb:return KS(t);case cr.timestamp:return JS(t);case cr.abstime:case cr.date:case cr.daterange:case cr.int4range:case cr.int8range:case cr.money:case cr.reltime:case cr.text:case cr.time:case cr.timestamptz:case cr.timetz:case cr.tsrange:case cr.tstzrange:return _0(t);default:return _0(t)}},_0=e=>e,VS=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},XS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},KS=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},QS=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,a=e[r];if(e[0]==="{"&&a==="}"){let c;const d=e.slice(1,r);try{c=JSON.parse("["+d+"]")}catch{c=d?d.split(","):[]}return c.map(f=>$1(t,f))}return e},JS=e=>typeof e=="string"?e.replace(" ","T"):e,H1=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Qf{constructor(t,r,a={},o=v0){this.channel=t,this.event=r,this.payload=a,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var a;return this._hasReceived(t)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(a=>a.status===t).forEach(a=>a.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var vm;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(vm||(vm={}));class pl{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},o=>{const{onJoin:c,onLeave:d,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=pl.syncState(this.state,o,c,d),this.pendingDiffs.forEach(p=>{this.state=pl.syncDiff(this.state,p,c,d)}),this.pendingDiffs=[],f()}),this.channel._on(a.diff,{},o=>{const{onJoin:c,onLeave:d,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=pl.syncDiff(this.state,o,c,d),f())}),this.onJoin((o,c,d)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:c,newPresences:d})}),this.onLeave((o,c,d)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:c,leftPresences:d})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,a,o){const c=this.cloneDeep(t),d=this.transformState(r),f={},p={};return this.map(c,(h,x)=>{d[h]||(p[h]=x)}),this.map(d,(h,x)=>{const y=c[h];if(y){const b=x.map(T=>T.presence_ref),v=y.map(T=>T.presence_ref),w=x.filter(T=>v.indexOf(T.presence_ref)<0),_=y.filter(T=>b.indexOf(T.presence_ref)<0);w.length>0&&(f[h]=w),_.length>0&&(p[h]=_)}else f[h]=x}),this.syncDiff(c,{joins:f,leaves:p},a,o)}static syncDiff(t,r,a,o){const{joins:c,leaves:d}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),o||(o=()=>{}),this.map(c,(f,p)=>{var h;const x=(h=t[f])!==null&&h!==void 0?h:[];if(t[f]=this.cloneDeep(p),x.length>0){const y=t[f].map(v=>v.presence_ref),b=x.filter(v=>y.indexOf(v.presence_ref)<0);t[f].unshift(...b)}a(f,x,p)}),this.map(d,(f,p)=>{let h=t[f];if(!h)return;const x=p.map(y=>y.presence_ref);h=h.filter(y=>x.indexOf(y.presence_ref)<0),t[f]=h,o(f,h,p),h.length===0&&delete t[f]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(a=>r(a,t[a]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,a)=>{const o=t[a];return"metas"in o?r[a]=o.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):r[a]=o,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var bm;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(bm||(bm={}));var gl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(gl||(gl={}));var Fa;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Fa||(Fa={}));class G0{constructor(t,r={config:{}},a){this.topic=t,this.params=r,this.socket=a,this.bindings={},this.state=Br.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Qf(this,ea.join,this.params,this.timeout),this.rejoinTimer=new W1(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Br.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Br.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Br.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Br.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Br.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ea.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new pl(this),this.broadcastEndpointURL=H1(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var a,o,c;if(this.socket.isConnected()||this.socket.connect(),this.state==Br.closed){const{config:{broadcast:d,presence:f,private:p}}=this.params,h=(o=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(v=>v.filter))!==null&&o!==void 0?o:[],x=!!this.bindings[gl.PRESENCE]&&this.bindings[gl.PRESENCE].length>0||((c=this.params.config.presence)===null||c===void 0?void 0:c.enabled)===!0,y={},b={broadcast:d,presence:Object.assign(Object.assign({},f),{enabled:x}),postgres_changes:h,private:p};this.socket.accessTokenValue&&(y.access_token=this.socket.accessTokenValue),this._onError(v=>t?.(Fa.CHANNEL_ERROR,v)),this._onClose(()=>t?.(Fa.CLOSED)),this.updateJoinPayload(Object.assign({config:b},y)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var w;if(this.socket.setAuth(),v===void 0){t?.(Fa.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,T=(w=_?.length)!==null&&w!==void 0?w:0,M=[];for(let F=0;F<T;F++){const A=_[F],{filter:{event:U,schema:V,table:te,filter:N}}=A,re=v&&v[F];if(re&&re.event===U&&re.schema===V&&re.table===te&&re.filter===N)M.push(Object.assign(Object.assign({},A),{id:re.id}));else{this.unsubscribe(),this.state=Br.errored,t?.(Fa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=M,t&&t(Fa.SUBSCRIBED);return}}).receive("error",v=>{this.state=Br.errored,t?.(Fa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{t?.(Fa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,a){return this.state===Br.joined&&t===gl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,a)}async send(t,r={}){var a,o;if(!this._canPush()&&t.type==="broadcast"){const{event:c,payload:d}=t,p={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:d,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,p,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((o=h.body)===null||o===void 0?void 0:o.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var d,f,p;const h=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((p=(f=(d=this.params)===null||d===void 0?void 0:d.config)===null||f===void 0?void 0:f.broadcast)===null||p===void 0)&&p.ack)&&c("ok"),h.receive("ok",()=>c("ok")),h.receive("error",()=>c("error")),h.receive("timeout",()=>c("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Br.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ea.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(o=>{a=new Qf(this,ea.leave,{},t),a.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Br.closed,this.bindings={}}async _fetchWithTimeout(t,r,a){const o=new AbortController,c=setTimeout(()=>o.abort(),a),d=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(c),d}_push(t,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Qf(this,t,r,a);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>qS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,a){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,a){var o,c;const d=t.toLocaleLowerCase(),{close:f,error:p,leave:h,join:x}=ea;if(a&&[f,p,h,x].indexOf(d)>=0&&a!==this._joinRef())return;let b=this._onMessage(d,r,a);if(r&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(d)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(v=>{var w,_,T;return((w=v.filter)===null||w===void 0?void 0:w.event)==="*"||((T=(_=v.filter)===null||_===void 0?void 0:_.event)===null||T===void 0?void 0:T.toLocaleLowerCase())===d}).map(v=>v.callback(b,a)):(c=this.bindings[d])===null||c===void 0||c.filter(v=>{var w,_,T,M,F,A;if(["broadcast","presence","postgres_changes"].includes(d))if("id"in v){const U=v.id,V=(w=v.filter)===null||w===void 0?void 0:w.event;return U&&((_=r.ids)===null||_===void 0?void 0:_.includes(U))&&(V==="*"||V?.toLocaleLowerCase()===((T=r.data)===null||T===void 0?void 0:T.type.toLocaleLowerCase()))}else{const U=(F=(M=v?.filter)===null||M===void 0?void 0:M.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return U==="*"||U===((A=r?.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===d}).map(v=>{if(typeof b=="object"&&"ids"in b){const w=b.data,{schema:_,table:T,commit_timestamp:M,type:F,errors:A}=w;b=Object.assign(Object.assign({},{schema:_,table:T,commit_timestamp:M,eventType:F,new:{},old:{},errors:A}),this._getPayloadRecords(w))}v.callback(b,a)})}_isClosed(){return this.state===Br.closed}_isJoined(){return this.state===Br.joined}_isJoining(){return this.state===Br.joining}_isLeaving(){return this.state===Br.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,a){const o=t.toLocaleLowerCase(),c={type:o,filter:r,callback:a};return this.bindings[o]?this.bindings[o].push(c):this.bindings[o]=[c],this}_off(t,r){const a=t.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(o=>{var c;return!(((c=o.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===a&&G0.isEqual(o.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const a in t)if(t[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ea.close,{},t)}_onError(t){this._on(ea.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Br.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=ym(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=ym(t.columns,t.old_record)),r}}const Jf=()=>{},Kc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ZS=[1e3,2e3,5e3,1e4],ew=1e4,tw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class rw{constructor(t,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=v0,this.transport=null,this.heartbeatIntervalMs=Kc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jf,this.ref=0,this.reconnectTimer=null,this.logger=Jf,this.conn=null,this.sendBuffer=[],this.serializer=new GS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let c;return o?c=o:typeof fetch>"u"?c=(...d)=>Ml(async()=>{const{default:f}=await Promise.resolve().then(()=>lo);return{default:f}},void 0).then(({default:f})=>f(...d)).catch(f=>{throw new Error(`Failed to load @supabase/node-fetch: ${f.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):c=fetch,(...d)=>c(...d)},!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${b0.websocket}`,this.httpEndpoint=H1(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zS.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:$S}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,a){this.logger(t,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case hl.connecting:return Hs.Connecting;case hl.open:return Hs.Open;case hl.closing:return Hs.Closing;default:return Hs.Closed}}isConnected(){return this.connectionState()===Hs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const a=`realtime:${t}`,o=this.getChannels().find(c=>c.topic===a);if(o)return o;{const c=new G0(`realtime:${t}`,r,this);return this.channels.push(c),c}}push(t){const{topic:r,event:a,payload:o,ref:c}=t,d=()=>{this.encode(t,f=>{var p;(p=this.conn)===null||p===void 0||p.send(f)})};this.log("push",`${r} ${a} (${c})`,o),this.isConnected()?d():this.sendBuffer.push(d)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(HS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Kc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(a=>a.topic===t&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(h){this.log("error","error in heartbeat callback",h)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:o,payload:c,ref:d}=r,f=d?`(${d})`:"",p=c.status||"";this.log("receive",`${p} ${a} ${o} ${f}`.trim(),c),this.channels.filter(h=>h._isMember(a)).forEach(h=>h._trigger(o,c,d)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ea.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const a=t.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${t}${a}${o}`}_workerObjectUrl(t){let r;if(t)r=t;else{const a=new Blob([tw],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const o={access_token:r,version:WS};r&&a.updateJoinPayload(o),a.joinedOnce&&a._isJoined()&&a._push(ea.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(a=>{try{a(r)}catch(o){this.log("error",`error in ${t} callback`,o)}})}catch(a){this.log("error",`error triggering ${t} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new W1(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Kc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,a,o,c,d,f,p,h,x;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=t?.timeout)!==null&&a!==void 0?a:v0,this.heartbeatIntervalMs=(o=t?.heartbeatIntervalMs)!==null&&o!==void 0?o:Kc.HEARTBEAT_INTERVAL,this.worker=(c=t?.worker)!==null&&c!==void 0?c:!1,this.accessToken=(d=t?.accessToken)!==null&&d!==void 0?d:null,this.heartbeatCallback=(f=t?.heartbeatCallback)!==null&&f!==void 0?f:Jf,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(p=t?.reconnectAfterMs)!==null&&p!==void 0?p:(y=>ZS[y-1]||ew),this.encode=(h=t?.encode)!==null&&h!==void 0?h:((y,b)=>b(JSON.stringify(y))),this.decode=(x=t?.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class Y0 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Fr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class nw extends Y0{constructor(t,r,a){super(t),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class S0 extends Y0{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var aw=function(e,t,r,a){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(x){try{h(a.next(x))}catch(y){d(y)}}function p(x){try{h(a.throw(x))}catch(y){d(y)}}function h(x){x.done?c(x.value):o(x.value).then(f,p)}h((a=a.apply(e,t||[])).next())})};const q1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ml(async()=>{const{default:a}=await Promise.resolve().then(()=>lo);return{default:a}},void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)},sw=()=>aw(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ml(()=>Promise.resolve().then(()=>lo),void 0)).Response:Response}),w0=e=>{if(Array.isArray(e))return e.map(r=>w0(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,a])=>{const o=r.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));t[o]=w0(a)}),t},iw=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Qs=function(e,t,r,a){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(x){try{h(a.next(x))}catch(y){d(y)}}function p(x){try{h(a.throw(x))}catch(y){d(y)}}function h(x){x.done?c(x.value):o(x.value).then(f,p)}h((a=a.apply(e,t||[])).next())})};const Zf=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ow=(e,t,r)=>Qs(void 0,void 0,void 0,function*(){const a=yield sw();e instanceof a&&!r?.noResolveJson?e.json().then(o=>{const c=e.status||500,d=o?.statusCode||c+"";t(new nw(Zf(o),c,d))}).catch(o=>{t(new S0(Zf(o),o))}):t(new S0(Zf(e),e))}),lw=(e,t,r,a)=>{const o={method:e,headers:t?.headers||{}};return e==="GET"||!a?o:(iw(a)?(o.headers=Object.assign({"Content-Type":"application/json"},t?.headers),o.body=JSON.stringify(a)):o.body=a,t?.duplex&&(o.duplex=t.duplex),Object.assign(Object.assign({},o),r))};function Bl(e,t,r,a,o,c){return Qs(this,void 0,void 0,function*(){return new Promise((d,f)=>{e(r,lw(t,a,o,c)).then(p=>{if(!p.ok)throw p;return a?.noResolveJson?p:p.json()}).then(p=>d(p)).catch(p=>ow(p,f,a))})})}function fd(e,t,r,a){return Qs(this,void 0,void 0,function*(){return Bl(e,"GET",t,r,a)})}function pa(e,t,r,a,o){return Qs(this,void 0,void 0,function*(){return Bl(e,"POST",t,a,o,r)})}function T0(e,t,r,a,o){return Qs(this,void 0,void 0,function*(){return Bl(e,"PUT",t,a,o,r)})}function cw(e,t,r,a){return Qs(this,void 0,void 0,function*(){return Bl(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function G1(e,t,r,a,o){return Qs(this,void 0,void 0,function*(){return Bl(e,"DELETE",t,a,o,r)})}var dn=function(e,t,r,a){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(x){try{h(a.next(x))}catch(y){d(y)}}function p(x){try{h(a.throw(x))}catch(y){d(y)}}function h(x){x.done?c(x.value):o(x.value).then(f,p)}h((a=a.apply(e,t||[])).next())})};const dw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},_m={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class uw{constructor(t,r={},a,o){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=a,this.fetch=q1(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,a,o){return dn(this,void 0,void 0,function*(){try{let c;const d=Object.assign(Object.assign({},_m),o);let f=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(d.upsert)});const p=d.metadata;typeof Blob<"u"&&a instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),p&&c.append("metadata",this.encodeMetadata(p)),c.append("",a)):typeof FormData<"u"&&a instanceof FormData?(c=a,c.append("cacheControl",d.cacheControl),p&&c.append("metadata",this.encodeMetadata(p))):(c=a,f["cache-control"]=`max-age=${d.cacheControl}`,f["content-type"]=d.contentType,p&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(p)))),o?.headers&&(f=Object.assign(Object.assign({},f),o.headers));const h=this._removeEmptyFolders(r),x=this._getFinalPath(h),y=yield(t=="PUT"?T0:pa)(this.fetch,`${this.url}/object/${x}`,c,Object.assign({headers:f},d?.duplex?{duplex:d.duplex}:{}));return{data:{path:h,id:y.Id,fullPath:y.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Fr(c))return{data:null,error:c};throw c}})}upload(t,r,a){return dn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,a)})}uploadToSignedUrl(t,r,a,o){return dn(this,void 0,void 0,function*(){const c=this._removeEmptyFolders(t),d=this._getFinalPath(c),f=new URL(this.url+`/object/upload/sign/${d}`);f.searchParams.set("token",r);try{let p;const h=Object.assign({upsert:_m.upsert},o),x=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&a instanceof Blob?(p=new FormData,p.append("cacheControl",h.cacheControl),p.append("",a)):typeof FormData<"u"&&a instanceof FormData?(p=a,p.append("cacheControl",h.cacheControl)):(p=a,x["cache-control"]=`max-age=${h.cacheControl}`,x["content-type"]=h.contentType);const y=yield T0(this.fetch,f.toString(),p,{headers:x});return{data:{path:c,fullPath:y.Key},error:null}}catch(p){if(this.shouldThrowOnError)throw p;if(Fr(p))return{data:null,error:p};throw p}})}createSignedUploadUrl(t,r){return dn(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t);const o=Object.assign({},this.headers);r?.upsert&&(o["x-upsert"]="true");const c=yield pa(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:o}),d=new URL(this.url+c.url),f=d.searchParams.get("token");if(!f)throw new Y0("No token returned by API");return{data:{signedUrl:d.toString(),path:t,token:f},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}})}update(t,r,a){return dn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,a)})}move(t,r,a){return dn(this,void 0,void 0,function*(){try{return{data:yield pa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Fr(o))return{data:null,error:o};throw o}})}copy(t,r,a){return dn(this,void 0,void 0,function*(){try{return{data:{path:(yield pa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Fr(o))return{data:null,error:o};throw o}})}createSignedUrl(t,r,a){return dn(this,void 0,void 0,function*(){try{let o=this._getFinalPath(t),c=yield pa(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:r},a?.transform?{transform:a.transform}:{}),{headers:this.headers});const d=a?.download?`&download=${a.download===!0?"":a.download}`:"";return c={signedUrl:encodeURI(`${this.url}${c.signedURL}${d}`)},{data:c,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Fr(o))return{data:null,error:o};throw o}})}createSignedUrls(t,r,a){return dn(this,void 0,void 0,function*(){try{const o=yield pa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),c=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:o.map(d=>Object.assign(Object.assign({},d),{signedUrl:d.signedURL?encodeURI(`${this.url}${d.signedURL}${c}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Fr(o))return{data:null,error:o};throw o}})}download(t,r){return dn(this,void 0,void 0,function*(){const o=typeof r?.transform<"u"?"render/image/authenticated":"object",c=this.transformOptsToQueryString(r?.transform||{}),d=c?`?${c}`:"";try{const f=this._getFinalPath(t);return{data:yield(yield fd(this.fetch,`${this.url}/${o}/${f}${d}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(this.shouldThrowOnError)throw f;if(Fr(f))return{data:null,error:f};throw f}})}info(t){return dn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const a=yield fd(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:w0(a),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}})}exists(t){return dn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield cw(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fr(a)&&a instanceof S0){const o=a.originalError;if([400,404].includes(o?.status))return{data:!1,error:a}}throw a}})}getPublicUrl(t,r){const a=this._getFinalPath(t),o=[],c=r?.download?`download=${r.download===!0?"":r.download}`:"";c!==""&&o.push(c);const f=typeof r?.transform<"u"?"render/image":"object",p=this.transformOptsToQueryString(r?.transform||{});p!==""&&o.push(p);let h=o.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${a}${h}`)}}}remove(t){return dn(this,void 0,void 0,function*(){try{return{data:yield G1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}})}list(t,r,a){return dn(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},dw),r),{prefix:t||""});return{data:yield pa(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},a),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Fr(o))return{data:null,error:o};throw o}})}listV2(t,r){return dn(this,void 0,void 0,function*(){try{const a=Object.assign({},t);return{data:yield pa(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const fw="2.12.1",hw={"X-Client-Info":`storage-js/${fw}`};var Ui=function(e,t,r,a){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(x){try{h(a.next(x))}catch(y){d(y)}}function p(x){try{h(a.throw(x))}catch(y){d(y)}}function h(x){x.done?c(x.value):o(x.value).then(f,p)}h((a=a.apply(e,t||[])).next())})};class pw{constructor(t,r={},a,o){this.shouldThrowOnError=!1;const c=new URL(t);o?.useNewHostname&&/supabase\.(co|in|red)$/.test(c.hostname)&&!c.hostname.includes("storage.supabase.")&&(c.hostname=c.hostname.replace("supabase.","storage.supabase.")),this.url=c.href,this.headers=Object.assign(Object.assign({},hw),r),this.fetch=q1(a)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Ui(this,void 0,void 0,function*(){try{return{data:yield fd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Fr(t))return{data:null,error:t};throw t}})}getBucket(t){return Ui(this,void 0,void 0,function*(){try{return{data:yield fd(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Ui(this,void 0,void 0,function*(){try{return{data:yield pa(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}})}updateBucket(t,r){return Ui(this,void 0,void 0,function*(){try{return{data:yield T0(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Fr(a))return{data:null,error:a};throw a}})}emptyBucket(t){return Ui(this,void 0,void 0,function*(){try{return{data:yield pa(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ui(this,void 0,void 0,function*(){try{return{data:yield G1(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Fr(r))return{data:null,error:r};throw r}})}}class gw extends pw{constructor(t,r={},a,o){super(t,r,a,o)}from(t){return new uw(this.url,this.headers,t,this.fetch)}}const xw="2.57.4";let ul="";typeof Deno<"u"?ul="deno":typeof document<"u"?ul="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ul="react-native":ul="node";const mw={"X-Client-Info":`supabase-js-${ul}/${xw}`},yw={headers:mw},vw={schema:"public"},bw={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_w={};var Sw=function(e,t,r,a){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(x){try{h(a.next(x))}catch(y){d(y)}}function p(x){try{h(a.throw(x))}catch(y){d(y)}}function h(x){x.done?c(x.value):o(x.value).then(f,p)}h((a=a.apply(e,t||[])).next())})};const ww=e=>{let t;return e?t=e:typeof fetch>"u"?t=I1:t=fetch,(...r)=>t(...r)},Tw=()=>typeof Headers>"u"?F1:Headers,Ew=(e,t,r)=>{const a=ww(r),o=Tw();return(c,d)=>Sw(void 0,void 0,void 0,function*(){var f;const p=(f=yield t())!==null&&f!==void 0?f:e;let h=new o(d?.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${p}`),a(c,Object.assign(Object.assign({},d),{headers:h}))})};var kw=function(e,t,r,a){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(x){try{h(a.next(x))}catch(y){d(y)}}function p(x){try{h(a.throw(x))}catch(y){d(y)}}function h(x){x.done?c(x.value):o(x.value).then(f,p)}h((a=a.apply(e,t||[])).next())})};function jw(e){return e.endsWith("/")?e:e+"/"}function Cw(e,t){var r,a;const{db:o,auth:c,realtime:d,global:f}=e,{db:p,auth:h,realtime:x,global:y}=t,b={db:Object.assign(Object.assign({},p),o),auth:Object.assign(Object.assign({},h),c),realtime:Object.assign(Object.assign({},x),d),storage:{},global:Object.assign(Object.assign(Object.assign({},y),f),{headers:Object.assign(Object.assign({},(r=y?.headers)!==null&&r!==void 0?r:{}),(a=f?.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>kw(this,void 0,void 0,function*(){return""})};return e.accessToken?b.accessToken=e.accessToken:delete b.accessToken,b}function Aw(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(jw(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Y1="2.71.1",Xi=30*1e3,E0=3,e0=E0*Xi,Rw="http://localhost:9999",Dw="supabase.auth.token",Nw={"X-Client-Info":`gotrue-js/${Y1}`},k0="X-Supabase-Api-Version",V1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ow=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Mw=600*1e3;class V0 extends Error{constructor(t,r,a){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function kt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Bw extends V0{constructor(t,r,a){super(t,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function Iw(e){return kt(e)&&e.name==="AuthApiError"}class X1 extends V0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ws extends V0{constructor(t,r,a,o){super(t,a,o),this.name=r,this.status=a}}class xs extends ws{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Fw(e){return kt(e)&&e.name==="AuthSessionMissingError"}class Qc extends ws{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jc extends ws{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Zc extends ws{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Lw(e){return kt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Sm extends ws{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class j0 extends ws{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function t0(e){return kt(e)&&e.name==="AuthRetryableFetchError"}class wm extends ws{constructor(t,r,a){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class C0 extends ws{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const hd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Tm=` 	
\r=`.split(""),Pw=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Tm.length;t+=1)e[Tm[t].charCodeAt(0)]=-2;for(let t=0;t<hd.length;t+=1)e[hd[t].charCodeAt(0)]=t;return e})();function Em(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(hd[a]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const a=t.queue>>t.queuedBits-6&63;r(hd[a]),t.queuedBits-=6}}function K1(e,t,r){const a=Pw[e];if(a>-1)for(t.queue=t.queue<<6|a,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function km(e){const t=[],r=d=>{t.push(String.fromCodePoint(d))},a={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},c=d=>{Ww(d,a,r)};for(let d=0;d<e.length;d+=1)K1(e.charCodeAt(d),o,c);return t.join("")}function zw(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Uw(e,t){for(let r=0;r<e.length;r+=1){let a=e.charCodeAt(r);if(a>55295&&a<=56319){const o=(a-55296)*1024&65535;a=(e.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}zw(a,t)}}function Ww(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let a=1;a<6;a+=1)if((e>>7-a&1)===0){t.utf8seq=a;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function $w(e){const t=[],r={queue:0,queuedBits:0},a=o=>{t.push(o)};for(let o=0;o<e.length;o+=1)K1(e.charCodeAt(o),r,a);return new Uint8Array(t)}function Hw(e){const t=[];return Uw(e,r=>t.push(r)),new Uint8Array(t)}function qw(e){const t=[],r={queue:0,queuedBits:0},a=o=>{t.push(o)};return e.forEach(o=>Em(o,r,a)),Em(null,r,a),t.join("")}function Gw(e){return Math.round(Date.now()/1e3)+e}function Yw(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Zn=()=>typeof window<"u"&&typeof document<"u",Us={tested:!1,writable:!1},Q1=()=>{if(!Zn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Us.tested)return Us.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Us.tested=!0,Us.writable=!0}catch{Us.tested=!0,Us.writable=!1}return Us.writable};function Vw(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,c)=>{t[c]=o})}catch{}return r.searchParams.forEach((a,o)=>{t[o]=a}),t}const J1=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ml(async()=>{const{default:a}=await Promise.resolve().then(()=>lo);return{default:a}},void 0).then(({default:a})=>a(...r)):t=fetch,(...r)=>t(...r)},Xw=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ki=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ws=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ps=async(e,t)=>{await e.removeItem(t)};class Dd{constructor(){this.promise=new Dd.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Dd.promiseConstructor=Promise;function r0(e){const t=e.split(".");if(t.length!==3)throw new C0("Invalid JWT structure");for(let a=0;a<t.length;a++)if(!Ow.test(t[a]))throw new C0("JWT not in base64url format");return{header:JSON.parse(km(t[0])),payload:JSON.parse(km(t[1])),signature:$w(t[2]),raw:{header:t[0],payload:t[1]}}}async function Kw(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Qw(e,t){return new Promise((a,o)=>{(async()=>{for(let c=0;c<1/0;c++)try{const d=await e(c);if(!t(c,null,d)){a(d);return}}catch(d){if(!t(c,d)){o(d);return}}})()})}function Jw(e){return("0"+e.toString(16)).substr(-2)}function Zw(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let o="";for(let c=0;c<56;c++)o+=r.charAt(Math.floor(Math.random()*a));return o}return crypto.getRandomValues(t),Array.from(t,Jw).join("")}async function e4(e){const r=new TextEncoder().encode(e),a=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(a);return Array.from(o).map(c=>String.fromCharCode(c)).join("")}async function t4(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await e4(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wi(e,t,r=!1){const a=Zw();let o=a;r&&(o+="/PASSWORD_RECOVERY"),await Ki(e,`${t}-code-verifier`,o);const c=await t4(a);return[c,a===c?"plain":"s256"]}const r4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function n4(e){const t=e.headers.get(k0);if(!t||!t.match(r4))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function a4(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function s4(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const i4=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function $i(e){if(!i4.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function n0(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function jm(e){return JSON.parse(JSON.stringify(e))}var o4=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]]);return r};const $s=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),l4=[502,503,504];async function Cm(e){var t;if(!Xw(e))throw new j0($s(e),0);if(l4.includes(e.status))throw new j0($s(e),e.status);let r;try{r=await e.json()}catch(c){throw new X1($s(c),c)}let a;const o=n4(e);if(o&&o.getTime()>=V1["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new wm($s(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(a==="session_not_found")throw new xs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((c,d)=>c&&typeof d=="string",!0))throw new wm($s(r),e.status,r.weak_password.reasons);throw new Bw($s(r),e.status||500,a)}const c4=(e,t,r,a)=>{const o={method:e,headers:t?.headers||{}};return e==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),o.body=JSON.stringify(a),Object.assign(Object.assign({},o),r))};async function Mt(e,t,r,a){var o;const c=Object.assign({},a?.headers);c[k0]||(c[k0]=V1["2024-01-01"].name),a?.jwt&&(c.Authorization=`Bearer ${a.jwt}`);const d=(o=a?.query)!==null&&o!==void 0?o:{};a?.redirectTo&&(d.redirect_to=a.redirectTo);const f=Object.keys(d).length?"?"+new URLSearchParams(d).toString():"",p=await d4(e,t,r+f,{headers:c,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(p):{data:Object.assign({},p),error:null}}async function d4(e,t,r,a,o,c){const d=c4(t,a,o,c);let f;try{f=await e(r,Object.assign({},d))}catch(p){throw console.error(p),new j0($s(p),0)}if(f.ok||await Cm(f),a?.noResolveJson)return f;try{return await f.json()}catch(p){await Cm(p)}}function Ia(e){var t;let r=null;p4(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Gw(e.expires_in)));const a=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:a},error:null}}function Am(e){const t=Ia(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ms(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function u4(e){return{data:e,error:null}}function f4(e){const{action_link:t,email_otp:r,hashed_token:a,redirect_to:o,verification_type:c}=e,d=o4(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:t,email_otp:r,hashed_token:a,redirect_to:o,verification_type:c},p=Object.assign({},d);return{data:{properties:f,user:p},error:null}}function h4(e){return e}function p4(e){return e.access_token&&e.refresh_token&&e.expires_in}const a0=["global","local","others"];var g4=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(r[a[o]]=e[a[o]]);return r};class x4{constructor({url:t="",headers:r={},fetch:a}){this.url=t,this.headers=r,this.fetch=J1(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=a0[0]){if(a0.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${a0.join(", ")}`);try{return await Mt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(a){if(kt(a))return{data:null,error:a};throw a}}async inviteUserByEmail(t,r={}){try{return await Mt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ms})}catch(a){if(kt(a))return{data:{user:null},error:a};throw a}}async generateLink(t){try{const{options:r}=t,a=g4(t,["options"]),o=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(o.new_email=a?.newEmail,delete o.newEmail),await Mt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:f4,redirectTo:r?.redirectTo})}catch(r){if(kt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Mt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ms})}catch(r){if(kt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,a,o,c,d,f,p;try{const h={nextPage:null,lastPage:0,total:0},x=await Mt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(c=(o=t?.perPage)===null||o===void 0?void 0:o.toString())!==null&&c!==void 0?c:""},xform:h4});if(x.error)throw x.error;const y=await x.json(),b=(d=x.headers.get("x-total-count"))!==null&&d!==void 0?d:0,v=(p=(f=x.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&p!==void 0?p:[];return v.length>0&&(v.forEach(w=>{const _=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),T=JSON.parse(w.split(";")[1].split("=")[1]);h[`${T}Page`]=_}),h.total=parseInt(b)),{data:Object.assign(Object.assign({},y),h),error:null}}catch(h){if(kt(h))return{data:{users:[]},error:h};throw h}}async getUserById(t){$i(t);try{return await Mt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ms})}catch(r){if(kt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){$i(t);try{return await Mt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ms})}catch(a){if(kt(a))return{data:{user:null},error:a};throw a}}async deleteUser(t,r=!1){$i(t);try{return await Mt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ms})}catch(a){if(kt(a))return{data:{user:null},error:a};throw a}}async _listFactors(t){$i(t.userId);try{const{data:r,error:a}=await Mt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:a}}catch(r){if(kt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){$i(t.userId),$i(t.id);try{return{data:await Mt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(kt(r))return{data:null,error:r};throw r}}}function Rm(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function m4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Hi={debug:!!(globalThis&&Q1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Z1 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class y4 extends Z1{}async function v4(e,t,r){Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const a=new globalThis.AbortController;return t>0&&setTimeout(()=>{a.abort(),Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async o=>{if(o){Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name);try{return await r()}finally{Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name)}}else{if(t===0)throw Hi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new y4(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Hi.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}m4();const b4={url:Rw,storageKey:Dw,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Nw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Dm(e,t,r){return await r()}const qi={};class Tl{constructor(t){var r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Tl.nextInstanceID,Tl.nextInstanceID+=1,this.instanceID>0&&Zn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},b4),t);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new x4({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=J1(o.fetch),this.lock=o.lock||Dm,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Zn()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=v4:this.lock=Dm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Q1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Rm(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Rm(this.memoryStorage)),Zn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(c){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",c)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async c=>{this._debug("received broadcast notification from other tab or client",c),await this._notifyAllSubscribers(c.data.event,c.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=qi[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){qi[this.storageKey]=Object.assign(Object.assign({},qi[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=qi[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){qi[this.storageKey]=Object.assign(Object.assign({},qi[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Y1}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=Vw(window.location.href);let a="none";if(this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce"),Zn()&&this.detectSessionInUrl&&a!=="none"){const{data:o,error:c}=await this._getSessionFromURL(r,a);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),Lw(c)){const p=(t=c.details)===null||t===void 0?void 0:t.code;if(p==="identity_already_exists"||p==="identity_not_found"||p==="single_identity_not_deletable")return{error:c}}return await this._removeSession(),{error:c}}const{session:d,redirectType:f}=o;return this._debug("#_initialize()","detected session in URL",d,"redirect type",f),await this._saveSession(d),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",d):await this._notifyAllSubscribers("SIGNED_IN",d)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return kt(r)?{error:r}:{error:new X1("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,a,o;try{const c=await Mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(o=t?.options)===null||o===void 0?void 0:o.captchaToken}},xform:Ia}),{data:d,error:f}=c;if(f||!d)return{data:{user:null,session:null},error:f};const p=d.session,h=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:h,session:p},error:null}}catch(c){if(kt(c))return{data:{user:null,session:null},error:c};throw c}}async signUp(t){var r,a,o;try{let c;if("email"in t){const{email:x,password:y,options:b}=t;let v=null,w=null;this.flowType==="pkce"&&([v,w]=await Wi(this.storage,this.storageKey)),c=await Mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:x,password:y,data:(r=b?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:v,code_challenge_method:w},xform:Ia})}else if("phone"in t){const{phone:x,password:y,options:b}=t;c=await Mt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:y,data:(a=b?.data)!==null&&a!==void 0?a:{},channel:(o=b?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:Ia})}else throw new Jc("You must provide either an email or phone number and a password");const{data:d,error:f}=c;if(f||!d)return{data:{user:null,session:null},error:f};const p=d.session,h=d.user;return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",p)),{data:{user:h,session:p},error:null}}catch(c){if(kt(c))return{data:{user:null,session:null},error:c};throw c}}async signInWithPassword(t){try{let r;if("email"in t){const{email:c,password:d,options:f}=t;r=await Mt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Am})}else if("phone"in t){const{phone:c,password:d,options:f}=t;r=await Mt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Am})}else throw new Jc("You must provide either an email or phone number and a password");const{data:a,error:o}=r;return o?{data:{user:null,session:null},error:o}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Qc}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:o})}catch(r){if(kt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,a,o,c;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(o=t.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(c=t.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,a,o,c,d,f,p,h,x,y,b,v;let w,_;if("message"in t)w=t.message,_=t.signature;else{const{chain:T,wallet:M,statement:F,options:A}=t;let U;if(Zn())if(typeof M=="object")U=M;else{const te=window;if("solana"in te&&typeof te.solana=="object"&&("signIn"in te.solana&&typeof te.solana.signIn=="function"||"signMessage"in te.solana&&typeof te.solana.signMessage=="function"))U=te.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof M!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");U=M}const V=new URL((r=A?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in U&&U.signIn){const te=await U.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},A?.signInWithSolana),{version:"1",domain:V.host,uri:V.href}),F?{statement:F}:null));let N;if(Array.isArray(te)&&te[0]&&typeof te[0]=="object")N=te[0];else if(te&&typeof te=="object"&&"signedMessage"in te&&"signature"in te)N=te;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)w=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),_=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in U)||typeof U.signMessage!="function"||!("publicKey"in U)||typeof U!="object"||!U.publicKey||!("toBase58"in U.publicKey)||typeof U.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${V.host} wants you to sign in with your Solana account:`,U.publicKey.toBase58(),...F?["",F,""]:[""],"Version: 1",`URI: ${V.href}`,`Issued At: ${(o=(a=A?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((c=A?.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${A.signInWithSolana.notBefore}`]:[],...!((d=A?.signInWithSolana)===null||d===void 0)&&d.expirationTime?[`Expiration Time: ${A.signInWithSolana.expirationTime}`]:[],...!((f=A?.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${A.signInWithSolana.chainId}`]:[],...!((p=A?.signInWithSolana)===null||p===void 0)&&p.nonce?[`Nonce: ${A.signInWithSolana.nonce}`]:[],...!((h=A?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${A.signInWithSolana.requestId}`]:[],...!((y=(x=A?.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||y===void 0)&&y.length?["Resources",...A.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const te=await U.signMessage(new TextEncoder().encode(w),"utf8");if(!te||!(te instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=te}}try{const{data:T,error:M}=await Mt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:qw(_)},!((b=t.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Ia});if(M)throw M;return!T||!T.session||!T.user?{data:{user:null,session:null},error:new Qc}:(T.session&&(await this._saveSession(T.session),await this._notifyAllSubscribers("SIGNED_IN",T.session)),{data:Object.assign({},T),error:M})}catch(T){if(kt(T))return{data:{user:null,session:null},error:T};throw T}}async _exchangeCodeForSession(t){const r=await Ws(this.storage,`${this.storageKey}-code-verifier`),[a,o]=(r??"").split("/");try{const{data:c,error:d}=await Mt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:a},xform:Ia});if(await ps(this.storage,`${this.storageKey}-code-verifier`),d)throw d;return!c||!c.session||!c.user?{data:{user:null,session:null,redirectType:null},error:new Qc}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:Object.assign(Object.assign({},c),{redirectType:o??null}),error:d})}catch(c){if(kt(c))return{data:{user:null,session:null,redirectType:null},error:c};throw c}}async signInWithIdToken(t){try{const{options:r,provider:a,token:o,access_token:c,nonce:d}=t,f=await Mt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:o,access_token:c,nonce:d,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Ia}),{data:p,error:h}=f;return h?{data:{user:null,session:null},error:h}:!p||!p.session||!p.user?{data:{user:null,session:null},error:new Qc}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:p,error:h})}catch(r){if(kt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,a,o,c,d;try{if("email"in t){const{email:f,options:p}=t;let h=null,x=null;this.flowType==="pkce"&&([h,x]=await Wi(this.storage,this.storageKey));const{error:y}=await Mt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(r=p?.data)!==null&&r!==void 0?r:{},create_user:(a=p?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:h,code_challenge_method:x},redirectTo:p?.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in t){const{phone:f,options:p}=t,{data:h,error:x}=await Mt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(o=p?.data)!==null&&o!==void 0?o:{},create_user:(c=p?.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:p?.captchaToken},channel:(d=p?.channel)!==null&&d!==void 0?d:"sms"}});return{data:{user:null,session:null,messageId:h?.message_id},error:x}}throw new Jc("You must provide either an email or phone number.")}catch(f){if(kt(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(t){var r,a;try{let o,c;"options"in t&&(o=(r=t.options)===null||r===void 0?void 0:r.redirectTo,c=(a=t.options)===null||a===void 0?void 0:a.captchaToken);const{data:d,error:f}=await Mt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:c}}),redirectTo:o,xform:Ia});if(f)throw f;if(!d)throw new Error("An error occurred on token verification.");const p=d.session,h=d.user;return p?.access_token&&(await this._saveSession(p),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",p)),{data:{user:h,session:p},error:null}}catch(o){if(kt(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(t){var r,a,o;try{let c=null,d=null;return this.flowType==="pkce"&&([c,d]=await Wi(this.storage,this.storageKey)),await Mt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((o=t?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:u4})}catch(c){if(kt(c))return{data:null,error:c};throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:a}=t;if(a)throw a;if(!r)throw new xs;const{error:o}=await Mt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:o}})}catch(t){if(kt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:a,type:o,options:c}=t,{error:d}=await Mt(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:d}}else if("phone"in t){const{phone:a,type:o,options:c}=t,{data:d,error:f}=await Mt(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:o,gotrue_meta_security:{captcha_token:c?.captchaToken}}});return{data:{user:null,session:null,messageId:d?.message_id},error:f}}throw new Jc("You must provide either an email or phone number and a type")}catch(r){if(kt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ws(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const a=t.expires_at?t.expires_at*1e3-Date.now()<e0:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",t.expires_at),!a){if(this.userStorage){const d=await Ws(this.userStorage,this.storageKey+"-user");d?.user?t.user=d.user:t.user=n0()}if(this.storage.isServer&&t.user){let d=this.suppressGetSessionWarning;t=new Proxy(t,{get:(p,h,x)=>(!d&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),d=!0,this.suppressGetSessionWarning=!0),Reflect.get(p,h,x))})}return{data:{session:t},error:null}}const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{session:null},error:c}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Mt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ms}):await this._useSession(async r=>{var a,o,c;const{data:d,error:f}=r;if(f)throw f;return!(!((a=d.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new xs}:await Mt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(o=d.session)===null||o===void 0?void 0:o.access_token)!==null&&c!==void 0?c:void 0,xform:ms})})}catch(r){if(kt(r))return Fw(r)&&(await this._removeSession(),await ps(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async a=>{const{data:o,error:c}=a;if(c)throw c;if(!o.session)throw new xs;const d=o.session;let f=null,p=null;this.flowType==="pkce"&&t.email!=null&&([f,p]=await Wi(this.storage,this.storageKey));const{data:h,error:x}=await Mt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:f,code_challenge_method:p}),jwt:d.access_token,xform:ms});if(x)throw x;return d.user=h.user,await this._saveSession(d),await this._notifyAllSubscribers("USER_UPDATED",d),{data:{user:d.user},error:null}})}catch(a){if(kt(a))return{data:{user:null},error:a};throw a}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new xs;const r=Date.now()/1e3;let a=r,o=!0,c=null;const{payload:d}=r0(t.access_token);if(d.exp&&(a=d.exp,o=a<=r),o){const{session:f,error:p}=await this._callRefreshToken(t.refresh_token);if(p)return{data:{user:null,session:null},error:p};if(!f)return{data:{user:null,session:null},error:null};c=f}else{const{data:f,error:p}=await this._getUser(t.access_token);if(p)throw p;c={access_token:t.access_token,refresh_token:t.refresh_token,user:f.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return{data:{user:c.user,session:c},error:null}}catch(r){if(kt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var a;if(!t){const{data:d,error:f}=r;if(f)throw f;t=(a=d.session)!==null&&a!==void 0?a:void 0}if(!t?.refresh_token)throw new xs;const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);return c?{data:{user:null,session:null},error:c}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(kt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Zn())throw new Zc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Zc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Sm("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Zc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Sm("No code detected.");const{data:F,error:A}=await this._exchangeCodeForSession(t.code);if(A)throw A;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:F.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:o,access_token:c,refresh_token:d,expires_in:f,expires_at:p,token_type:h}=t;if(!c||!f||!d||!h)throw new Zc("No session defined in URL");const x=Math.round(Date.now()/1e3),y=parseInt(f);let b=x+y;p&&(b=parseInt(p));const v=b-x;v*1e3<=Xi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${y}s`);const w=b-y;x-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,b,x):x-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,b,x);const{data:_,error:T}=await this._getUser(c);if(T)throw T;const M={provider_token:a,provider_refresh_token:o,access_token:c,expires_in:y,expires_at:b,refresh_token:d,token_type:h,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:M,redirectType:t.type},error:null}}catch(a){if(kt(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ws(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:o,error:c}=r;if(c)return{error:c};const d=(a=o.session)===null||a===void 0?void 0:a.access_token;if(d){const{error:f}=await this.admin.signOut(d,t);if(f&&!(Iw(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return t!=="others"&&(await this._removeSession(),await ps(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=Yw(),a={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(t){return await this._useSession(async r=>{var a,o;try{const{data:{session:c},error:d}=r;if(d)throw d;await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",t,"session",c)}catch(c){await((o=this.stateChangeEmitters.get(t))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",c),console.error(c)}})}async resetPasswordForEmail(t,r={}){let a=null,o=null;this.flowType==="pkce"&&([a,o]=await Wi(this.storage,this.storageKey,!0));try{return await Mt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:a,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(c){if(kt(c))return{data:null,error:c};throw c}}async getUserIdentities(){var t;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(kt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:a,error:o}=await this._useSession(async c=>{var d,f,p,h,x;const{data:y,error:b}=c;if(b)throw b;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(d=t.options)===null||d===void 0?void 0:d.redirectTo,scopes:(f=t.options)===null||f===void 0?void 0:f.scopes,queryParams:(p=t.options)===null||p===void 0?void 0:p.queryParams,skipBrowserRedirect:!0});return await Mt(this.fetch,"GET",v,{headers:this.headers,jwt:(x=(h=y.session)===null||h===void 0?void 0:h.access_token)!==null&&x!==void 0?x:void 0})});if(o)throw o;return Zn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),{data:{provider:t.provider,url:a?.url},error:null}}catch(a){if(kt(a))return{data:{provider:t.provider,url:null},error:a};throw a}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var a,o;const{data:c,error:d}=r;if(d)throw d;return await Mt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(o=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(kt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await Qw(async o=>(o>0&&await Kw(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await Mt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ia})),(o,c)=>{const d=200*Math.pow(2,o);return c&&t0(c)&&Date.now()+d-a<Xi})}catch(a){if(this._debug(r,"error",a),kt(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",a),Zn()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:t,url:a},error:null}}async _recoverAndRefresh(){var t,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const o=await Ws(this.storage,this.storageKey);if(o&&this.userStorage){let d=await Ws(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!d&&(d={user:o.user},await Ki(this.userStorage,this.storageKey+"-user",d)),o.user=(t=d?.user)!==null&&t!==void 0?t:n0()}else if(o&&!o.user&&!o.user){const d=await Ws(this.storage,this.storageKey+"-user");d&&d?.user?(o.user=d.user,await ps(this.storage,this.storageKey+"-user"),await Ki(this.storage,this.storageKey,o)):o.user=n0()}if(this._debug(a,"session from storage",o),!this._isValidSession(o)){this._debug(a,"session is not valid"),o!==null&&await this._removeSession();return}const c=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<e0;if(this._debug(a,`session has${c?"":" not"} expired with margin of ${e0}s`),c){if(this.autoRefreshToken&&o.refresh_token){const{error:d}=await this._callRefreshToken(o.refresh_token);d&&(console.error(d),t0(d)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",d),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:d,error:f}=await this._getUser(o.access_token);!f&&d?.user?(o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(d){console.error("Error getting user data:",d),this._debug(a,"error getting user data, skipping SIGNED_IN notification",d)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(a,"error",o),console.error(o);return}finally{this._debug(a,"end")}}async _callRefreshToken(t){var r,a;if(!t)throw new xs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Dd;const{data:c,error:d}=await this._refreshAccessToken(t);if(d)throw d;if(!c.session)throw new xs;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const f={session:c.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(c){if(this._debug(o,"error",c),kt(c)){const d={session:null,error:c};return t0(c)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(d),d}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(c),c}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(t,r,a=!0){const o=`#_notifyAllSubscribers(${t})`;this._debug(o,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:t,session:r});const c=[],d=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(t,r)}catch(p){c.push(p)}});if(await Promise.all(d),c.length>0){for(let f=0;f<c.length;f+=1)console.error(c[f]);throw c[0]}}finally{this._debug(o,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await Ki(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const c=jm(o);await Ki(this.storage,this.storageKey,c)}else{const o=jm(r);await Ki(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await ps(this.storage,this.storageKey),await ps(this.storage,this.storageKey+"-code-verifier"),await ps(this.storage,this.storageKey+"-user"),this.userStorage&&await ps(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Zn()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Xi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((a.expires_at*1e3-t)/Xi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Xi}ms, refresh threshold is ${E0} ticks`),o<=E0&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Z1)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Zn()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,a){const o=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&o.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[c,d]=await Wi(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(d)}`});o.push(f.toString())}if(a?.queryParams){const c=new URLSearchParams(a.queryParams);o.push(c.toString())}return a?.skipBrowserRedirect&&o.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${t}?${o.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var a;const{data:o,error:c}=r;return c?{data:null,error:c}:await Mt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(a=o?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(kt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var a,o;const{data:c,error:d}=r;if(d)return{data:null,error:d};const f=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:p,error:h}=await Mt(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(a=c?.session)===null||a===void 0?void 0:a.access_token});return h?{data:null,error:h}:(t.factorType==="totp"&&(!((o=p?.totp)===null||o===void 0)&&o.qr_code)&&(p.totp.qr_code=`data:image/svg+xml;utf-8,${p.totp.qr_code}`),{data:p,error:null})})}catch(r){if(kt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:o,error:c}=r;if(c)return{data:null,error:c};const{data:d,error:f}=await Mt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(a=o?.session)===null||a===void 0?void 0:a.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:f})})}catch(r){if(kt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:o,error:c}=r;return c?{data:null,error:c}:await Mt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(a=o?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(kt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:a}=await this._challenge({factorId:t.factorId});return a?{data:null,error:a}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const a=t?.factors||[],o=a.filter(d=>d.factor_type==="totp"&&d.status==="verified"),c=a.filter(d=>d.factor_type==="phone"&&d.status==="verified");return{data:{all:a,totp:o,phone:c},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,a;const{data:{session:o},error:c}=t;if(c)return{data:null,error:c};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=r0(o.access_token);let f=null;d.aal&&(f=d.aal);let p=f;((a=(r=o.user.factors)===null||r===void 0?void 0:r.filter(y=>y.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(p="aal2");const x=d.amr||[];return{data:{currentLevel:f,nextLevel:p,currentAuthenticationMethods:x},error:null}}))}async fetchJwk(t,r={keys:[]}){let a=r.keys.find(f=>f.kid===t);if(a)return a;const o=Date.now();if(a=this.jwks.keys.find(f=>f.kid===t),a&&this.jwks_cached_at+Mw>o)return a;const{data:c,error:d}=await Mt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(d)throw d;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=o,a=c.keys.find(f=>f.kid===t),!a)?null:a}async getClaims(t,r={}){try{let a=t;if(!a){const{data:v,error:w}=await this.getSession();if(w||!v.session)return{data:null,error:w};a=v.session.access_token}const{header:o,payload:c,signature:d,raw:{header:f,payload:p}}=r0(a);r?.allowExpired||a4(c.exp);const h=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!h){const{error:v}=await this.getUser(a);if(v)throw v;return{data:{claims:c,header:o,signature:d},error:null}}const x=s4(o.alg),y=await crypto.subtle.importKey("jwk",h,x,!0,["verify"]);if(!await crypto.subtle.verify(x,y,d,Hw(`${f}.${p}`)))throw new C0("Invalid JWT signature");return{data:{claims:c,header:o,signature:d},error:null}}catch(a){if(kt(a))return{data:null,error:a};throw a}}}Tl.nextInstanceID=0;const _4=Tl;class S4 extends _4{constructor(t){super(t)}}var w4=function(e,t,r,a){function o(c){return c instanceof r?c:new r(function(d){d(c)})}return new(r||(r=Promise))(function(c,d){function f(x){try{h(a.next(x))}catch(y){d(y)}}function p(x){try{h(a.throw(x))}catch(y){d(y)}}function h(x){x.done?c(x.value):o(x.value).then(f,p)}h((a=a.apply(e,t||[])).next())})};class T4{constructor(t,r,a){var o,c,d;this.supabaseUrl=t,this.supabaseKey=r;const f=Aw(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",f),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",f),this.storageUrl=new URL("storage/v1",f),this.functionsUrl=new URL("functions/v1",f);const p=`sb-${f.hostname.split(".")[0]}-auth-token`,h={db:vw,realtime:_w,auth:Object.assign(Object.assign({},bw),{storageKey:p}),global:yw},x=Cw(a??{},h);this.storageKey=(o=x.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(c=x.global.headers)!==null&&c!==void 0?c:{},x.accessToken?(this.accessToken=x.accessToken,this.auth=new Proxy({},{get:(y,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((d=x.auth)!==null&&d!==void 0?d:{},this.headers,x.global.fetch),this.fetch=Ew(r,this._getAccessToken.bind(this),x.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},x.realtime)),this.rest=new PS(new URL("rest/v1",f).href,{headers:this.headers,schema:x.db.schema,fetch:this.fetch}),this.storage=new gw(this.storageUrl.href,this.headers,this.fetch,a?.storage),x.accessToken||this._listenForAuthEvents()}get functions(){return new AS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},a={}){return this.rest.rpc(t,r,a)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return w4(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(r=(t=a.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:o,userStorage:c,storageKey:d,flowType:f,lock:p,debug:h},x,y){const b={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new S4({url:this.authUrl.href,headers:Object.assign(Object.assign({},b),x),storageKey:d,autoRefreshToken:t,persistSession:r,detectSessionInUrl:a,storage:o,userStorage:c,flowType:f,lock:p,debug:h,fetch:y,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new rw(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(t,r,a){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const E4=(e,t,r)=>new T4(e,t,r);function k4(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}k4()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const j4="https://wuluriiajnaruvaldlhb.supabase.co",C4="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind1bHVyaWlham5hcnV2YWxkbGhiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc4MDc4OTQsImV4cCI6MjA3MzM4Mzg5NH0.-Dx4fALDwoKHjsxOy1hKsME_DG4ZCQi2PdLCq5wV_hI",A4=async(e,t)=>{const r=e instanceof Request?e:void 0,a=r?.url??(typeof e=="string"?e:e instanceof URL?e.toString():""),o=(t?.method??r?.method??"GET").toUpperCase();if(a.includes("/rest/v1"))try{const{pathname:c}=new URL(a);console.info("[supabase]",o,c),c.includes("pg_timezone_names")&&console.trace("Timezone list requested from Supabase")}catch{console.info("[supabase]",o,a)}return fetch(e,t)},Oe=E4(j4,C4,{global:{fetch:A4}}),A0=e=>{let t=0;for(let r=0;r<e.length;r++){const a=e.charCodeAt(r);t=(t<<5)-t+a,t=t&t}return t.toString()},ey=j.createContext(void 0),xa=()=>{const e=j.useContext(ey);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},R4=({children:e})=>{const[t,r]=j.useState(null),[a,o]=j.useState(null),[c,d]=j.useState(!0);j.useEffect(()=>{const b=setTimeout(()=>{c&&d(!1)},3e4);(async()=>{try{const{data:{session:_},error:T}=await Oe.auth.getSession();if(_?.user)o(_.user),await f(_.user.id);else{const M=localStorage.getItem("pos_user");M&&r(JSON.parse(M))}}catch{}finally{d(!1)}})();const{data:{subscription:w}}=Oe.auth.onAuthStateChange(async(_,T)=>{if(_==="SIGNED_IN"&&T?.user){o(T.user);try{await f(T.user.id)}catch{}}else _==="SIGNED_OUT"?(o(null),r(null),localStorage.removeItem("pos_user")):_==="TOKEN_REFRESHED"&&T?.user&&o(T.user)});return()=>{clearTimeout(b),w.unsubscribe()}},[]);const f=async b=>{try{const{data:v,error:w}=await Oe.from("users").select("*").eq("user_id",parseInt(b)).single();if(w){console.error("Error loading user:",w),r(null);return}r(v),localStorage.setItem("pos_user",JSON.stringify(v))}catch(v){console.error("Error in loadUserProfile:",v),r(null)}},p=async(b,v)=>{try{d(!0);const w=await h(b,v);return w&&localStorage.setItem("lastLogin",new Date().toLocaleString()),w}catch{return!1}finally{d(!1)}},h=async(b,v)=>{try{const w=A0(v),{data:_,error:T}=await Oe.from("users").select("*").eq("username",b).eq("password_hash",w).eq("active",!0).single();if(T||!_)return!1;const M={user_id:_.user_id,username:_.username,role:_.role,active:_.active,icon:_.icon};return r(M),localStorage.setItem("pos_user",JSON.stringify(M)),localStorage.setItem("lastLogin",new Date().toLocaleString()),localStorage.setItem("lastPassword",v),window.location.href="/",!0}catch{return!1}},y={user:t,supabaseUser:a,login:p,logout:async()=>{try{a&&await Oe.auth.signOut(),r(null),o(null),localStorage.removeItem("pos_user"),localStorage.removeItem("lastPassword")}catch{}},loading:c,currentUserId:a?.id||t?.user_id?.toString()};return i.jsx(ey.Provider,{value:y,children:e})},ty=j.createContext(void 0),D4=({children:e})=>{const[t,r]=j.useState(!1);return i.jsx(ty.Provider,{value:{isCollapsed:t,setIsCollapsed:r},children:e})},X0=()=>{const e=j.useContext(ty);if(e===void 0)throw new Error("useNav must be used within a NavProvider");return e},Nm={Admin:{canManageUsers:!0,canManageProducts:!0,canProcessSales:!0,canViewReports:!0,canChangeSettings:!0,canUploadImages:!0,canLookupProducts:!0,canLookupCustomers:!0},Manager:{canManageUsers:!1,canManageProducts:!0,canProcessSales:!0,canViewReports:!0,canChangeSettings:!1,canUploadImages:!0,canLookupProducts:!0,canLookupCustomers:!0},Cashier:{canManageUsers:!1,canManageProducts:!1,canProcessSales:!0,canViewReports:!1,canChangeSettings:!1,canUploadImages:!1,canLookupProducts:!0,canLookupCustomers:!0}},ry=j.createContext(void 0),N4=({children:e})=>{const{user:t}=xa(),r=t?.role||"Cashier",a=Nm[r]||Nm.Cashier,o=f=>a[f]||!1,d={userRole:r,permissions:a,hasPermission:o,canAccessRoute:f=>{switch(f){case"/admin":return o("canManageUsers");case"/products":return o("canManageProducts")||o("canLookupProducts");case"/sales":return o("canProcessSales");case"/customers":return o("canLookupCustomers");case"/":return!0;default:return!0}}};return i.jsx(ry.Provider,{value:d,children:e})},K0=()=>{const e=j.useContext(ry);if(e===void 0)throw new Error("useRole must be used within a RoleProvider");return e},O4=j.createContext(void 0),M4=({children:e})=>{const[t,r]=j.useState(null),[a,o]=j.useState(!1);j.useEffect(()=>{const f=sessionStorage.getItem("pin_validated");r(f==="true")},[]);const c=async f=>{o(!0);const p="1967";return await new Promise(h=>setTimeout(h,500)),f===p?(r(!0),sessionStorage.setItem("pin_validated","true"),o(!1),!0):(r(!1),o(!1),!1)},d=f=>{r(f)};return i.jsx(O4.Provider,{value:{isPinValid:t,isCheckingPin:a,validatePin:c,setPinValid:d},children:e})},B4=()=>{const{isCollapsed:e,setIsCollapsed:t}=X0();j.useEffect(()=>{const r=o=>{if(e)return;const c=document.querySelector("nav");if(c&&c.contains(o.target))return;o.target.closest('button, a, input, select, textarea, [role="button"], [onclick]')||t(!0)},a=setTimeout(()=>{document.addEventListener("click",r)},100);return()=>{clearTimeout(a),document.removeEventListener("click",r)}},[e,t])},I4=()=>{const[e,t]=j.useState(""),[r,a]=j.useState(""),[o,c]=j.useState(""),[d,f]=j.useState(!1),{login:p,loading:h}=xa(),x=async y=>{if(y.preventDefault(),c(""),!e||!r){c("Please enter both username and password");return}await p(e,r)||c("Invalid username or password")};return i.jsxs("div",{style:{minHeight:"100vh",height:"100vh",width:"100%",display:"flex",fontFamily:"Quicksand, Comfortaa, sans-serif"},children:[i.jsxs("div",{style:{flex:"0 0 45%",background:"#f8fafc",display:"flex",flexDirection:"column",justifyContent:"center",padding:"60px 80px",position:"relative"},children:[i.jsxs("div",{style:{marginBottom:"40px",maxWidth:"320px",margin:"0 auto 40px auto"},children:[i.jsx("div",{style:{width:"40px",height:"40px",background:"#1a1a1a",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"24px"},children:i.jsx("i",{className:"fa-solid fa-bolt",style:{color:"#ffffff",fontSize:"20px"}})}),i.jsx("h1",{style:{fontSize:"32px",fontWeight:"700",color:"#1a1a1a",marginBottom:"8px",lineHeight:"1.2"},children:"Welcome back!"}),i.jsx("p",{style:{fontSize:"16px",color:"#6b7280",margin:0,lineHeight:"1.5"},children:"Your business, your team, your flow  all in one place."})]}),i.jsxs("form",{style:{display:"flex",flexDirection:"column",gap:"20px",maxWidth:"320px",margin:"0 auto",width:"100%"},onSubmit:x,children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"username",style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Username"}),i.jsx("input",{id:"username",name:"username",type:"text",required:!0,style:{width:"100%",padding:"14px 16px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"16px",color:"#1a1a1a",background:"#ffffff",outline:"none",transition:"border-color 0.2s ease, box-shadow 0.2s ease",boxSizing:"border-box"},onFocus:y=>{y.target.style.borderColor="#3b82f6",y.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:y=>{y.target.style.borderColor="#d1d5db",y.target.style.boxShadow="none"},placeholder:"Enter your username",value:e,onChange:y=>t(y.target.value),disabled:h})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#374151",marginBottom:"8px"},children:"Password"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("input",{id:"password",name:"password",type:d?"text":"password",required:!0,style:{width:"100%",padding:"14px 16px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"16px",color:"#1a1a1a",background:"#ffffff",outline:"none",transition:"border-color 0.2s ease, box-shadow 0.2s ease",boxSizing:"border-box"},onFocus:y=>{y.target.style.borderColor="#3b82f6",y.target.style.boxShadow="0 0 0 3px rgba(59, 130, 246, 0.1)"},onBlur:y=>{y.target.style.borderColor="#d1d5db",y.target.style.boxShadow="none"},placeholder:"Enter your password",value:r,onChange:y=>a(y.target.value),disabled:h}),i.jsx("div",{style:{position:"absolute",top:"50%",right:"12px",transform:"translateY(-50%)",cursor:"pointer"},onClick:()=>f(!d),children:i.jsx("i",{className:d?"fa-solid fa-eye-slash":"fa-solid fa-eye",style:{color:"#6b7280",fontSize:"16px"}})})]})]}),o&&i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626",padding:"12px 16px",borderRadius:"8px",fontSize:"14px"},children:o}),i.jsx("button",{type:"submit",disabled:h,style:{width:"100%",padding:"16px 24px",background:"#1a1a1a",color:"#ffffff",border:"none",borderRadius:"8px",fontSize:"16px",fontWeight:"600",cursor:h?"not-allowed":"pointer",opacity:h?.7:1,transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",marginTop:"8px",boxSizing:"border-box"},children:h?i.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{color:"#ffffff",fontSize:"16px",marginRight:"8px",animation:"spin 1s linear infinite"}}),"Signing in..."]}):"Log In"}),localStorage.getItem("pos_user")&&i.jsx("div",{style:{textAlign:"center",marginTop:"16px"},children:i.jsxs("button",{type:"button",onClick:async()=>{const y=JSON.parse(localStorage.getItem("pos_user")||"{}"),b=localStorage.getItem("lastPassword");y.username&&b?await p(y.username,b)||c("Auto-login failed. Please enter credentials manually."):c("No stored credentials found.")},disabled:h,style:{background:"none",border:"none",color:"#3b82f6",fontSize:"12px",cursor:"pointer",textDecoration:"underline"},children:["Last login: ",localStorage.getItem("lastLogin")||"Never"," (Click to auto-login)"]})})]})]}),i.jsx("div",{style:{flex:"0 0 50%",background:"#f8fafc",backgroundImage:"url(/images/backgrounds/login_bg.png)",backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",display:"flex",alignItems:"center",justifyContent:"center",position:"relative",overflow:"hidden"}})]})},F4=({children:e})=>{const{user:t,supabaseUser:r,loading:a}=xa();return a?i.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-400 mb-4",children:"Loading..."})]})}):!t&&!r?i.jsx(I4,{}):i.jsx(i.Fragment,{children:e})},ed=({children:e,requiredPermission:t,fallbackRoute:r="/"})=>{const a=ia(),{canAccessRoute:o,hasPermission:c}=K0();return o(a.pathname)?t&&!c(t)?i.jsx(im,{to:r,replace:!0}):i.jsx(i.Fragment,{children:e}):i.jsx(im,{to:r,replace:!0})},L4=()=>{const e=ia(),{user:t,logout:r}=xa(),{isCollapsed:a,setIsCollapsed:o}=X0(),{canAccessRoute:c,userRole:d}=K0(),p=[{path:"/",label:"Dashboard",icon:"fas fa-home"},{path:"/products",label:"Products",icon:"fas fa-box"},{path:"/sales",label:"Sales",icon:"fas fa-dollar-sign"},{path:"/transactions",label:"Transactions",icon:"fas fa-receipt"},{path:"/side-businesses",label:"Side Businesses",icon:"fas fa-briefcase"},{path:"/reminders",label:"Reminders",icon:"fas fa-sticky-note"},{path:"/admin",label:"Admin",icon:"fas fa-users-cog"}].filter(x=>c(x.path)),h=x=>{switch(x){case"Admin":return"#ef4444";case"Manager":return"#f59e0b";case"Cashier":return"#3b82f6";default:return"#6b7280"}};return i.jsxs("nav",{style:{width:a?"60px":"160px",height:"100vh",background:"#1a1a1a",borderRight:"1px solid #333333",display:"flex",flexDirection:"column",position:"fixed",left:0,top:0,zIndex:50,padding:a?"20px 8px 20px 8px":"20px 12px 20px 12px",boxShadow:"2px 0 8px rgba(0, 0, 0, 0.3)",transition:"width 0.3s ease, padding 0.3s ease"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:a?"center":"flex-start",gap:"12px",marginBottom:"32px",paddingBottom:"16px",borderBottom:"1px solid #333333"},children:[i.jsx("div",{onClick:()=>o(!a),style:{width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:"4px",transition:"background 0.2s ease"},onMouseEnter:x=>x.target.style.setProperty("background-color","#333333"),onMouseLeave:x=>x.target.style.setProperty("background-color","transparent"),children:i.jsx("div",{style:{width:"16px",height:"2px",background:"#ffffff",position:"relative",transition:"transform 0.3s ease"},children:i.jsx("div",{style:{position:"absolute",top:"6px",left:0,width:"16px",height:"2px",background:"#ffffff",transition:"transform 0.3s ease"}})})}),!a&&i.jsx("h1",{style:{color:"#ffffff",fontSize:"16px",fontWeight:"bold",margin:0,transition:"opacity 0.3s ease"},children:"Retail POS"})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px",flex:1,overflowY:"auto"},children:p.map(x=>i.jsxs($0,{to:x.path,style:{display:"flex",alignItems:"center",justifyContent:a?"center":"flex-start",gap:"12px",padding:a?"12px 8px":"12px 16px",borderRadius:"8px",textDecoration:"none",transition:"all 0.2s ease",background:e.pathname===x.path?"#333333":"transparent",color:e.pathname===x.path?"#ffffff":"#cccccc"},onMouseEnter:y=>{e.pathname!==x.path&&(y.target.style.backgroundColor="#333333"(y.target).style.color="#ffffff")},onMouseLeave:y=>{e.pathname!==x.path&&(y.target.style.backgroundColor="transparent"(y.target).style.color="#cccccc")},children:[i.jsx("i",{className:x.icon,style:{fontSize:"16px",width:"20px"}}),!a&&i.jsx("span",{style:{fontSize:"13px",fontWeight:"500",transition:"opacity 0.3s ease"},children:x.label})]},x.path))}),i.jsxs("div",{style:{padding:"8px 0",borderTop:"1px solid #333333",display:"flex",flexDirection:"column",gap:"8px",alignItems:a?"center":"stretch"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:a?"center":"flex-start",gap:"12px",padding:a?"8px":"8px 12px",borderRadius:"8px",background:"#333333",cursor:"pointer",transition:"background 0.2s ease",width:a?"44px":"auto"},onMouseEnter:x=>x.target.style.setProperty("background-color","#444444"),onMouseLeave:x=>x.target.style.setProperty("background-color","#333333"),children:[i.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#ffffff",display:"flex",alignItems:"center",justifyContent:"center",color:"#1a1a1a",fontSize:"14px",fontWeight:"bold"},children:t?.username?.charAt(0).toUpperCase()}),!a&&i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{color:"#ffffff",fontSize:"14px",fontWeight:"500",margin:0,lineHeight:"1.2",transition:"opacity 0.3s ease"},children:t?.username}),i.jsx("p",{style:{color:h(d),fontSize:"12px",margin:0,textTransform:"capitalize",transition:"opacity 0.3s ease",fontWeight:"500"},children:d})]})]}),i.jsxs("button",{onClick:async()=>{console.log("Logout button clicked"),await r()},style:{width:a?"44px":"100%",height:"40px",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",borderRadius:"8px",background:"#dc3545",border:"none",cursor:"pointer",transition:"background 0.2s ease, width 0.3s ease",color:"#ffffff",fontSize:"14px",fontWeight:"500"},onMouseEnter:x=>{const y=x.target;y.style.background="#c82333"},onMouseLeave:x=>{const y=x.target;y.style.background="#dc3545"},children:[i.jsx("i",{className:"fa-solid fa-sign-out-alt",style:{fontSize:"16px"}}),!a&&i.jsx("span",{style:{transition:"opacity 0.3s ease"},children:"Logout"})]})]})]})},un=(e,t={})=>{const r=typeof e=="number"&&isFinite(e)?e:0,{locale:a="en-IE",currency:o="EUR",minimumFractionDigits:c=2,maximumFractionDigits:d=2}=t;try{return new Intl.NumberFormat(a,{style:"currency",currency:o,minimumFractionDigits:c,maximumFractionDigits:d}).format(r)}catch{return`${o} ${r.toFixed(2)}`}},P4=(e,t={})=>{const r=typeof e=="number"&&isFinite(e)?e:0,{locale:a="en-IE",currency:o="EUR"}=t;try{return new Intl.NumberFormat(a,{style:"currency",currency:o,notation:"compact",maximumFractionDigits:1}).format(r)}catch{const c=Math.abs(r);return c>=1e6?`${un(r/1e6,{...t,maximumFractionDigits:1})}M`:c>=1e3?`${un(r/1e3,{...t,maximumFractionDigits:1})}K`:un(r,t)}},z4=()=>{const[e,t]=j.useState([]),[r,a]=j.useState(!0),[o,c]=j.useState(null),d=async()=>{try{a(!0),c(null);const{data:h,error:x}=await Oe.from("products").select("*").lt("stock_quantity",10).order("stock_quantity",{ascending:!0});if(x)throw x;t(h||[])}catch(h){console.error("Error fetching low stock items:",h),c(h instanceof Error?h.message:"Failed to fetch low stock items")}finally{a(!1)}},f=async(h,x)=>{try{c(null);const{error:y}=await Oe.from("products").update({stock_quantity:x,last_updated:new Date().toISOString()}).eq("product_id",h);if(y)throw y;const{error:b}=await Oe.from("inventory_movements").insert({product_id:h,quantity_change:x,movement_type:"Restock",datetime:new Date().toISOString()});return b&&console.warn("Failed to log inventory movement:",b),await d(),!0}catch(y){return console.error("Error restocking product:",y),c(y instanceof Error?y.message:"Failed to restock product"),!1}},p=async h=>{const x=e.find(b=>b.product_id===h);if(!x)return c("Product not found"),!1;const y=Math.max(x.reorder_level*2,20);return await f(h,y)};return j.useEffect(()=>{d()},[]),{lowStockItems:e,loading:r,error:o,fetchLowStockItems:d,restockProduct:f,quickRestock:p}},U4=({product:e,onRestock:t,onQuickRestock:r})=>{const[a,o]=j.useState(!1),[c,d]=j.useState(""),[f,p]=j.useState(!1),h=async()=>{p(!0);const v=await r(e.product_id);p(!1),v&&o(!1)},x=async()=>{const v=parseInt(c);if(isNaN(v)||v<=0)return;p(!0);const w=await t(e.product_id,v);p(!1),w&&(o(!1),d(""))},y=()=>e.stock_quantity<=2?"#ef4444":e.stock_quantity<=5?"#f59e0b":"#eab308",b=()=>e.stock_quantity<=2?"Critical":e.stock_quantity<=5?"Low":"Below Reorder";return i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"16px",border:"1px solid rgba(125, 141, 134, 0.2)",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",transition:"all 0.3s ease",position:"relative"},onMouseEnter:v=>{v.currentTarget.style.transform="translateY(-2px)",v.currentTarget.style.boxShadow="0 4px 16px rgba(62, 63, 41, 0.15)"},onMouseLeave:v=>{v.currentTarget.style.transform="translateY(0)",v.currentTarget.style.boxShadow="0 2px 8px rgba(62, 63, 41, 0.1)"},children:[i.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",background:y(),color:"white",padding:"4px 8px",borderRadius:"6px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase"},children:b()}),i.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"flex-start"},children:[i.jsxs("div",{style:{width:"60px",height:"60px",borderRadius:"8px",background:"#f9fafb",border:"1px solid rgba(125, 141, 134, 0.2)",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",flexShrink:0},children:[e.image_url?i.jsx("img",{src:e.image_url,alt:e.name,style:{width:"100%",height:"100%",objectFit:"cover"},onError:v=>{v.currentTarget.style.setProperty("display","none")(v.currentTarget.nextElementSibling).style.setProperty("display","flex")}}):null,i.jsx("div",{style:{display:e.image_url?"none":"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",color:"#7d8d86",fontSize:"20px"},children:i.jsx("i",{className:"fa-solid fa-box"})})]}),i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",color:"#3e3f29",margin:"0 0 4px 0",lineHeight:"1.3"},children:e.name}),i.jsx("p",{style:{fontSize:"12px",color:"#7d8d86",margin:"0 0 8px 0"},children:e.category}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[i.jsxs("span",{style:{fontSize:"12px",color:"#3e3f29",fontWeight:"500"},children:["Stock: ",e.stock_quantity]}),i.jsx("span",{style:{fontSize:"12px",color:"#7d8d86"},children:""}),i.jsxs("span",{style:{fontSize:"12px",color:"#7d8d86"},children:["Reorder at: ",e.reorder_level]})]}),a?i.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[i.jsx("input",{type:"number",value:c,onChange:v=>d(v.target.value),placeholder:"Qty",min:"1",style:{width:"60px",padding:"6px 8px",border:"1px solid #7d8d86",borderRadius:"6px",fontSize:"12px",outline:"none"}}),i.jsx("button",{onClick:x,disabled:f||!c,style:{background:"#7d8d86",color:"white",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"12px",fontWeight:"500",cursor:f||!c?"not-allowed":"pointer",opacity:f||!c?.7:1,transition:"all 0.2s ease"},onMouseEnter:v=>{!f&&c&&(v.currentTarget.style.background="#bca88d")},onMouseLeave:v=>{!f&&c&&(v.currentTarget.style.background="#7d8d86")},children:f?i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite"}}):"Restock"}),i.jsx("button",{onClick:()=>{o(!1),d("")},disabled:f,style:{background:"transparent",color:"#7d8d86",border:"none",fontSize:"12px",cursor:f?"not-allowed":"pointer",opacity:f?.7:1},children:"Cancel"})]}):i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsxs("button",{onClick:h,disabled:f,style:{background:"#10b981",color:"white",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"12px",fontWeight:"500",cursor:f?"not-allowed":"pointer",opacity:f?.7:1,transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"4px"},onMouseEnter:v=>{f||(v.currentTarget.style.background="#059669")},onMouseLeave:v=>{f||(v.currentTarget.style.background="#10b981")},children:[f?i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite"}}):i.jsx("i",{className:"fa-solid fa-bolt"}),"Quick Restock"]}),i.jsx("button",{onClick:()=>o(!0),disabled:f,style:{background:"transparent",color:"#7d8d86",border:"1px solid #7d8d86",borderRadius:"6px",padding:"6px 12px",fontSize:"12px",fontWeight:"500",cursor:f?"not-allowed":"pointer",opacity:f?.7:1,transition:"all 0.2s ease"},onMouseEnter:v=>{f||(v.currentTarget.style.background="#7d8d86",v.currentTarget.style.color="white")},onMouseLeave:v=>{f||(v.currentTarget.style.background="transparent",v.currentTarget.style.color="#7d8d86")},children:"Custom"})]})]})]})]})},W4=()=>{const{lowStockItems:e,loading:t,error:r,restockProduct:a,quickRestock:o}=z4(),[c,d]=j.useState(0),f=e[c]||null,p=c<e.length-1,h=c>0,x=()=>{p&&d(c+1)},y=()=>{h&&d(c-1)};return t?i.jsx("div",{style:{minHeight:"200px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#7d8d86",fontSize:"16px"},children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite",fontSize:"20px"}}),"Loading low stock items..."]})}):r?i.jsx("div",{style:{minHeight:"200px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{textAlign:"center",color:"#ef4444"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{fontSize:"24px",marginBottom:"8px"}}),i.jsx("p",{style:{margin:0,fontSize:"14px"},children:r})]})}):i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:e.length>0?"#fbbf24":"#10b981",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{fontSize:"18px",color:e.length>0?"#d97706":"#059669"}})}),i.jsxs("div",{children:[i.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",color:"#3e3f29",margin:"0 0 4px 0"},children:"Low Stock Items"}),i.jsxs("p",{style:{fontSize:"14px",color:"#7d8d86",margin:0},children:[e.length," item",e.length!==1?"s":""," need",e.length===1?"s":""," restocking"]})]})]}),e.length>1&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:y,disabled:!h,style:{background:h?"#7d8d86":"#e5e7eb",color:h?"#f1f0e4":"#9ca3af",border:"none",borderRadius:"6px",padding:"6px 8px",fontSize:"12px",cursor:h?"pointer":"not-allowed",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:b=>{h&&(b.currentTarget.style.background="#bca88d")},onMouseLeave:b=>{h&&(b.currentTarget.style.background="#7d8d86")},children:i.jsx("i",{className:"fa-solid fa-chevron-left"})}),i.jsxs("span",{style:{fontSize:"12px",color:"#7d8d86",fontWeight:"500",minWidth:"40px",textAlign:"center"},children:[c+1," / ",e.length]}),i.jsx("button",{onClick:x,disabled:!p,style:{background:p?"#7d8d86":"#e5e7eb",color:p?"#f1f0e4":"#9ca3af",border:"none",borderRadius:"6px",padding:"6px 8px",fontSize:"12px",cursor:p?"pointer":"not-allowed",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:b=>{p&&(b.currentTarget.style.background="#bca88d")},onMouseLeave:b=>{p&&(b.currentTarget.style.background="#7d8d86")},children:i.jsx("i",{className:"fa-solid fa-chevron-right"})})]})]}),e.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"40px 20px",color:"#7d8d86"},children:[i.jsx("i",{className:"fa-solid fa-check-circle",style:{fontSize:"48px",marginBottom:"16px",color:"#10b981"}}),i.jsx("p",{style:{fontSize:"16px",margin:0,fontWeight:"500"},children:"All items are well stocked!"}),i.jsx("p",{style:{fontSize:"14px",margin:"8px 0 0 0",opacity:.8},children:"No items need restocking at the moment."})]}):f?i.jsx(U4,{product:f,onRestock:a,onQuickRestock:o},f.product_id):null]})},$4=e=>{const[t,r]=j.useState([]),[a,o]=j.useState([]),[c,d]=j.useState([]),[f,p]=j.useState(!0),[h,x]=j.useState(null),y=w=>{const _=e||new Date;switch(w){case"today":const T=_.toISOString().split("T")[0];return{start:`${T}T00:00:00`,end:`${T}T23:59:59`};case"week":const M=new Date(_);M.setDate(_.getDate()-_.getDay()),M.setHours(0,0,0,0);const F=new Date(M);return F.setDate(M.getDate()+6),F.setHours(23,59,59,999),{start:M.toISOString(),end:F.toISOString()};case"month":const A=new Date(_.getFullYear(),_.getMonth(),1);A.setHours(0,0,0,0);const U=new Date(_.getFullYear(),_.getMonth()+1,0);return U.setHours(23,59,59,999),{start:A.toISOString(),end:U.toISOString()};default:return{start:"",end:""}}},b=async w=>{try{const{start:_,end:T}=y(w);console.log(`Fetching ${w} analytics from ${_} to ${T}`);const{data:M,error:F}=await Oe.from("sale_items").select(`
          quantity,
          price_each,
          products (product_id, name, image_url),
          sales!inner (datetime)
        `).gte("sales.datetime",_).lt("sales.datetime",T);if(F)throw console.error(`Error fetching ${w} analytics:`,F),F;console.log(`${w} analytics data:`,M);const A=new Map;(M||[]).forEach(V=>{const te=V.products?.product_id,N=V.products?.name,re=V.products?.image_url;if(te&&N)if(A.has(te)){const L=A.get(te);L.quantity_sold+=V.quantity,L.total_sales+=V.quantity*V.price_each}else A.set(te,{product_id:te,product_name:N,quantity_sold:V.quantity,total_sales:V.quantity*V.price_each,image_url:re})});const U=Array.from(A.values()).sort((V,te)=>te.total_sales-V.total_sales).slice(0,5);return console.log(`${w} sorted products:`,U),U}catch(_){throw console.error(`Error fetching ${w} product analytics:`,_),_}},v=async()=>{try{p(!0),x(null);const[w,_,T]=await Promise.all([b("today").catch(()=>[]),b("week").catch(()=>[]),b("month").catch(()=>[])]);r(w),o(_),d(T)}catch(w){console.error("Error fetching product analytics:",w),x(w instanceof Error?w.message:"Failed to fetch product analytics")}finally{p(!1)}};return j.useEffect(()=>{v()},[e]),{todayProducts:t,weekProducts:a,monthProducts:c,loading:f,error:h,refetch:v}},H4=({activePeriod:e,selectedDate:t})=>{const{todayProducts:r,weekProducts:a,monthProducts:o,loading:c,error:d}=$4(t),[f,p]=j.useState(e??"today");j.useEffect(()=>{e&&p(e)},[e]);const h=v=>{switch(v){case"today":return r;case"week":return a;case"month":return o}},x=v=>{switch(v){case"today":if(t){const w=new Date;return t.toDateString()===w.toDateString()?"Today":t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}return"Today";case"week":return"This Week";case"month":return"This Month"}},y=["today","week","month"],b=h(f);return c?i.jsxs("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",border:"2px solid #d1d5db",borderWidth:"2px",borderStyle:"solid",borderColor:"#d1d5db"},children:[i.jsx("style",{children:"@keyframes shimmer{0%{background-position:-400px 0}100%{background-position:400px 0}} .skeleton{background-image:linear-gradient(90deg,#e5e7eb 0px,#f3f4f6 40px,#e5e7eb 80px);background-size:600px 100%;animation:shimmer 1.2s infinite linear;border-radius:8px}"}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[i.jsx("div",{className:"skeleton",style:{width:"40px",height:"40px"}}),i.jsx("div",{className:"skeleton",style:{width:"160px",height:"18px"}})]}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:[i.jsx("div",{className:"skeleton",style:{width:"80px",height:"28px"}}),i.jsx("div",{className:"skeleton",style:{width:"100px",height:"28px"}}),i.jsx("div",{className:"skeleton",style:{width:"100px",height:"28px"}})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:Array.from({length:5}).map((v,w)=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",border:"1px solid rgba(125,141,134,0.1)",borderRadius:"8px"},children:[i.jsx("div",{className:"skeleton",style:{width:"32px",height:"32px"}}),i.jsx("div",{className:"skeleton",style:{width:"40px",height:"40px"}}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{className:"skeleton",style:{width:"160px",height:"12px",marginBottom:"6px"}}),i.jsx("div",{className:"skeleton",style:{width:"100px",height:"10px"}})]}),i.jsx("div",{className:"skeleton",style:{width:"70px",height:"14px"}})]},w))})]}):d?i.jsx("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",border:"2px solid #d1d5db",borderWidth:"2px",borderStyle:"solid",borderColor:"#d1d5db",minHeight:"120px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsxs("div",{style:{textAlign:"center",color:"#ef4444"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{fontSize:"24px",marginBottom:"8px"}}),i.jsx("p",{style:{margin:0,fontSize:"14px"},children:d})]})}):i.jsxs("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",border:"2px solid #d1d5db",borderWidth:"2px",borderStyle:"solid",borderColor:"#d1d5db"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"16px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"#bca88d",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-chart-line",style:{fontSize:"18px",color:"#3e3f29"}})}),i.jsx("h3",{style:{fontSize:"20px",fontWeight:600,color:"#3e3f29",margin:0},children:"Top Products"})]}),i.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:y.map(v=>i.jsxs("button",{onClick:()=>p(v),style:{padding:"6px 12px",borderRadius:"6px",border:"1px solid #d1d5db",background:f===v?"#7d8d86":"#ffffff",color:f===v?"#f1f0e4":"#7d8d86",fontSize:"12px",fontWeight:600,cursor:"pointer"},children:[i.jsx("i",{className:`fa-solid ${v==="today"?"fa-calendar-day":v==="week"?"fa-calendar-week":"fa-calendar"}`,style:{fontSize:"12px",marginRight:6}}),x(v)]},v))}),b.length===0?i.jsxs("div",{style:{textAlign:"center",color:"#7d8d86",padding:"16px"},children:["No products for ",x(f)]}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:b.slice(0,3).map((v,w)=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"white",borderRadius:"8px",border:"1px solid rgba(125, 141, 134, 0.1)"},children:[i.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:w===0?"#fbbf24":w===1?"#e5e7eb":w===2?"#f59e0b":"#7d8d86",display:"flex",alignItems:"center",justifyContent:"center",color:w===1?"#6b7280":"#3e3f29",fontSize:"12px",fontWeight:700},children:w===0?i.jsx("i",{className:"fa-solid fa-crown",style:{fontSize:14}}):w+1}),i.jsx("div",{style:{width:40,height:40,borderRadius:8,background:"#f9fafb",border:"1px solid #e5e7eb",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:v.image_url?i.jsx("img",{src:v.image_url,alt:v.product_name,style:{width:"100%",height:"100%",objectFit:"cover"}}):i.jsx("i",{className:"fa-solid fa-box",style:{color:"#7d8d86"}})}),i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsx("p",{style:{fontSize:14,fontWeight:600,color:"#3e3f29",margin:"0 0 2px 0"},children:v.product_name}),i.jsxs("p",{style:{fontSize:12,color:"#7d8d86",margin:0},children:[v.quantity_sold," sold"]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx("p",{style:{fontSize:14,fontWeight:600,color:"#10b981",margin:0},children:un(v.total_sales)}),w===0&&i.jsx("p",{style:{fontSize:10,color:"#d97706",margin:"2px 0 0 0",fontWeight:500},children:"TOP SELLER"})]})]},v.product_id))})]})},q4=()=>{const[e,t]=j.useState([]),[r,a]=j.useState([]),[o,c]=j.useState([]),[d,f]=j.useState(!0),[p,h]=j.useState(null),x=U=>{const V=U.getFullYear(),te=String(U.getMonth()+1).padStart(2,"0"),N=String(U.getDate()).padStart(2,"0");return`${V}-${te}-${N}`},y=(U=0)=>{const V=new Date,te=V.getDay(),N=new Date(V);N.setDate(V.getDate()-te+U*7),N.setHours(0,0,0,0);const re=[],L=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];for(let X=0;X<7;X++){const le=new Date(N);le.setDate(N.getDate()+X),re.push({day:L[X],date:x(le),fullDate:le})}return re},b=()=>{const U=[];for(let V=10;V<=20;V++){const te=V===12?"12 PM":V>12?`${V-12} PM`:`${V} AM`;U.push({hour:V,hourLabel:te,startTime:`${V.toString().padStart(2,"0")}:00:00`,endTime:`${(V+1).toString().padStart(2,"0")}:00:00`})}return U},v=async(U=0)=>{try{const V=y(U),te=[];for(const{day:N,date:re,fullDate:L}of V){const X=`${re}T00:00:00`,le=`${re}T23:59:59`,{data:ge,error:Re}=await Oe.from("sales").select("total_amount, datetime").gte("datetime",X).lt("datetime",le);Re&&console.error(`Error fetching sales for ${N}:`,Re);const{data:fe,error:Ae}=await Oe.from("side_business_sales").select("total_amount, date_time").gte("date_time",X).lt("date_time",le);Ae&&console.error(`Error fetching side business sales for ${N}:`,Ae);const ee=ge?.reduce((K,Y)=>K+(Y.total_amount||0),0)||0,ye=fe?.reduce((K,Y)=>K+(Y.total_amount||0),0)||0,ae=ee+ye,Se=ge?.length||0,k=fe?.length||0,J=Se+k,O=J>0?ae/J:0;te.push({day:N,date:re,totalSales:ae,transactionCount:J,averageTransaction:O})}t(te)}catch(V){throw console.error("Error fetching weekly sales:",V),V}},w=async U=>{try{const V=b(),te=[];for(const{hour:N,hourLabel:re,startTime:L,endTime:X}of V){const le=`${U}T${L}`,ge=`${U}T${X}`,{data:Re,error:fe}=await Oe.from("sales").select("total_amount, datetime").gte("datetime",le).lt("datetime",ge);fe&&console.error(`Error fetching hourly sales for ${N}:00:`,fe);const{data:Ae,error:ee}=await Oe.from("side_business_sales").select("total_amount, date_time").gte("date_time",le).lt("date_time",ge);ee&&console.error(`Error fetching hourly side business sales for ${N}:00:`,ee);const ye=Re?.reduce((K,Y)=>K+(Y.total_amount||0),0)||0,ae=Ae?.reduce((K,Y)=>K+(Y.total_amount||0),0)||0,Se=ye+ae,k=Re?.length||0,J=Ae?.length||0,O=k+J;(Se>0||O>0)&&console.log(`Hour ${N}:00 - Sales: ${Se.toFixed(2)}, Transactions: ${O}`),te.push({hour:N,hourLabel:re,totalSales:Se,transactionCount:O})}a(te)}catch(V){throw console.error("Error fetching hourly sales:",V),V}},_=async()=>{try{f(!0),h(null),await Promise.all([v(),w(x(new Date)),F()])}catch(U){console.error("Error fetching sales analytics:",U),h(U instanceof Error?U.message:"Failed to fetch sales analytics")}finally{f(!1)}},T=async U=>{try{await w(U)}catch(V){console.error("Error refreshing hourly data:",V),h(V instanceof Error?V.message:"Failed to refresh hourly data")}},M=async(U=0)=>{try{await v(U)}catch(V){console.error("Error refreshing weekly data:",V),h(V instanceof Error?V.message:"Failed to refresh weekly data")}},F=async(U=0)=>{try{const V=new Date,te=new Date(V.getFullYear(),V.getMonth()+U,1),N=new Date(te.getFullYear(),te.getMonth()+1,1),re=`${x(te)}T00:00:00`,L=`${x(N)}T00:00:00`,[X,le]=await Promise.all([Oe.from("sales").select("total_amount, datetime").gte("datetime",re).lt("datetime",L),Oe.from("side_business_sales").select("total_amount, date_time").gte("date_time",re).lt("date_time",L)]),ge=new Date(te.getFullYear(),te.getMonth()+1,0).getDate(),Re={};for(let ee=1;ee<=ge;ee++)Re[ee]={total:0,count:0};const fe=(ee,ye)=>{const Se=new Date(ee).getDate();Re[Se]||(Re[Se]={total:0,count:0}),Re[Se].total+=ye||0,Re[Se].count+=1};(X.data||[]).forEach(ee=>fe(ee.datetime,ee.total_amount||0)),(le.data||[]).forEach(ee=>fe(ee.date_time,ee.total_amount||0));const Ae=[];for(let ee=1;ee<=ge;ee++){const ye=new Date(te.getFullYear(),te.getMonth(),ee),ae=Re[ee]||{total:0,count:0},Se=ae.total,k=ae.count;Ae.push({day:String(ee),date:x(ye),totalSales:Se,transactionCount:k,averageTransaction:k>0?Se/k:0})}c(Ae)}catch(V){throw console.error("Error fetching monthly sales:",V),V}},A=async(U=0)=>{try{await F(U)}catch(V){console.error("Error refreshing monthly data:",V),h(V instanceof Error?V.message:"Failed to refresh monthly data")}};return j.useEffect(()=>{_()},[]),{weeklyData:e,hourlyData:r,monthlyData:o,loading:d,error:p,refreshHourlyData:T,refreshWeeklyData:M,refreshMonthlyData:A,refetch:_}},G4=()=>{const[e,t]=j.useState(null),[r,a]=j.useState(!0),[o,c]=j.useState(null),d=async()=>{try{a(!0),c(null);const{data:f,error:p}=await Oe.from("business_info").select("*").order("business_id",{ascending:!0}).limit(1).single();if(p){console.error("Error fetching business info:",p),c(p.message);return}t(f)}catch(f){console.error("Error in fetchBusinessInfo:",f),c(f instanceof Error?f.message:"Failed to fetch business info")}finally{a(!1)}};return j.useEffect(()=>{d()},[]),{businessInfo:e,loading:r,error:o,refetch:d}},Y4=({selectedDate:e,activePeriod:t})=>{const{weeklyData:r,hourlyData:a,monthlyData:o,loading:c,error:d,refreshHourlyData:f,refreshWeeklyData:p,refreshMonthlyData:h}=q4(),{businessInfo:x}=G4(),[y,b]=j.useState("weekly"),[v,w]=j.useState(new Date().toISOString().split("T")[0]),[_,T]=j.useState(0),[M,F]=j.useState(0),[A,U]=j.useState({visible:!1,x:0,y:0,data:null}),V=async ae=>{w(ae),await f(ae)};j.useEffect(()=>{if(!e)return;const Se=(De=>`${De.getFullYear()}-${String(De.getMonth()+1).padStart(2,"0")}-${String(De.getDate()).padStart(2,"0")}`)(e);w(Se),f(Se);const k=De=>{const Be=new Date(De);return Be.setHours(0,0,0,0),Be.setDate(Be.getDate()-Be.getDay()),Be},J=k(e),O=new Date;O.setHours(0,0,0,0);const K=k(O),Y=J.getTime()-K.getTime(),H=Math.round(Y/(1e3*60*60*24)),pe=Math.round(H/7);T(pe),p(pe);const Ge=new Date,He=(e.getFullYear()-Ge.getFullYear())*12+(e.getMonth()-Ge.getMonth());F(He),h(He)},[e]),j.useEffect(()=>{t&&b(t==="today"?"hourly":t==="week"?"weekly":"monthly")},[t]);const te=async()=>{const ae=_-1;T(ae),await p(ae)},N=async()=>{const ae=_+1;T(ae),await p(ae)},re=async()=>{T(0),await p(0)},L=()=>{const ae=new Date,Se=ae.getDay(),k=new Date(ae);k.setDate(ae.getDate()-Se+_*7);const J=new Date(k);J.setDate(k.getDate()+6);const O=K=>K.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${O(k)} - ${O(J)}`},X=(ae,Se)=>{U({visible:!0,x:ae.clientX,y:ae.clientY,data:Se})},le=()=>{U({visible:!1,x:0,y:0,data:null})},ge=ae=>{const Se=Math.max(...ae.map(k=>k.totalSales));return Se===0?1:Math.ceil(Se*1.1)},Re=(ae,Se)=>ae===0?0:Math.max(ae/Se*180,4),fe=(ae,Se=!0)=>{if(Se){const k=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#f97316"];return k[ae%k.length]}else{const k=Math.min(ae/9,1),J=Math.floor(59+180*k),O=Math.floor(130+-62*k),K=Math.floor(246+-178*k);return`rgb(${J}, ${O}, ${K})`}};if(c)return i.jsx("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"32px",border:"2px solid #d1d5db",borderWidth:"2px",borderStyle:"solid",borderColor:"#d1d5db",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"400px"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#7d8d86",fontSize:"16px"},children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite",fontSize:"20px"}}),"Loading sales data..."]})});if(d)return i.jsx("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"32px",border:"2px solid #d1d5db",borderWidth:"2px",borderStyle:"solid",borderColor:"#d1d5db",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"400px"},children:i.jsxs("div",{style:{textAlign:"center",color:"#ef4444"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{fontSize:"24px",marginBottom:"8px"}}),i.jsx("p",{style:{margin:0,fontSize:"14px"},children:d})]})});const Ae=y==="weekly"?r:y==="monthly"?o:a,ee=Ae.length>0?ge(Ae):100,ye=y==="monthly"?Math.ceil(Ae.length/12):1;return Ae.length===0&&!c&&!d?i.jsxs("div",{style:{background:"#ffffff",borderRadius:"16px",padding:"32px",border:"5px solid #000000 !important",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",width:"100%",margin:"0",fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",textAlign:"center",minHeight:"400px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"24px"},children:[i.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"transparent",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:(x?.logo_url,i.jsx("img",{src:x?.logo_url||"/retailpos/images/backgrounds/logo1.png",alt:x?.name||"LandM Store Logo",style:{width:"100%",height:"100%",objectFit:"contain",borderRadius:"12px"},onError:ae=>{const Se=ae.target;Se.style.display="none";const k=Se.parentElement;k&&(k.innerHTML='<i class="fa-solid fa-chart-line" style="font-size: 20px; color: #7d8d86;"></i>')}}))}),i.jsxs("div",{children:[i.jsx("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#3e3f29",margin:"0 0 4px 0"},children:"Sales Overview"}),(x?.name||"LandM Store")&&i.jsx("p",{style:{fontSize:"14px",color:"#7d8d86",margin:0,fontWeight:"500"},children:x?.name||"LandM Store"})]})]}),i.jsxs("div",{style:{color:"#7d8d86",fontSize:"16px",marginBottom:"16px"},children:[i.jsx("i",{className:"fa-solid fa-chart-bar",style:{fontSize:"48px",marginBottom:"16px",opacity:.5}}),i.jsx("p",{style:{margin:"0 0 8px 0",fontSize:"18px",fontWeight:"500"},children:"No sales data available"}),i.jsx("p",{style:{margin:0,fontSize:"14px",opacity:.8},children:y==="weekly"?"No sales recorded for this week":"No sales recorded for this date"})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(-100%) scale(0.9); }
          to { opacity: 1; transform: translateY(-100%) scale(1); }
        }
      `}),i.jsxs("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"32px",border:"2px solid #d1d5db",borderWidth:"2px",borderStyle:"solid",borderColor:"#d1d5db",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",width:"100%",maxWidth:"1000px",margin:"0 auto",fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",marginBottom:"24px"},children:[i.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:"transparent",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden"},children:(x?.logo_url,i.jsx("img",{src:x?.logo_url||"/retailpos/images/backgrounds/logo1.png",alt:x?.name||"LandM Store Logo",style:{width:"100%",height:"100%",objectFit:"contain",borderRadius:"12px"},onError:ae=>{const Se=ae.target;Se.style.display="none";const k=Se.parentElement;k&&(k.innerHTML='<i class="fa-solid fa-chart-line" style="font-size: 20px; color: #7d8d86;"></i>')}}))}),i.jsxs("div",{children:[i.jsx("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#3e3f29",margin:"0 0 4px 0"},children:"Sales Overview"}),(x?.name||"LandM Store")&&i.jsx("p",{style:{fontSize:"14px",color:"#7d8d86",margin:0,fontWeight:"500"},children:x?.name||"LandM Store"})]})]}),i.jsxs("div",{style:{display:"flex",background:"#f9fafb",borderRadius:"8px",padding:"4px",gap:"4px",marginBottom:"24px",maxWidth:"300px",border:"2px solid #d1d5db"},children:[i.jsxs("button",{onClick:()=>b("weekly"),style:{flex:1,padding:"8px 16px",borderRadius:"6px",border:"none",background:y==="weekly"?"#7d8d86":"transparent",color:y==="weekly"?"#f1f0e4":"#7d8d86",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},onMouseEnter:ae=>{y!=="weekly"&&(ae.currentTarget.style.background="#e5e7eb",ae.currentTarget.style.color="#3e3f29")},onMouseLeave:ae=>{y!=="weekly"&&(ae.currentTarget.style.background="transparent",ae.currentTarget.style.color="#7d8d86")},children:[i.jsx("i",{className:"fa-solid fa-calendar-week",style:{fontSize:"12px"}}),"Weekly"]}),i.jsxs("button",{onClick:()=>b("hourly"),style:{flex:1,padding:"8px 16px",borderRadius:"6px",border:"none",background:y==="hourly"?"#7d8d86":"transparent",color:y==="hourly"?"#f1f0e4":"#7d8d86",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},onMouseEnter:ae=>{y!=="hourly"&&(ae.currentTarget.style.background="#e5e7eb",ae.currentTarget.style.color="#3e3f29")},onMouseLeave:ae=>{y!=="hourly"&&(ae.currentTarget.style.background="transparent",ae.currentTarget.style.color="#7d8d86")},children:[i.jsx("i",{className:"fa-solid fa-clock",style:{fontSize:"12px"}}),"Hourly"]}),i.jsxs("button",{onClick:()=>b("monthly"),style:{flex:1,padding:"8px 16px",borderRadius:"6px",border:"none",background:y==="monthly"?"#7d8d86":"transparent",color:y==="monthly"?"#f1f0e4":"#7d8d86",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},onMouseEnter:ae=>{y!=="monthly"&&(ae.currentTarget.style.background="#e5e7eb",ae.currentTarget.style.color="#3e3f29")},onMouseLeave:ae=>{y!=="monthly"&&(ae.currentTarget.style.background="transparent",ae.currentTarget.style.color="#7d8d86")},children:[i.jsx("i",{className:"fa-solid fa-calendar",style:{fontSize:"12px"}}),"Monthly"]})]}),y==="weekly"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"24px",padding:"12px 16px",background:"#f9fafb",borderRadius:"8px",border:"2px solid #d1d5db"},children:[i.jsxs("button",{onClick:te,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",borderRadius:"6px",border:"1px solid #d1d5db",background:"#ffffff",color:"#7d8d86",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:ae=>{ae.currentTarget.style.background="#f3f4f6",ae.currentTarget.style.borderColor="#7d8d86"},onMouseLeave:ae=>{ae.currentTarget.style.background="#ffffff",ae.currentTarget.style.borderColor="#d1d5db"},children:[i.jsx("i",{className:"fa-solid fa-chevron-left",style:{fontSize:"12px"}}),"Previous Week"]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#3e3f29",marginBottom:"2px"},children:L()}),i.jsx("button",{onClick:re,style:{fontSize:"12px",color:"#7d8d86",background:"transparent",border:"none",cursor:"pointer",textDecoration:"underline",transition:"color 0.2s ease"},onMouseEnter:ae=>{ae.currentTarget.style.color="#3e3f29"},onMouseLeave:ae=>{ae.currentTarget.style.color="#7d8d86"},children:_===0?"Current Week":"Go to Current Week"})]}),i.jsxs("button",{onClick:N,style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",borderRadius:"6px",border:"1px solid #d1d5db",background:"#ffffff",color:"#7d8d86",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:ae=>{ae.currentTarget.style.background="#f3f4f6",ae.currentTarget.style.borderColor="#7d8d86"},onMouseLeave:ae=>{ae.currentTarget.style.background="#ffffff",ae.currentTarget.style.borderColor="#d1d5db"},children:["Next Week",i.jsx("i",{className:"fa-solid fa-chevron-right",style:{fontSize:"12px"}})]})]}),y==="monthly"&&i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"24px",padding:"12px 16px",background:"#f9fafb",borderRadius:"8px",border:"2px solid #d1d5db"},children:[i.jsxs("button",{onClick:async()=>{const ae=M-1;F(ae),await h(ae)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",borderRadius:"6px",border:"1px solid #d1d5db",background:"#ffffff",color:"#7d8d86",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:[i.jsx("i",{className:"fa-solid fa-chevron-left",style:{fontSize:"12px"}}),"Previous Month"]}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#3e3f29",marginBottom:"2px"},children:new Date(new Date().getFullYear(),new Date().getMonth()+M,1).toLocaleDateString("en-US",{month:"short",year:"numeric"})}),i.jsx("button",{onClick:async()=>{F(0),await h(0)},style:{fontSize:"12px",color:"#7d8d86",background:"transparent",border:"none",cursor:"pointer",textDecoration:"underline"},children:M===0?"Current Month":"Go to Current Month"})]}),i.jsxs("button",{onClick:async()=>{const ae=M+1;F(ae),await h(ae)},style:{display:"flex",alignItems:"center",gap:"6px",padding:"8px 12px",borderRadius:"6px",border:"1px solid #d1d5db",background:"#ffffff",color:"#7d8d86",fontSize:"14px",fontWeight:500,cursor:"pointer"},children:["Next Month",i.jsx("i",{className:"fa-solid fa-chevron-right",style:{fontSize:"12px"}})]})]}),y==="hourly"&&i.jsxs("div",{style:{marginBottom:"24px",padding:"12px",background:"#f9fafb",borderRadius:"8px",border:"2px solid #d1d5db"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"8px"},children:"Select Date:"}),i.jsx("input",{type:"date",value:v,onChange:ae=>V(ae.target.value),style:{padding:"8px 12px",border:"2px solid #d1d5db",borderRadius:"6px",fontSize:"14px",color:"#3e3f29",background:"white",outline:"none"}})]}),i.jsxs("div",{style:{width:"100%",height:"400px",background:"white",borderRadius:"12px",padding:"40px",border:"2px solid #d1d5db",position:"relative",overflow:"visible",margin:"0",boxSizing:"border-box",fontFamily:"inherit",display:"flex",flexDirection:"column"},children:[i.jsx("div",{style:{position:"absolute",left:"15px",top:"40px",bottom:"30px",fontSize:"11px",color:"#9ca3af",fontWeight:"500",zIndex:1,padding:"10px 0",height:"260px"},children:[100,75,50,25,0].map((ae,Se)=>i.jsx("span",{style:{position:"absolute",textAlign:"right",minWidth:"20px",top:`${Se*25}%`,transform:"translateY(-50%)"},children:P4(ee*ae/100)},ae))}),i.jsx("div",{style:{display:"flex",alignItems:"flex-end",justifyContent:"space-between",flex:1,gap:y==="weekly"?"20px":y==="monthly"?"6px":"12px",marginBottom:"30px",padding:"0 40px 0 70px",position:"relative",zIndex:2,overflow:"visible",width:"100%",boxSizing:"border-box",minHeight:"260px"},children:Ae.map((ae,Se)=>{const k=Re(ae.totalSales,ee),J=fe(Se,y!=="hourly");return i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end",flex:1,maxWidth:y==="weekly"?"100px":y==="monthly"?"24px":"80px",overflow:"visible",boxSizing:"border-box",height:"100%"},children:[i.jsx("div",{style:{width:"100%",maxWidth:y==="weekly"?"80px":y==="monthly"?"16px":"60px",height:`${k}px`,background:J,borderRadius:"8px 8px 0 0",marginBottom:"12px",position:"relative",transition:"all 0.3s ease",cursor:"pointer",boxSizing:"border-box",display:"block"},onMouseEnter:O=>{O.currentTarget.style.transform="scaleY(1.05)",O.currentTarget.style.opacity="0.8",X(O,ae)},onMouseLeave:O=>{O.currentTarget.style.transform="scaleY(1)",O.currentTarget.style.opacity="1",le()}}),i.jsx("span",{style:{fontSize:y==="weekly"?"13px":"11px",fontWeight:"500",color:"#7d8d86",textAlign:"center",display:"block",margin:"0",padding:"0"},children:y==="weekly"?ae.day:y==="monthly"?Se%ye===0?ae.day:"":ae.hourLabel})]},Se)})})]}),A.visible&&A.data&&i.jsxs("div",{style:{position:"fixed",left:A.x+10,top:A.y-10,background:"rgba(31, 41, 55, 0.95)",color:"#ffffff",padding:"12px 16px",borderRadius:"8px",fontSize:"12px",fontWeight:"500",whiteSpace:"nowrap",pointerEvents:"none",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)",zIndex:9999,backdropFilter:"blur(8px)",border:"1px solid rgba(255, 255, 255, 0.1)",transform:"translateY(-100%)",animation:"fadeIn 0.2s ease-out"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"4px"},children:[i.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"2px",background:y==="weekly"?fe(0,!0):fe(0,!1)}}),i.jsx("span",{style:{fontWeight:"600",fontSize:"13px"},children:y==="weekly"?A.data.day:A.data.hourLabel})]}),i.jsxs("div",{style:{fontSize:"11px",opacity:.8,marginBottom:"2px"},children:[A.data.transactionCount," transaction",A.data.transactionCount!==1?"s":""]}),i.jsx("div",{style:{fontWeight:"600",fontSize:"14px",color:"#60a5fa"},children:un(A.data.totalSales)})]})]}),i.jsx("div",{style:{width:"100%",maxWidth:"1000px",margin:"12px auto 0 auto"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"16px",flexWrap:"wrap",background:"#3e3f29",borderRadius:"8px",padding:"8px 12px",border:"2px solid #d1d5db"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("div",{style:{width:"12px",height:"12px",borderRadius:"2px",background:"#7d8d86"}}),i.jsx("span",{style:{fontSize:"11px",color:"#f1f0e4",fontWeight:500},children:y==="weekly"?"Daily Sales":y==="monthly"?"Daily Sales (Month)":"Hourly Sales"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:"fa-solid fa-chart-bar",style:{fontSize:"12px",color:"#f1f0e4"}}),i.jsxs("span",{style:{fontSize:"11px",color:"#f1f0e4",fontWeight:500},children:["Max: ",un(ee)]})]})]})})]})},V4=()=>{const e=Ks(),[t,r]=j.useState({totalProducts:0,totalSales:0,totalCustomers:0,todayRevenue:0,todaySideBusinessRevenue:0,todayTransactions:0,lowStockItems:0}),[a,o]=j.useState(!0),[c,d]=j.useState(null),[f,p]=j.useState([]),[h,x]=j.useState(!1),[y,b]=j.useState(!1),[v,w]=j.useState(new Date),[_,T]=j.useState(new Date),[M,F]=j.useState([]),[A,U]=j.useState("today"),[V,te]=j.useState([]),[N,re]=j.useState(0),[L,X]=j.useState(0);j.useEffect(()=>{le(),ge()},[]),j.useEffect(()=>{Re(A,v),fe(A,v)},[A,v]);const le=async()=>{try{o(!0);const[de,$e,z]=await Promise.all([Oe.from("products").select("product_id",{count:"exact",head:!0}).limit(1e3),Oe.from("sales").select("sale_id",{count:"exact",head:!0}).limit(1e3),Oe.from("customers").select("customer_id",{count:"exact",head:!0}).limit(1e3)]),be=oe=>`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}-${String(oe.getDate()).padStart(2,"0")}`,Ke=be(new Date),{data:je,count:dt}=await Oe.from("sales").select("total_amount",{count:"exact"}).gte("datetime",`${Ke}T00:00:00`).lt("datetime",`${Ke}T23:59:59`),We=je?.reduce((oe,Le)=>oe+(Le.total_amount||0),0)||0,ot=new Date;ot.setDate(ot.getDate()-1);const Ne=be(ot),{count:tt}=await Oe.from("sales").select("sale_id",{count:"exact",head:!0}).gte("datetime",`${Ne}T00:00:00`).lt("datetime",`${Ne}T23:59:59`);re(tt||0);const{data:mt,count:ht}=await Oe.from("side_business_sales").select(`
          total_amount,
          side_business_items!inner(
            side_businesses!inner(
              business_id,
              name,
              image_url
            )
          )
        `,{count:"exact"}).gte("date_time",`${Ke}T00:00:00`).lt("date_time",`${Ke}T23:59:59`),St=mt?.reduce((oe,Le)=>oe+(Le.total_amount||0),0)||0;X(ht||0);const It=new Map;mt&&mt.forEach(oe=>{const Le=oe.side_business_items?.side_businesses;if(Le){const lt=Le.business_id,Ct=It.get(lt);Ct?Ct.total_amount+=oe.total_amount||0:It.set(lt,{business_id:lt,name:Le.name,image_url:Le.image_url,total_amount:oe.total_amount||0})}}),te(Array.from(It.values()));const{count:Tt}=await Oe.from("products").select("product_id",{count:"exact",head:!0}).lt("stock_quantity",10);r({totalProducts:de.count||0,totalSales:$e.count||0,totalCustomers:z.count||0,todayRevenue:We,todaySideBusinessRevenue:St,todayTransactions:dt||0,lowStockItems:Tt||0})}catch(de){console.error("Error fetching dashboard stats:",de);const $e=de instanceof Error?de.message:"Unknown error";alert(`Dashboard loading error: ${$e}. Please check your database permissions.`)}finally{o(!1)}},ge=async de=>{try{const be=(We=>`${We.getFullYear()}-${String(We.getMonth()+1).padStart(2,"0")}-${String(We.getDate()).padStart(2,"0")}`)(de||v),{data:Ke,error:je}=await Oe.from("sales").select(`
          sale_id,
          datetime,
          total_amount,
          payment_method,
          partial_payment,
          partial_amount,
          remaining_amount,
          partial_notes,
          sale_items (quantity)
        `).gte("datetime",`${be}T00:00:00`).lt("datetime",`${be}T23:59:59`).order("datetime",{ascending:!1}).limit(5);if(je){console.error("Error fetching recent transactions:",je);return}const dt=(Ke||[]).map(We=>({sale_id:We.sale_id,datetime:We.datetime,total_amount:We.total_amount,payment_method:We.payment_method,items_count:We.sale_items?.reduce((ot,Ne)=>ot+Ne.quantity,0)||0,status:"completed",partial_payment:We.partial_payment,partial_amount:We.partial_amount,remaining_amount:We.remaining_amount,partial_notes:We.partial_notes}));F(dt)}catch($e){console.error("Error in fetchRecentTransactions:",$e)}},Re=async(de,$e)=>{try{o(!0);const{start:z,end:be}=pe(de,$e),{data:Ke,count:je}=await Oe.from("sales").select("total_amount",{count:"exact"}).gte("datetime",z).lt("datetime",be),dt=Ke?.reduce((ht,St)=>ht+(St.total_amount||0),0)||0,{data:We,count:ot}=await Oe.from("side_business_sales").select(`
          total_amount,
          side_business_items!inner(
            side_businesses!inner(
              business_id,
              name,
              image_url
            )
          )
        `,{count:"exact"}).gte("date_time",z).lt("date_time",be),Ne=We?.reduce((ht,St)=>ht+(St.total_amount||0),0)||0;X(ot||0);const tt=new Map;We&&We.forEach(ht=>{const St=ht.side_business_items?.side_businesses;if(St){const It=St.business_id,Tt=tt.get(It);Tt?Tt.total_amount+=ht.total_amount||0:tt.set(It,{business_id:It,name:St.name,image_url:St.image_url,total_amount:ht.total_amount||0})}}),te(Array.from(tt.values()));const{count:mt}=await Oe.from("products").select("product_id",{count:"exact",head:!0}).lt("stock_quantity",10);r({totalProducts:0,totalSales:0,totalCustomers:0,todayRevenue:dt,todaySideBusinessRevenue:Ne,todayTransactions:je||0,lowStockItems:mt||0})}catch(z){console.error("Error fetching dashboard stats for period:",z)}finally{o(!1)}},fe=async(de,$e)=>{try{const{start:z,end:be}=pe(de,$e),{data:Ke,error:je}=await Oe.from("sales").select(`
          sale_id,
          datetime,
          total_amount,
          payment_method,
          partial_payment,
          partial_amount,
          remaining_amount,
          partial_notes,
          sale_items (quantity)
        `).gte("datetime",z).lt("datetime",be).order("datetime",{ascending:!1}).limit(5);if(je){console.error("Error fetching recent transactions for period:",je);return}const dt=(Ke||[]).map(We=>({sale_id:We.sale_id,datetime:We.datetime,total_amount:We.total_amount,payment_method:We.payment_method,items_count:We.sale_items?.reduce((ot,Ne)=>ot+Ne.quantity,0)||0,status:"completed",partial_payment:We.partial_payment,partial_amount:We.partial_amount,remaining_amount:We.remaining_amount,partial_notes:We.partial_notes}));F(dt)}catch(z){console.error("Error in fetchRecentTransactionsForPeriod:",z)}},Ae=async de=>{try{x(!0);const $e=new Date(de);d($e),p([]);const be=(We=>`${We.getFullYear()}-${String(We.getMonth()+1).padStart(2,"0")}-${String(We.getDate()).padStart(2,"0")}`)($e),{data:Ke,error:je}=await Oe.from("sales").select(`
          sale_id,
          datetime,
          total_amount,
          payment_method,
          sale_items (quantity)
        `).gte("datetime",`${be}T00:00:00`).lt("datetime",`${be}T23:59:59`).order("datetime",{ascending:!1});if(je){console.error("Error fetching transactions:",je);return}const dt=(Ke||[]).map(We=>({transaction_id:`TXN-${We.sale_id.toString().padStart(6,"0")}`,datetime:We.datetime,total_amount:We.total_amount,payment_method:We.payment_method,items_count:We.sale_items?.reduce((ot,Ne)=>ot+Ne.quantity,0)||0}));p(dt)}catch($e){console.error("Error fetching transactions:",$e)}finally{x(!1)}},ee=()=>{d(null),p([])},ye=de=>{ee(),e(`/transaction/${de}`)},ae=de=>{w(de),b(!1),Se(de),ge(de)},Se=async de=>{try{o(!0);const $e=Le=>`${Le.getFullYear()}-${String(Le.getMonth()+1).padStart(2,"0")}-${String(Le.getDate()).padStart(2,"0")}`,z=$e(de),[be,Ke,je]=await Promise.all([Oe.from("products").select("product_id",{count:"exact",head:!0}),Oe.from("sales").select("sale_id",{count:"exact",head:!0}).gte("datetime",`${z}T00:00:00`).lt("datetime",`${z}T23:59:59`),Oe.from("customers").select("customer_id",{count:"exact",head:!0})]),{data:dt,count:We}=await Oe.from("sales").select("total_amount",{count:"exact"}).gte("datetime",`${z}T00:00:00`).lt("datetime",`${z}T23:59:59`),ot=dt?.reduce((Le,lt)=>Le+(lt.total_amount||0),0)||0,Ne=new Date(de);Ne.setDate(Ne.getDate()-1);const tt=$e(Ne),{count:mt}=await Oe.from("sales").select("sale_id",{count:"exact",head:!0}).gte("datetime",`${tt}T00:00:00`).lt("datetime",`${tt}T23:59:59`);re(mt||0);const{data:ht,count:St}=await Oe.from("side_business_sales").select(`
          total_amount,
          side_business_items!inner(
            side_businesses!inner(
              business_id,
              name,
              image_url
            )
          )
        `,{count:"exact"}).gte("date_time",`${z}T00:00:00`).lt("date_time",`${z}T23:59:59`),It=ht?.reduce((Le,lt)=>Le+(lt.total_amount||0),0)||0;X(St||0);const Tt=new Map;ht&&ht.forEach(Le=>{const lt=Le.side_business_items?.side_businesses;if(lt){const Ct=lt.business_id,qt=Tt.get(Ct);qt?qt.total_amount+=Le.total_amount||0:Tt.set(Ct,{business_id:Ct,name:lt.name,image_url:lt.image_url,total_amount:Le.total_amount||0})}}),te(Array.from(Tt.values()));const{count:oe}=await Oe.from("products").select("product_id",{count:"exact",head:!0}).lt("stock_quantity",10);r({totalProducts:be.count||0,totalSales:Ke.count||0,totalCustomers:je.count||0,todayRevenue:ot,todaySideBusinessRevenue:It,todayTransactions:We||0,lowStockItems:oe||0})}catch($e){console.error("Error fetching dashboard stats for date:",$e)}finally{o(!1)}},k=(de,$e)=>{const z=new Date(de,$e,1),be=new Date(z);be.setDate(be.getDate()-z.getDay());const Ke=[],je=new Date(be);for(let dt=0;dt<42;dt++)Ke.push(new Date(je)),je.setDate(je.getDate()+1);return Ke},J=()=>{switch(A){case"today":const de=new Date;return v.toDateString()===de.toDateString()?"Today's Sales":`${v.toLocaleDateString("en-US",{month:"short",day:"numeric"})} Sales`;case"week":return"This Week Sales";case"month":return"This Month Sales";default:return"Today's Sales"}},O=()=>{switch(A){case"today":const de=new Date;return v.toDateString()===de.toDateString()?"Today's Transactions":`${v.toLocaleDateString("en-US",{month:"short",day:"numeric"})} Transactions`;case"week":return"This Week Transactions";case"month":return"This Month Transactions";default:return"Today's Transactions"}},K=()=>{if(N===0)return t.todayTransactions>0?"+100%":"0%";const de=(t.todayTransactions-N)/N*100;return`${de>=0?"+":""}${de.toFixed(0)}%`},Y=()=>t.todayTransactions-L,H=()=>{const de=Y(),$e=K();return{text:`Products: ${de} | Side Business: ${L} (${$e} from yesterday)`,icon:"fa-solid fa-chart-pie"}},pe=(de,$e)=>{const z=be=>`${be.getFullYear()}-${String(be.getMonth()+1).padStart(2,"0")}-${String(be.getDate()).padStart(2,"0")}`;switch(de){case"today":const be=z($e);return{start:`${be}T00:00:00`,end:`${be}T23:59:59`};case"week":const Ke=new Date($e);Ke.setDate($e.getDate()-$e.getDay()),Ke.setHours(0,0,0,0);const je=new Date(Ke);return je.setDate(Ke.getDate()+6),je.setHours(23,59,59,999),{start:Ke.toISOString(),end:je.toISOString()};case"month":const dt=new Date($e.getFullYear(),$e.getMonth(),1);dt.setHours(0,0,0,0);const We=new Date($e.getFullYear(),$e.getMonth()+1,0);return We.setHours(23,59,59,999),{start:dt.toISOString(),end:We.toISOString()};default:return{start:"",end:""}}},Ge=de=>{const $e=new Date,z=de.toDateString()===$e.toDateString(),be=de.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return z?"Today's Transactions":`${be} Transactions`},He=de=>{const $e=new Date,z=de.toDateString()===$e.toDateString(),be=de.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return z?"No transactions found for today":`No transactions found for ${be}`},De=(de,$e,z=100)=>{const be=de+$e;if(be===0)return null;const je=de/be*100/100*360,dt=(Ne,tt,mt)=>{const ht=We(z/2,z/2,mt,tt),St=We(z/2,z/2,mt,Ne),It=tt-Ne<=180?"0":"1";return`M ${z/2} ${z/2} L ${ht.x} ${ht.y} A ${mt} ${mt} 0 ${It} 0 ${St.x} ${St.y} Z`},We=(Ne,tt,mt,ht)=>{const St=(ht-90)*Math.PI/180;return{x:Ne+mt*Math.cos(St),y:tt+mt*Math.sin(St)}},ot=z*.4;return i.jsxs("svg",{width:z,height:z,style:{marginRight:"12px"},children:[de>0&&i.jsx("path",{d:dt(0,je,ot),fill:"#dc2626",stroke:"#ffffff",strokeWidth:"2"}),$e>0&&i.jsx("path",{d:dt(je,360,ot),fill:"#f59e0b",stroke:"#ffffff",strokeWidth:"2"})]})},rt=[{title:J(),value:un(t.todayRevenue+t.todaySideBusinessRevenue),change:`Products: ${un(t.todayRevenue)} | Side Business: ${un(t.todaySideBusinessRevenue)}`,changeColor:"#1a1a1a",icon:"fa-solid fa-euro-sign",bgColor:"#1a1a1a",iconColor:"#f1f0e4"},{title:O(),value:t.todayTransactions,change:H().text,changeIcon:H().icon,changeColor:"#bca88d",icon:"fa-solid fa-shopping-cart",bgColor:"#bca88d",iconColor:"#1a1a1a",pieChart:{productCount:Y(),sideBusinessCount:L}}];return a?i.jsxs("div",{style:{padding:"0"},children:[i.jsx("style",{children:`
          @keyframes shimmer { 0% { background-position: -400px 0; } 100% { background-position: 400px 0; } }
          .skeleton { background-image: linear-gradient(90deg, #e5e7eb 0px, #f3f4f6 40px, #e5e7eb 80px); background-size: 600px 100%; animation: shimmer 1.2s infinite linear; }
        `}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"24px",marginBottom:"32px"},children:[i.jsx("div",{className:"skeleton",style:{height:"140px",borderRadius:"16px"}}),i.jsx("div",{className:"skeleton",style:{height:"140px",borderRadius:"16px"}}),i.jsx("div",{className:"skeleton",style:{height:"140px",borderRadius:"16px"}}),i.jsx("div",{className:"skeleton",style:{height:"140px",borderRadius:"16px"}})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px",marginBottom:"32px"},children:[i.jsx("div",{className:"skeleton",style:{height:"300px",borderRadius:"16px"}}),i.jsx("div",{className:"skeleton",style:{height:"300px",borderRadius:"16px"}})]}),i.jsx("div",{className:"skeleton",style:{height:"420px",borderRadius:"16px"}})]}):i.jsxs("div",{style:{padding:"0"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",gap:"16px",marginBottom:"32px"},children:[i.jsxs("div",{onClick:()=>b(!0),style:{background:"#1a1a1a",border:"1px solid #1a1a1a",borderRadius:"8px",padding:"12px 16px",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"200px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",color:"#f1f0e4",fontSize:"14px",fontWeight:"500"},children:[i.jsx("i",{className:"fa-solid fa-calendar",style:{fontSize:"16px",color:"#bca88d"}}),i.jsx("span",{style:{color:"#bca88d"},children:v.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]}),i.jsx("i",{className:"fa-solid fa-chevron-down",style:{fontSize:"12px",color:"#bca88d",transition:"transform 0.2s ease"}})]}),i.jsxs("div",{style:{display:"flex",gap:"8px",background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"4px"},children:[i.jsx("button",{onClick:()=>U("today"),style:{padding:"6px 10px",borderRadius:"6px",border:"none",background:A==="today"?"#7d8d86":"transparent",color:A==="today"?"#f1f0e4":"#7d8d86",fontSize:"12px",fontWeight:600,cursor:"pointer"},children:"Today"}),i.jsx("button",{onClick:()=>U("week"),style:{padding:"6px 10px",borderRadius:"6px",border:"none",background:A==="week"?"#7d8d86":"transparent",color:A==="week"?"#f1f0e4":"#7d8d86",fontSize:"12px",fontWeight:600,cursor:"pointer"},children:"This Week"}),i.jsx("button",{onClick:()=>U("month"),style:{padding:"6px 10px",borderRadius:"6px",border:"none",background:A==="month"?"#7d8d86":"transparent",color:A==="month"?"#f1f0e4":"#7d8d86",fontSize:"12px",fontWeight:600,cursor:"pointer"},children:"This Month"})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"24px",marginBottom:"32px",minHeight:"140px"},children:[rt.map((de,$e)=>i.jsx("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",border:"2px solid #d1d5db",borderWidth:"2px",borderStyle:"solid",borderColor:"#d1d5db",transition:"all 0.3s ease",cursor:"pointer",display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"120px"},children:i.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{color:"#1a1a1a",fontSize:"16px",fontWeight:"500",margin:"0 0 12px 0"},children:de.title}),i.jsx("p",{style:{fontSize:"36px",fontWeight:"bold",color:"#1a1a1a",margin:"0 0 8px 0",lineHeight:"1.1"},children:de.value}),i.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"12px",fontSize:"14px",fontWeight:"500",color:de.changeColor,margin:0},children:de.pieChart?i.jsxs(i.Fragment,{children:[De(de.pieChart.productCount,de.pieChart.sideBusinessCount),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"#dc2626"}}),i.jsxs("span",{style:{fontSize:"13px",fontWeight:"600",color:"#1a1a1a"},children:["Products: ",de.pieChart.productCount]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("div",{style:{width:"10px",height:"10px",borderRadius:"50%",backgroundColor:"#f59e0b"}}),i.jsxs("span",{style:{fontSize:"13px",fontWeight:"600",color:"#1a1a1a"},children:["Side Business: ",de.pieChart.sideBusinessCount]})]})]})]}):i.jsxs(i.Fragment,{children:[de.changeIcon&&i.jsx("i",{className:de.changeIcon,style:{fontSize:"12px"}}),i.jsx("span",{children:de.change})]})}),$e===0&&V.length>0&&i.jsx("div",{style:{marginTop:"12px",paddingTop:"12px",borderTop:"1px solid rgba(125, 141, 134, 0.2)"},children:i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(80px, 1fr))",gap:"12px",maxWidth:"100%"},children:V.map(z=>i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"6px",padding:"8px",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",overflow:"hidden",background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:z.image_url?i.jsx("img",{src:z.image_url,alt:z.name,style:{width:"100%",height:"100%",objectFit:"cover"},onError:be=>{const Ke=be.target;Ke.style.display="none";const je=Ke.parentElement;je&&(je.innerHTML='<i class="fa-solid fa-store" style="font-size: 18px; color: #7d8d86;"></i>')}}):i.jsx("i",{className:"fa-solid fa-store",style:{fontSize:"18px",color:"#7d8d86"}})}),i.jsxs("div",{style:{textAlign:"center",width:"100%"},children:[i.jsx("p",{style:{fontSize:"11px",color:"#7d8d86",fontWeight:"500",margin:"0 0 2px 0",lineHeight:"1.2"},children:z.name}),i.jsx("p",{style:{fontSize:"12px",color:"#1a1a1a",fontWeight:"600",margin:0},children:un(z.total_amount)})]})]},z.business_id))})})]}),i.jsx("div",{style:{width:"56px",height:"56px",borderRadius:"14px",background:de.bgColor,display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-end",marginTop:"16px"},children:i.jsx("i",{className:de.icon,style:{fontSize:"24px",color:de.iconColor}})})]})},$e)),i.jsx("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"20px",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",border:"2px solid #d1d5db",borderWidth:"2px",borderStyle:"solid",borderColor:"#d1d5db",transition:"all 0.3s ease",display:"flex",flexDirection:"column",justifyContent:"space-between",minHeight:"120px"},children:i.jsx(W4,{})}),i.jsx(H4,{activePeriod:A,selectedDate:v})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1.5fr",gap:"24px",marginBottom:"32px"},children:[i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"24px"},children:i.jsxs("div",{className:"dashboardCard",style:{background:"#ffffff",borderRadius:"16px",padding:"24px",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",border:"5px solid #000000 !important"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"20px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"10px",background:"#1a1a1a",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-clock",style:{fontSize:"18px",color:"#f1f0e4"}})}),i.jsx("h3",{style:{fontSize:"20px",fontWeight:"600",color:"#1a1a1a",margin:0},children:(()=>{switch(A){case"today":const de=new Date;return v.toDateString()===de.toDateString()?"Recent Transactions":`${v.toLocaleDateString("en-US",{month:"short",day:"numeric"})} Transactions`;case"week":return"This Week Transactions";case"month":return"This Month Transactions";default:return"Recent Transactions"}})()})]}),i.jsx("button",{onClick:()=>Ae(v),style:{background:"#1a1a1a",color:"#f1f0e4",border:"none",padding:"8px 16px",borderRadius:"8px",fontSize:"12px",fontWeight:600,cursor:"pointer",transition:"all 0.2s ease"},children:"View All"})]}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:M.length>0?M.map(de=>i.jsxs("div",{onClick:()=>e(`/transaction/TXN-${de.sale_id.toString().padStart(6,"0")}`),style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:de.partial_payment?"#fef2f2":"white",borderRadius:"8px",border:de.partial_payment?"1px solid #fecaca":"1px solid transparent",cursor:"pointer",transition:"all 0.2s ease"},children:[i.jsxs("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:de.partial_payment?"#f59e0b":de.status==="completed"?"#10b981":"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[i.jsx("i",{className:`fa-solid ${de.partial_payment?"fa-exclamation":de.status==="completed"?"fa-check":"fa-hourglass-half"}`,style:{fontSize:"12px",color:"white"}}),de.partial_payment&&i.jsx("div",{style:{position:"absolute",top:"-2px",right:"-2px",width:"8px",height:"8px",borderRadius:"50%",background:"#dc2626",border:"1px solid white"}})]}),i.jsxs("div",{style:{flex:1},children:[i.jsxs("p",{style:{fontSize:"14px",fontWeight:"600",color:"#1a1a1a",margin:"0 0 2px 0"},children:["#TXN-",de.sale_id.toString().padStart(6,"0")]}),i.jsxs("p",{style:{fontSize:"12px",color:"#1a1a1a",margin:0},children:[de.items_count," item",de.items_count!==1?"s":""," | ",de.payment_method,de.partial_payment&&i.jsx("span",{style:{color:"#dc2626",fontWeight:"600",marginLeft:"8px"},children:" PARTIAL"})]})]}),i.jsx("div",{style:{textAlign:"right"},children:de.partial_payment?i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"600",color:"#10b981",margin:"0 0 2px 0"},children:un(de.partial_amount||0)}),i.jsxs("p",{style:{fontSize:"11px",color:"#6b7280",margin:"0 0 2px 0",fontWeight:"500"},children:["of ",un((de.partial_amount||0)+(de.remaining_amount||0))]}),i.jsxs("p",{style:{fontSize:"10px",color:"#dc2626",margin:0,fontWeight:"600"},children:["OWES: ",un(de.remaining_amount||0)]})]}):i.jsx("p",{style:{fontSize:"14px",fontWeight:"600",color:"#1a1a1a",margin:0},children:un(de.total_amount)})})]},de.sale_id)):i.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#1a1a1a",fontSize:"14px"},children:(()=>{switch(A){case"today":const de=new Date;return v.toDateString()===de.toDateString()?"No recent transactions":`No transactions on ${v.toLocaleDateString("en-US",{month:"short",day:"numeric"})}`;case"week":return"No transactions this week";case"month":return"No transactions this month";default:return"No recent transactions"}})()})})]})}),i.jsx("div",{children:i.jsx(Y4,{selectedDate:v,activePeriod:A})})]}),c&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"16px",padding:"32px",maxWidth:"600px",width:"100%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px",paddingBottom:"16px",borderBottom:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsx("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#1a1a1a",margin:0},children:Ge(c)}),i.jsx("button",{onClick:ee,style:{background:"none",border:"none",fontSize:"24px",color:"#1a1a1a",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease"},children:""})]}),h?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"40px"},children:i.jsxs("div",{style:{fontSize:"16px",color:"#1a1a1a",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite",fontSize:"20px"}}),"Loading transactions..."]})}):f.length>0?i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:f.map((de,$e)=>i.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.2s ease",cursor:"pointer"},onClick:()=>ye(de.transaction_id),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"#1a1a1a",display:"flex",alignItems:"center",justifyContent:"center",color:"#f1f0e4",fontSize:"16px"},children:i.jsx("i",{className:"fa-solid fa-check",style:{fontSize:"14px"}})}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"600",color:"#1a1a1a",margin:"0 0 4px 0"},children:de.transaction_id}),i.jsxs("p",{style:{fontSize:"12px",color:"#1a1a1a",margin:0},children:[new Date(de.datetime).toLocaleTimeString()," | ",de.items_count," items | ",de.payment_method]})]})]}),i.jsx("div",{style:{fontSize:"16px",fontWeight:"600",color:"#1a1a1a"},children:un(de.total_amount)})]},$e))}):i.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#1a1a1a"},children:[i.jsx("i",{className:"fa-solid fa-receipt",style:{fontSize:"48px",marginBottom:"16px",opacity:.5}}),i.jsx("p",{style:{fontSize:"16px",margin:0},children:He(c)})]})]})}),y&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"16px",padding:"24px",maxWidth:"400px",width:"100%",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.3)",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[i.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",color:"#1a1a1a",margin:0},children:_.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>T(new Date(_.getFullYear(),_.getMonth()-1,1)),style:{background:"none",border:"none",fontSize:"16px",color:"#1a1a1a",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"all 0.2s ease"},children:i.jsx("i",{className:"fa-solid fa-chevron-left"})}),i.jsx("button",{onClick:()=>T(new Date(_.getFullYear(),_.getMonth()+1,1)),style:{background:"none",border:"none",fontSize:"16px",color:"#1a1a1a",cursor:"pointer",padding:"4px 8px",borderRadius:"4px",transition:"all 0.2s ease"},children:i.jsx("i",{className:"fa-solid fa-chevron-right"})}),i.jsx("button",{onClick:()=>b(!1),style:{background:"none",border:"none",fontSize:"20px",color:"#1a1a1a",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease"},children:""})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px",marginBottom:"16px"},children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(de=>i.jsx("div",{style:{textAlign:"center",fontSize:"12px",fontWeight:"600",color:"#1a1a1a",padding:"8px 4px"},children:de},de)),k(_.getFullYear(),_.getMonth()).map((de,$e)=>{const z=de.getMonth()===_.getMonth(),be=de.toDateString()===new Date().toDateString(),Ke=de.toDateString()===v.toDateString();return i.jsx("button",{onClick:()=>ae(de),style:{background:Ke?"#1a1a1a":"transparent",color:Ke?"#f1f0e4":z?"#1a1a1a":"#bca88d",border:be?"2px solid #1a1a1a":"1px solid transparent",borderRadius:"8px",padding:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",opacity:z?1:.5},children:de.getDate()},$e)})]}),i.jsx("div",{style:{textAlign:"center"},children:i.jsx("button",{onClick:()=>ae(new Date),style:{background:"#1a1a1a",color:"#f1f0e4",border:"none",padding:"8px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:"Today"})})]})})]})};async function X4(e,t){console.log(" Starting image upload for product:",t),console.log(" File details:",{name:e.name,size:e.size,type:e.type});try{const r=`product-images/${t}.${e.name.split(".").pop()}`;console.log(" Uploading to Supabase Storage:",r);const{error:a}=await Oe.storage.from("products").upload(r,e,{contentType:e.type,upsert:!0});if(a)return console.error(" Upload failed:",a),null;const{data:{publicUrl:o}}=Oe.storage.from("products").getPublicUrl(r);console.log(" Image uploaded successfully:",o),console.log(" Updating database with public URL...");const{error:c}=await Oe.from("products").update({image_url:o}).eq("product_id",t);return c?(console.error(" DB update failed:",c),null):(console.log(" Database updated with public URL"),o)}catch(r){return console.error(" Unexpected error during upload:",r),null}}const K4=()=>{const{hasPermission:e}=K0(),{user:t}=xa(),[r,a]=j.useState([]),[o,c]=j.useState(!0),[d,f]=j.useState(null),[p,h]=j.useState({totalProducts:0,inStock:0,lowStock:0,outOfStock:0}),[x,y]=j.useState(null),[b,v]=j.useState(!1),[w,_]=j.useState(null),[T,M]=j.useState(null),[F,A]=j.useState(!1),[U,V]=j.useState("daily"),[te,N]=j.useState(""),[re,L]=j.useState("all"),[X,le]=j.useState(!1),[ge,Re]=j.useState([]),[fe,Ae]=j.useState(!1),[ee,ye]=j.useState(!1),[ae,Se]=j.useState(null),[k,J]=j.useState({product_name:"",category:"",price:"",stock_quantity:"100",reorder_level:"10",supplier_info:"",tax_rate:"",description:"",sku:"",is_weighted:!1,weight_unit:"",price_per_unit:""}),[O,K]=j.useState(!1),[Y,H]=j.useState(!1),[pe,Ge]=j.useState("Hi! I'm Lily, your inventory assistant! I can help you understand your stock levels and manage your products. Hover over the stats cards to see what they mean!"),[He,De]=j.useState(!1),[Be,rt]=j.useState(null),[de,$e]=j.useState(null),[z,be]=j.useState(!1),[Ke,je]=j.useState(null),[dt,We]=j.useState(null),[ot,Ne]=j.useState(1),[tt,mt]=j.useState(10),[ht,St]=j.useState(0),[It,Tt]=j.useState([]),[oe,Le]=j.useState([]),[lt,Ct]=j.useState(null),[qt,dr]=j.useState(null),er=300*1e3,Pt=async(S=!1)=>{if(!S&&lt&&Date.now()-lt.timestamp<er){const Q=lt.data.map(ne=>({...ne,price:0,stock_quantity:0,supplier_info:"",reorder_level:0,image_url:null,created_at:"",updated_at:""}));Le(Q);return}try{const{data:Q,error:ne}=await Oe.from("products").select("product_id, name, category").order("name",{ascending:!0});if(ne){console.error("Error fetching all products for suggestions:",ne);return}const Ce=Q||[],Ve=Ce.map(ze=>({...ze,price:0,stock_quantity:0,supplier_info:"",reorder_level:0,image_url:null,created_at:"",updated_at:""}));Le(Ve),Ct({data:Ce,timestamp:Date.now()})}catch(Q){console.error("Error fetching all products for suggestions:",Q)}},ut=async()=>{try{const{data:S,error:Q}=await Oe.from("products").select("category").not("category","is",null).not("category","eq","");if(Q){console.error("Error fetching categories:",Q);return}const ne=Array.from(new Set(S.map(Ce=>Ce.category))).filter(Ce=>Ce&&Ce.trim()!=="").sort();Tt(ne)}catch(S){console.error("Error fetching distinct categories:",S)}};j.useEffect(()=>{pt(),ut(),Pt(),Lt()},[]),j.useEffect(()=>{console.log("Modal state changed:",{showEditModal:ee,editingProduct:ae?.name})},[ee,ae]);const Yt=()=>{Ne(1),pt(1,tt,te,re)},wt=S=>{S.key==="Enter"&&(Yt(),le(!1))},se=S=>{const Q=S.target.value;if(N(Q),Q.length>=2){const ne=ma(Q);Re(ne),le(ne.length>0)}else le(!1),Re([])},_e=S=>{const Q=S.type==="product"?S.product.name:S.name;N(Q),le(!1),Re([]),Ne(1),pt(1,tt,Q,re)},gt=()=>{N(""),le(!1),Re([]),Ne(1),pt(1,tt,"",re)};j.useEffect(()=>{Ne(1),pt(1,tt,te,re)},[re]);const pt=async(S=ot,Q=tt,ne=te,Ce=re,Ve=null)=>{try{if(c(!0),f(null),Ve&&Ve!=="totalProducts"){let ze=Oe.from("products").select("*").order("product_id",{ascending:!0});if(ne&&ne.trim()){const or=`name.ilike.%${ne.trim()}%,category.ilike.%${ne.trim()}%`;ze=ze.or(or)}Ce&&Ce!=="all"&&(ze=ze.eq("category",Ce)),Ve==="outOfStock"&&(ze=ze.eq("stock_quantity",0));const{data:Xe,error:nt}=await ze;if(nt)throw nt;let st=Xe||[];Ve==="inStock"?st=st.filter(or=>or.stock_quantity>or.reorder_level):Ve==="lowStock"&&(st=st.filter(or=>or.stock_quantity<=or.reorder_level&&or.stock_quantity>0)),St(st.length);const it=(S-1)*Q,Bt=st.slice(it,it+Q);a(Bt)}else{let ze=Oe.from("products").select("product_id",{count:"exact",head:!0}),Xe=Oe.from("products").select("*").order("product_id",{ascending:!0});if(ne&&ne.trim()){const rn=`name.ilike.%${ne.trim()}%,category.ilike.%${ne.trim()}%`;ze=ze.or(rn),Xe=Xe.or(rn)}Ce&&Ce!=="all"&&(ze=ze.eq("category",Ce),Xe=Xe.eq("category",Ce));const{count:nt,error:st}=await ze;if(st)throw st;St(nt||0);const it=(S-1)*Q,{data:Bt,error:or}=await Xe.range(it,it+Q-1);if(or)throw or;a(Bt||[])}}catch(ze){const Xe=ze instanceof Error?ze.message:"Failed to fetch products";f(Xe),console.error("Error fetching products:",ze),alert(`Products loading error: ${Xe}. Please check your database permissions.`)}finally{c(!1)}},Lt=async(S=!1)=>{if(!S&&qt&&Date.now()-qt.timestamp<er){h(qt.data);return}try{const{data:Q,error:ne}=await Oe.from("products").select("stock_quantity, reorder_level");if(ne)throw ne;if(Q){const Ce=Q.length,Ve=Q.filter(st=>st.stock_quantity>st.reorder_level).length,ze=Q.filter(st=>st.stock_quantity<=st.reorder_level&&st.stock_quantity>0).length,Xe=Q.filter(st=>st.stock_quantity===0).length,nt={totalProducts:Ce,inStock:Ve,lowStock:ze,outOfStock:Xe};h(nt),dr({data:nt,timestamp:Date.now()})}}catch(Q){console.error("Error fetching summary stats:",Q)}},zt=S=>{x===S?(y(null),N(""),L("all"),Ne(1),pt(1,tt,"","all")):(y(S),N(""),L("all"),Ne(1),pt(1,tt,"","all",S))},Et=S=>{const Q=new Date,ne=new Date(Q.getTime()-720*60*60*1e3);new Date(Q.getTime()-10080*60*1e3);const Ce=S.filter(nt=>nt.sales&&new Date(nt.sales.datetime)>=ne),Ve=[];for(let nt=29;nt>=0;nt--){const st=new Date(Q.getTime()-nt*24*60*60*1e3),it=st.toISOString().split("T")[0],Bt=Ce.filter(wr=>wr.sales&&wr.sales.datetime.startsWith(it)),or=Bt.length,rn=Bt.reduce((wr,xr)=>wr+(xr.calculated_price||xr.price_each*xr.quantity),0);Ve.push({date:it,day:st.getDate(),month:st.getMonth()+1,sales:or,revenue:rn})}const ze=[];for(let nt=3;nt>=0;nt--){const st=new Date(Q.getTime()-(nt+1)*7*24*60*60*1e3),it=new Date(Q.getTime()-nt*7*24*60*60*1e3),Bt=Ce.filter(wr=>{if(!wr.sales)return!1;const xr=new Date(wr.sales.datetime);return xr>=st&&xr<it}),or=Bt.length,rn=Bt.reduce((wr,xr)=>wr+(xr.calculated_price||xr.price_each*xr.quantity),0);ze.push({week:`Week ${4-nt}`,startDate:st.toISOString().split("T")[0],endDate:it.toISOString().split("T")[0],sales:or,revenue:rn})}const Xe=[];for(let nt=5;nt>=0;nt--){const st=new Date(Q.getFullYear(),Q.getMonth()-nt,1),it=new Date(Q.getFullYear(),Q.getMonth()-nt+1,0),Bt=S.filter(wr=>{if(!wr.sales)return!1;const xr=new Date(wr.sales.datetime);return xr>=st&&xr<=it}),or=Bt.length,rn=Bt.reduce((wr,xr)=>wr+(xr.calculated_price||xr.price_each*xr.quantity),0);Xe.push({month:st.toLocaleDateString("en-US",{month:"short",year:"numeric"}),sales:or,revenue:rn})}return{daily:Ve,weekly:ze,monthly:Xe}},Lr=async S=>{try{A(!0),f(null),console.log("Fetching insights for product:",S.product_id,S.name);const Q=S.sales_count||0,ne=S.total_revenue||0,Ce=S.last_sold_date,Ve=Q>0?(Q/30).toFixed(1):0,ze=ne*.6,Xe=ne-ze,nt=ne>0?Xe/ne*100:0,{data:st,error:it}=await Oe.from("sale_items").select(`
          *,
          sales (
            sale_id,
            datetime,
            total_amount,
            payment_method,
            customers (name),
            users (username)
          )
        `).eq("product_id",S.product_id).order("sales.datetime",{ascending:!1});console.log("All sales query result:",{data:st,error:it});const Bt=st?.slice(0,10)||[],or=Bt?.map(tr=>({date:tr.sales?new Date(tr.sales.datetime).toLocaleDateString():"Unknown",time:tr.sales?new Date(tr.sales.datetime).toLocaleTimeString():"Unknown",quantity:tr.weight||tr.quantity,unit:tr.weight?S.weight_unit||"kg":"units",price:tr.calculated_price||tr.price_each*tr.quantity,customer:tr.sales?.customers?.name||"Walk-in Customer",cashier:tr.sales?.users?.username||"Unknown"}))||[],rn=Bt?.reduce((tr,gn)=>tr+(gn.weight||gn.quantity),0)||0,wr=new Date;wr.setDate(wr.getDate()-30);const zd=(Bt?.filter(tr=>tr.sales&&new Date(tr.sales.datetime)>=wr)||[]).reduce((tr,gn)=>{if(gn.sales&&gn.sales.datetime){const va=new Date(gn.sales.datetime).toDateString();tr[va]=(tr[va]||0)+1}return tr},{}),ln=Object.entries(zd).sort(([,tr],[,gn])=>gn-tr).slice(0,5).map(([tr,gn])=>({date:tr,count:gn})),ni=Et(st||[]);console.log("Calculated insights:",{totalSales:Q,totalRevenue:ne,totalQuantitySold:rn,averageSalesPerDay:Ve,topSellingDays:ln,estimatedProfit:Xe,profitMargin:nt,recentSalesList:or,lastSoldDate:Ce,chartData:ni}),M({product:S,totalSales:Q,totalRevenue:ne,totalQuantitySold:rn,averageSalesPerDay:parseFloat(Ve),topSellingDays:ln,estimatedProfit:Xe,profitMargin:nt,recentSalesList:or,lastSoldDate:Ce,chartData:ni,salesData:st||[]})}catch(Q){console.error("Error fetching product insights:",Q),f(Q instanceof Error?Q.message:"Failed to fetch product insights")}finally{A(!1)}},In=S=>{_(S),v(!0),Lr(S)},Dr=r,fr=Math.ceil(ht/tt),hr=ht>0?(ot-1)*tt+1:0,Gt=Math.min(ot*tt,ht),yr=["all",...It],Gr=S=>!S||S.length<2?[]:It.filter(ne=>ne.toLowerCase().includes(S.toLowerCase())||S.toLowerCase().includes(ne.toLowerCase())||ne.toLowerCase().split(" ").some(Ce=>Ce.includes(S.toLowerCase())||S.toLowerCase().includes(Ce))).slice(0,5),ma=S=>{if(!S||S.length<2)return[];const Q=S.toLowerCase(),ne=[],Ce=[];oe.forEach(Xe=>{Xe.name.toLowerCase().includes(Q)&&ne.push({type:"product",product:Xe}),Xe.category.toLowerCase().includes(Q)&&ne.push({type:"product",product:Xe}),Xe.description&&Xe.description.toLowerCase().includes(Q)&&ne.push({type:"product",product:Xe}),Xe.sku&&Xe.sku.toLowerCase().includes(Q)&&ne.push({type:"product",product:Xe})}),It.forEach(Xe=>{Xe.toLowerCase().includes(Q)&&Ce.push({type:"category",name:Xe})});const Ve=ne.filter((Xe,nt,st)=>Xe.type==="product"&&st.findIndex(it=>it.type==="product"&&it.product.product_id===Xe.product.product_id)===nt).slice(0,6),ze=Ce.filter((Xe,nt,st)=>Xe.type==="category"&&st.findIndex(it=>it.type==="category"&&it.name===Xe.name)===nt).slice(0,2);return[...Ve,...ze]},ya=S=>{S>=1&&S<=fr&&(Ne(S),pt(S,tt,te,re))},C=S=>{mt(S),Ne(1),pt(1,S,te,re)},q=()=>{ot>1&&ya(ot-1)},I=()=>{ot<fr&&ya(ot+1)},P=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(S){const Q=Math.random()*16|0;return(S==="x"?Q:Q&3|8).toString(16)}),W=(S,Q,ne=!1)=>{const Ce=(Xe,nt,st=!0)=>{if(!Xe||Xe.trim()===""){if(st)throw new Error(`${nt} is required`);return 0}const it=parseFloat(Xe);if(isNaN(it))throw new Error(`${nt} must be a valid number`);return it},Ve=(Xe,nt,st=!0)=>{if(!Xe||Xe.trim()===""){if(st)throw new Error(`${nt} is required`);return 0}const it=parseInt(Xe);if(isNaN(it)||!Number.isInteger(it))throw new Error(`${nt} must be a valid whole number`);return it},ze={name:S.product_name?.trim()||(()=>{throw new Error("Product name is required")})(),category:S.category?.trim()||(()=>{throw new Error("Category is required")})(),price:S.is_weighted?0:Ce(S.price,"Price",!ne),stock_quantity:Ve(S.stock_quantity,"Stock quantity",!ne),supplier_info:S.supplier_info?.trim()||"",reorder_level:Ve(S.reorder_level,"Reorder level",!ne),tax_rate:S.tax_rate?Ce(S.tax_rate,"Tax rate",!1):0,last_updated:new Date().toISOString(),is_weighted:S.is_weighted||!1,weight_unit:S.is_weighted?S.weight_unit:null,price_per_unit:S.is_weighted&&S.price_per_unit?Ce(S.price_per_unit,"Price per unit",!1):null,description:S.description?.trim()||"",sku:S.sku?.trim()||""};return Q?{...ze,product_id:Q}:ze},G=async S=>{S.preventDefault(),console.log("Form submitted, newProduct:",k),K(!0);try{const Q=P();console.log("Generated product ID:",Q);const ne=W(k,Q);console.log("Inserting product data:",ne);const{data:Ce,error:Ve}=await Oe.from("products").insert([ne]).select();if(Ve)throw console.error("Supabase error:",Ve),Ve;if(console.log("Product added successfully!"),Be){const ze=await Ye(Q);if(ze){const Xe={...Ce[0],image_url:ze};a(nt=>[...nt,Xe])}}else a(ze=>[...ze,Ce[0]]);St(ze=>ze+1),J({product_name:"",category:"",price:"",stock_quantity:"100",reorder_level:"10",supplier_info:"",tax_rate:"",description:"",sku:"",is_weighted:!1,weight_unit:"",price_per_unit:""}),rt(null),$e(null),Ae(!1),ut(),Pt(!0),Lt(!0)}catch(Q){console.error("Error adding product:",Q);let ne="Failed to add product";Q instanceof Error&&Q.message&&(Q.message.includes("is required")||Q.message.includes("must be a valid")?ne=Q.message:Q.message.includes("duplicate key value violates unique constraint")?ne="A product with this ID already exists. Please try again.":Q.message.includes("violates check constraint")?ne="Invalid data provided. Please check your input values.":Q.message.includes("not-null constraint")?ne="Required fields are missing. Please fill in all required fields.":ne=`Failed to add product: ${Q.message}`),f(ne)}finally{K(!1)}},me=async S=>{if(S.preventDefault(),!!ae){K(!0),f(null);try{console.log("Editing product data:",k);const Q=W(k,void 0,!0);console.log("Transformed product data:",Q);const{data:ne,error:Ce}=await Oe.from("products").update(Q).eq("product_id",ae.product_id).select();if(Ce)throw console.error("Supabase error:",Ce),console.error("Error details:",JSON.stringify(Ce,null,2)),Ce;let Ve=ne[0];if(Be){const ze=await Ye(ae.product_id);ze&&(Ve={...ne[0],image_url:ze})}a(r.map(ze=>ze.product_id===ae.product_id?Ve:ze)),ce(),ye(!1),Se(null),ut(),Pt(!0),Lt(!0)}catch(Q){console.error("Failed to update product:",Q);let ne="Failed to update product";Q instanceof Error&&Q.message&&(Q.message.includes("is required")||Q.message.includes("must be a valid")?ne=Q.message:Q.message.includes("violates check constraint")?ne="Invalid data provided. Please check your input values.":Q.message.includes("not-null constraint")?ne="Required fields are missing. Please fill in all required fields.":ne=`Failed to update product: ${Q.message}`),f(ne)}finally{K(!1)}}},Me=async S=>{try{console.log(" Starting delete for product:",S);const{error:Q}=await Oe.from("products").delete().eq("product_id",S);if(Q)throw console.error(" Error deleting product:",Q),Q;console.log(" Product deleted successfully"),a(r.filter(ne=>ne.product_id!==S)),We(null),St(ne=>Math.max(0,ne-1)),Pt(!0),Lt(!0)}catch(Q){console.error(" Delete failed:",Q),f(Q instanceof Error?Q.message:"Failed to delete product")}},ce=()=>{J({product_name:"",category:"",price:"",stock_quantity:"100",reorder_level:"10",supplier_info:"",tax_rate:"",description:"",sku:"",is_weighted:!1,weight_unit:"",price_per_unit:""}),rt(null),$e(null),Ae(!1),ye(!1),Se(null)},we=S=>{console.log("Starting edit for product:",S),Se(S),J({product_name:S.name,category:S.category,price:S.is_weighted?S.price_per_unit?.toString()||"":S.price.toString(),stock_quantity:S.stock_quantity.toString(),reorder_level:S.reorder_level.toString(),supplier_info:S.supplier_info||"",tax_rate:S.tax_rate?.toString()||"",description:S.description||"",sku:S.sku||"",is_weighted:S.is_weighted||!1,weight_unit:S.weight_unit||"",price_per_unit:S.price_per_unit?.toString()||""}),$e(S.image_url||null),rt(null),ye(!0),console.log("Edit modal should be open now")},Te=S=>{const Q=S.target.files?.[0];if(Q){rt(Q);const ne=new FileReader;ne.onload=Ce=>{$e(Ce.target?.result)},ne.readAsDataURL(Q)}},Ye=async S=>{if(!Be)return null;try{return await X4(Be,S)}catch(Q){return console.error("Image upload failed:",Q),null}},Je=S=>{je(S),be(!0)},ct=()=>{be(!1),je(null)},Qe=(S,Q)=>S===0?{status:"out",color:"#ef4444",bgColor:"#fef2f2",textColor:"#dc2626"}:S<=Q?{status:"low",color:"#f59e0b",bgColor:"#fffbeb",textColor:"#d97706"}:{status:"good",color:"#10b981",bgColor:"#f0fdf4",textColor:"#059669"},at=S=>{const Q=S.toLowerCase();return Q.includes("small")?"#3b82f6":Q.includes("large")?"#ef4444":Q.includes("medium")?"#f59e0b":"#7d8d86"},bt=S=>{const Q=S.split(" ");return Q.map((ne,Ce)=>{const Ve=ne.toLowerCase();let ze="#1a1a1a";return Ve==="small"?ze="#3b82f6":Ve==="large"?ze="#ef4444":Ve==="medium"&&(ze="#f59e0b"),i.jsxs("span",{style:{color:ze},children:[ne,Ce<Q.length-1?" ":""]},Ce)})},B=()=>i.jsxs("div",{style:{position:"fixed",bottom:"20px",right:"20px",zIndex:1e3,display:"flex",alignItems:"flex-end",gap:"12px"},children:[Y&&i.jsxs("div",{style:{background:"#f8fafc",border:"2px solid #7d8d86",borderRadius:"16px",padding:"12px 16px",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.15)",maxWidth:"250px",fontSize:"14px",color:"#3e3f29",position:"relative",marginBottom:"8px"},children:[i.jsx("p",{style:{margin:0,fontWeight:"500"},children:pe}),i.jsx("div",{style:{position:"absolute",bottom:"-8px",right:"20px",width:"0",height:"0",borderLeft:"8px solid transparent",borderRight:"8px solid transparent",borderTop:"8px solid #7d8d86"}})]}),i.jsx("div",{style:{width:"60px",height:"60px",borderRadius:"50%",background:"#f8fafc",border:"3px solid #7d8d86",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 4px 15px rgba(0, 0, 0, 0.1)",transition:"transform 0.2s ease"},onClick:()=>H(!Y),onMouseEnter:S=>{const Q=S.target;Q.style.transform="scale(1.05)"},onMouseLeave:S=>{const Q=S.target;Q.style.transform="scale(1)"},children:i.jsx("img",{src:t?.icon?`/images/icons/${t.icon}.png`:"/images/backgrounds/lily.png",alt:t?.icon||"Lily",style:{width:"50px",height:"50px",borderRadius:"50%"}})})]});return o?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:i.jsxs("div",{style:{fontSize:"20px",color:"#7d8d86",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite",fontSize:"24px"}}),"Loading inventory..."]})}):i.jsxs("div",{style:{padding:"24px",background:"#f8fafc",minHeight:"100vh",border:"1px solid rgba(125, 141, 134, 0.1)",borderRadius:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"32px",padding:"20px",background:"#f8fafc",borderRadius:"12px",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsxs("div",{children:[i.jsx("h1",{style:{fontSize:"32px",fontWeight:"bold",color:"#3e3f29",margin:"0 0 8px 0"},children:"Inventory Management"}),i.jsx("p",{style:{fontSize:"16px",color:"#7d8d86",margin:0},children:"Manage your product inventory, stock levels, and suppliers."})]}),e("canManageProducts")&&i.jsxs("button",{onClick:()=>{console.log("Add Product button clicked"),Ae(!0),console.log("showAddModal set to true")},style:{background:"#7d8d86",color:"#f1f0e4",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",fontSize:"14px",fontWeight:"500"},onMouseEnter:S=>{S.target.style.background="#bca88d",Ge("Click this button to add a new product to your inventory! You'll need to fill in details like name, price, stock quantity, and reorder level."),H(!0)},onMouseLeave:S=>{S.target.style.background="#7d8d86",H(!1)},children:[i.jsx("i",{className:"fa-solid fa-plus",style:{fontSize:"16px"}}),i.jsx("span",{children:"Add Product"})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"20px",marginBottom:"32px",padding:"20px",background:"#f8fafc",borderRadius:"12px",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsx("div",{onClick:()=>zt("totalProducts"),style:{background:x==="totalProducts"?"#f0f8f0":"#f8fafc",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",cursor:"pointer",transition:"all 0.2s ease",border:x==="totalProducts"?"2px solid #7d8d86":"2px solid transparent"},onMouseEnter:S=>{x!=="totalProducts"&&(S.target.style.background="#f1f5f9")},onMouseLeave:S=>{x!=="totalProducts"&&(S.target.style.background="#f8fafc")},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",background:"#7d8d86",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-boxes-stacked",style:{fontSize:"18px",color:"#f1f0e4"}})}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"24px",fontWeight:"bold",color:"#3e3f29",margin:"0 0 4px 0"},children:p.totalProducts}),i.jsx("p",{style:{fontSize:"12px",color:"#7d8d86",margin:0},children:"Total Products"})]})]})}),i.jsx("div",{onClick:()=>zt("inStock"),style:{background:x==="inStock"?"#f0fdf4":"#f8fafc",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",cursor:"pointer",transition:"all 0.2s ease",border:x==="inStock"?"2px solid #10b981":"2px solid transparent"},onMouseEnter:S=>{x!=="inStock"&&(S.target.style.background="#f1f5f9")},onMouseLeave:S=>{x!=="inStock"&&(S.target.style.background="#f8fafc")},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",background:"#10b981",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-circle-check",style:{fontSize:"18px",color:"white"}})}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"24px",fontWeight:"bold",color:"#3e3f29",margin:"0 0 4px 0"},children:p.inStock}),i.jsx("p",{style:{fontSize:"12px",color:"#7d8d86",margin:0},children:"In Stock"})]})]})}),i.jsx("div",{onClick:()=>zt("lowStock"),style:{background:x==="lowStock"?"#fffbeb":"#f8fafc",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",cursor:"pointer",transition:"all 0.2s ease",border:x==="lowStock"?"2px solid #f59e0b":"2px solid transparent"},onMouseEnter:S=>{x!=="lowStock"&&(S.target.style.background="#f1f5f9")},onMouseLeave:S=>{x!=="lowStock"&&(S.target.style.background="#f8fafc")},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",background:"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-triangle-exclamation",style:{fontSize:"18px",color:"white"}})}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"24px",fontWeight:"bold",color:"#3e3f29",margin:"0 0 4px 0"},children:p.lowStock}),i.jsx("p",{style:{fontSize:"12px",color:"#7d8d86",margin:0},children:"Low Stock"})]})]})}),i.jsx("div",{onClick:()=>zt("outOfStock"),style:{background:x==="outOfStock"?"#fef2f2":"#f8fafc",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",cursor:"pointer",transition:"all 0.2s ease",border:x==="outOfStock"?"2px solid #ef4444":"2px solid transparent"},onMouseEnter:S=>{x!=="outOfStock"&&(S.target.style.background="#f1f5f9")},onMouseLeave:S=>{x!=="outOfStock"&&(S.target.style.background="#f8fafc")},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"8px",background:"#ef4444",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-circle-xmark",style:{fontSize:"18px",color:"white"}})}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"24px",fontWeight:"bold",color:"#3e3f29",margin:"0 0 4px 0"},children:p.outOfStock}),i.jsx("p",{style:{fontSize:"12px",color:"#7d8d86",margin:0},children:"Out of Stock"})]})]})})]}),i.jsx("div",{style:{background:"#f8fafc",borderRadius:"12px",padding:"20px",marginBottom:"24px",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",border:"2px solid rgba(125, 141, 134, 0.3)"},children:i.jsxs("div",{style:{display:"flex",gap:"24px",alignItems:"center",flexWrap:"wrap"},children:[i.jsx("div",{style:{flex:"1",minWidth:"250px",maxWidth:"400px"},children:i.jsxs("div",{style:{position:"relative",display:"flex",gap:"8px"},children:[i.jsxs("div",{style:{position:"relative",flex:1},children:[i.jsx("i",{className:"fa-solid fa-search",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#7d8d86",fontSize:"14px",zIndex:1}}),i.jsx("input",{type:"text",placeholder:"Search products... (Press Enter to search)",value:te,onChange:se,onKeyPress:wt,onBlur:()=>{setTimeout(()=>le(!1),200)},onFocus:()=>{te.length>=2&&ge.length>0&&le(!0)},style:{width:"100%",padding:"10px 12px 10px 36px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29",boxSizing:"border-box"}}),te&&i.jsx("button",{onClick:gt,style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",color:"#7d8d86",cursor:"pointer",padding:"4px",borderRadius:"4px",fontSize:"12px",transition:"color 0.2s ease"},onMouseEnter:S=>S.target.style.color="#ef4444",onMouseLeave:S=>S.target.style.color="#7d8d86",children:i.jsx("i",{className:"fa-solid fa-times"})}),X&&ge.length>0&&i.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,backgroundColor:"white",border:"1px solid #d1d5db",borderTop:"none",borderRadius:"0 0 8px 8px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",zIndex:50,maxHeight:"300px",overflow:"auto"},children:ge.map((S,Q)=>i.jsx("div",{onClick:()=>_e(S),style:{padding:"12px",cursor:"pointer",fontSize:"14px",color:"#3e3f29",borderBottom:Q<ge.length-1?"1px solid #f3f4f6":"none",transition:"background 0.2s ease",display:"flex",alignItems:"center",gap:"12px"},onMouseEnter:ne=>ne.target.style.background="#f9fafb",onMouseLeave:ne=>ne.target.style.background="#f8fafc",children:S.type==="product"?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"6px",overflow:"hidden",flexShrink:0,backgroundColor:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center"},children:S.product.image_url?i.jsx("img",{src:S.product.image_url,alt:S.product.name,style:{width:"100%",height:"100%",objectFit:"cover"}}):i.jsx("i",{className:"fa-solid fa-box",style:{color:"#9ca3af",fontSize:"16px"}})}),i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsx("div",{style:{fontWeight:"500",marginBottom:"2px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:S.product.name}),i.jsxs("div",{style:{fontSize:"12px",color:"#6b7280",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("span",{children:S.product.category}),i.jsx("span",{children:""}),i.jsx("span",{style:{fontWeight:"500",color:"#059669"},children:S.product.is_weighted?`${S.product.price_per_unit}/${S.product.weight_unit}`:`${S.product.price}`}),S.product.sku&&i.jsxs(i.Fragment,{children:[i.jsx("span",{children:""}),i.jsxs("span",{children:["SKU: ",S.product.sku]})]})]})]}),i.jsx("i",{className:"fa-solid fa-box",style:{color:"#7d8d86",fontSize:"14px",flexShrink:0}})]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-tags",style:{color:"#7d8d86",fontSize:"16px",width:"16px",flexShrink:0}}),i.jsxs("div",{style:{flex:1,minWidth:0},children:[i.jsx("div",{style:{fontWeight:"500",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:S.name}),i.jsx("div",{style:{fontSize:"12px",color:"#6b7280"},children:"Category"})]}),i.jsx("i",{className:"fa-solid fa-arrow-right",style:{color:"#7d8d86",fontSize:"12px",flexShrink:0}})]})},Q))})]}),i.jsxs("button",{onClick:Yt,style:{padding:"10px 16px",background:"#7d8d86",color:"#f1f0e4",border:"none",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background 0.2s ease",display:"flex",alignItems:"center",gap:"6px",whiteSpace:"nowrap"},onMouseEnter:S=>S.target.style.background="#bca88d",onMouseLeave:S=>S.target.style.background="#7d8d86",children:[i.jsx("i",{className:"fa-solid fa-search",style:{fontSize:"12px"}}),"Search"]})]})}),i.jsx("div",{style:{minWidth:"180px"},children:i.jsx("select",{value:re,onChange:S=>L(S.target.value),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29",cursor:"pointer"},children:yr.map(S=>i.jsx("option",{value:S,children:S==="all"?"All Categories":S},S))})})]})}),i.jsx("div",{style:{background:"#f8fafc",borderRadius:"12px",overflow:"hidden",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)",border:"2px solid rgba(125, 141, 134, 0.3)"},children:i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{style:{background:"#3e3f29",borderBottom:"4px solid #7d8d86"},children:i.jsxs("tr",{children:[i.jsx("th",{style:{padding:"16px",textAlign:"left",color:"#f1f0e4",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",borderBottom:"4px solid #7d8d86",borderRight:"2px solid #7d8d86"},children:"Product"}),i.jsx("th",{style:{padding:"16px",textAlign:"left",color:"#f1f0e4",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",borderBottom:"4px solid #7d8d86",borderRight:"2px solid #7d8d86"},children:"Category"}),i.jsx("th",{style:{padding:"16px",textAlign:"left",color:"#f1f0e4",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",borderBottom:"4px solid #7d8d86",borderRight:"2px solid #7d8d86"},children:"Price"}),i.jsx("th",{style:{padding:"16px",textAlign:"left",color:"#f1f0e4",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",borderBottom:"4px solid #7d8d86",borderRight:"2px solid #7d8d86"},children:"Stock"}),i.jsx("th",{style:{padding:"16px",textAlign:"left",color:"#f1f0e4",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",borderBottom:"4px solid #7d8d86",borderRight:"2px solid #7d8d86"},children:"Status"}),i.jsx("th",{style:{padding:"16px",textAlign:"left",color:"#f1f0e4",fontSize:"12px",fontWeight:"600",textTransform:"uppercase",borderBottom:"4px solid #7d8d86"},children:"Actions"})]})}),i.jsx("tbody",{style:{border:"1px solid rgba(125, 141, 134, 0.2)"},children:Dr.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:6,style:{padding:"40px",textAlign:"center",color:"#7d8d86"},children:[i.jsx("i",{className:"fa-solid fa-boxes-stacked",style:{fontSize:"48px",marginBottom:"16px",opacity:.5}}),i.jsx("p",{style:{fontSize:"16px",margin:0},children:"No products found"}),i.jsx("p",{style:{fontSize:"14px",margin:"8px 0 0 0"},children:"Add your first product to get started!"})]})}):Dr.map(S=>{const Q=Qe(S.stock_quantity,S.reorder_level);return i.jsxs("tr",{style:{borderBottom:"2px solid rgba(125, 141, 134, 0.3)",borderLeft:"1px solid rgba(125, 141, 134, 0.2)",borderRight:"1px solid rgba(125, 141, 134, 0.2)",transition:"background 0.2s ease",cursor:"pointer"},onClick:()=>In(S),onMouseEnter:ne=>ne.target.style.background="rgba(125, 141, 134, 0.05)",onMouseLeave:ne=>ne.target.style.background="transparent",children:[i.jsx("td",{style:{padding:"16px",borderRight:"2px solid rgba(125, 141, 134, 0.25)"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[S.image_url&&i.jsx("img",{src:S.image_url,alt:S.name,onClick:ne=>{ne.stopPropagation(),S.image_url&&Je(S.image_url)},style:{width:"48px",height:"48px",objectFit:"cover",borderRadius:"8px",border:"2px solid #bca88d",background:"#f3f4f6",cursor:"pointer",transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:ne=>{const Ce=ne.target;Ce.style.transform="scale(1.05)",Ce.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)",Ge("Click on the image to see it in full size! This helps you get a better look at the product."),H(!0)},onMouseLeave:ne=>{const Ce=ne.target;Ce.style.transform="scale(1)",Ce.style.boxShadow="none",H(!1)}}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"600",margin:"0 0 4px 0"},children:bt(S.name)}),i.jsxs("p",{style:{fontSize:"12px",color:"#7d8d86",margin:0},children:["ID: ",S.product_id]})]})]})}),i.jsx("td",{style:{padding:"16px",borderRight:"2px solid rgba(125, 141, 134, 0.25)"},children:i.jsx("span",{style:{background:"#f3f4f6",color:at(S.category),padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",border:`1px solid ${at(S.category)}`},children:S.category})}),i.jsxs("td",{style:{padding:"16px",borderRight:"2px solid rgba(125, 141, 134, 0.25)"},children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"600",color:"#3e3f29",margin:0},children:S.is_weighted&&S.price_per_unit&&S.weight_unit?`${S.price_per_unit.toFixed(2)}/${S.weight_unit}`:`${S.price.toFixed(2)}`}),S.is_weighted&&i.jsx("p",{style:{fontSize:"12px",color:"#7d8d86",margin:"4px 0 0 0"},children:"Sold by weight"})]}),i.jsxs("td",{style:{padding:"16px",borderRight:"2px solid rgba(125, 141, 134, 0.25)"},children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"600",color:"#3e3f29",margin:0},children:S.stock_quantity}),i.jsxs("p",{style:{fontSize:"12px",color:"#7d8d86",margin:0},children:["Reorder: ",S.reorder_level]})]}),i.jsx("td",{style:{padding:"16px",borderRight:"2px solid rgba(125, 141, 134, 0.25)"},children:i.jsx("span",{style:{background:Q.bgColor,color:Q.textColor,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500",textTransform:"capitalize"},children:Q.status==="good"?"In Stock":Q.status==="low"?"Low Stock":"Out of Stock"})}),i.jsx("td",{style:{padding:"16px"},children:i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e("canManageProducts")&&i.jsxs("button",{onClick:ne=>{ne.stopPropagation(),console.log("Edit button clicked for product:",S.name),we(S)},style:{background:"#7d8d86",color:"#f1f0e4",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",transition:"background 0.2s ease"},onMouseEnter:ne=>{ne.target.style.background="#bca88d",Ge(`Click to edit "${S.name}". You can update the price, stock quantity, reorder level, and other details!`),H(!0)},onMouseLeave:ne=>{ne.target.style.background="#7d8d86",H(!1)},children:[i.jsx("i",{className:"fa-solid fa-pen-to-square",style:{marginRight:"4px"}}),"Edit"]}),i.jsxs("button",{onClick:ne=>{ne.stopPropagation(),We(S)},style:{background:"#ef4444",color:"white",border:"none",padding:"6px 12px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",transition:"background 0.2s ease"},onMouseEnter:ne=>ne.target.style.background="#dc2626",onMouseLeave:ne=>ne.target.style.background="#ef4444",children:[i.jsx("i",{className:"fa-solid fa-trash-can",style:{marginRight:"4px"}}),"Delete"]})]})})]},S.product_id)})})]})})}),i.jsx("div",{style:{marginTop:"16px",fontSize:"14px",color:"#7d8d86",textAlign:"center",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid rgba(125, 141, 134, 0.2)",marginBottom:"16px"},children:ht>0?i.jsxs(i.Fragment,{children:["Showing ",hr,"-",Gt," of ",ht," products",fr>1&&i.jsxs("span",{style:{marginLeft:"16px"},children:["(Page ",ot," of ",fr,")"]})]}):"No products found"}),fr>1&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"16px",background:"#f8fafc",borderRadius:"12px",boxShadow:"0 2px 8px rgba(62, 63, 41, 0.1)",border:"1px solid rgba(125, 141, 134, 0.2)",marginBottom:"24px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("label",{style:{fontSize:"14px",color:"#3e3f29",fontWeight:"500"},children:"Show:"}),i.jsxs("select",{value:tt,onChange:S=>C(parseInt(S.target.value)),style:{padding:"6px 12px",border:"2px solid #bca88d",borderRadius:"6px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29",cursor:"pointer"},children:[i.jsx("option",{value:5,children:"5"}),i.jsx("option",{value:10,children:"10"}),i.jsx("option",{value:25,children:"25"}),i.jsx("option",{value:50,children:"50"}),i.jsx("option",{value:100,children:"100"})]}),i.jsx("span",{style:{fontSize:"14px",color:"#7d8d86"},children:"per page"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs("button",{onClick:q,disabled:ot===1,style:{padding:"8px 12px",border:"2px solid #bca88d",borderRadius:"6px",background:ot===1?"#f3f4f6":"white",color:ot===1?"#9ca3af":"#3e3f29",cursor:ot===1?"not-allowed":"pointer",fontSize:"14px",transition:"all 0.2s ease"},onMouseEnter:S=>{ot!==1&&(S.target.style.background="#f8f9fa")},onMouseLeave:S=>{ot!==1&&(S.target.style.background="#f8fafc")},children:[i.jsx("i",{className:"fa-solid fa-chevron-left",style:{marginRight:"4px"}}),"Previous"]}),i.jsx("div",{style:{display:"flex",gap:"4px"},children:Array.from({length:Math.min(5,fr)},(S,Q)=>{let ne;return fr<=5||ot<=3?ne=Q+1:ot>=fr-2?ne=fr-4+Q:ne=ot-2+Q,i.jsx("button",{onClick:()=>ya(ne),style:{padding:"8px 12px",border:"2px solid #bca88d",borderRadius:"6px",background:ot===ne?"#7d8d86":"white",color:ot===ne?"#f1f0e4":"#3e3f29",cursor:"pointer",fontSize:"14px",fontWeight:ot===ne?"600":"400",transition:"all 0.2s ease",minWidth:"40px"},onMouseEnter:Ce=>{ot!==ne&&(Ce.target.style.background="#f8f9fa")},onMouseLeave:Ce=>{ot!==ne&&(Ce.target.style.background="#f8fafc")},children:ne},ne)})}),i.jsxs("button",{onClick:I,disabled:ot===fr,style:{padding:"8px 12px",border:"2px solid #bca88d",borderRadius:"6px",background:ot===fr?"#f3f4f6":"white",color:ot===fr?"#9ca3af":"#3e3f29",cursor:ot===fr?"not-allowed":"pointer",fontSize:"14px",transition:"all 0.2s ease"},onMouseEnter:S=>{ot!==fr&&(S.target.style.background="#f8f9fa")},onMouseLeave:S=>{ot!==fr&&(S.target.style.background="#f8fafc")},children:["Next",i.jsx("i",{className:"fa-solid fa-chevron-right",style:{marginLeft:"4px"}})]})]})]}),fe&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},children:i.jsxs("div",{style:{background:"#f8fafc",borderRadius:"16px",padding:"32px",width:"90%",maxWidth:"600px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.3)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[i.jsx("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#3e3f29",margin:0},children:"Add New Product"}),i.jsx("button",{onClick:ce,style:{background:"none",border:"none",fontSize:"24px",color:"#7d8d86",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:S=>{S.target.style.background="#f3f4f6",S.target.style.color="#3e3f29",Ge("Click this X button to close the form without saving. It's the same as clicking Cancel!"),H(!0)},onMouseLeave:S=>{S.target.style.background="none",S.target.style.color="#7d8d86",H(!1)},children:i.jsx("i",{className:"fa-solid fa-times"})})]}),i.jsxs("form",{onSubmit:G,children:[d&&i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626",padding:"12px",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:d}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Product Name *"}),i.jsx("input",{type:"text",required:!0,value:k.product_name,onChange:S=>J({...k,product_name:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"e.g., Plantain Chips, Jollof Rice Mix"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Category *"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("input",{type:"text",required:!0,value:k.category,onChange:S=>{J({...k,category:S.target.value}),De(S.target.value.length>=2)},onFocus:()=>{De(k.category.length>=2),Ge("Start typing a category name and I'll suggest similar ones you've used before! This helps keep your categories consistent."),H(!0)},onBlur:()=>setTimeout(()=>De(!1),200),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"e.g., Grains, Spices, Beverages"}),He&&Gr(k.category).length>0&&i.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"#f8fafc",border:"2px solid #bca88d",borderTop:"none",borderRadius:"0 0 8px 8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",zIndex:1e3,maxHeight:"200px",overflow:"auto"},children:Gr(k.category).map((S,Q)=>i.jsxs("div",{onClick:()=>{J({...k,category:S}),De(!1),Ge(`Great choice! I've selected "${S}" for you. This helps keep your categories organized!`),H(!0)},style:{padding:"10px 12px",cursor:"pointer",fontSize:"14px",color:"#3e3f29",borderBottom:Q<Gr(k.category).length-1?"1px solid #f3f4f6":"none",transition:"background 0.2s ease"},onMouseEnter:ne=>ne.target.style.background="#f8f9fa",onMouseLeave:ne=>ne.target.style.background="transparent",children:[i.jsx("i",{className:"fa-solid fa-tag",style:{marginRight:"8px",color:"#7d8d86",fontSize:"12px"}}),S]},Q))})]})]})]}),i.jsxs("div",{style:{marginBottom:"16px",padding:"16px",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"},children:[i.jsx("input",{type:"checkbox",id:"is_weighted",checked:k.is_weighted,onChange:S=>J({...k,is_weighted:S.target.checked}),style:{width:"16px",height:"16px"}}),i.jsx("label",{htmlFor:"is_weighted",style:{fontSize:"14px",fontWeight:"500",color:"#3e3f29",cursor:"pointer"},children:"This product is sold by weight (e.g., fruits, vegetables, meat)"})]}),k.is_weighted&&i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Weight Unit *"}),i.jsxs("select",{value:k.weight_unit,onChange:S=>J({...k,weight_unit:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},children:[i.jsx("option",{value:"",children:"Select unit"}),i.jsx("option",{value:"kg",children:"Kilogram (kg)"}),i.jsx("option",{value:"g",children:"Gram (g)"}),i.jsx("option",{value:"lb",children:"Pound (lb)"}),i.jsx("option",{value:"oz",children:"Ounce (oz)"}),i.jsx("option",{value:"l",children:"Liter (l)"}),i.jsx("option",{value:"ml",children:"Milliliter (ml)"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:["Price per ",k.weight_unit||"unit"," *"]}),i.jsx("input",{type:"number",step:"0.01",required:k.is_weighted,value:k.price_per_unit,onChange:S=>J({...k,price_per_unit:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"0.00"})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:["Price ",k.is_weighted?"(Auto-set to 0 for weighted items)":"*"]}),i.jsx("input",{type:"number",step:"0.01",required:!k.is_weighted,value:k.is_weighted?"0":k.price,onChange:S=>{k.is_weighted||J({...k,price:S.target.value})},style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:k.is_weighted?"#f9fafb":"white",color:k.is_weighted?"#6b7280":"#3e3f29",cursor:k.is_weighted?"not-allowed":"text"},placeholder:k.is_weighted?"0.00 (auto-set for weighted items)":"0.00",disabled:k.is_weighted})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Stock Quantity *"}),i.jsx("input",{type:"number",required:!0,value:k.stock_quantity,onChange:S=>J({...k,stock_quantity:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"0"})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Reorder Level *"}),i.jsx("input",{type:"number",required:!0,value:k.reorder_level,onChange:S=>J({...k,reorder_level:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"10"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Tax Rate (%)"}),i.jsx("input",{type:"number",step:"0.01",value:k.tax_rate,onChange:S=>J({...k,tax_rate:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"0.00"})]})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Supplier Information"}),i.jsx("input",{type:"text",value:k.supplier_info,onChange:S=>J({...k,supplier_info:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"e.g., African Foods Ltd, +234-xxx-xxxx"})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"SKU (Auto-generated if empty)"}),i.jsx("input",{type:"text",value:k.sku,onChange:S=>J({...k,sku:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"Leave empty for auto-generation"})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Product Image"}),i.jsxs("div",{style:{display:"flex",gap:"16px",alignItems:"center"},children:[i.jsx("input",{type:"file",accept:"image/*",onChange:Te,style:{display:"none"},id:"image-upload"}),i.jsxs("label",{htmlFor:"image-upload",style:{padding:"10px 16px",border:"2px dashed #bca88d",borderRadius:"8px",cursor:"pointer",fontSize:"14px",color:"#7d8d86",textAlign:"center",transition:"all 0.2s ease",minWidth:"120px"},onMouseEnter:S=>{S.target.style.borderColor="#7d8d86",S.target.style.color="#3e3f29",Ge("Click here to upload a product image! This helps customers see what they're buying."),H(!0)},onMouseLeave:S=>{S.target.style.borderColor="#bca88d",S.target.style.color="#7d8d86",H(!1)},children:[i.jsx("i",{className:"fa-solid fa-camera",style:{marginRight:"8px"}}),"Choose Image"]}),(de||ae?.image_url)&&i.jsxs("div",{style:{position:"relative"},children:[i.jsx("img",{src:de||ae?.image_url,alt:"Preview",onClick:()=>{const S=de||ae?.image_url;S&&Je(S)},style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"8px",border:"2px solid #bca88d",background:"#f3f4f6",cursor:"pointer",transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:S=>{const Q=S.target;Q.style.transform="scale(1.05)",Q.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)"},onMouseLeave:S=>{const Q=S.target;Q.style.transform="scale(1)",Q.style.boxShadow="none"}}),i.jsx("button",{type:"button",onClick:()=>{$e(null),rt(null)},style:{position:"absolute",top:"-8px",right:"-8px",width:"24px",height:"24px",borderRadius:"50%",background:"#ef4444",border:"none",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-times"})})]})]})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Description"}),i.jsx("textarea",{value:k.description,onChange:S=>J({...k,description:S.target.value}),rows:3,style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29",resize:"vertical"},placeholder:"e.g., Crispy plantain chips made from fresh plantains, perfect for snacking"})]}),i.jsxs("div",{style:{display:"flex",gap:"16px",justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:ce,style:{background:"#f3f4f6",color:"#3e3f29",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background 0.2s ease"},onMouseEnter:S=>{S.target.style.background="#e5e7eb",Ge("This will close the form and clear all the information you've entered. Don't worry, you can always start over!"),H(!0)},onMouseLeave:S=>{S.target.style.background="#f3f4f6",H(!1)},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:O,style:{background:O?"#9ca3af":"#7d8d86",color:"#ffffff",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:O?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",transition:"background 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:S=>{O||(Ge("This will save your new product to the inventory! Make sure all required fields are filled out before clicking."),H(!0))},onMouseLeave:S=>{O||H(!1)},children:O?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite"}}),"Adding..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-plus"}),"Add Product"]})})]})]})]})}),ee&&ae&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"20px"},children:i.jsxs("div",{style:{background:"#f8fafc",borderRadius:"12px",padding:"32px",width:"100%",maxWidth:"600px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[i.jsx("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#3e3f29",margin:0},children:"Edit Product"}),i.jsx("button",{onClick:ce,style:{background:"none",border:"none",fontSize:"24px",color:"#7d8d86",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:S=>{S.target.style.background="#f3f4f6",S.target.style.color="#3e3f29",Ge("Click this X button to close the edit form without saving. It's the same as clicking Cancel!"),H(!0)},onMouseLeave:S=>{S.target.style.background="none",S.target.style.color="#7d8d86",H(!1)},children:i.jsx("i",{className:"fa-solid fa-times"})})]}),i.jsxs("form",{onSubmit:me,children:[d&&i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626",padding:"12px",borderRadius:"8px",marginBottom:"16px",fontSize:"14px"},children:d}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Product Name *"}),i.jsx("input",{type:"text",required:!0,value:k.product_name,onChange:S=>J({...k,product_name:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"e.g., Plantain Chips, Jollof Rice Mix"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Category *"}),i.jsxs("div",{style:{position:"relative"},children:[i.jsx("input",{type:"text",required:!0,value:k.category,onChange:S=>{J({...k,category:S.target.value}),De(S.target.value.length>=2)},onFocus:()=>{De(k.category.length>=2),Ge("Start typing a category name and I'll suggest similar ones you've used before! This helps keep your categories consistent."),H(!0)},onBlur:()=>setTimeout(()=>De(!1),200),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"e.g., Grains, Spices, Beverages"}),He&&Gr(k.category).length>0&&i.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"#f8fafc",border:"2px solid #bca88d",borderTop:"none",borderRadius:"0 0 8px 8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",zIndex:1e3,maxHeight:"200px",overflow:"auto"},children:Gr(k.category).map((S,Q)=>i.jsxs("div",{onClick:()=>{J({...k,category:S}),De(!1),Ge(`Great choice! I've selected "${S}" for you. This helps keep your categories organized!`),H(!0)},style:{padding:"10px 12px",cursor:"pointer",fontSize:"14px",color:"#3e3f29",borderBottom:Q<Gr(k.category).length-1?"1px solid #f3f4f6":"none",transition:"background 0.2s ease"},onMouseEnter:ne=>ne.target.style.background="#f8f9fa",onMouseLeave:ne=>ne.target.style.background="transparent",children:[i.jsx("i",{className:"fa-solid fa-tag",style:{marginRight:"8px",color:"#7d8d86",fontSize:"12px"}}),S]},Q))})]})]})]}),i.jsxs("div",{style:{marginBottom:"16px",padding:"16px",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"},children:[i.jsx("input",{type:"checkbox",id:"is_weighted_edit",checked:k.is_weighted,onChange:S=>J({...k,is_weighted:S.target.checked}),style:{width:"16px",height:"16px"}}),i.jsx("label",{htmlFor:"is_weighted_edit",style:{fontSize:"14px",fontWeight:"500",color:"#3e3f29",cursor:"pointer"},children:"This product is sold by weight (e.g., fruits, vegetables, meat)"})]}),k.is_weighted&&i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Weight Unit *"}),i.jsxs("select",{value:k.weight_unit,onChange:S=>J({...k,weight_unit:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},children:[i.jsx("option",{value:"",children:"Select unit"}),i.jsx("option",{value:"kg",children:"Kilogram (kg)"}),i.jsx("option",{value:"g",children:"Gram (g)"}),i.jsx("option",{value:"lb",children:"Pound (lb)"}),i.jsx("option",{value:"oz",children:"Ounce (oz)"}),i.jsx("option",{value:"l",children:"Liter (l)"}),i.jsx("option",{value:"ml",children:"Milliliter (ml)"})]})]}),i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:["Price per ",k.weight_unit||"unit"," *"]}),i.jsx("input",{type:"number",step:"0.01",required:k.is_weighted,value:k.price_per_unit,onChange:S=>J({...k,price_per_unit:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"0.00"})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[i.jsxs("div",{children:[i.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:["Price ",k.is_weighted?"(Auto-set to 0 for weighted items)":"*"]}),i.jsx("input",{type:"number",step:"0.01",required:!k.is_weighted,value:k.is_weighted?"0":k.price,onChange:S=>{k.is_weighted||J({...k,price:S.target.value})},style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:k.is_weighted?"#f9fafb":"white",color:k.is_weighted?"#6b7280":"#3e3f29",cursor:k.is_weighted?"not-allowed":"text"},placeholder:k.is_weighted?"0.00 (auto-set for weighted items)":"0.00",disabled:k.is_weighted})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Stock Quantity *"}),i.jsx("input",{type:"number",required:!0,value:k.stock_quantity,onChange:S=>J({...k,stock_quantity:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"0"})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px",marginBottom:"16px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Reorder Level *"}),i.jsx("input",{type:"number",required:!0,value:k.reorder_level,onChange:S=>J({...k,reorder_level:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"10"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Tax Rate (%)"}),i.jsx("input",{type:"number",step:"0.01",value:k.tax_rate,onChange:S=>J({...k,tax_rate:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"0.00"})]})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Supplier Information"}),i.jsx("input",{type:"text",value:k.supplier_info,onChange:S=>J({...k,supplier_info:S.target.value}),style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29"},placeholder:"e.g., African Foods Ltd, +234-xxx-xxxx"})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Product Image"}),i.jsxs("div",{style:{display:"flex",gap:"16px",alignItems:"center"},children:[i.jsx("input",{type:"file",accept:"image/*",onChange:Te,style:{display:"none"},id:"image-upload"}),i.jsxs("label",{htmlFor:"image-upload",style:{padding:"10px 16px",border:"2px dashed #bca88d",borderRadius:"8px",cursor:"pointer",fontSize:"14px",color:"#7d8d86",textAlign:"center",transition:"all 0.2s ease",minWidth:"120px"},onMouseEnter:S=>{S.target.style.borderColor="#7d8d86",S.target.style.color="#3e3f29",Ge("Click here to upload a product image! This helps customers see what they're buying."),H(!0)},onMouseLeave:S=>{S.target.style.borderColor="#bca88d",S.target.style.color="#7d8d86",H(!1)},children:[i.jsx("i",{className:"fa-solid fa-camera",style:{marginRight:"8px"}}),"Choose Image"]}),(de||ae?.image_url)&&i.jsxs("div",{style:{position:"relative"},children:[i.jsx("img",{src:de||ae?.image_url,alt:"Preview",onClick:()=>{const S=de||ae?.image_url;S&&Je(S)},style:{width:"80px",height:"80px",objectFit:"cover",borderRadius:"8px",border:"2px solid #bca88d",background:"#f3f4f6",cursor:"pointer",transition:"transform 0.2s ease, box-shadow 0.2s ease"},onMouseEnter:S=>{const Q=S.target;Q.style.transform="scale(1.05)",Q.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.15)"},onMouseLeave:S=>{const Q=S.target;Q.style.transform="scale(1)",Q.style.boxShadow="none"}}),i.jsx("button",{type:"button",onClick:()=>{$e(null),rt(null)},style:{position:"absolute",top:"-8px",right:"-8px",width:"24px",height:"24px",borderRadius:"50%",background:"#ef4444",border:"none",color:"white",cursor:"pointer",fontSize:"12px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-times"})})]})]})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#3e3f29",marginBottom:"6px"},children:"Description"}),i.jsx("textarea",{value:k.description,onChange:S=>J({...k,description:S.target.value}),rows:3,style:{width:"100%",padding:"10px 12px",border:"2px solid #bca88d",borderRadius:"8px",fontSize:"14px",background:"#f8fafc",color:"#3e3f29",resize:"vertical"},placeholder:"e.g., Crispy plantain chips made from fresh plantains, perfect for snacking"})]}),i.jsxs("div",{style:{display:"flex",gap:"16px",justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:ce,style:{background:"#f3f4f6",color:"#3e3f29",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:"pointer",fontSize:"14px",fontWeight:"500",transition:"background 0.2s ease"},onMouseEnter:S=>{S.target.style.background="#e5e7eb",Ge("This will close the edit form and discard any changes you've made. Don't worry, you can always edit again!"),H(!0)},onMouseLeave:S=>{S.target.style.background="#f3f4f6",H(!1)},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:O,style:{background:O?"#9ca3af":"#7d8d86",color:"#ffffff",border:"none",padding:"12px 24px",borderRadius:"8px",cursor:O?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",transition:"background 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:S=>{O||(Ge("This will save your changes to the product! Make sure all required fields are filled out before clicking."),H(!0))},onMouseLeave:S=>{O||H(!1)},children:O?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite"}}),"Updating..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-save"}),"Update Product"]})})]})]})]})}),z&&Ke&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.9)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:ct,children:i.jsx("div",{style:{position:"relative",width:"400px",height:"400px",display:"flex",alignItems:"center",justifyContent:"center",backgroundImage:`url(${Ke})`,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",borderRadius:"8px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)",backgroundColor:"#ffffff"},onClick:S=>S.stopPropagation(),children:i.jsx("button",{onClick:ct,style:{position:"absolute",top:"-40px",right:"-40px",width:"40px",height:"40px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.9)",border:"none",color:"#3e3f29",cursor:"pointer",fontSize:"20px",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s ease"},onMouseEnter:S=>S.target.style.background="rgba(255, 255, 255, 1)",onMouseLeave:S=>S.target.style.background="rgba(255, 255, 255, 0.9)",children:i.jsx("i",{className:"fa-solid fa-times"})})})}),dt&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{backgroundColor:"#ffffff",borderRadius:"16px",padding:"32px",maxWidth:"500px",width:"90%",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.5)"},children:[i.jsx("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#1a1a1a",marginBottom:"16px",textAlign:"center"},children:"Delete Product"}),i.jsxs("p",{style:{fontSize:"16px",color:"#1a1a1a",marginBottom:"8px",textAlign:"center"},children:["Are you sure you want to delete ",i.jsx("strong",{children:dt.name}),"?"]}),i.jsx("p",{style:{fontSize:"14px",color:"#ef4444",marginBottom:"24px",textAlign:"center"},children:"This action cannot be undone."}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>We(null),style:{background:"#6b7280",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"background 0.2s ease"},onMouseEnter:S=>S.target.style.background="#4b5563",onMouseLeave:S=>S.target.style.background="#6b7280",children:"Cancel"}),i.jsx("button",{onClick:()=>Me(dt.product_id),style:{background:"#ef4444",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"background 0.2s ease"},onMouseEnter:S=>S.target.style.background="#dc2626",onMouseLeave:S=>S.target.style.background="#ef4444",children:"Delete Product"})]})]})}),b&&w&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3,padding:"20px"},onClick:()=>v(!1),children:i.jsxs("div",{style:{background:"#f8fafc",borderRadius:"16px",padding:"32px",maxWidth:"800px",width:"100%",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)"},onClick:S=>S.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px",paddingBottom:"20px",borderBottom:"2px solid #f1f5f9"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[w.image_url&&i.jsxs("div",{style:{position:"relative"},children:[i.jsx("img",{src:w.image_url,alt:w.name,style:{width:"80px",height:"80px",borderRadius:"16px",objectFit:"cover",border:"3px solid #e5e7eb",background:"#f3f4f6",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"}}),i.jsx("div",{style:{position:"absolute",top:"-8px",right:"-8px",background:"#10b981",color:"white",borderRadius:"50%",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",fontWeight:"bold"},children:i.jsx("i",{className:"fas fa-chart-line"})})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[i.jsx("i",{className:"fas fa-analytics",style:{color:"#7d8d86",fontSize:"20px"}}),i.jsx("h2",{style:{margin:0,fontSize:"28px",fontWeight:"700",color:"#1e293b",letterSpacing:"-0.025em"},children:"Product Insights"})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"4px"},children:[i.jsx("i",{className:"fas fa-box",style:{color:"#7d8d86",fontSize:"16px"}}),i.jsx("p",{style:{margin:0,fontSize:"18px",color:"#374151",fontWeight:"600"},children:w.name})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("i",{className:"fas fa-tags",style:{color:"#9ca3af",fontSize:"14px"}}),i.jsx("p",{style:{margin:0,fontSize:"14px",color:"#6b7280"},children:w.category}),w.sku&&i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-barcode",style:{color:"#9ca3af",fontSize:"14px",marginLeft:"16px"}}),i.jsxs("span",{style:{fontSize:"14px",color:"#6b7280"},children:["SKU: ",w.sku]})]})]})]})]}),i.jsx("button",{onClick:()=>v(!1),style:{width:"40px",height:"40px",borderRadius:"50%",background:"#f8fafc",border:"2px solid #e2e8f0",color:"#6b7280",cursor:"pointer",fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},onMouseEnter:S=>{S.currentTarget.style.background="#ef4444",S.currentTarget.style.color="white",S.currentTarget.style.borderColor="#ef4444"},onMouseLeave:S=>{S.currentTarget.style.background="#f8fafc",S.currentTarget.style.color="#6b7280",S.currentTarget.style.borderColor="#e2e8f0"},children:i.jsx("i",{className:"fas fa-times"})})]}),F?i.jsxs("div",{style:{textAlign:"center",padding:"60px"},children:[i.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"12px",fontSize:"18px",color:"#7d8d86",background:"#f8fafc",padding:"20px 32px",borderRadius:"12px",border:"1px solid #e2e8f0"},children:[i.jsx("i",{className:"fas fa-spinner fa-spin",style:{fontSize:"20px",color:"#3b82f6"}}),"Loading insights..."]}),i.jsx("div",{style:{fontSize:"14px",color:"#9ca3af",marginTop:"12px"},children:"Analyzing sales data and trends"})]}):T?i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:"40px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px"},children:[i.jsx("i",{className:"fas fa-chart-bar",style:{color:"#7d8d86",fontSize:"20px"}}),i.jsx("h3",{style:{margin:0,fontSize:"20px",fontWeight:"600",color:"#1e293b"},children:"Performance Overview"})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"20px"},children:[i.jsxs("div",{style:{background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",padding:"24px",borderRadius:"16px",textAlign:"center",border:"1px solid #93c5fd",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)",position:"relative",overflow:"hidden"},children:[i.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",color:"#3b82f6",fontSize:"16px"},children:i.jsx("i",{className:"fas fa-shopping-cart"})}),i.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#1e40af",marginBottom:"8px"},children:T.totalSales}),i.jsx("div",{style:{fontSize:"14px",color:"#1e40af",fontWeight:"500"},children:"Total Sales"})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%)",padding:"24px",borderRadius:"16px",textAlign:"center",border:"1px solid #86efac",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)",position:"relative",overflow:"hidden"},children:[i.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",color:"#10b981",fontSize:"16px"},children:i.jsx("i",{className:"fas fa-euro-sign"})}),i.jsxs("div",{style:{fontSize:"32px",fontWeight:"700",color:"#166534",marginBottom:"8px"},children:["",T.totalRevenue.toFixed(2)]}),i.jsx("div",{style:{fontSize:"14px",color:"#166534",fontWeight:"500"},children:"Total Revenue"})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",padding:"24px",borderRadius:"16px",textAlign:"center",border:"1px solid #fbbf24",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)",position:"relative",overflow:"hidden"},children:[i.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",color:"#f59e0b",fontSize:"16px"},children:i.jsx("i",{className:"fas fa-weight"})}),i.jsx("div",{style:{fontSize:"32px",fontWeight:"700",color:"#92400e",marginBottom:"8px"},children:T.totalQuantitySold.toFixed(1)}),i.jsxs("div",{style:{fontSize:"14px",color:"#92400e",fontWeight:"500"},children:[w.is_weighted?w.weight_unit||"kg":"Units"," Sold"]})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%)",padding:"24px",borderRadius:"16px",textAlign:"center",border:"1px solid #f9a8d4",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)",position:"relative",overflow:"hidden"},children:[i.jsx("div",{style:{position:"absolute",top:"12px",right:"12px",color:"#ec4899",fontSize:"16px"},children:i.jsx("i",{className:"fas fa-percentage"})}),i.jsxs("div",{style:{fontSize:"32px",fontWeight:"700",color:"#be185d",marginBottom:"8px"},children:[T.profitMargin.toFixed(1),"%"]}),i.jsx("div",{style:{fontSize:"14px",color:"#be185d",fontWeight:"500"},children:"Est. Profit Margin"})]})]})]}),T.chartData&&i.jsxs("div",{style:{marginBottom:"40px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"24px"},children:[i.jsx("i",{className:"fas fa-chart-line",style:{color:"#7d8d86",fontSize:"20px"}}),i.jsx("h3",{style:{margin:0,fontSize:"20px",fontWeight:"600",color:"#1e293b"},children:"Sales Trends & Analytics"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",marginBottom:"24px"},children:[i.jsxs("button",{onClick:()=>V("daily"),style:{padding:"12px 20px",borderRadius:"12px",border:"none",background:U==="daily"?"#3b82f6":"#f8fafc",color:U==="daily"?"white":"#6b7280",cursor:"pointer",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s ease",boxShadow:U==="daily"?"0 4px 6px rgba(59, 130, 246, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[i.jsx("i",{className:"fas fa-calendar-day"}),"Daily (30 days)"]}),i.jsxs("button",{onClick:()=>V("weekly"),style:{padding:"12px 20px",borderRadius:"12px",border:"none",background:U==="weekly"?"#10b981":"#f8fafc",color:U==="weekly"?"white":"#6b7280",cursor:"pointer",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s ease",boxShadow:U==="weekly"?"0 4px 6px rgba(16, 185, 129, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[i.jsx("i",{className:"fas fa-calendar-week"}),"Weekly (4 weeks)"]}),i.jsxs("button",{onClick:()=>V("monthly"),style:{padding:"12px 20px",borderRadius:"12px",border:"none",background:U==="monthly"?"#f59e0b":"#f8fafc",color:U==="monthly"?"white":"#6b7280",cursor:"pointer",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s ease",boxShadow:U==="monthly"?"0 4px 6px rgba(245, 158, 11, 0.3)":"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[i.jsx("i",{className:"fas fa-calendar-alt"}),"Monthly (6 months)"]})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)",padding:"24px",borderRadius:"16px",minHeight:"220px",border:"1px solid #e2e8f0",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)"},children:[U==="daily"&&i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},children:[i.jsx("i",{className:"fas fa-chart-bar",style:{color:"#3b82f6",fontSize:"16px"}}),i.jsx("h4",{style:{margin:0,fontSize:"16px",color:"#1e293b",fontWeight:"600"},children:"Daily Sales (Last 30 Days)"})]}),i.jsx("div",{style:{display:"flex",alignItems:"end",gap:"4px",height:"150px"},children:T.chartData.daily.map((S,Q)=>{const ne=Math.max(...T.chartData.daily.map(Ve=>Ve.sales)),Ce=ne>0?S.sales/ne*120:0;return i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[i.jsx("div",{style:{width:"100%",height:`${Ce}px`,background:S.sales>0?"#7d8d86":"#e5e7eb",borderRadius:"2px 2px 0 0",minHeight:"2px"},title:`${S.date}: ${S.sales} sales, ${S.revenue.toFixed(2)}`}),i.jsx("div",{style:{fontSize:"10px",color:"#6b7280",marginTop:"4px",textAlign:"center"},children:S.day})]},Q)})})]}),U==="weekly"&&i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},children:[i.jsx("i",{className:"fas fa-chart-area",style:{color:"#10b981",fontSize:"16px"}}),i.jsx("h4",{style:{margin:0,fontSize:"16px",color:"#1e293b",fontWeight:"600"},children:"Weekly Sales (Last 4 Weeks)"})]}),i.jsx("div",{style:{display:"flex",alignItems:"end",gap:"8px",height:"150px"},children:T.chartData.weekly.map((S,Q)=>{const ne=Math.max(...T.chartData.weekly.map(Ve=>Ve.sales)),Ce=ne>0?S.sales/ne*120:0;return i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[i.jsx("div",{style:{width:"100%",height:`${Ce}px`,background:S.sales>0?"#10b981":"#e5e7eb",borderRadius:"4px 4px 0 0",minHeight:"2px"},title:`${S.week}: ${S.sales} sales, ${S.revenue.toFixed(2)}`}),i.jsx("div",{style:{fontSize:"10px",color:"#6b7280",marginTop:"4px",textAlign:"center"},children:S.week})]},Q)})})]}),U==="monthly"&&i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"20px"},children:[i.jsx("i",{className:"fas fa-chart-pie",style:{color:"#f59e0b",fontSize:"16px"}}),i.jsx("h4",{style:{margin:0,fontSize:"16px",color:"#1e293b",fontWeight:"600"},children:"Monthly Sales (Last 6 Months)"})]}),i.jsx("div",{style:{display:"flex",alignItems:"end",gap:"8px",height:"150px"},children:T.chartData.monthly.map((S,Q)=>{const ne=Math.max(...T.chartData.monthly.map(Ve=>Ve.sales)),Ce=ne>0?S.sales/ne*120:0;return i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[i.jsx("div",{style:{width:"100%",height:`${Ce}px`,background:S.sales>0?"#f59e0b":"#e5e7eb",borderRadius:"4px 4px 0 0",minHeight:"2px"},title:`${S.month}: ${S.sales} sales, ${S.revenue.toFixed(2)}`}),i.jsx("div",{style:{fontSize:"10px",color:"#6b7280",marginTop:"4px",textAlign:"center"},children:S.month.split(" ")[0]})]},Q)})})]})]})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)",padding:"24px",borderRadius:"16px",marginBottom:"32px",border:"1px solid #e2e8f0",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px"},children:[i.jsx("i",{className:"fas fa-info-circle",style:{color:"#7d8d86",fontSize:"20px"}}),i.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:"Product Information"})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"20px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("i",{className:"fas fa-barcode",style:{color:"#6b7280",fontSize:"16px"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#9ca3af",fontWeight:"500"},children:"Product ID"}),i.jsx("div",{style:{fontSize:"14px",color:"#374151",fontWeight:"600"},children:w.product_id})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("i",{className:"fas fa-tags",style:{color:"#6b7280",fontSize:"16px"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#9ca3af",fontWeight:"500"},children:"Category"}),i.jsx("div",{style:{fontSize:"14px",color:"#374151",fontWeight:"600"},children:w.category})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("i",{className:"fas fa-boxes",style:{color:"#6b7280",fontSize:"16px"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#9ca3af",fontWeight:"500"},children:"Current Stock"}),i.jsx("div",{style:{fontSize:"14px",color:"#374151",fontWeight:"600"},children:w.stock_quantity})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("i",{className:"fas fa-exclamation-triangle",style:{color:"#6b7280",fontSize:"16px"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#9ca3af",fontWeight:"500"},children:"Reorder Level"}),i.jsx("div",{style:{fontSize:"14px",color:"#374151",fontWeight:"600"},children:w.reorder_level})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("i",{className:"fas fa-euro-sign",style:{color:"#6b7280",fontSize:"16px"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#9ca3af",fontWeight:"500"},children:"Price"}),i.jsxs("div",{style:{fontSize:"14px",color:"#374151",fontWeight:"600"},children:["",w.is_weighted?`${w.price_per_unit}/${w.weight_unit}`:w.price.toFixed(2)]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#f8fafc",borderRadius:"8px",border:"1px solid #e5e7eb"},children:[i.jsx("i",{className:"fas fa-weight",style:{color:"#6b7280",fontSize:"16px"}}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:"12px",color:"#9ca3af",fontWeight:"500"},children:"Type"}),i.jsx("div",{style:{fontSize:"14px",color:"#374151",fontWeight:"600"},children:w.is_weighted?"Weighted Product":"Regular Product"})]})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"24px",marginBottom:"32px"},children:[i.jsxs("div",{style:{background:"#f8fafc",padding:"20px",borderRadius:"12px"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"16px",fontWeight:"600",color:"#3e3f29"},children:"Sales Performance"}),i.jsxs("div",{style:{fontSize:"14px",color:"#7d8d86",lineHeight:"1.6"},children:[i.jsxs("div",{style:{marginBottom:"8px"},children:[i.jsx("strong",{children:"Average sales per day:"})," ",T.averageSalesPerDay.toFixed(1)]}),i.jsxs("div",{style:{marginBottom:"8px"},children:[i.jsx("strong",{children:"Estimated profit:"})," ",T.estimatedProfit.toFixed(2)]}),i.jsxs("div",{style:{marginBottom:"8px"},children:[i.jsx("strong",{children:"Last sold:"})," ",T.lastSoldDate?new Date(T.lastSoldDate).toLocaleDateString():"Never"]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Price per unit:"})," ",w.is_weighted?`${w.price_per_unit}/${w.weight_unit}`:w.price.toFixed(2)]})]})]}),i.jsxs("div",{style:{background:"#f8fafc",padding:"20px",borderRadius:"12px"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"16px",fontWeight:"600",color:"#3e3f29"},children:"Top Selling Days (Last 30 Days)"}),T.topSellingDays.length>0?i.jsx("div",{style:{fontSize:"14px",color:"#7d8d86"},children:T.topSellingDays.map((S,Q)=>i.jsxs("div",{style:{marginBottom:"4px"},children:[new Date(S.date).toLocaleDateString(),": ",S.count," sales"]},Q))}):i.jsx("div",{style:{fontSize:"14px",color:"#7d8d86"},children:"No sales in the last 30 days"})]})]}),i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)",padding:"24px",borderRadius:"16px",border:"1px solid #e2e8f0",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"20px"},children:[i.jsx("i",{className:"fas fa-receipt",style:{color:"#7d8d86",fontSize:"20px"}}),i.jsx("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600",color:"#1e293b"},children:"Recent Sales"})]}),T.recentSalesList.length>0?i.jsx("div",{style:{maxHeight:"300px",overflow:"auto"},children:i.jsxs("table",{style:{width:"100%",fontSize:"14px"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{borderBottom:"2px solid #e5e7eb",background:"#f9fafb"},children:[i.jsxs("th",{style:{textAlign:"left",padding:"12px 8px",fontWeight:"600",color:"#374151",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:"fas fa-calendar",style:{fontSize:"12px",color:"#6b7280"}}),"Date"]}),i.jsxs("th",{style:{textAlign:"left",padding:"12px 8px",fontWeight:"600",color:"#374151",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:"fas fa-hashtag",style:{fontSize:"12px",color:"#6b7280"}}),"Quantity"]}),i.jsxs("th",{style:{textAlign:"left",padding:"12px 8px",fontWeight:"600",color:"#374151",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:"fas fa-euro-sign",style:{fontSize:"12px",color:"#6b7280"}}),"Price"]}),i.jsxs("th",{style:{textAlign:"left",padding:"12px 8px",fontWeight:"600",color:"#374151",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:"fas fa-user",style:{fontSize:"12px",color:"#6b7280"}}),"Customer"]}),i.jsxs("th",{style:{textAlign:"left",padding:"12px 8px",fontWeight:"600",color:"#374151",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:"fas fa-user-tie",style:{fontSize:"12px",color:"#6b7280"}}),"Cashier"]})]})}),i.jsx("tbody",{children:T.recentSalesList.map((S,Q)=>i.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[i.jsxs("td",{style:{padding:"8px 0",color:"#3e3f29"},children:[S.date," ",S.time]}),i.jsxs("td",{style:{padding:"8px 0",color:"#3e3f29"},children:[S.quantity," ",S.unit]}),i.jsxs("td",{style:{padding:"8px 0",color:"#3e3f29"},children:["",S.price.toFixed(2)]}),i.jsx("td",{style:{padding:"8px 0",color:"#3e3f29"},children:S.customer}),i.jsx("td",{style:{padding:"8px 0",color:"#3e3f29"},children:S.cashier})]},Q))})]})}):i.jsx("div",{style:{fontSize:"14px",color:"#7d8d86",textAlign:"center",padding:"20px"},children:"No sales recorded for this product"})]})]}):i.jsxs("div",{children:[i.jsxs("div",{style:{textAlign:"center",padding:"40px",marginBottom:"32px",background:"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)",borderRadius:"16px",border:"1px solid #fecaca"},children:[i.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:"12px",fontSize:"20px",color:"#dc2626",marginBottom:"12px",fontWeight:"600"},children:[i.jsx("i",{className:"fas fa-chart-line",style:{fontSize:"24px"}}),"No Sales Data Available"]}),i.jsx("div",{style:{fontSize:"14px",color:"#991b1b"},children:"This product hasn't been sold yet"})]}),i.jsxs("div",{style:{background:"#f8fafc",padding:"20px",borderRadius:"12px"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"16px",fontWeight:"600",color:"#3e3f29"},children:"Product Information"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px",fontSize:"14px",color:"#7d8d86"},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Product ID:"})," ",w.product_id]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Category:"})," ",w.category]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Current Stock:"})," ",w.stock_quantity]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Reorder Level:"})," ",w.reorder_level]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Price:"})," ",w.is_weighted?`${w.price_per_unit}/${w.weight_unit}`:w.price.toFixed(2)]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Type:"})," ",w.is_weighted?"Weighted Product":"Regular Product"]})]})]})]})]})}),i.jsx(B,{})]})},Om=[{id:"pNInz6obpgDQGcFmaJgB",name:"Adam (Deep, Authoritative)",type:"standard",costPer1K:.18},{id:"EXAVITQu4vr4xnSDxMaL",name:"Bella (Warm, Friendly)",type:"standard",costPer1K:.18},{id:"VR6AewLTigWG4xSOukaG",name:"Josh (Professional, Clear)",type:"standard",costPer1K:.18},{id:"AZnzlk1XvdvUeBnXmlld",name:"Domi (Confident, Energetic)",type:"standard",costPer1K:.18},{id:"ErXwobaYiN019PkySvjV",name:"Elli (Natural, Conversational)",type:"standard",costPer1K:.18},{id:"MF3mGyEYCl7XYWbV9V6O",name:"Rachel (Professional, Warm)",type:"standard",costPer1K:.18},{id:"TxGEqnHWrfWFTfGW9XjX",name:"Drew (Deep, Authoritative)",type:"standard",costPer1K:.18},{id:"VR6AewLTigWG4xSOukaG",name:"Clyde (Friendly, Approachable)",type:"standard",costPer1K:.18}];class Q4{settings;usage;isInitialized=!1;constructor(){this.settings=this.loadSettings(),this.usage=this.loadUsage(),this.initializeUsage()}loadSettings(){const r={enabled:!1,useElevenLabs:!0,selectedVoice:"HobRzuqtLputbKAXOdTj",apiKey:"sk_337a097ef281682961b7c3db26217470f085fd565c3d711d",dailyLimit:5e3,fallbackToBrowser:!0};try{return localStorage.removeItem("tts-settings"),console.log("Cleared old TTS settings, using ElevenLabs defaults"),r}catch{return r}}loadUsage(){const t={totalCharacters:0,totalCost:0,dailyUsage:0,dailyCost:0,lastResetDate:new Date().toISOString().split("T")[0]};try{const r=localStorage.getItem("tts-usage");return r?{...t,...JSON.parse(r)}:t}catch{return t}}saveSettings(){try{localStorage.setItem("tts-settings",JSON.stringify(this.settings))}catch(t){console.error("Failed to save TTS settings:",t)}}saveUsage(){try{localStorage.setItem("tts-usage",JSON.stringify(this.usage))}catch(t){console.error("Failed to save TTS usage:",t)}}initializeUsage(){const t=new Date().toISOString().split("T")[0];this.usage.lastResetDate!==t&&(this.usage.dailyUsage=0,this.usage.dailyCost=0,this.usage.lastResetDate=t,this.saveUsage())}getSettings(){return{...this.settings}}getUsage(){return this.initializeUsage(),{...this.usage}}updateSettings(t){this.settings={...this.settings,...t},this.saveSettings()}async speak(t){if(console.log("TTS Service speak called with:",t),console.log("TTS Settings:",this.settings),!this.settings.enabled)return console.log("TTS not enabled"),!1;const r=t.length,a=this.calculateCost(r);return this.usage.dailyUsage+r>this.settings.dailyLimit?(console.log("Daily limit exceeded, using fallback"),this.settings.fallbackToBrowser?this.speakWithBrowser(t):!1):this.settings.useElevenLabs&&this.settings.apiKey&&(console.log("Trying ElevenLabs TTS with voice:",this.settings.selectedVoice),await this.speakWithElevenLabs(t))?(this.updateUsage(r,a),!0):this.settings.fallbackToBrowser?(console.log("Falling back to browser TTS"),this.speakWithBrowser(t)):(console.log("No TTS method available"),!1)}async speakWithDelay(t,r=2e3){return new Promise(a=>{setTimeout(async()=>{const o=await this.speak(t);a(o)},r)})}async speakWithElevenLabs(t){try{console.log("Making ElevenLabs API call..."),console.log("Voice ID:",this.settings.selectedVoice),console.log("API Key:",this.settings.apiKey.substring(0,10)+"...");const r=await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${this.settings.selectedVoice}`,{method:"POST",headers:{Accept:"audio/mpeg","Content-Type":"application/json","xi-api-key":this.settings.apiKey},body:JSON.stringify({text:t,model_id:"eleven_monolingual_v1",voice_settings:{stability:.5,similarity_boost:.5}})});if(console.log("ElevenLabs response status:",r.status),!r.ok){const d=await r.text();throw console.error("ElevenLabs API error response:",d),new Error(`ElevenLabs API error: ${r.status} - ${d}`)}const a=await r.blob();console.log("Audio blob received, size:",a.size);const o=URL.createObjectURL(a),c=new Audio(o);return new Promise(d=>{c.onended=()=>{console.log("ElevenLabs audio playback ended"),URL.revokeObjectURL(o),d(!0)},c.onerror=f=>{console.error("ElevenLabs audio playback error:",f),URL.revokeObjectURL(o),d(!1)},c.onloadstart=()=>console.log("ElevenLabs audio started loading"),c.oncanplay=()=>console.log("ElevenLabs audio can play"),console.log("Starting ElevenLabs audio playback..."),c.play()})}catch(r){return console.error("ElevenLabs TTS error:",r),!1}}speakWithBrowser(t){if(!("speechSynthesis"in window))return!1;try{speechSynthesis.cancel();const r=new SpeechSynthesisUtterance(t);return r.rate=1,r.pitch=1,r.volume=.8,speechSynthesis.speak(r),!0}catch{return!1}}calculateCost(t){const r=Om.find(a=>a.id===this.settings.selectedVoice);return r?t/1e3*r.costPer1K:0}updateUsage(t,r){this.usage.totalCharacters+=t,this.usage.totalCost+=r,this.usage.dailyUsage+=t,this.usage.dailyCost+=r,this.saveUsage()}stop(){"speechSynthesis"in window&&speechSynthesis.cancel()}getAvailableVoices(){return Om}resetDailyUsage(){this.usage.dailyUsage=0,this.usage.dailyCost=0,this.usage.lastResetDate=new Date().toISOString().split("T")[0],this.saveUsage()}}const bn=new Q4,cl=()=>{const e=new Date,t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),c=String(e.getMinutes()).padStart(2,"0"),d=String(e.getSeconds()).padStart(2,"0");return`${t}-${r}-${a} ${o}:${c}:${d}`},Mm=["Order confirmed! Your jollof rice dreams are one step closer.","Thanks for shopping! Even suya is jealous of your taste.","Your order is secured tighter than plantain at a party.","Order complete! Somewhere, egusi soup just smiled at you.","Confirmed! Your basket was blessed by the spirit of fufu.","You did it! May your order arrive faster than puff-puff disappears.","Order locked! Your kitchen is about to smell like victory.","Thanks for shopping! Even aunties will approve of this order.","Your order is in! We'll protect it like Nigerians protect their jollof recipe.","Success! Your food is coming with more flavor than a pepper soup challenge.","Confirmed  your taste is hotter than shito pepper.","Order complete! Don't worry, we didn't forget the Maggi cubes.","Transaction approved! Time to prepare for a feast fit for ancestors.","Done! May your meals be as sweet as ripe plantain.","Your order is confirmed  better hide it before the neighbors smell it!"],J4=async e=>{if(e.length===0){await bn.speak("No items in order yet.");return}let t=`Order contains ${e.length} item${e.length===1?"":"s"}. `,r=0;e.forEach((a,o)=>{const c=a.product?.name||a.sideBusinessItem?.name||"Unknown Item",d=a.quantity;let f=0;a.customPrice?f=a.customPrice:a.calculatedPrice?f=a.calculatedPrice/d:a.product?.price?f=a.product.price:a.sideBusinessItem?.price&&(f=a.sideBusinessItem.price);let p=0;a.weight&&a.calculatedPrice?(p=a.calculatedPrice,t+=`Item ${o+1}: ${c}, ${a.weight} units at ${a.product?.price_per_unit?.toFixed(2)||"0.00"} per unit, `):(p=f*d,t+=`Item ${o+1}: ${c}, quantity ${d}, ${f.toFixed(2)} each, `),r+=p;const h=[`making this ${r.toFixed(2)}. `,`total so far ${r.toFixed(2)}. `,`${r.toFixed(2)} total. `,`running total ${r.toFixed(2)}. `,`${r.toFixed(2)}. `,`now at ${r.toFixed(2)}. `],x=h[Math.floor(Math.random()*h.length)];t+=x}),await bn.speak(t),setTimeout(async()=>{const a=Mm[Math.floor(Math.random()*Mm.length)];await bn.speak(a)},500)},Z4=async e=>{const t=[`Your total is ${e.toFixed(2)}. Time to feast!`,`Total: ${e.toFixed(2)}. Your taste buds are about to dance!`,`${e.toFixed(2)} total. May your meals be blessed!`,`Order total: ${e.toFixed(2)}. Even jollof rice approves!`],r=t[Math.floor(Math.random()*t.length)];await bn.speak(r)},s0=async(e,t)=>{await bn.speak(`${e} added to order for ${t.toFixed(2)}.`)},eT=()=>{const{user:e}=xa(),[t]=yS(),r=Ks(),[a,o]=j.useState([]),[c,d]=j.useState([]),[f,p]=j.useState([]),[h,x]=j.useState([]),[y,b]=j.useState([]),[v,w]=j.useState("All"),[_,T]=j.useState(""),[M,F]=j.useState([]),[A,U]=j.useState([]),[V,te]=j.useState(!1),[N,re]=j.useState(!1),[L,X]=j.useState({items:[],subtotal:0,tax:0,discount:0,total:0}),[le,ge]=j.useState(""),[Re,fe]=j.useState(""),[Ae,ee]=j.useState(!0),[ye,ae]=j.useState(!1),[Se,k]=j.useState("cash"),[J,O]=j.useState(""),[K,Y]=j.useState(0),[H,pe]=j.useState(""),[Ge,He]=j.useState(!1),[De,Be]=j.useState(!1),[rt,de]=j.useState(null),[$e,z]=j.useState(""),[be,Ke]=j.useState(!1),[je,dt]=j.useState(null),[We,ot]=j.useState(""),[Ne,tt]=j.useState(null),[mt,ht]=j.useState(!1),[St,It]=j.useState(""),[Tt,oe]=j.useState(""),[Le,lt]=j.useState(""),[Ct,qt]=j.useState([]),[,dr]=j.useState(bn.getSettings()),[er,Pt]=j.useState(!1),[ut,Yt]=j.useState(!1),[wt,se]=j.useState(""),[_e,gt]=j.useState(0),[pt,Lt]=j.useState(""),[zt,Et]=j.useState(null),[Lr,In]=j.useState(null),[Dr,fr]=j.useState(!1);j.useEffect(()=>{hr(),Gt();const B=t.get("transaction");B&&(Et(B),fr(!0),yr(B))},[t]),j.useEffect(()=>{const B=S=>{S.key==="Enter"&&S.ctrlKey&&L.items.length>0&&(S.preventDefault(),ae(!0)),S.key==="Escape"&&(T(""),te(!1))};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[L.items]),j.useEffect(()=>{ma()},[a,c,v,_,A]),j.useEffect(()=>{A.length>0&&f.length===0&&p(A)},[A,f.length]),j.useEffect(()=>{q()},[L.items]),j.useEffect(()=>{const B=parseFloat(J)||0,S=ut?parseFloat(wt)||0:L.total,Q=B-S;Y(Q>0?Q:0)},[J,L.total,ut,wt]),j.useEffect(()=>{if(ut){const B=parseFloat(wt)||0,S=Math.max(0,L.total-B);gt(S)}else gt(0)},[ut,wt,L.total]),j.useEffect(()=>{O(ut&&wt||L.total.toString())},[L.total,ut,wt]);const hr=async(B,S)=>{try{ee(!0);let Q=Oe.from("products").select("*").order("sales_count",{ascending:!1}).limit(50);S&&S.trim();const{data:ne,error:Ce}=await Q;if(Ce)throw Ce;const{data:Ve,error:ze}=await Oe.from("side_business_items").select(`
          *,
          side_businesses (name, business_type)
        `).order("name");if(ze)throw ze;o(ne||[]),d(Ve||[]),U(ne||[]);const Xe=ne?.map(it=>it.category).filter(Boolean)||[],nt=Ve?.map(it=>it.side_businesses?.name).filter(Boolean)||[],st=["All",...new Set([...Xe,...nt])];b(st)}catch{}finally{ee(!1),re(!1)}},Gt=async()=>{try{const{data:B,error:S}=await Oe.from("side_businesses").select("business_id, name").eq("business_type","service").order("name");if(S)throw S;qt(B||[])}catch(B){console.error("Error fetching service businesses:",B),qt([])}},yr=async B=>{try{const S=parseInt(B.replace("TXN-","")),{data:Q,error:ne}=await Oe.from("sales").select(`
          *,
          customers (name),
          users (username)
        `).eq("sale_id",S).single();if(ne)return;In(Q);const{data:Ce,error:Ve}=await Oe.from("sale_items").select(`
          *,
          products (
            name,
            category,
            price,
            stock_quantity,
            image_url,
            is_weighted,
            weight_unit,
            price_per_unit
          )
        `).eq("sale_id",S);if(Ve)return;const ze=(Ce||[]).map(it=>{const or={product:{product_id:it.product_id.toString(),name:it.products?.name||"Unknown Product",price:it.price_each,category:it.products?.category||"Unknown",stock_quantity:it.products?.stock_quantity||0,image_url:it.products?.image_url,is_weighted:it.products?.is_weighted||!1,weight_unit:it.products?.weight_unit,price_per_unit:it.products?.price_per_unit},quantity:it.quantity};return it.products?.is_weighted&&it.weight&&it.calculated_price&&(or.weight=it.weight,or.calculatedPrice=it.calculated_price),or}),Xe=ze.reduce((it,Bt)=>Bt.weight&&Bt.calculatedPrice?it+Bt.calculatedPrice:it+Bt.product.price*Bt.quantity,0),nt=Xe*.1,st=Xe+nt;X({items:ze,subtotal:Xe,tax:nt,discount:0,total:st}),Q.customers?.name&&ge(Q.customers.name)}catch{}},Gr=B=>{if(B.length<2){F([]),te(!1);return}const S=B.toLowerCase().trim(),Q=a.filter(Ve=>{const ze=Ve.name.toLowerCase().includes(S),Xe=Ve.category?.toLowerCase().includes(S),nt=Ve.description?.toLowerCase().includes(S),st=Ve.sku?.toLowerCase().includes(S);return ze||Xe||nt||st}).slice(0,3),ne=c.filter(Ve=>{const ze=Ve.name.toLowerCase().includes(S),Xe=Ve.side_businesses?.name.toLowerCase().includes(S);return ze||Xe}).slice(0,2),Ce=[...Q,...ne].slice(0,5);F(Ce),te(Ce.length>0)},ma=()=>{let B=A;if(v!=="All"&&(B=B.filter(Q=>Q.category===v)),_){const Q=_.toLowerCase().trim();B=B.filter(ne=>ne.name.toLowerCase().includes(Q)||ne.category?.toLowerCase().includes(Q)||ne.description?.toLowerCase().includes(Q)||ne.sku?.toLowerCase().includes(Q))}p(B);let S=c;v!=="All"&&(S=S.filter(Q=>Q.side_businesses?.name===v)),_&&(S=S.filter(Q=>Q.name.toLowerCase().includes(_.toLowerCase()))),x(S)},ya=B=>{T(B),Gr(B)},C=B=>{T(B.name),te(!1),F([]),"product_id"in B?I(B):W(B)},q=()=>{const B=L.items.reduce((Ce,Ve)=>{if(Ve.product)return Ve.weight&&Ve.calculatedPrice?Ce+Ve.calculatedPrice:Ce+Ve.product.price*Ve.quantity;if(Ve.sideBusinessItem){const ze=Ve.customPrice||Ve.sideBusinessItem.price||0;return Ce+ze*Ve.quantity}return Ce},0),S=0,Q=0,ne=B-Q;X(Ce=>({...Ce,subtotal:B,tax:S,discount:Q,total:ne}))},I=B=>{if(B.is_weighted&&B.price_per_unit&&B.weight_unit){dt(B),ot(""),Ke(!0);return}X(S=>S.items.find(ne=>ne.product?.product_id===B.product_id&&!ne.weight)?{...S,items:S.items.map(ne=>ne.product?.product_id===B.product_id&&!ne.weight?{...ne,quantity:ne.quantity+1}:ne)}:{...S,items:[...S.items,{product:B,quantity:1}]}),s0(B.name,B.price)},P=(B,S)=>{const Q=S*(B.price_per_unit||0);X(Ne?ne=>({...ne,items:ne.items.map(Ce=>Ce.product?.product_id===Ne&&Ce.weight?{...Ce,weight:S,calculatedPrice:Q}:Ce)}):ne=>({...ne,items:[...ne.items,{product:B,quantity:1,weight:S,calculatedPrice:Q}]})),Ke(!1),dt(null),tt(null),ot("")},W=B=>{if(!B.price)de(B),z(""),Be(!0);else{X(ne=>ne.items.find(Ve=>Ve.sideBusinessItem?.item_id===B.item_id)?{...ne,items:ne.items.map(Ve=>Ve.sideBusinessItem?.item_id===B.item_id?{...Ve,quantity:Ve.quantity+1}:Ve)}:{...ne,items:[...ne.items,{sideBusinessItem:B,quantity:1}]});const S=B.name,Q=B.price||0;s0(S,Q)}},G=()=>{if(!rt)return;const B=parseFloat($e);if(isNaN(B)||B<0){alert("Please enter a valid price");return}X(S=>S.items.find(ne=>ne.sideBusinessItem?.item_id===rt.item_id&&ne.customPrice===B)?{...S,items:S.items.map(ne=>ne.sideBusinessItem?.item_id===rt.item_id&&ne.customPrice===B?{...ne,quantity:ne.quantity+1}:ne)}:{...S,items:[...S.items,{sideBusinessItem:rt,quantity:1,customPrice:B}]}),Be(!1),de(null),z("")},me=async()=>{if(!St.trim()||!Tt||!Le){alert("Please fill in all fields");return}const B=parseFloat(Tt);if(isNaN(B)||B<0){alert("Please enter a valid price");return}try{const S={item_id:Date.now(),business_id:parseInt(Le),name:St.trim(),price:B,stock_qty:null,side_businesses:{name:Ct.find(Q=>Q.business_id.toString()===Le)?.name||"Service",business_type:"service"}};X(Q=>({...Q,items:[...Q.items,{sideBusinessItem:S,quantity:1,customPrice:B}]})),s0(St.trim(),B),It(""),oe(""),lt(""),ht(!1)}catch(S){console.error("Error creating quick service:",S),alert("Failed to create service. Please try again.")}},Me=(B,S)=>{if(S<=0){Te(B);return}X(Q=>({...Q,items:Q.items.map(ne=>ne.product?.product_id===B?{...ne,quantity:S}:ne.sideBusinessItem?.item_id.toString()===B?{...ne,quantity:S}:ne)}))},ce=(B,S)=>{if(S<=0){Te(B);return}X(Q=>({...Q,items:Q.items.map(ne=>{if(ne.product?.product_id===B&&ne.weight){const Ce=S*(ne.product.price_per_unit||0);return{...ne,weight:S,calculatedPrice:Ce}}return ne})}))},we=B=>{B.product&&B.weight&&(dt(B.product),ot(B.weight.toString()),Ke(!0),tt(B.product.product_id))},Te=B=>{X(S=>({...S,items:S.items.filter(Q=>Q.product?.product_id!==B&&Q.sideBusinessItem?.item_id.toString()!==B)}))},Ye=()=>{if(window.confirm("Are you sure you want to reset the current transaction? This will clear all items from the order.")){X({items:[],subtotal:0,tax:0,discount:0,total:0}),ge(""),fe(""),k("cash"),O(""),Y(0),pe("");const B=document.createElement("div");B.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: #10b981;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        font-weight: 500;
        z-index: 10000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      `,B.textContent="Transaction reset successfully!",document.body.appendChild(B),setTimeout(()=>{document.body.removeChild(B)},3e3)}},Je=()=>{const B=`RCP-${Date.now()}`,S=new Date,Q=S.toLocaleDateString("en-IE"),ne=S.toLocaleTimeString("en-IE",{hour:"2-digit",minute:"2-digit"});return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Receipt - ${B}</title>
        <style>
          body { 
            font-family: 'Courier New', monospace; 
            font-size: 12px; 
            line-height: 1.4; 
            margin: 0; 
            padding: 10px; 
            background: white;
            color: black;
          }
          .receipt { 
            width: 100%; 
            max-width: 400px; 
            margin: 0 auto; 
            border: 1px solid #ccc; 
            padding: 20px; 
            background: white;
          }
          .header { 
            text-align: center; 
            margin-bottom: 15px; 
            border-bottom: 1px dashed #333; 
            padding-bottom: 10px; 
          }
          .logo-fallback {
            display: none;
            background: #333;
            color: white;
            padding: 8px;
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
          }
          .business-info { 
            font-size: 10px; 
            margin: 8px 0; 
          }
          .divider { 
            border-top: 1px dashed #333; 
            margin: 10px 0; 
          }
          .item-row { 
            display: flex; 
            justify-content: space-between; 
            margin: 3px 0; 
          }
          .total-row { 
            font-weight: bold; 
            border-top: 1px solid #333; 
            padding-top: 5px; 
            margin-top: 8px; 
          }
          .payment-info { 
            margin: 10px 0; 
          }
          .notes-section {
            margin: 10px 0;
            padding: 8px;
            background: #f5f5f5;
            border-radius: 4px;
          }
          .footer { 
            text-align: center; 
            margin-top: 15px; 
            font-size: 10px; 
            border-top: 1px dashed #333; 
            padding-top: 10px; 
          }
        </style>
      </head>
      <body>
        <div class="receipt">
          <div class="header">
            <img src="/retailpos/images/backgrounds/logo1.png" alt="LandM Store" style="max-width: 80px; height: auto; display: block; margin: 0 auto 10px;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
            <div class="logo-fallback" style="display: none; font-size: 24px; font-weight: bold; margin-bottom: 8px; color: #1a1a1a;">LandM Store</div>
            <div class="business-info">
              <div>Unit 2 Glenmore Park</div>
              <div>Dundalk, Co. Louth</div>
              <div>087 797 0412</div>
            </div>
          </div>
          
          <div class="divider"></div>
          
          <div class="item-row">
            <span>Date: ${Q}</span>
            <span>Time: ${ne}</span>
          </div>
          <div class="item-row">
            <span>Receipt: ${B}</span>
            <span>Cashier: ${e?.username||"System"}</span>
          </div>
          
          <div class="divider"></div>
          
          ${L.items.map(Ce=>{const Ve=Ce.product?.name||Ce.sideBusinessItem?.name||"Unknown Item",ze=Ce.product?.price||Ce.customPrice||Ce.sideBusinessItem?.price||0;return`
            <div class="item-row">
              <span>${Ve} x${Ce.quantity}</span>
              <span>${(ze*Ce.quantity).toFixed(2)}</span>
            </div>
          `}).join("")}
          
          <div class="divider"></div>
          
          <div class="item-row total-row">
            <span>SUBTOTAL:</span>
            <span>${L.subtotal.toFixed(2)}</span>
          </div>
          <div class="item-row total-row">
            <span>${ut?"ORDER TOTAL:":"GRAND TOTAL:"}</span>
            <span>${L.total.toFixed(2)}</span>
          </div>
          
          ${ut?`
          <div class="divider"></div>
          <div style="background: #fef3c7; border: 1px solid #f59e0b; border-radius: 4px; padding: 8px; margin: 10px 0;">
            <div style="font-weight: bold; margin-bottom: 5px; color: #92400e;">
              <i class="fa-solid fa-credit-card" style="margin-right: 5px;"></i>
              PARTIAL PAYMENT
            </div>
            <div class="item-row">
              <span>Amount Paid Today:</span>
              <span style="color: #059669; font-weight: bold;">${(parseFloat(wt)||0).toFixed(2)}</span>
            </div>
            <div class="item-row">
              <span>Remaining Balance:</span>
              <span style="color: #dc2626; font-weight: bold;">${_e.toFixed(2)}</span>
            </div>
            ${pt?`
            <div style="margin-top: 5px; font-size: 10px; color: #92400e;">
              Note: ${pt}
            </div>
            `:""}
          </div>
          `:""}
          
          <div class="payment-info">
            <div class="item-row">
              <span>Payment Method:</span>
              <span>${Se.toUpperCase()}</span>
            </div>
            ${Se==="cash"?`
            <div class="item-row">
              <span>Amount Received:</span>
              <span>${parseFloat(J).toFixed(2)}</span>
            </div>
            <div class="item-row">
              <span>Change Given:</span>
              <span>${K.toFixed(2)}</span>
            </div>
            `:Se==="card"?`
            <div class="item-row">
              <span>Card: ****1234</span>
              <span>Approval: ${Math.floor(Math.random()*1e4)}</span>
            </div>
            `:""}
          </div>
          
          ${H||ut&&pt?`
          <div class="divider"></div>
          <div class="notes-section">
            <div style="font-weight: bold; margin-bottom: 5px;">Notes:</div>
            <div style="font-size: 9px; line-height: 1.3; margin-left: 10px;">
              ${ut?`PARTIAL PAYMENT
Amount Paid Today: ${(parseFloat(wt)||0).toFixed(2)}
Remaining Balance: ${_e.toFixed(2)}
${pt?`Partial Payment Notes: ${pt}`:""}`:""}
              ${H?(ut?`

`:"")+H:""}
            </div>
          </div>
          `:""}
          
          <div class="divider"></div>
          
          <div class="footer">
            <div>Thank you for shopping with us!</div>
            <div style="margin-top: 5px;">LandM Store - Your Local African Food Store</div>
            ${ut?`
            <div style="margin-top: 10px; font-size: 9px; color: #92400e;">
              <strong>Please keep this receipt for your records</strong><br>
              Remaining balance: ${_e.toFixed(2)}
            </div>
            `:""}
          </div>
        </div>
      </body>
      </html>
    `},ct=()=>{const B=window.open("","_blank");B&&(B.document.write(Je()),B.document.close(),B.print(),B.close())},Qe=async()=>{if(L.items.length!==0)try{let B;if(Dr&&zt){const Ce=parseInt(zt.replace("TXN-","")),{data:Ve,error:ze}=await Oe.from("sales").update({total_amount:L.total,payment_method:Se}).eq("sale_id",Ce).select().single();if(ze)throw ze;B=Ve}else{let Ce=null;if(le.trim()){const{data:nt,error:st}=await Oe.from("customers").select("customer_id").eq("name",le.trim()).single();if(nt&&!st)Ce=nt.customer_id;else{const{data:it,error:Bt}=await Oe.from("customers").insert([{name:le.trim(),phone_number:Re.trim()||"000-000-0000",email:null}]).select().single();Bt?(console.error("Error creating customer:",Bt),Ce=null):Ce=it.customer_id}}let Ve="";ut&&(Ve=`PARTIAL PAYMENT
Amount Paid Today: ${(parseFloat(wt)||0).toFixed(2)}
Remaining Balance: ${_e.toFixed(2)}`,pt&&(Ve+=`

Partial Payment Notes: ${pt}`)),H&&(Ve+=(Ve?`

`:"")+H);let ze,Xe;try{const nt={datetime:cl(),total_amount:ut?parseFloat(wt)||0:L.total,payment_method:Se,cashier_id:e?.user_id,customer_id:Ce,discount_applied:L.discount,partial_payment:ut,partial_amount:ut?parseFloat(wt)||0:null,remaining_amount:ut?_e:null,partial_notes:ut?pt:null,notes:Ve||null},st=await Oe.from("sales").insert([nt]).select("*").single();ze=st.data,Xe=st.error}catch{const st={datetime:cl(),total_amount:ut?parseFloat(wt)||0:L.total,payment_method:Se,cashier_id:e?.user_id,customer_id:Ce,discount_applied:L.discount,partial_payment:ut,partial_amount:ut?parseFloat(wt)||0:null,remaining_amount:ut?_e:null,partial_notes:ut?pt:null},it=await Oe.from("sales").insert([st]).select("*").single();ze=it.data,Xe=it.error}if(Xe)throw Xe;B=ze}if(Dr&&zt){const Ce=Lr?(await Oe.from("sale_items").select("product_id").eq("sale_id",B.sale_id)).data?.map(Xe=>Xe.product_id)||[]:[],Ve=L.items.filter(Xe=>Xe.product&&!Ce.includes(Xe.product.product_id));if(Ve.length>0){const Xe=Ve.map(st=>({sale_id:B.sale_id,product_id:st.product.product_id,quantity:st.quantity,price_each:st.product.price,weight:st.weight||null,calculated_price:st.calculatedPrice||null})),{error:nt}=await Oe.from("sale_items").insert(Xe);if(nt)throw nt;for(const st of Xe){const it=st.calculated_price||st.price_each*st.quantity,{error:Bt}=await Oe.rpc("increment_product_sales",{product_id_param:st.product_id,revenue_amount:it});Bt&&console.error("Error updating product sales counter:",Bt)}}const ze=L.items.filter(Xe=>Xe.sideBusinessItem);for(const Xe of ze){let nt=Xe.sideBusinessItem.item_id;if(nt>1e9){const{data:it,error:Bt}=await Oe.from("side_business_items").insert({business_id:Xe.sideBusinessItem.business_id,name:Xe.sideBusinessItem.name,price:Xe.customPrice||Xe.sideBusinessItem.price,stock_qty:null,notes:"Created via Quick Service"}).select().single();if(Bt)throw Bt;nt=it.item_id}const{error:st}=await Oe.from("side_business_sales").insert({item_id:nt,quantity:Xe.quantity,total_amount:(Xe.customPrice||Xe.sideBusinessItem.price||0)*Xe.quantity,payment_method:Se,date_time:cl()});if(st)throw st}}else{const Ce=L.items.filter(ze=>ze.product).map(ze=>({sale_id:B.sale_id,product_id:ze.product.product_id,quantity:ze.quantity,price_each:ze.product.price,weight:ze.weight||null,calculated_price:ze.calculatedPrice||null})),Ve=L.items.filter(ze=>ze.sideBusinessItem);for(const ze of Ve){let Xe=ze.sideBusinessItem.item_id;if(Xe>1e9){const{data:st,error:it}=await Oe.from("side_business_items").insert({business_id:ze.sideBusinessItem.business_id,name:ze.sideBusinessItem.name,price:ze.customPrice||ze.sideBusinessItem.price,stock_qty:null,notes:"Created via Quick Service"}).select().single();if(it)throw it;Xe=st.item_id}const{error:nt}=await Oe.from("side_business_sales").insert({item_id:Xe,quantity:ze.quantity,total_amount:(ze.customPrice||ze.sideBusinessItem.price||0)*ze.quantity,payment_method:Se,date_time:cl()});if(nt)throw nt}if(Ce.length>0){const{error:ze}=await Oe.from("sale_items").insert(Ce);if(ze)throw ze;for(const Xe of Ce){const nt=Xe.calculated_price||Xe.price_each*Xe.quantity,{error:st}=await Oe.rpc("increment_product_sales",{product_id_param:Xe.product_id,revenue_amount:nt});st&&console.error("Error updating product sales counter:",st)}}}const S=Dr&&zt?L.items.filter(Ce=>Ce.product?!(Lr?(Lr.sale_items||[]).map(ze=>ze.product_id):[]).includes(Ce.product.product_id):!1):L.items.filter(Ce=>Ce.product);for(const Ce of S){if(!Ce.product)continue;const{error:Ve}=await Oe.from("products").update({stock_quantity:Ce.product.stock_quantity-Ce.quantity,last_updated:cl()}).eq("product_id",Ce.product.product_id);if(Ve)throw Ve;const{error:ze}=await Oe.from("inventory_movements").insert([{product_id:Ce.product.product_id,quantity_change:-Ce.quantity,movement_type:"Sale",reference_id:B.sale_id}]);if(ze)throw ze}const Q=L.items.filter(Ce=>Ce.sideBusinessItem);for(const Ce of Q){if(!Ce.sideBusinessItem||Ce.sideBusinessItem.stock_qty===null)continue;const{error:Ve}=await Oe.from("side_business_items").update({stock_qty:Ce.sideBusinessItem.stock_qty-Ce.quantity}).eq("item_id",Ce.sideBusinessItem.item_id);if(Ve)throw Ve}X({items:[],subtotal:0,tax:0,discount:0,total:0}),ge(""),fe(""),k("cash"),O(""),Y(0),pe(""),ut&&_e>0&&B?.sale_id&&await bt(le,Re,_e,B.sale_id),Yt(!1),se(""),gt(0),Lt("");const ne=document.createElement("div");ne.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: #10b981;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        font-weight: 500;
        z-index: 10000;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      `,ne.textContent=Dr?"Items added to transaction successfully!":ut?`Partial payment processed! ${(parseFloat(wt)||0).toFixed(2)} paid, ${_e.toFixed(2)} remaining. Reminder created.`:"Sale processed successfully!",document.body.appendChild(ne),setTimeout(()=>{document.body.removeChild(ne)},3e3),Z4(L.total),ae(!1),Dr&&zt&&setTimeout(()=>{r(`/transaction/${zt}`)},2e3)}catch(B){alert(`Failed to process sale: ${B instanceof Error?B.message:"Unknown error"}`)}},at=()=>{const B=new Date,S=B.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}),Q=B.toLocaleDateString("en-GB",{weekday:"long",day:"2-digit",month:"2-digit",year:"numeric"});return`${S} - ${Q}`},bt=async(B,S,Q,ne)=>{try{const Ce=e?.user_id||1,Ve=`Payment Due: ${B||"Customer"}`,ze=S?`
Phone: ${S}`:"",Xe=`Customer owes ${Q.toFixed(2)} from Sale #${ne}. Please follow up for payment.${ze}`,nt=new Date;nt.setDate(nt.getDate()+1);const st=nt.toISOString().split("T")[0],{error:it}=await Oe.from("reminders").insert([{title:Ve,body:Xe,remind_date:st,owner_id:Ce}]).select().single();it&&(console.error("Error creating partial payment reminder:",it),console.error("Reminder data attempted:",{title:Ve,body:Xe,remind_date:st,owner_id:Ce}))}catch(Ce){console.error("Error creating partial payment reminder:",Ce)}};return Ae?i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",fontSize:"18px",color:"#6b7280"},children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin",style:{marginRight:"12px"}}),"Loading products..."]}):i.jsxs("div",{style:{display:"flex",height:"100vh",background:"linear-gradient(135deg, #7d8d86, #3e3f29)",fontFamily:"Poppins, sans-serif"},children:[i.jsxs("div",{style:{flex:1,background:"#ffffff",margin:"20px",borderRadius:"20px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[i.jsxs("div",{style:{padding:"24px 32px",borderBottom:"1px solid #e5e7eb",background:Dr?"#fef3c7":"#f9fafb"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("h1",{style:{fontSize:"28px",fontWeight:"600",color:"#1f2937",margin:"0 0 8px 0"},children:[i.jsx("i",{className:"fa-solid fa-cash-register",style:{marginRight:"12px",color:"#7d8d86"}}),"Point Of Sales"]}),Dr&&i.jsxs("div",{style:{background:"#f59e0b",color:"#92400e",padding:"8px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-plus-circle"}),"Adding to Transaction #",zt]})]}),Dr&&i.jsx("p",{style:{fontSize:"14px",color:"#92400e",margin:"8px 0 0 0",fontStyle:"italic"},children:"Adding new items to existing transaction. Existing items will be preserved."})]}),i.jsx("div",{style:{padding:"20px 32px 16px",borderBottom:"1px solid #e5e7eb"},children:i.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center",maxWidth:"600px"},children:[i.jsxs("div",{style:{position:"relative",flex:1},children:[i.jsx("i",{className:"fa-solid fa-search",style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#6b7280",fontSize:"16px",zIndex:1}}),i.jsx("input",{type:"text",placeholder:"Search products by name, category, description, or SKU...",value:_,onChange:B=>ya(B.target.value),onFocus:B=>{B.target.style.borderColor="#7d8d86",te(M.length>0)},onBlur:B=>{B.target.style.borderColor="#e5e7eb",setTimeout(()=>te(!1),200)},onKeyDown:B=>{B.key==="Enter"&&(B.preventDefault(),_.trim()&&te(!1))},style:{width:"100%",padding:"12px 16px",paddingLeft:"40px",paddingRight:_?"40px":"16px",border:"2px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"}}),_&&i.jsx("button",{onClick:()=>{T(""),te(!1),F([])},style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#6b7280",fontSize:"16px",padding:"4px",borderRadius:"4px",transition:"color 0.2s ease"},onMouseEnter:B=>B.target.style.color="#dc2626",onMouseLeave:B=>B.target.style.color="#6b7280",children:i.jsx("i",{className:"fa-solid fa-times"})}),V&&M.length>0&&i.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"#ffffff",border:"1px solid #6b7280",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:M.map((B,S)=>{const Q="product_id"in B,ne="item_id"in B;return i.jsxs("div",{onClick:()=>C(B),style:{padding:"12px 16px",cursor:"pointer",borderBottom:S<M.length-1?"1px solid #f3f4f6":"none",display:"flex",alignItems:"center",gap:"12px",transition:"background-color 0.2s ease"},children:[i.jsx("div",{style:{width:"32px",height:"32px",background:Q&&B.image_url?`url(${B.image_url})`:"linear-gradient(135deg, #f3f4f6, #e5e7eb)",backgroundSize:"cover",backgroundPosition:"center",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",color:"#6b7280"},children:ne&&i.jsx("i",{className:"fa-solid fa-briefcase"})}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{margin:"0 0 2px 0",fontSize:"14px",fontWeight:"500",color:"#1f2937"},children:B.name}),i.jsx("p",{style:{margin:"0",fontSize:"12px",color:"#6b7280"},children:Q?`${B.category}  ${B.price.toFixed(2)}`:`${B.side_businesses?.name||"Side Business"}  ${B.price?`${B.price.toFixed(2)}`:"Custom Price"}`})]}),i.jsx("i",{className:"fa-solid fa-plus",style:{color:"#7d8d86",fontSize:"12px"}})]},Q?B.product_id:`sb-${B.item_id}`)})})]}),i.jsxs("button",{style:{background:"linear-gradient(135deg, #7d8d86, #3e3f29)",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-search"}),"Search"]}),i.jsxs("button",{onClick:()=>ht(!0),style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-plus-circle"}),"Quick Service"]})]})}),i.jsx("div",{style:{padding:"16px 32px",borderBottom:"1px solid #e5e7eb"},children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("label",{style:{fontSize:"14px",fontWeight:"500",color:"#374151",whiteSpace:"nowrap"},children:"Category:"}),i.jsx("select",{value:v,onChange:B=>w(B.target.value),style:{background:"#ffffff",border:"2px solid #6b7280",borderRadius:"8px",padding:"8px 12px",fontSize:"14px",fontWeight:"500",color:"#374151",cursor:"pointer",minWidth:"200px",outline:"none",transition:"border-color 0.2s ease"},onFocus:B=>B.target.style.borderColor="#7d8d86",onBlur:B=>B.target.style.borderColor="#e5e7eb",children:y.map(B=>{let S=0;return B==="All"?S=a.length+c.length:S=c.filter(Q=>Q.side_businesses?.name===B).length,i.jsxs("option",{value:B,children:[B," ",B==="All"?`(${S})`:S>0?`(${S})`:""]},B)})})]})}),i.jsxs("div",{style:{flex:1,padding:"24px 32px",overflowY:"auto"},children:[i.jsx("div",{style:{marginBottom:"16px"},children:i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 4px 0"},children:"Products"})}),f.length===0?i.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},children:[i.jsx("i",{className:"fa-solid fa-search",style:{fontSize:"48px",marginBottom:"16px",opacity:.5}}),i.jsx("h3",{style:{fontSize:"18px",fontWeight:"500",color:"#374151",margin:"0 0 8px 0"},children:"No products found"}),i.jsx("p",{style:{fontSize:"14px",margin:"0",color:"#6b7280"},children:_?`No products match "${_}"`:"Try selecting a different category"})]}):i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(180px, 1fr))",gap:"12px"},children:[f.map(B=>i.jsxs("div",{style:{background:"#ffffff",border:"2px solid #6b7280",borderRadius:"8px",padding:"12px",textAlign:"center",transition:"all 0.2s ease",cursor:"pointer",position:"relative",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},onMouseEnter:S=>{S.currentTarget.style.transform="translateY(-1px)",S.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)",S.currentTarget.style.border="2px solid #6b7280"},onMouseLeave:S=>{S.currentTarget.style.transform="translateY(0)",S.currentTarget.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)",S.currentTarget.style.border="2px solid #6b7280"},children:[i.jsx("div",{style:{width:"100%",height:"100px",background:B.image_url?`url(${B.image_url})`:"linear-gradient(135deg, #f3f4f6, #e5e7eb)",backgroundSize:"cover",backgroundPosition:"center",borderRadius:"6px",marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:!B.image_url&&i.jsx("i",{className:"fa-solid fa-image",style:{fontSize:"24px",color:"#9ca3af"}})}),i.jsx("h4",{style:{fontSize:"13px",fontWeight:"500",color:"#1f2937",margin:"0 0 6px 0",lineHeight:"1.3",height:"34px",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:B.name}),i.jsx("p",{style:{fontSize:"14px",fontWeight:"600",color:"#7d8d86",margin:"0 0 8px 0"},children:B.is_weighted&&B.price_per_unit&&B.weight_unit?B.weight_unit==="g"&&B.price_per_unit<1?`${(B.price_per_unit*1e3).toFixed(2)}/kg`:B.weight_unit==="kg"&&B.price_per_unit>=1?`${B.price_per_unit.toFixed(2)}/kg`:`${B.price_per_unit.toFixed(2)}/${B.weight_unit}`:`${B.price.toFixed(2)}`}),i.jsxs("button",{onClick:()=>I(B),style:{background:"#7d8d86",color:"white",border:"none",borderRadius:"4px",padding:"6px 12px",fontSize:"12px",fontWeight:"500",cursor:"pointer",width:"100%",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},onMouseEnter:S=>{S.currentTarget.style.background="#3e3f29"},onMouseLeave:S=>{S.currentTarget.style.background="#7d8d86"},children:[i.jsx("i",{className:"fa-solid fa-plus",style:{fontSize:"10px"}}),"Add"]})]},B.product_id)),h.map(B=>i.jsxs("div",{style:{background:"#ffffff",border:"3px solid #374151",borderRadius:"8px",padding:"12px",textAlign:"center",transition:"all 0.2s ease",cursor:"pointer",position:"relative",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},onMouseEnter:S=>{S.currentTarget.style.transform="translateY(-1px)",S.currentTarget.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.1)"},onMouseLeave:S=>{S.currentTarget.style.transform="translateY(0)",S.currentTarget.style.boxShadow="none"},children:[i.jsx("div",{style:{width:"100%",height:"100px",background:"linear-gradient(135deg, #f3f4f6, #e5e7eb)",borderRadius:"6px",marginBottom:"8px",display:"flex",alignItems:"center",justifyContent:"center"},children:i.jsx("i",{className:"fa-solid fa-briefcase",style:{fontSize:"24px",color:"#9ca3af"}})}),i.jsx("h4",{style:{fontSize:"13px",fontWeight:"500",color:"#1f2937",margin:"0 0 6px 0",lineHeight:"1.3",height:"34px",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:B.name}),i.jsx("p",{style:{fontSize:"14px",fontWeight:"600",color:"#7d8d86",margin:"0 0 8px 0"},children:B.price?`${B.price.toFixed(2)}`:"Custom Price"}),i.jsxs("button",{onClick:()=>W(B),style:{background:"#7d8d86",color:"white",border:"none",borderRadius:"4px",padding:"6px 12px",fontSize:"12px",fontWeight:"500",cursor:"pointer",width:"100%",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"4px"},onMouseEnter:S=>{S.currentTarget.style.background="#3e3f29"},onMouseLeave:S=>{S.currentTarget.style.background="#7d8d86"},children:[i.jsx("i",{className:"fa-solid fa-plus",style:{fontSize:"10px"}}),"Add"]})]},`sb-${B.item_id}`))]})]})]}),i.jsxs("div",{style:{width:"400px",background:"#ffffff",margin:"20px 20px 20px 0",borderRadius:"20px",display:"flex",flexDirection:"column",overflow:"hidden"},children:[i.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e5e7eb",background:"#f9fafb"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"},children:[i.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(135deg, #7d8d86, #3e3f29)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"16px",fontWeight:"600"},children:e?.username?.charAt(0).toUpperCase()}),i.jsx("div",{children:i.jsxs("p",{style:{margin:"0",fontSize:"16px",fontWeight:"500",color:"#1f2937"},children:["Hello, ",e?.username]})})]}),i.jsx("p",{style:{margin:"0",fontSize:"14px",color:"#6b7280"},children:at()})]}),i.jsxs("div",{style:{flex:1,padding:"24px",overflowY:"auto"},children:[i.jsxs("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 16px 0"},children:["Order Detail #",Math.floor(Math.random()*1e7)]}),L.items.length===0?i.jsxs("div",{style:{textAlign:"center",color:"#6b7280",padding:"40px 0"},children:[i.jsx("i",{className:"fa-solid fa-shopping-cart",style:{fontSize:"48px",marginBottom:"16px",opacity:.5}}),i.jsx("p",{children:"No items in order"})]}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:L.items.map(B=>{const S=B.product?.product_id||`sb-${B.sideBusinessItem?.item_id}`,Q=B.product?.name||B.sideBusinessItem?.name||"Unknown Item",ne=B.product?.price||B.customPrice||B.sideBusinessItem?.price||0,Ce=!!B.sideBusinessItem;return i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px",background:"#ffffff",borderRadius:"8px",border:"3px solid #dc2626",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"},children:[i.jsx("div",{style:{width:"40px",height:"40px",background:Ce?"linear-gradient(135deg, #f3f4f6, #e5e7eb)":B.product?.image_url?`url(${B.product.image_url})`:"linear-gradient(135deg, #f3f4f6, #e5e7eb)",backgroundSize:"cover",backgroundPosition:"center",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center"},children:Ce&&i.jsx("i",{className:"fa-solid fa-briefcase",style:{fontSize:"16px",color:"#9ca3af"}})}),i.jsxs("div",{style:{flex:1},children:[i.jsx("p",{style:{margin:"0 0 4px 0",fontSize:"14px",fontWeight:"500",color:"#1f2937"},children:Q.length>20?Q.substring(0,20)+"...":Q}),i.jsx("p",{style:{margin:"0",fontSize:"14px",color:"#7d8d86",fontWeight:"600"},children:B.weight&&B.calculatedPrice?i.jsxs(i.Fragment,{children:[B.weight," ",B.product?.weight_unit,"  ",B.calculatedPrice.toFixed(2)]}):`${ne.toFixed(2)}`})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[!B.weight&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>Me(S,B.quantity-1),style:{width:"24px",height:"24px",borderRadius:"4px",border:"1px solid #d1d5db",background:"#ffffff",color:"#374151",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},children:"-"}),i.jsx("span",{style:{minWidth:"20px",textAlign:"center",fontSize:"14px",fontWeight:"500",color:"#1f2937"},children:B.quantity}),i.jsx("button",{onClick:()=>Me(S,B.quantity+1),style:{width:"24px",height:"24px",borderRadius:"4px",border:"1px solid #d1d5db",background:"#ffffff",color:"#374151",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},children:"+"})]}),B.weight&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>ce(S,B.weight-.1),style:{width:"24px",height:"24px",borderRadius:"4px",border:"1px solid #d1d5db",background:"#ffffff",color:"#374151",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},children:"-"}),i.jsxs("button",{onClick:()=>we(B),style:{minWidth:"60px",height:"24px",borderRadius:"4px",border:"1px solid #7d8d86",background:"#f9fafb",color:"#7d8d86",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"11px",fontWeight:"500",padding:"0 4px"},title:"Click to edit weight",children:[B.weight," ",B.product?.weight_unit]}),i.jsx("button",{onClick:()=>ce(S,B.weight+.1),style:{width:"24px",height:"24px",borderRadius:"4px",border:"1px solid #d1d5db",background:"#ffffff",color:"#374151",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px"},children:"+"})]}),i.jsx("button",{onClick:()=>Te(S),style:{width:"24px",height:"24px",borderRadius:"4px",border:"none",background:"#ef4444",color:"white",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",marginLeft:"4px"},children:i.jsx("i",{className:"fa-solid fa-trash"})})]})]},S)})})]}),i.jsxs("div",{style:{padding:"24px",borderTop:"1px solid #e5e7eb",background:"#f9fafb"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 16px 0"},children:"Payment Detail"}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"8px"},children:"Customer Name"}),i.jsx("input",{type:"text",value:le,onChange:B=>ge(B.target.value),placeholder:"Enter customer name",style:{width:"100%",padding:"8px 12px",border:"1px solid #6b7280",borderRadius:"6px",fontSize:"14px",outline:"none"}})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Sub Total"}),i.jsxs("span",{style:{fontSize:"14px",fontWeight:"500",color:"#1f2937"},children:["",L.subtotal.toFixed(2)]})]}),L.discount>0&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"8px"},children:[i.jsx("span",{style:{fontSize:"14px",color:"#6b7280"},children:"Discount"}),i.jsxs("span",{style:{fontSize:"14px",fontWeight:"500",color:"#1f2937"},children:["",L.discount.toFixed(2)]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"8px",borderTop:"1px solid #d1d5db",marginBottom:"16px"},children:[i.jsx("span",{style:{fontSize:"16px",fontWeight:"600",color:"#1f2937"},children:"Total Payment"}),i.jsxs("span",{style:{fontSize:"16px",fontWeight:"600",color:"#7d8d86"},children:["",L.total.toFixed(2)]})]})]}),i.jsx("button",{style:{background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"14px",fontWeight:"500",cursor:"pointer",width:"100%",marginBottom:"12px"},children:"Add Voucher"}),i.jsxs("div",{style:{background:"#2a2a2a",border:"1px solid #404040",borderRadius:"12px",padding:"10px 12px",display:"flex",alignItems:"center",gap:"8px",width:"fit-content",maxWidth:"280px",marginBottom:"12px",opacity:L.items.length===0?.5:1,cursor:L.items.length===0?"not-allowed":"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)"},onClick:async()=>{if(L.items.length!==0){if(er){console.log("Pausing TTS..."),bn.pause(),Pt(!1);return}console.log("Announce Order clicked!"),console.log("Order items:",L.items),Pt(!0),bn.updateSettings({enabled:!0}),dr(bn.getSettings()),console.log("TTS Settings after enabling:",bn.getSettings());try{await J4(L.items),setTimeout(()=>{bn.updateSettings({enabled:!1}),dr(bn.getSettings()),Pt(!1)},3e3)}catch(B){console.error("TTS Error:",B),bn.updateSettings({enabled:!1}),dr(bn.getSettings()),Pt(!1)}}},title:er?"Pause announcement":"Announce all items in current order",onMouseEnter:B=>{L.items.length>0&&(B.currentTarget.style.background="#333333",B.currentTarget.style.borderColor="#555555")},onMouseLeave:B=>{L.items.length>0&&(B.currentTarget.style.background="#2a2a2a",B.currentTarget.style.borderColor="#404040")},children:[i.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"#8A85FF",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:"0 2px 4px rgba(138, 133, 255, 0.3)",transition:"all 0.2s ease"},onMouseEnter:B=>{L.items.length>0&&(B.currentTarget.style.background="#9A95FF",B.currentTarget.style.transform="scale(1.05)")},onMouseLeave:B=>{L.items.length>0&&(B.currentTarget.style.background="#8A85FF",B.currentTarget.style.transform="scale(1)")},children:i.jsx("i",{className:er?"fa-solid fa-pause":"fa-solid fa-play",style:{fontSize:"12px",color:"white",marginLeft:er?"0px":"2px"}})}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"1px",flex:1,maxWidth:"120px"},children:Array.from({length:15},(B,S)=>i.jsx("div",{style:{width:"2px",height:er?`${Math.random()*12+3}px`:"4px",background:er?"#8A85FF":"#666666",borderRadius:"1px",transition:"all 0.3s ease",animation:er?`waveform-${S} 1.5s ease-in-out infinite`:"none"}},S))}),i.jsx("div",{style:{color:"white",fontSize:"11px",fontWeight:"500",minWidth:"28px",textAlign:"center"},children:er?"":L.items.length>0?`${L.items.length}`:"0:00"}),i.jsx("div",{style:{color:"white",fontSize:"14px",opacity:.8},children:i.jsx("i",{className:"fa-solid fa-volume-high"})})]}),i.jsxs("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:[i.jsxs("button",{onClick:Ye,disabled:L.items.length===0,title:L.items.length>0?"Clear all items from current transaction":"No items to reset",style:{background:L.items.length===0?"#f3f4f6":"#ef4444",color:L.items.length===0?"#9ca3af":"white",border:"none",borderRadius:"8px",padding:"12px 16px",fontSize:"14px",fontWeight:"500",cursor:L.items.length===0?"not-allowed":"pointer",flex:1,transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[i.jsx("i",{className:"fa-solid fa-rotate-left",style:{fontSize:"12px"}}),"Reset"]}),i.jsxs("button",{onClick:()=>ae(!0),disabled:L.items.length===0,title:L.items.length>0?"Press Ctrl+Enter to view sales summary":"Add items to process sale",style:{background:L.items.length===0?"#9ca3af":"linear-gradient(135deg, #7d8d86, #3e3f29)",color:"white",border:"none",borderRadius:"8px",padding:"12px 16px",fontSize:"14px",fontWeight:"600",cursor:L.items.length===0?"not-allowed":"pointer",flex:2,transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},children:[i.jsx("i",{className:"fa-solid fa-credit-card",style:{fontSize:"12px"}}),"Purchase",L.items.length>0&&i.jsx("span",{style:{fontSize:"10px",opacity:.8,marginLeft:"2px"},children:"(Ctrl+Enter)"})]})]})]})]}),ye&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"16px",padding:"20px",width:"95%",maxWidth:"700px",maxHeight:"95vh",overflowY:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px",paddingBottom:"8px",borderBottom:"1px solid #e5e7eb"},children:[i.jsxs("h2",{style:{margin:"0",fontSize:"24px",fontWeight:"600",color:"#1f2937"},children:[i.jsx("i",{className:"fa-solid fa-receipt",style:{marginRight:"12px",color:"#7d8d86"}}),"Sales Summary"]}),i.jsx("button",{onClick:()=>ae(!1),style:{background:"none",border:"none",fontSize:"20px",color:"#6b7280",cursor:"pointer",padding:"4px"},children:i.jsx("i",{className:"fa-solid fa-xmark"})})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 12px 0"},children:"Customer Information"}),i.jsx("input",{type:"text",value:le,onChange:B=>ge(B.target.value),placeholder:"Enter customer name (optional)",style:{width:"100%",padding:"12px 16px",border:"1px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",marginBottom:"12px"}})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"8px"},children:"Phone Number (Optional)"}),i.jsx("input",{type:"tel",value:Re,onChange:B=>fe(B.target.value),placeholder:"Enter phone number (optional)",style:{width:"100%",padding:"12px 16px",border:"1px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",marginBottom:"16px"}})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 12px 0"},children:"Payment Method"}),i.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"16px"},children:["cash","card","credit"].map(B=>i.jsxs("button",{onClick:()=>k(B),style:{background:Se===B?"#7d8d86":"#f3f4f6",color:Se===B?"white":"#374151",border:"none",borderRadius:"8px",padding:"8px 16px",fontSize:"14px",fontWeight:"500",cursor:"pointer",textTransform:"capitalize",transition:"all 0.2s ease"},children:[i.jsx("i",{className:`fa-solid fa-${B==="cash"?"money-bill":B==="card"?"credit-card":"hand-holding-dollar"}`,style:{marginRight:"6px"}}),B]},B))})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0"},children:"Payment Options"}),i.jsxs("button",{onClick:()=>{Yt(!ut),ut?(se(""),gt(0)):(se(L.total.toString()),gt(0))},style:{background:ut?"#ef4444":"#7d8d86",color:"white",border:"none",borderRadius:"8px",padding:"8px 16px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"6px"},children:[i.jsx("i",{className:`fa-solid fa-${ut?"times":"credit-card"}`,style:{fontSize:"12px"}}),ut?"Disable Partial":"Enable Partial Payment"]})]}),ut&&i.jsxs("div",{style:{background:"#fef3c7",border:"1px solid #f59e0b",borderRadius:"8px",padding:"12px",marginBottom:"16px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[i.jsx("i",{className:"fa-solid fa-info-circle",style:{color:"#f59e0b"}}),i.jsx("span",{style:{fontSize:"14px",fontWeight:"500",color:"#92400e"},children:"Partial Payment Enabled"})]}),i.jsxs("div",{style:{fontSize:"14px",color:"#92400e"},children:[i.jsxs("div",{children:["Amount to pay now: ",i.jsxs("strong",{children:["",(parseFloat(wt)||0).toFixed(2)]})]}),i.jsxs("div",{children:["Remaining amount: ",i.jsxs("strong",{children:["",_e.toFixed(2)]})]}),_e>0&&i.jsxs("div",{style:{marginTop:"8px",padding:"8px",background:"#fef2f2",border:"1px solid #fca5a5",borderRadius:"4px"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{marginRight:"6px",color:"#dc2626"}}),i.jsxs("strong",{style:{color:"#dc2626"},children:["Still need to pay: ",_e.toFixed(2)]})]})]})]}),ut&&i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Amount to Pay Now ()"}),i.jsx("input",{type:"number",step:"0.01",min:"0",max:L.total,value:wt,onChange:B=>{const S=B.target.value;se(S);const Q=parseFloat(S)||0;gt(Math.max(0,L.total-Q))},style:{width:"100%",padding:"12px 16px",border:"2px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"},placeholder:`Enter amount (max ${L.total.toFixed(2)})`})]}),ut&&i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Notes (Optional)"}),i.jsx("textarea",{value:pt,onChange:B=>Lt(B.target.value),placeholder:"Add any notes about this partial payment...",style:{width:"100%",padding:"12px 16px",border:"2px solid #6b7280",borderRadius:"8px",fontSize:"14px",outline:"none",resize:"vertical",minHeight:"60px",fontFamily:"inherit",transition:"border-color 0.2s ease"}})]})]}),Se==="cash"&&i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 12px 0"},children:"Amount Received"}),i.jsx("div",{style:{marginBottom:"12px"},children:i.jsxs("button",{onClick:()=>O(ut?wt:L.total.toFixed(2)),style:{width:"100%",padding:"12px 16px",border:"1px solid #d1d5db",borderRadius:"8px",background:"#ffffff",color:"#374151",fontSize:"16px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},onMouseOver:B=>B.target.style.background="#f9fafb",onMouseOut:B=>B.target.style.background="#ffffff",children:["Set Exact Amount (",ut?(parseFloat(wt)||0).toFixed(2):L.total.toFixed(2),")"]})}),i.jsx("input",{type:"number",step:"0.01",value:J,onChange:B=>O(B.target.value),placeholder:`Enter amount: ${ut?(parseFloat(wt)||0).toFixed(2):L.total.toFixed(2)}`,style:{width:"100%",maxWidth:"300px",margin:"0 auto",display:"block",padding:"12px 16px",border:"1px solid #6b7280",borderRadius:"8px",fontSize:"18px",fontWeight:"500",outline:"none",background:"#ffffff",textAlign:"center"}}),K>0&&i.jsxs("div",{style:{marginTop:"12px",padding:"12px 16px",background:"#f0f9ff",border:"1px solid #0ea5e9",borderRadius:"8px",color:"#0c4a6e",fontSize:"16px",fontWeight:"600",textAlign:"center"},children:[i.jsx("i",{className:"fa-solid fa-coins",style:{marginRight:"8px"}}),"Change: ",K.toFixed(2)]}),ut&&_e>0&&i.jsxs("div",{style:{marginTop:"12px",padding:"12px 16px",background:"#fef2f2",border:"2px solid #dc2626",borderRadius:"8px",color:"#dc2626",fontSize:"16px",fontWeight:"600",textAlign:"center"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{marginRight:"8px"}}),"Still need to pay: ",_e.toFixed(2)]}),J&&parseFloat(J)<L.total&&!ut&&i.jsxs("div",{style:{marginTop:"12px",padding:"12px 16px",background:"#fef2f2",border:"1px solid #f87171",borderRadius:"8px",color:"#dc2626",fontSize:"16px",fontWeight:"600",textAlign:"center"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{marginRight:"8px"}}),"Need ",((ut?parseFloat(wt)||0:L.total)-parseFloat(J)).toFixed(2)," more"]})]}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 12px 0"},children:"Receipt Notes (Optional)"}),i.jsx("textarea",{value:H,onChange:B=>pe(B.target.value),placeholder:"Add notes for receipt (e.g., partial payment, special instructions, etc.)",style:{width:"100%",padding:"12px 16px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"14px",outline:"none",resize:"vertical",minHeight:"60px",fontFamily:"inherit"}}),i.jsx("p",{style:{fontSize:"12px",color:"#6b7280",margin:"8px 0 0 0"},children:"These notes will appear on the printed receipt"})]}),i.jsxs("div",{style:{background:"#f9fafb",padding:"12px",borderRadius:"12px",marginBottom:"16px"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 16px 0"},children:"Payment Summary"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontSize:"16px",color:"#6b7280"},children:"Subtotal"}),i.jsxs("span",{style:{fontSize:"16px",fontWeight:"500",color:"#1f2937"},children:["",L.subtotal.toFixed(2)]})]}),L.discount>0&&i.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontSize:"16px",color:"#6b7280"},children:"Discount"}),i.jsxs("span",{style:{fontSize:"16px",fontWeight:"500",color:"#1f2937"},children:["",L.discount.toFixed(2)]})]}),ut&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontSize:"16px",color:"#6b7280"},children:"Amount to Pay Now"}),i.jsxs("span",{style:{fontSize:"16px",fontWeight:"500",color:"#7d8d86"},children:["",(parseFloat(wt)||0).toFixed(2)]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[i.jsx("span",{style:{fontSize:"16px",color:"#6b7280"},children:"Remaining Amount"}),i.jsxs("span",{style:{fontSize:"16px",fontWeight:"500",color:"#ef4444"},children:["",_e.toFixed(2)]})]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"12px",borderTop:"1px solid #d1d5db",marginTop:"8px"},children:[i.jsx("span",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937"},children:ut?"Total Order":"Total"}),i.jsxs("span",{style:{fontSize:"18px",fontWeight:"600",color:"#7d8d86"},children:["",L.total.toFixed(2)]})]})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"space-between"},children:[i.jsxs("div",{style:{display:"flex",gap:"12px"},children:[i.jsxs("button",{onClick:()=>He(!0),style:{background:"#ffffff",color:"#3e3f29",border:"1px solid #3e3f29",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-eye"}),"View Receipt"]}),i.jsxs("button",{onClick:ct,style:{background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-print"}),"Print Receipt"]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px"},children:[i.jsx("button",{onClick:()=>ae(!1),style:{background:"#f3f4f6",color:"#374151",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),i.jsxs("button",{onClick:Qe,disabled:Se==="cash"&&(!J||parseFloat(J)<(ut?parseFloat(wt)||0:L.total)),style:{background:Se==="cash"&&(!J||parseFloat(J)<(ut?parseFloat(wt)||0:L.total))?"#9ca3af":"linear-gradient(135deg, #7d8d86, #3e3f29)",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:Se==="cash"&&(!J||parseFloat(J)<(ut?parseFloat(wt)||0:L.total))?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px",opacity:Se==="cash"&&(!J||parseFloat(J)<(ut?parseFloat(wt)||0:L.total))?.6:1},children:[i.jsx("i",{className:"fa-solid fa-credit-card"}),ut?"Process Partial Payment":"Process Sale"]})]})]})]})}),Ge&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"24px",width:"95vw",height:"95vh",overflow:"auto",position:"relative"},children:[i.jsx("button",{onClick:()=>He(!1),style:{position:"absolute",top:"12px",right:"12px",background:"none",border:"none",fontSize:"20px",cursor:"pointer",color:"#6b7280",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},onMouseOver:B=>B.target.style.background="#f3f4f6",onMouseOut:B=>B.target.style.background="none",children:i.jsx("i",{className:"fa-solid fa-times"})}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",color:"#1f2937",margin:"0 0 16px 0",textAlign:"center"},children:"Receipt Preview"}),i.jsx("div",{dangerouslySetInnerHTML:{__html:Je()},style:{border:"1px solid #e5e7eb",borderRadius:"8px",padding:"30px",background:"#ffffff",fontFamily:"Courier New, monospace",fontSize:"16px",lineHeight:"1.6",maxWidth:"600px",margin:"0 auto"}})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>He(!1),style:{padding:"12px 24px",border:"1px solid #d1d5db",borderRadius:"8px",background:"#ffffff",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer"},children:"Close"}),i.jsxs("button",{onClick:()=>{He(!1),ct()},style:{padding:"12px 24px",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #3e3f29 0%, #7d8d86 100%)",color:"#ffffff",fontSize:"14px",fontWeight:"600",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-print"}),"Print Receipt"]})]})]})}),De&&rt&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{backgroundColor:"#ffffff",borderRadius:"12px",padding:"32px",maxWidth:"400px",width:"90%",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},children:[i.jsx("h3",{style:{margin:"0 0 16px 0",fontSize:"20px",fontWeight:"600",color:"#1f2937"},children:"Enter Custom Price"}),i.jsxs("p",{style:{margin:"0 0 20px 0",fontSize:"14px",color:"#6b7280"},children:["Set the price for: ",i.jsx("strong",{children:rt.name})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Price ()"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:$e,onChange:B=>z(B.target.value),placeholder:"0.00",style:{width:"100%",padding:"12px",border:"1px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"},onKeyDown:B=>{B.key==="Enter"&&G()},autoFocus:!0})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>{Be(!1),de(null),z("")},style:{padding:"12px 24px",border:"1px solid #d1d5db",borderRadius:"8px",background:"#ffffff",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:"Cancel"}),i.jsx("button",{onClick:G,style:{padding:"12px 24px",border:"none",borderRadius:"8px",background:"linear-gradient(135deg, #7d8d86, #3e3f29)",color:"#ffffff",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease"},children:"Add to Order"})]})]})}),be&&je&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.3)"},children:[i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:"0 0 16px 0"},children:Ne?"Edit Weight":"Enter Weight"}),i.jsxs("div",{style:{marginBottom:"16px"},children:[i.jsx("p",{style:{fontSize:"14px",color:"#6b7280",margin:"0 0 8px 0"},children:je.name}),i.jsxs("p",{style:{fontSize:"12px",color:"#9ca3af",margin:"0 0 12px 0"},children:["Price: ",je.price_per_unit?.toFixed(2)," per ",je.weight_unit]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsxs("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"8px"},children:["Weight (",je.weight_unit,")"]}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:We,onChange:B=>ot(B.target.value),placeholder:`Enter weight in ${je.weight_unit}`,style:{width:"100%",padding:"12px",border:"2px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"},onFocus:B=>B.target.style.borderColor="#7d8d86",onBlur:B=>B.target.style.borderColor="#e5e7eb",autoFocus:!0})]}),We&&parseFloat(We)>0&&i.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"12px",marginBottom:"20px"},children:[i.jsx("p",{style:{fontSize:"14px",color:"#374151",margin:"0 0 4px 0"},children:"Total Price:"}),i.jsxs("p",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:0},children:["",((parseFloat(We)||0)*(je.price_per_unit||0)).toFixed(2)]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>{Ke(!1),dt(null),tt(null),ot("")},style:{padding:"12px 24px",border:"1px solid #d1d5db",borderRadius:"8px",background:"#ffffff",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:"Cancel"}),i.jsx("button",{onClick:()=>{const B=parseFloat(We);B>0&&P(je,B)},disabled:!We||parseFloat(We)<=0,style:{padding:"12px 24px",border:"none",borderRadius:"8px",background:!We||parseFloat(We)<=0?"#d1d5db":"#7d8d86",color:!We||parseFloat(We)<=0?"#9ca3af":"#ffffff",fontSize:"14px",fontWeight:"500",cursor:!We||parseFloat(We)<=0?"not-allowed":"pointer",transition:"all 0.2s ease"},children:Ne?"Update Weight":"Add to Order"})]})]})}),mt&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"32px",maxWidth:"500px",width:"90%",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},children:[i.jsxs("h3",{style:{margin:"0 0 20px 0",fontSize:"24px",fontWeight:"600",color:"#1f2937",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("i",{className:"fa-solid fa-plus-circle",style:{color:"#10b981"}}),"Create Quick Service"]}),i.jsx("p",{style:{margin:"0 0 24px 0",fontSize:"14px",color:"#6b7280"},children:"Create a service on-the-fly with custom name and price. No need to predefine items!"}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Service Business"}),i.jsxs("select",{value:Le,onChange:B=>lt(B.target.value),style:{width:"100%",padding:"12px",border:"2px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"},onFocus:B=>B.target.style.borderColor="#7d8d86",onBlur:B=>B.target.style.borderColor="#e5e7eb",children:[i.jsx("option",{value:"",children:"Select a service business"}),Ct.map(B=>i.jsx("option",{value:B.business_id,children:B.name},B.business_id))]})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Service Name"}),i.jsx("input",{type:"text",value:St,onChange:B=>It(B.target.value),placeholder:"e.g., Haircut, Consultation, Repair...",style:{width:"100%",padding:"12px",border:"2px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"},onFocus:B=>B.target.style.borderColor="#7d8d86",onBlur:B=>B.target.style.borderColor="#e5e7eb",autoFocus:!0})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontSize:"14px",fontWeight:"500",color:"#374151"},children:"Price ()"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:Tt,onChange:B=>oe(B.target.value),placeholder:"0.00",style:{width:"100%",padding:"12px",border:"2px solid #6b7280",borderRadius:"8px",fontSize:"16px",outline:"none",transition:"border-color 0.2s ease"},onFocus:B=>B.target.style.borderColor="#7d8d86",onBlur:B=>B.target.style.borderColor="#e5e7eb"})]}),i.jsxs("div",{style:{display:"flex",gap:"12px",justifyContent:"flex-end"},children:[i.jsx("button",{onClick:()=>{ht(!1),It(""),oe(""),lt("")},style:{padding:"12px 24px",border:"1px solid #d1d5db",borderRadius:"8px",background:"#ffffff",color:"#374151",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease"},children:"Cancel"}),i.jsxs("button",{onClick:me,disabled:!St.trim()||!Tt||!Le,style:{padding:"12px 24px",border:"none",borderRadius:"8px",background:!St.trim()||!Tt||!Le?"#d1d5db":"linear-gradient(135deg, #10b981, #059669)",color:!St.trim()||!Tt||!Le?"#9ca3af":"#ffffff",fontSize:"14px",fontWeight:"600",cursor:!St.trim()||!Tt||!Le?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-plus"}),"Add to Order"]})]})]})})]})},tT="_searchContainer_tecz1_2",rT="_searchBarSection_tecz1_12",nT="_searchBarWrapper_tecz1_16",aT="_searchInputWrapper_tecz1_22",sT="_searchIcon_tecz1_40",iT="_searchInput_tecz1_22",oT="_clearButton_tecz1_65",lT="_searchResults_tecz1_87",cT="_resultsCount_tecz1_91",dT="_filtersSection_tecz1_98",uT="_filtersContainer_tecz1_103",fT="_filterGroup_tecz1_110",hT="_filterLabel_tecz1_116",pT="_filterSelect_tecz1_123",gT="_sortToggleButton_tecz1_140",xT="_clearFiltersButton_tecz1_158",Mr={searchContainer:tT,searchBarSection:rT,searchBarWrapper:nT,searchInputWrapper:aT,searchIcon:sT,searchInput:iT,clearButton:oT,searchResults:lT,resultsCount:cT,filtersSection:dT,filtersContainer:uT,filterGroup:fT,filterLabel:hT,filterSelect:pT,sortToggleButton:gT,clearFiltersButton:xT},mT=({searchTerm:e="",onSearchChange:t,searchPlaceholder:r="Search...",showSearchResults:a=!1,searchResultsCount:o=0,onClearSearch:c,filters:d=[],sortOptions:f=[],onSortToggle:p,sortOrder:h="desc",onClearFilters:x,hasActiveFilters:y=!1})=>i.jsxs("div",{className:Mr.searchContainer,children:[t&&i.jsx("div",{className:Mr.searchBarSection,children:i.jsxs("div",{className:Mr.searchBarWrapper,children:[i.jsxs("div",{className:Mr.searchInputWrapper,children:[i.jsx("i",{className:`fa-solid fa-search ${Mr.searchIcon}`}),i.jsx("input",{type:"text",placeholder:r,value:e,onChange:b=>t(b.target.value),className:Mr.searchInput}),e&&c&&i.jsx("button",{onClick:c,className:Mr.clearButton,title:"Clear search",children:i.jsx("i",{className:"fa-solid fa-times"})})]}),a&&e&&i.jsx("div",{className:Mr.searchResults,children:i.jsxs("span",{className:Mr.resultsCount,children:[o," result",o!==1?"s":""," found"]})})]})}),(d.length>0||f.length>0||p||y)&&i.jsx("div",{className:Mr.filtersSection,children:i.jsxs("div",{className:Mr.filtersContainer,children:[d.map((b,v)=>i.jsxs("div",{className:Mr.filterGroup,children:[i.jsxs("label",{className:Mr.filterLabel,children:[b.label,":"]}),i.jsx("select",{value:b.value,onChange:w=>b.onChange(w.target.value),className:Mr.filterSelect,children:b.options.map(w=>i.jsx("option",{value:w.value,children:w.label},w.value))})]},v)),f.map((b,v)=>i.jsxs("div",{className:Mr.filterGroup,children:[i.jsxs("label",{className:Mr.filterLabel,children:[b.label,":"]}),i.jsx("select",{value:b.value,onChange:w=>b.onChange(w.target.value),className:Mr.filterSelect,children:b.options.map(w=>i.jsx("option",{value:w.value,children:w.label},w.value))})]},v)),p&&i.jsx("button",{onClick:p,className:Mr.sortToggleButton,title:`Sort ${h==="asc"?"Descending":"Ascending"}`,children:i.jsx("i",{className:`fa-solid fa-sort-${h==="asc"?"up":"down"}`})}),y&&x&&i.jsxs("button",{onClick:x,className:Mr.clearFiltersButton,title:"Clear all filters",children:[i.jsx("i",{className:"fa-solid fa-times"}),"Clear"]})]})})]}),yT="_sideBusinessesContainer_272f1_2",vT="_pageHeader_272f1_8",bT="_pageTitle_272f1_17",_T="_primaryButton_272f1_31",ST="_statisticsGrid_272f1_54",wT="_statisticsCard_272f1_61",TT="_statisticsCardContent_272f1_75",ET="_statisticsInfo_272f1_81",kT="_statisticsLabel_272f1_85",jT="_statisticsValue_272f1_92",CT="_statisticsIcon_272f1_99",AT="_statisticsIconPurple_272f1_104",RT="_statisticsIconBlue_272f1_108",DT="_statisticsIconGreen_272f1_112",NT="_statisticsIconOrange_272f1_116",OT="_mainContentGrid_272f1_121",MT="_contentPanel_272f1_128",BT="_contentPanelHeader_272f1_142",IT="_contentPanelTitle_272f1_151",FT="_contentPanelBody_272f1_158",LT="_emptyStateMessage_272f1_165",PT="_emptyStateMessageIcon_272f1_171",zT="_emptyStateMessageText_272f1_177",UT="_listContainer_272f1_184",WT="_listContainerDivided_272f1_189",$T="_listItemCard_272f1_193",HT="_listItemCardContent_272f1_210",qT="_listItemCardIcon_272f1_217",GT="_listItemCardMain_272f1_234",YT="_listItemCardTitle_272f1_238",VT="_listItemCardSubtitle_272f1_245",XT="_listItemCardMeta_272f1_251",KT="_listItemCardPrice_272f1_258",QT="_listItemCardStock_272f1_264",JT="_listItemCardCount_272f1_269",ZT="_listItemCardTime_272f1_274",e3="_listItemCardActions_272f1_279",t3="_actionButton_272f1_284",r3="_actionButtonIcon_272f1_303",n3="_statusBadge_272f1_308",a3="_statusBadgeRental_272f1_316",s3="_statusBadgeResale_272f1_321",i3="_statusBadgeService_272f1_326",o3="_statusBadgeGray_272f1_331",l3="_statusBadgeCash_272f1_336",c3="_statusBadgeCard_272f1_341",d3="_statusBadgeMobile_272f1_346",u3="_modalOverlay_272f1_352",f3="_modalDialog_272f1_363",h3="_modalDialogTitle_272f1_373",p3="_modalDialogForm_272f1_380",g3="_formFieldGroup_272f1_386",x3="_formFieldLabel_272f1_391",m3="_formFieldInput_272f1_399",y3="_formFieldTextarea_272f1_420",v3="_formFieldSelect_272f1_444",b3="_actionButtonDanger_272f1_496",_3="_standardButton_272f1_506",S3="_standardButtonSecondary_272f1_516",w3="_standardButtonDanger_272f1_525",T3="_standardButtonSuccess_272f1_534",E3="_businessDetailModalHeader_272f1_544",k3="_businessAnalyticsSection_272f1_554",j3="_analyticsSectionTitle_272f1_558",C3="_analyticsGrid_272f1_567",A3="_analyticsCard_272f1_574",R3="_analyticsCardHeader_272f1_587",D3="_analyticsIcon_272f1_594",N3="_analyticsIconBlue_272f1_600",O3="_analyticsIconGreen_272f1_604",M3="_analyticsIconPurple_272f1_608",B3="_analyticsPeriod_272f1_612",I3="_analyticsCardContent_272f1_618",F3="_analyticsMetric_272f1_624",L3="_analyticsLabel_272f1_630",P3="_analyticsValue_272f1_636",z3="_itemsSectionHeader_272f1_643",U3="_restockButton_272f1_650",W3="_restockActionButton_272f1_669",$3="_editActionButton_272f1_679",H3="_formFieldHelp_272f1_690",q3="_modalHeader_272f1_698",G3="_modalCloseButton_272f1_707",Y3="_required_272f1_724",V3="_errorMessage_272f1_730",X3="_listItemCardNotes_272f1_748",K3="_restockInfo_272f1_759",Q3="_restockItemName_272f1_767",J3="_restockCurrentStock_272f1_774",Z3="_restockPreview_272f1_780",eE="_restockPreviewText_272f1_788",tE="_businessDetailModalIcon_272f1_803",rE="_businessDetailModalInfo_272f1_819",nE="_businessDetailModalName_272f1_823",aE="_businessDetailModalDescription_272f1_830",sE="_businessDetailModalMeta_272f1_836",iE="_businessDetailModalDate_272f1_842",oE="_businessDetailModalStats_272f1_847",lE="_businessDetailModalItems_272f1_854",cE="_noItemsMessage_272f1_865",dE="_deleteConfirmationWarning_272f1_872",uE="_deleteConfirmationWarningText_272f1_878",fE="_modalDialogActions_272f1_885",hE="_errorStateContainer_272f1_893",pE="_errorStateContent_272f1_901",gE="_errorStateIcon_272f1_910",xE="_errorStateTitle_272f1_916",mE="_errorStateText_272f1_922",yE="_errorStateRetryButton_272f1_927",vE="_loadingStateContainer_272f1_944",bE="_loadingStateText_272f1_951",_E="_loadingStateSpinner_272f1_959",R={sideBusinessesContainer:yT,pageHeader:vT,pageTitle:bT,primaryButton:_T,statisticsGrid:ST,statisticsCard:wT,statisticsCardContent:TT,statisticsInfo:ET,statisticsLabel:kT,statisticsValue:jT,statisticsIcon:CT,statisticsIconPurple:AT,statisticsIconBlue:RT,statisticsIconGreen:DT,statisticsIconOrange:NT,mainContentGrid:OT,contentPanel:MT,contentPanelHeader:BT,contentPanelTitle:IT,contentPanelBody:FT,emptyStateMessage:LT,emptyStateMessageIcon:PT,emptyStateMessageText:zT,listContainer:UT,listContainerDivided:WT,listItemCard:$T,listItemCardContent:HT,listItemCardIcon:qT,listItemCardMain:GT,listItemCardTitle:YT,listItemCardSubtitle:VT,listItemCardMeta:XT,listItemCardPrice:KT,listItemCardStock:QT,listItemCardCount:JT,listItemCardTime:ZT,listItemCardActions:e3,actionButton:t3,actionButtonIcon:r3,statusBadge:n3,statusBadgeRental:a3,statusBadgeResale:s3,statusBadgeService:i3,statusBadgeGray:o3,statusBadgeCash:l3,statusBadgeCard:c3,statusBadgeMobile:d3,modalOverlay:u3,modalDialog:f3,modalDialogTitle:h3,modalDialogForm:p3,formFieldGroup:g3,formFieldLabel:x3,formFieldInput:m3,formFieldTextarea:y3,formFieldSelect:v3,actionButtonDanger:b3,standardButton:_3,standardButtonSecondary:S3,standardButtonDanger:w3,standardButtonSuccess:T3,businessDetailModalHeader:E3,businessAnalyticsSection:k3,analyticsSectionTitle:j3,analyticsGrid:C3,analyticsCard:A3,analyticsCardHeader:R3,analyticsIcon:D3,analyticsIconBlue:N3,analyticsIconGreen:O3,analyticsIconPurple:M3,analyticsPeriod:B3,analyticsCardContent:I3,analyticsMetric:F3,analyticsLabel:L3,analyticsValue:P3,itemsSectionHeader:z3,restockButton:U3,restockActionButton:W3,editActionButton:$3,formFieldHelp:H3,modalHeader:q3,modalCloseButton:G3,required:Y3,errorMessage:V3,listItemCardNotes:X3,restockInfo:K3,restockItemName:Q3,restockCurrentStock:J3,restockPreview:Z3,restockPreviewText:eE,businessDetailModalIcon:tE,businessDetailModalInfo:rE,businessDetailModalName:nE,businessDetailModalDescription:aE,businessDetailModalMeta:sE,businessDetailModalDate:iE,businessDetailModalStats:oE,businessDetailModalItems:lE,noItemsMessage:cE,deleteConfirmationWarning:dE,deleteConfirmationWarningText:uE,modalDialogActions:fE,errorStateContainer:hE,errorStateContent:pE,errorStateIcon:gE,errorStateTitle:xE,errorStateText:mE,errorStateRetryButton:yE,loadingStateContainer:vE,loadingStateText:bE,loadingStateSpinner:_E};async function SE(e,t,r){console.log(" Starting image upload for side business:",t),console.log(" File details:",{name:e.name,size:e.size,type:e.type}),console.log(" User ID:",r);try{if(!r)return console.error(" No user ID provided"),null;console.log(" User ID provided:",r);const{data:a,error:o}=await Oe.storage.listBuckets();o?console.error(" Error listing buckets:",o):console.log(" Available buckets:",a?.map(h=>h.name));const c=`sidebusiness-images/${t}.${e.name.split(".").pop()}`;console.log(" Uploading to Supabase Storage:",c);const{error:d}=await Oe.storage.from("products").upload(c,e,{contentType:e.type,upsert:!0});if(d)return console.error(" Upload failed:",d),null;const{data:{publicUrl:f}}=Oe.storage.from("products").getPublicUrl(c);console.log(" Image uploaded successfully:",f),console.log(" Updating database with public URL...");const{error:p}=await Oe.from("side_businesses").update({image_url:f}).eq("business_id",t);return p?(console.error(" DB update failed:",p),null):(console.log(" Database updated with public URL"),f)}catch(a){return console.error(" Unexpected error during upload:",a),null}}const wE=()=>{const{user:e}=xa(),[t,r]=j.useState([]),[a,o]=j.useState([]),[c,d]=j.useState([]),[f,p]=j.useState(!0),[h,x]=j.useState(null),[y,b]=j.useState("all"),[v,w]=j.useState("all"),[_,T]=j.useState(""),[M,F]=j.useState("created_at"),[A,U]=j.useState("desc"),[V,te]=j.useState(!1),[N,re]=j.useState(!1),[L,X]=j.useState(new Set),[le,ge]=j.useState(!1),[Re,fe]=j.useState(null),[Ae,ee]=j.useState(!1),[ye,ae]=j.useState(null),[Se,k]=j.useState(null),[J,O]=j.useState(null),[K,Y]=j.useState(!1),[H,pe]=j.useState({item_id:null,current_stock:0,restock_quantity:""}),[Ge,He]=j.useState(!1),[De,Be]=j.useState(null),[rt,de]=j.useState({name:"",description:"",business_type:"service",icon:"fa-solid fa-briefcase"}),[$e,z]=j.useState(null),[be,Ke]=j.useState(!1),[je,dt]=j.useState({business_id:"",name:"",price:"",stock_qty:"",notes:""}),[We,ot]=j.useState({item_id:"",quantity:1,total_amount:"",payment_method:"cash"});j.useEffect(()=>{Ne()},[]);const Ne=async()=>{try{p(!0),x(null);const{data:se,error:_e}=await Oe.from("side_businesses").select("*").order("created_at",{ascending:!1});if(_e)throw _e;const{data:gt,error:pt}=await Oe.from("side_business_items").select(`
          *,
          side_businesses (name)
        `).order("created_at",{ascending:!1});if(pt)throw pt;const{data:Lt,error:zt}=await Oe.from("side_business_sales").select(`
          *,
          side_business_items (
            name,
            side_businesses (name)
          )
        `).order("date_time",{ascending:!1}).limit(10);if(zt)throw zt;r(se||[]),o(gt||[]),d(Lt||[])}catch(se){x(se instanceof Error?se.message:"Failed to fetch data")}finally{p(!1)}},tt=async se=>{if(se.preventDefault(),!rt.name.trim()){x("Business name is required");return}if(!rt.business_type){x("Business type is required");return}if(!e?.user_id){x("User not authenticated");return}try{x(null);const{data:_e,error:gt}=await Oe.from("side_businesses").insert({owner_id:e.user_id,name:rt.name.trim(),description:rt.description.trim()||null,business_type:rt.business_type}).select();if(gt)throw console.error("Database error:",gt),new Error(`Database error: ${gt.message}`);if(!_e||_e.length===0)throw new Error("No data returned from insert");const pt=_e[0].business_id;if($e){Ke(!0);try{await SE($e,pt.toString(),e.user_id)}catch(Lt){console.error("Error uploading image:",Lt)}finally{Ke(!1)}}de({name:"",description:"",business_type:"service",icon:"fa-solid fa-briefcase"}),z(null),te(!1),await Ne()}catch(_e){console.error("Error adding business:",_e),x(_e instanceof Error?_e.message:"Failed to add business")}},mt=async se=>{se.preventDefault();try{const{error:_e}=await Oe.from("side_business_items").insert({business_id:parseInt(je.business_id),name:je.name,price:je.price?parseFloat(je.price):null,stock_qty:je.stock_qty?parseInt(je.stock_qty):null,notes:je.notes.trim()||null});if(_e)throw _e;dt({business_id:"",name:"",price:"",stock_qty:"",notes:""}),re(!1),Ne()}catch(_e){x(_e instanceof Error?_e.message:"Failed to add item")}},ht=async se=>{se.preventDefault();try{const{error:_e}=await Oe.from("side_business_sales").insert({item_id:parseInt(We.item_id),quantity:We.quantity,total_amount:parseFloat(We.total_amount),payment_method:We.payment_method});if(_e)throw _e;ot({item_id:"",quantity:1,total_amount:"",payment_method:"cash"}),ge(!1),Ne()}catch(_e){x(_e instanceof Error?_e.message:"Failed to add sale")}},St=async se=>{try{console.log(" Starting delete for sale:",se);const{error:_e}=await Oe.from("side_business_sales").delete().eq("sale_id",se);if(_e)throw console.error(" Error deleting sale:",_e),_e;console.log(" Sale deleted successfully"),k(null),Ne()}catch(_e){console.error(" Delete sale failed:",_e),x(_e instanceof Error?_e.message:"Failed to delete sale")}},It=async se=>{try{console.log(" Starting delete for business:",se);const{data:_e,error:gt}=await Oe.from("side_business_items").select("item_id").eq("business_id",se);if(gt)throw console.error(" Error fetching items:",gt),gt;if(console.log(" Found items to delete:",_e?.length||0),_e&&_e.length>0){const zt=_e.map(Lr=>Lr.item_id);console.log(" Deleting sales for items:",zt);const{error:Et}=await Oe.from("side_business_sales").delete().in("item_id",zt);if(Et)throw console.error(" Error deleting sales:",Et),Et;console.log(" Sales deleted successfully")}console.log(" Deleting items for business:",se);const{error:pt}=await Oe.from("side_business_items").delete().eq("business_id",se);if(pt)throw console.error(" Error deleting items:",pt),pt;console.log(" Items deleted successfully"),console.log(" Deleting business:",se);const{error:Lt}=await Oe.from("side_businesses").delete().eq("business_id",se);if(Lt)throw console.error(" Error deleting business:",Lt),Lt;console.log(" Business deleted successfully"),ae(null),Ne()}catch(_e){console.error(" Delete failed:",_e),x(_e instanceof Error?_e.message:"Failed to delete business")}},Tt=async se=>{try{const _e=new Date,gt=new Date(_e.getFullYear(),_e.getMonth(),_e.getDate()),pt=new Date(gt);pt.setDate(gt.getDate()-gt.getDay());const Lt=new Date(_e.getFullYear(),_e.getMonth(),1),{data:zt}=await Oe.from("side_business_items").select("item_id, stock_qty").eq("business_id",se),Et=zt?.reduce((hr,Gt)=>hr+(Gt.stock_qty||0),0)||0,Lr=zt?.map(hr=>hr.item_id)||[];if(Lr.length===0){O({currentStock:0,dailySales:{count:0,revenue:0},weeklySales:{count:0,revenue:0},monthlySales:{count:0,revenue:0}});return}const{data:In}=await Oe.from("side_business_sales").select("total_amount").in("item_id",Lr).gte("date_time",gt.toISOString()),{data:Dr}=await Oe.from("side_business_sales").select("total_amount").in("item_id",Lr).gte("date_time",pt.toISOString()),{data:fr}=await Oe.from("side_business_sales").select("total_amount").in("item_id",Lr).gte("date_time",Lt.toISOString());O({currentStock:Et,dailySales:{count:In?.length||0,revenue:In?.reduce((hr,Gt)=>hr+Gt.total_amount,0)||0},weeklySales:{count:Dr?.length||0,revenue:Dr?.reduce((hr,Gt)=>hr+Gt.total_amount,0)||0},monthlySales:{count:fr?.length||0,revenue:fr?.reduce((hr,Gt)=>hr+Gt.total_amount,0)||0}})}catch(_e){console.error("Error fetching business analytics:",_e),O({currentStock:0,dailySales:{count:0,revenue:0},weeklySales:{count:0,revenue:0},monthlySales:{count:0,revenue:0}})}},oe=async se=>{if(se.preventDefault(),!(!H.item_id||!H.restock_quantity))try{const _e=H.current_stock+parseInt(H.restock_quantity),{error:gt}=await Oe.from("side_business_items").update({stock_qty:_e}).eq("item_id",H.item_id);if(gt)throw gt;pe({item_id:null,current_stock:0,restock_quantity:""}),Y(!1),Ne(),Re&&Tt(Re.business_id)}catch(_e){x(_e instanceof Error?_e.message:"Failed to restock item")}},Le=se=>{pe({item_id:se.item_id,current_stock:se.stock_qty||0,restock_quantity:""}),Y(!0)},lt=se=>{Be(se),He(!0)},Ct=async se=>{if(se.preventDefault(),!!De)try{const{error:_e}=await Oe.from("side_business_items").update({name:De.name,price:De.price,notes:De.notes}).eq("item_id",De.item_id);if(_e)throw _e;He(!1),Be(null),Ne(),Re&&Tt(Re.business_id)}catch(_e){x(_e instanceof Error?_e.message:"Failed to update item")}},qt=se=>{fe(se),ee(!0),Tt(se.business_id)},dr=se=>{switch(se){case"rental":return R.statusBadgeRental;case"resale":return R.statusBadgeResale;case"service":return R.statusBadgeService;default:return R.statusBadgeGray}},er=se=>{switch(se){case"cash":return R.statusBadgeCash;case"card":return R.statusBadgeCard;case"mobile":return R.statusBadgeMobile;default:return R.statusBadgeGray}},Pt=a.filter(se=>{const _e=y==="all"||se.business_id.toString()===y,gt=_===""||se.name.toLowerCase().includes(_.toLowerCase())||se.side_businesses?.name.toLowerCase().includes(_.toLowerCase());return _e&&gt}).sort((se,_e)=>{let gt,pt;switch(M){case"name":gt=se.name.toLowerCase(),pt=_e.name.toLowerCase();break;case"price":gt=se.price||0,pt=_e.price||0;break;case"created_at":gt=new Date(se.created_at),pt=new Date(_e.created_at);break;default:return 0}return A==="asc"?gt-pt:pt-gt}),ut=t.filter(se=>{const _e=v==="all"||se.business_type===v,gt=_===""||se.name.toLowerCase().includes(_.toLowerCase())||se.description?.toLowerCase().includes(_.toLowerCase());return _e&&gt}).sort((se,_e)=>{let gt,pt;switch(M){case"name":gt=se.name.toLowerCase(),pt=_e.name.toLowerCase();break;case"created_at":gt=new Date(se.created_at),pt=new Date(_e.created_at);break;default:return 0}return A==="asc"?gt-pt:pt-gt}),Yt=c.filter(se=>{const _e=a.find(Et=>Et.item_id===se.item_id)?.business_id,gt=y==="all"||_e?.toString()===y,pt=t.find(Et=>Et.business_id===_e),Lt=v==="all"||pt?.business_type===v,zt=_===""||se.side_business_items?.name.toLowerCase().includes(_.toLowerCase())||se.side_business_items?.side_businesses?.name.toLowerCase().includes(_.toLowerCase());return gt&&Lt&&zt}).sort((se,_e)=>{const gt=new Date(se.date_time),pt=new Date(_e.date_time);return A==="asc"?gt.getTime()-pt.getTime():pt.getTime()-gt.getTime()}),wt=[...new Set(t.map(se=>se.business_type).filter(Boolean))];return f?i.jsx("div",{className:R.loadingStateContainer,children:i.jsxs("div",{className:R.loadingStateText,children:[i.jsx("i",{className:`fa-solid fa-spinner ${R.loadingStateSpinner}`}),"Loading side businesses..."]})}):h?i.jsx("div",{className:R.errorStateContainer,children:i.jsxs("div",{className:R.errorStateContent,children:[i.jsx("i",{className:`fa-solid fa-exclamation-triangle ${R.errorStateIcon}`}),i.jsx("h2",{className:R.errorStateTitle,children:"Error Loading Side Businesses"}),i.jsx("p",{className:R.errorStateText,children:h}),i.jsx("button",{className:R.errorStateRetryButton,onClick:Ne,children:"Try Again"})]})}):i.jsxs("div",{className:R.sideBusinessesContainer,children:[i.jsxs("div",{className:R.pageHeader,children:[i.jsxs("h1",{className:R.pageTitle,children:[i.jsx("i",{className:"fa-solid fa-briefcase"}),"Side Businesses"]}),i.jsxs("button",{onClick:()=>te(!0),className:R.primaryButton,children:[i.jsx("i",{className:"fa-solid fa-plus"}),"Add Business"]})]}),i.jsx(mT,{searchTerm:_,onSearchChange:T,searchPlaceholder:"Search businesses, items, or sales...",showSearchResults:!!_,searchResultsCount:Pt.length+ut.length+Yt.length,onClearSearch:()=>T(""),filters:[{label:"Business",value:y,onChange:b,options:[{value:"all",label:"All Businesses"},...t.map(se=>({value:se.business_id.toString(),label:se.name}))]},{label:"Type",value:v,onChange:w,options:[{value:"all",label:"All Types"},...wt.map(se=>({value:se,label:se.charAt(0).toUpperCase()+se.slice(1)}))]}],sortOptions:[{label:"Sort",value:M,onChange:se=>F(se),options:[{value:"created_at",label:"Date Created"},{value:"name",label:"Name"},{value:"price",label:"Price"}]}],onSortToggle:()=>U(A==="asc"?"desc":"asc"),sortOrder:A,hasActiveFilters:y!=="all"||v!=="all",onClearFilters:()=>{b("all"),w("all")}}),i.jsxs("div",{className:R.statisticsGrid,children:[i.jsx("div",{className:R.statisticsCard,children:i.jsxs("div",{className:R.statisticsCardContent,children:[i.jsxs("div",{className:R.statisticsInfo,children:[i.jsx("p",{className:R.statisticsLabel,children:"Total Businesses"}),i.jsx("p",{className:R.statisticsValue,children:ut.length})]}),i.jsx("i",{className:`fas fa-briefcase ${R.statisticsIcon} ${R.statisticsIconPurple}`})]})}),i.jsx("div",{className:R.statisticsCard,children:i.jsxs("div",{className:R.statisticsCardContent,children:[i.jsxs("div",{className:R.statisticsInfo,children:[i.jsx("p",{className:R.statisticsLabel,children:"Total Items"}),i.jsx("p",{className:R.statisticsValue,children:Pt.length})]}),i.jsx("i",{className:`fas fa-box ${R.statisticsIcon} ${R.statisticsIconBlue}`})]})}),i.jsx("div",{className:R.statisticsCard,children:i.jsxs("div",{className:R.statisticsCardContent,children:[i.jsxs("div",{className:R.statisticsInfo,children:[i.jsx("p",{className:R.statisticsLabel,children:"Total Sales"}),i.jsx("p",{className:R.statisticsValue,children:Yt.length})]}),i.jsx("i",{className:`fas fa-chart-line ${R.statisticsIcon} ${R.statisticsIconGreen}`})]})}),i.jsx("div",{className:R.statisticsCard,children:i.jsxs("div",{className:R.statisticsCardContent,children:[i.jsxs("div",{className:R.statisticsInfo,children:[i.jsx("p",{className:R.statisticsLabel,children:"Revenue"}),i.jsxs("p",{className:R.statisticsValue,children:["",Yt.reduce((se,_e)=>se+_e.total_amount,0).toFixed(2)]})]}),i.jsx("i",{className:`fas fa-euro-sign ${R.statisticsIcon} ${R.statisticsIconOrange}`})]})})]}),i.jsxs("div",{className:R.mainContentGrid,children:[i.jsxs("div",{className:R.contentPanel,children:[i.jsx("div",{className:R.contentPanelHeader,children:i.jsx("h2",{className:R.contentPanelTitle,children:"Businesses"})}),i.jsx("div",{className:R.contentPanelBody,children:ut.length===0?i.jsxs("div",{className:R.emptyStateMessage,children:[i.jsx("i",{className:`fa-solid fa-briefcase ${R.emptyStateMessageIcon}`}),i.jsx("p",{className:R.emptyStateMessageText,children:"No businesses found. Add your first side business to get started!"})]}):i.jsx("div",{className:`${R.listContainer} ${R.listContainerDivided}`,children:ut.map(se=>i.jsx("div",{className:R.listItemCard,onClick:()=>qt(se),children:i.jsxs("div",{className:R.listItemCardContent,children:[i.jsx("div",{className:R.listItemCardIcon,children:se.image_url&&i.jsx("img",{src:se.image_url,alt:se.name,style:{width:"40px",height:"40px",borderRadius:"8px",objectFit:"cover"}})}),i.jsxs("div",{className:R.listItemCardMain,children:[i.jsx("h3",{className:R.listItemCardTitle,children:se.name}),se.description&&i.jsx("p",{className:R.listItemCardSubtitle,children:se.description}),i.jsxs("div",{className:R.listItemCardMeta,children:[i.jsx("span",{className:`${R.statusBadge} ${dr(se.business_type)}`,children:se.business_type||"service"}),i.jsxs("span",{className:R.listItemCardCount,children:[a.filter(_e=>_e.business_id===se.business_id).length," items"]})]})]}),i.jsx("div",{className:R.listItemCardActions,children:i.jsxs("button",{onClick:_e=>{_e.stopPropagation(),ae(se)},className:`${R.actionButton} ${R.actionButtonDanger}`,title:"Delete Business",children:[i.jsx("i",{className:`fas fa-trash ${R.actionButtonIcon}`}),"Delete"]})})]})},se.business_id))})})]}),i.jsxs("div",{className:R.contentPanel,children:[i.jsxs("div",{className:R.contentPanelHeader,children:[i.jsx("h2",{className:R.contentPanelTitle,children:"Items"}),i.jsxs("button",{onClick:()=>re(!0),className:R.actionButton,style:{marginLeft:"auto"},children:[i.jsx("i",{className:`fas fa-plus ${R.actionButtonIcon}`}),"Add Item"]})]}),i.jsx("div",{className:R.contentPanelBody,children:Pt.length===0?i.jsxs("div",{className:R.emptyStateMessage,children:[i.jsx("i",{className:`fa-solid fa-box ${R.emptyStateMessageIcon}`}),i.jsx("p",{className:R.emptyStateMessageText,children:"No items found. Add items to your businesses!"})]}):i.jsx("div",{className:`${R.listContainer} ${R.listContainerDivided}`,children:Pt.map(se=>i.jsx("div",{className:R.listItemCard,children:i.jsxs("div",{className:R.listItemCardContent,children:[i.jsxs("div",{className:R.listItemCardMain,children:[i.jsx("h3",{className:R.listItemCardTitle,children:se.name}),i.jsx("p",{className:R.listItemCardSubtitle,children:se.side_businesses?.name||"Unknown Business"}),i.jsxs("div",{className:R.listItemCardMeta,children:[se.price?i.jsxs("span",{className:R.listItemCardPrice,children:["",se.price]}):i.jsx("span",{className:R.listItemCardPrice,style:{color:"#7d8d86",fontStyle:"italic"},children:"Custom Amount"}),se.stock_qty!==null&&i.jsxs("span",{className:R.listItemCardStock,children:["Stock: ",se.stock_qty]}),t.find(_e=>_e.business_id===se.business_id)?.business_type==="service"&&i.jsx("span",{className:`${R.statusBadge} ${R.statusBadgeService}`,style:{fontSize:"10px",padding:"2px 6px"},children:"Service"})]})]}),i.jsx("div",{className:R.listItemCardActions,children:i.jsxs("button",{onClick:()=>{ot(_e=>({..._e,item_id:se.item_id.toString()})),ge(!0)},className:R.actionButton,children:[i.jsx("i",{className:`fas fa-plus ${R.actionButtonIcon}`}),"Sale"]})})]})},se.item_id))})})]}),i.jsxs("div",{className:R.contentPanel,children:[i.jsx("div",{className:R.contentPanelHeader,children:i.jsx("h2",{className:R.contentPanelTitle,children:"Recent Sales"})}),i.jsx("div",{className:R.contentPanelBody,children:Yt.length===0?i.jsxs("div",{className:R.emptyStateMessage,children:[i.jsx("i",{className:`fa-solid fa-receipt ${R.emptyStateMessageIcon}`}),i.jsx("p",{className:R.emptyStateMessageText,children:"No sales recorded yet."})]}):i.jsx("div",{className:`${R.listContainer} ${R.listContainerDivided}`,children:Yt.map(se=>i.jsx("div",{className:R.listItemCard,children:i.jsxs("div",{className:R.listItemCardContent,children:[i.jsxs("div",{className:R.listItemCardMain,children:[i.jsx("h3",{className:R.listItemCardTitle,children:se.side_business_items?.name||"Unknown Item"}),i.jsx("p",{className:R.listItemCardSubtitle,children:se.side_business_items?.side_businesses?.name||"Unknown Business"}),i.jsxs("p",{className:R.listItemCardTime,children:[new Date(se.date_time).toLocaleDateString()," at ",new Date(se.date_time).toLocaleTimeString()]}),i.jsxs("div",{className:R.listItemCardMeta,children:[i.jsxs("span",{className:R.listItemCardCount,children:["Qty: ",se.quantity]}),i.jsxs("span",{className:R.listItemCardPrice,children:["",se.total_amount]}),i.jsx("span",{className:`${R.statusBadge} ${er(se.payment_method)}`,children:se.payment_method})]})]}),i.jsx("div",{className:R.listItemCardActions,children:i.jsxs("button",{onClick:_e=>{_e.stopPropagation(),k(se)},className:`${R.actionButton} ${R.actionButtonDanger}`,title:"Delete Sale",children:[i.jsx("i",{className:`fas fa-trash ${R.actionButtonIcon}`}),"Delete"]})})]})},se.sale_id))})})]})]}),V&&i.jsx("div",{className:R.modalOverlay,children:i.jsxs("div",{className:R.modalDialog,children:[i.jsxs("div",{className:R.modalHeader,children:[i.jsx("h2",{className:R.modalDialogTitle,children:"Create New Business"}),i.jsx("button",{type:"button",onClick:()=>{de({name:"",description:"",business_type:"service",icon:"fa-solid fa-briefcase"}),te(!1),x(null)},className:R.modalCloseButton,children:i.jsx("i",{className:"fas fa-times"})})]}),h&&i.jsxs("div",{className:R.errorMessage,children:[i.jsx("i",{className:"fas fa-exclamation-triangle"}),h]}),i.jsxs("form",{onSubmit:tt,className:R.modalDialogForm,children:[i.jsxs("div",{className:R.formFieldGroup,children:[i.jsxs("label",{className:R.formFieldLabel,children:["Business Name ",i.jsx("span",{className:R.required,children:"*"})]}),i.jsx("input",{type:"text",required:!0,value:rt.name,onChange:se=>de(_e=>({..._e,name:se.target.value})),className:R.formFieldInput,placeholder:"Enter business name",maxLength:100})]}),i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Description"}),i.jsx("textarea",{value:rt.description,onChange:se=>de(_e=>({..._e,description:se.target.value})),className:R.formFieldTextarea,rows:3,placeholder:"Brief description of your business",maxLength:500}),i.jsx("small",{className:R.formFieldHelp,children:"Optional: Describe what your business does"})]}),i.jsxs("div",{className:R.formFieldGroup,children:[i.jsxs("label",{className:R.formFieldLabel,children:["Business Type ",i.jsx("span",{className:R.required,children:"*"})]}),i.jsxs("select",{value:rt.business_type,onChange:se=>de(_e=>({..._e,business_type:se.target.value})),className:R.formFieldSelect,required:!0,children:[i.jsx("option",{value:"",children:"Select business type"}),i.jsx("option",{value:"service",children:"Service (Custom pricing per transaction)"}),i.jsx("option",{value:"rental",children:"Rental (Fixed pricing with stock)"}),i.jsx("option",{value:"resale",children:"Resale (Fixed pricing with stock)"})]}),i.jsxs("small",{className:R.formFieldHelp,children:[rt.business_type==="service"&&"Services allow custom pricing for each transaction",rt.business_type==="rental"&&"Rentals have fixed prices and track stock quantities",rt.business_type==="resale"&&"Resale items have fixed prices and track stock quantities"]})]}),i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Business Image"}),i.jsx("input",{type:"file",accept:"image/*",onChange:se=>{const _e=se.target.files?.[0];z(_e||null)},className:R.formFieldInput}),i.jsx("small",{className:R.formFieldHelp,children:"Optional: Upload an image for your business (max 5MB, will be compressed)"}),$e&&i.jsxs("div",{style:{marginTop:"8px",padding:"8px",background:"#f0f0f0",borderRadius:"4px"},children:[i.jsx("i",{className:"fas fa-image",style:{marginRight:"8px",color:"#7d8d86"}}),"Selected: ",$e.name]})]}),i.jsxs("div",{className:R.modalDialogActions,children:[i.jsx("button",{type:"button",onClick:()=>{de({name:"",description:"",business_type:"service",icon:"fa-solid fa-briefcase"}),z(null),te(!1),x(null)},className:`${R.standardButton} ${R.standardButtonSecondary}`,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:!rt.name.trim()||!rt.business_type||be,className:`${R.standardButton} ${R.standardButtonPrimary}`,children:be?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-spinner fa-spin",style:{marginRight:"8px"}}),"Creating..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fas fa-plus",style:{marginRight:"8px"}}),"Create Business"]})})]})]})]})}),N&&i.jsx("div",{className:R.modalOverlay,children:i.jsxs("div",{className:R.modalDialog,children:[i.jsx("h2",{className:R.modalDialogTitle,children:"Add Item"}),i.jsxs("form",{onSubmit:mt,className:R.modalDialogForm,children:[i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Business"}),i.jsxs("select",{required:!0,value:je.business_id,onChange:se=>dt(_e=>({..._e,business_id:se.target.value})),className:R.formFieldSelect,children:[i.jsx("option",{value:"",children:"Select a business"}),t.map(se=>i.jsxs("option",{value:se.business_id,children:[se.name," (",se.business_type,")"]},se.business_id))]})]}),i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Item Name"}),i.jsx("input",{type:"text",required:!0,value:je.name,onChange:se=>dt(_e=>({..._e,name:se.target.value})),className:R.formFieldInput,placeholder:"e.g., Haircut, Chair Rental, etc."})]}),je.business_id&&t.find(se=>se.business_id.toString()===je.business_id)?.business_type!=="service"&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Price ()"}),i.jsx("input",{type:"number",step:"0.01",value:je.price,onChange:se=>dt(_e=>({..._e,price:se.target.value})),className:R.formFieldInput,placeholder:"0.00"})]}),i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Stock Quantity"}),i.jsx("input",{type:"number",min:"0",value:je.stock_qty,onChange:se=>dt(_e=>({..._e,stock_qty:se.target.value})),className:R.formFieldInput,placeholder:"0"})]})]}),je.business_id&&t.find(se=>se.business_id.toString()===je.business_id)?.business_type==="service"&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:R.formFieldGroup,children:i.jsxs("p",{style:{color:"#7d8d86",fontSize:"14px",margin:0},children:[i.jsx("i",{className:"fa-solid fa-info-circle",style:{marginRight:"8px"}}),"Service items don't have fixed prices or stock. You'll enter the amount when recording a sale."]})}),i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Service Notes"}),i.jsx("textarea",{value:je.notes,onChange:se=>dt(_e=>({..._e,notes:se.target.value})),className:R.formFieldTextarea,rows:3,placeholder:"Add notes, instructions, or details for this service...",maxLength:500}),i.jsx("small",{className:R.formFieldHelp,children:"Optional: Add any special instructions, requirements, or details for this service"})]})]}),i.jsxs("div",{className:R.modalDialogActions,children:[i.jsx("button",{type:"button",onClick:()=>re(!1),className:`${R.standardButton} ${R.standardButtonSecondary}`,children:"Cancel"}),i.jsx("button",{type:"submit",className:`${R.standardButton} ${R.standardButtonSuccess}`,children:"Add Item"})]})]})]})}),le&&i.jsx("div",{className:R.modalOverlay,style:{zIndex:2e3},children:i.jsxs("div",{className:R.modalDialog,children:[i.jsx("h2",{className:R.modalDialogTitle,children:"Record Sale"}),i.jsxs("form",{onSubmit:ht,className:R.modalDialogForm,children:[i.jsxs("div",{className:R.formGroup,children:[i.jsx("label",{className:R.formLabel,children:"Item"}),i.jsxs("select",{required:!0,value:We.item_id,onChange:se=>ot(_e=>({..._e,item_id:se.target.value})),className:R.formFieldSelect,children:[i.jsx("option",{value:"",children:"Select an item"}),a.map(se=>i.jsxs("option",{value:se.item_id,children:[se.name," - ",se.side_businesses?.name,se.side_businesses&&t.find(_e=>_e.name===se.side_businesses?.name)?.business_type==="service"?" (Service - Custom Amount)":se.price?` (${se.price})`:""]},se.item_id))]})]}),i.jsxs("div",{className:R.formGroup,children:[i.jsx("label",{className:R.formLabel,children:"Quantity"}),i.jsx("input",{type:"number",min:"1",required:!0,value:We.quantity,onChange:se=>ot(_e=>({..._e,quantity:parseInt(se.target.value)})),className:R.formFieldInput})]}),i.jsxs("div",{className:R.formGroup,children:[i.jsx("label",{className:R.formLabel,children:"Total Amount ()"}),i.jsx("input",{type:"number",step:"0.01",required:!0,value:We.total_amount,onChange:se=>ot(_e=>({..._e,total_amount:se.target.value})),className:R.formFieldInput,placeholder:"0.00"}),We.item_id&&a.find(se=>se.item_id.toString()===We.item_id)&&t.find(se=>se.name===a.find(_e=>_e.item_id.toString()===We.item_id)?.side_businesses?.name)?.business_type==="service"&&i.jsxs("p",{style:{color:"#7d8d86",fontSize:"12px",margin:"4px 0 0 0"},children:[i.jsx("i",{className:"fa-solid fa-info-circle",style:{marginRight:"4px"}}),"Enter the custom amount for this service"]})]}),i.jsxs("div",{className:R.formGroup,children:[i.jsx("label",{className:R.formLabel,children:"Payment Method"}),i.jsxs("select",{value:We.payment_method,onChange:se=>ot(_e=>({..._e,payment_method:se.target.value})),className:R.formFieldSelect,children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"mobile",children:"Mobile"})]})]}),i.jsxs("div",{className:R.modalDialogActions,children:[i.jsx("button",{type:"button",onClick:()=>ge(!1),className:`${R.standardButton} ${R.standardButtonSecondary}`,children:"Cancel"}),i.jsx("button",{type:"submit",className:`${R.standardButton} ${R.standardButtonSuccess}`,children:"Record Sale"})]})]})]})}),Ae&&Re&&i.jsx("div",{className:R.modalOverlay,children:i.jsxs("div",{className:R.modalDialog,style:{maxWidth:"600px"},children:[i.jsx("h2",{className:R.modalDialogTitle,children:"Business Details"}),i.jsxs("div",{className:R.businessDetailModalHeader,children:[i.jsx("div",{className:R.businessDetailModalIcon,children:Re.image_url?i.jsx("img",{src:Re.image_url,alt:Re.name,style:{width:"100%",height:"100%",borderRadius:"16px",objectFit:"cover"}}):i.jsx("i",{className:Re.icon||"fa-solid fa-briefcase"})}),i.jsxs("div",{className:R.businessDetailModalInfo,children:[i.jsx("h3",{className:R.businessDetailModalName,children:Re.name}),i.jsx("p",{className:R.businessDetailModalDescription,children:Re.description||"No description provided"}),i.jsxs("div",{className:R.businessDetailModalMeta,children:[i.jsx("span",{className:`${R.statusBadge} ${dr(Re.business_type)}`,children:Re.business_type||"service"}),i.jsxs("span",{className:R.businessDetailModalDate,children:["Created: ",new Date(Re.created_at).toLocaleDateString()]})]})]})]}),i.jsxs("div",{className:R.businessDetailModalStats,children:[i.jsx("div",{className:R.statisticsCard,children:i.jsxs("div",{className:R.statisticsCardContent,children:[i.jsxs("div",{className:R.statisticsInfo,children:[i.jsx("p",{className:R.statisticsLabel,children:"Total Items"}),i.jsx("p",{className:R.statisticsValue,children:a.filter(se=>se.business_id===Re.business_id).length})]}),i.jsx("i",{className:`fas fa-box ${R.statisticsIcon} ${R.statisticsIconBlue}`})]})}),i.jsx("div",{className:R.statisticsCard,children:i.jsxs("div",{className:R.statisticsCardContent,children:[i.jsxs("div",{className:R.statisticsInfo,children:[i.jsx("p",{className:R.statisticsLabel,children:"Current Stock"}),i.jsx("p",{className:R.statisticsValue,children:J?.currentStock||0})]}),i.jsx("i",{className:`fas fa-warehouse ${R.statisticsIcon} ${R.statisticsIconOrange}`})]})})]}),i.jsxs("div",{className:R.businessAnalyticsSection,children:[i.jsx("h4",{className:R.analyticsSectionTitle,children:"Sales Analytics"}),i.jsxs("div",{className:R.analyticsGrid,children:[i.jsxs("div",{className:R.analyticsCard,children:[i.jsxs("div",{className:R.analyticsCardHeader,children:[i.jsx("i",{className:`fas fa-calendar-day ${R.analyticsIcon} ${R.analyticsIconBlue}`}),i.jsx("span",{className:R.analyticsPeriod,children:"Today"})]}),i.jsxs("div",{className:R.analyticsCardContent,children:[i.jsxs("div",{className:R.analyticsMetric,children:[i.jsx("span",{className:R.analyticsLabel,children:"Sales"}),i.jsx("span",{className:R.analyticsValue,children:J?.dailySales.count||0})]}),i.jsxs("div",{className:R.analyticsMetric,children:[i.jsx("span",{className:R.analyticsLabel,children:"Revenue"}),i.jsxs("span",{className:R.analyticsValue,children:["",(J?.dailySales.revenue||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:R.analyticsCard,children:[i.jsxs("div",{className:R.analyticsCardHeader,children:[i.jsx("i",{className:`fas fa-calendar-week ${R.analyticsIcon} ${R.analyticsIconGreen}`}),i.jsx("span",{className:R.analyticsPeriod,children:"This Week"})]}),i.jsxs("div",{className:R.analyticsCardContent,children:[i.jsxs("div",{className:R.analyticsMetric,children:[i.jsx("span",{className:R.analyticsLabel,children:"Sales"}),i.jsx("span",{className:R.analyticsValue,children:J?.weeklySales.count||0})]}),i.jsxs("div",{className:R.analyticsMetric,children:[i.jsx("span",{className:R.analyticsLabel,children:"Revenue"}),i.jsxs("span",{className:R.analyticsValue,children:["",(J?.weeklySales.revenue||0).toFixed(2)]})]})]})]}),i.jsxs("div",{className:R.analyticsCard,children:[i.jsxs("div",{className:R.analyticsCardHeader,children:[i.jsx("i",{className:`fas fa-calendar-alt ${R.analyticsIcon} ${R.analyticsIconPurple}`}),i.jsx("span",{className:R.analyticsPeriod,children:"This Month"})]}),i.jsxs("div",{className:R.analyticsCardContent,children:[i.jsxs("div",{className:R.analyticsMetric,children:[i.jsx("span",{className:R.analyticsLabel,children:"Sales"}),i.jsx("span",{className:R.analyticsValue,children:J?.monthlySales.count||0})]}),i.jsxs("div",{className:R.analyticsMetric,children:[i.jsx("span",{className:R.analyticsLabel,children:"Revenue"}),i.jsxs("span",{className:R.analyticsValue,children:["",(J?.monthlySales.revenue||0).toFixed(2)]})]})]})]})]})]}),i.jsxs("div",{className:R.businessDetailModalItems,children:[i.jsxs("div",{className:R.itemsSectionHeader,children:[i.jsx("h4",{children:"Items in this business:"}),i.jsxs("button",{onClick:()=>re(!0),className:R.restockButton,title:"Add new item",children:[i.jsx("i",{className:"fas fa-plus"}),"Add Item"]})]}),a.filter(se=>se.business_id===Re.business_id).length===0?i.jsx("p",{className:R.noItemsMessage,children:"No items added yet."}):i.jsx("div",{className:R.listContainer,children:a.filter(se=>se.business_id===Re.business_id).map(se=>i.jsx("div",{className:R.listItemCard,children:i.jsxs("div",{className:R.listItemCardContent,children:[i.jsxs("div",{className:R.listItemCardMain,children:[i.jsx("h4",{className:R.listItemCardTitle,children:se.name}),i.jsxs("div",{className:R.listItemCardMeta,children:[se.price?i.jsxs("span",{className:R.listItemCardPrice,children:["",se.price]}):i.jsx("span",{className:R.listItemCardPrice,style:{color:"#7d8d86",fontStyle:"italic"},children:"Custom Amount"}),se.stock_qty!==null&&i.jsxs("span",{className:R.listItemCardStock,children:["Stock: ",se.stock_qty]}),Re?.business_type==="service"&&i.jsx("span",{className:`${R.statusBadge} ${R.statusBadgeService}`,style:{fontSize:"10px",padding:"2px 6px"},children:"Service"})]}),se.notes&&i.jsxs("div",{className:R.listItemCardNotes,children:[i.jsx("i",{className:"fas fa-sticky-note",style:{marginRight:"6px",color:"#6b7280"}}),i.jsx("span",{style:{fontSize:"12px",color:"#6b7280",fontStyle:"italic"},children:se.notes.length>100?`${se.notes.substring(0,100)}...`:se.notes})]})]}),i.jsxs("div",{className:R.listItemCardActions,children:[i.jsxs("button",{onClick:()=>lt(se),className:`${R.actionButton} ${R.editActionButton}`,title:"Edit item",children:[i.jsx("i",{className:`fas fa-edit ${R.actionButtonIcon}`}),"Edit"]}),se.stock_qty!==null&&i.jsxs("button",{onClick:()=>Le(se),className:`${R.actionButton} ${R.restockActionButton}`,title:"Restock item",children:[i.jsx("i",{className:`fas fa-boxes-stacked ${R.actionButtonIcon}`}),"Restock"]}),i.jsxs("button",{onClick:()=>{ot(_e=>({..._e,item_id:se.item_id.toString()})),ge(!0)},className:R.actionButton,title:"Record sale",children:[i.jsx("i",{className:`fas fa-plus ${R.actionButtonIcon}`}),"Sale"]})]})]})},se.item_id))})]}),i.jsxs("div",{className:R.modalDialogActions,children:[i.jsx("button",{type:"button",onClick:()=>ee(!1),className:`${R.standardButton} ${R.standardButtonSecondary}`,children:"Close"}),i.jsx("button",{type:"button",onClick:()=>{ee(!1),ae(Re)},className:`${R.standardButton} ${R.standardButtonDanger}`,children:"Delete Business"})]})]})}),ye&&i.jsx("div",{className:R.modalOverlay,children:i.jsxs("div",{className:R.modalDialog,children:[i.jsx("h2",{className:R.modalDialogTitle,children:"Delete Business"}),i.jsxs("p",{className:R.deleteConfirmationWarning,children:["Are you sure you want to delete ",i.jsx("strong",{children:ye.name}),"?"]}),i.jsx("p",{className:R.deleteConfirmationWarningText,children:"This will permanently delete the business, all its items, and all related sales records. This action cannot be undone."}),i.jsxs("div",{className:R.modalDialogActions,children:[i.jsx("button",{type:"button",onClick:()=>ae(null),className:`${R.standardButton} ${R.standardButtonSecondary}`,children:"Cancel"}),i.jsx("button",{type:"button",onClick:()=>It(ye.business_id),className:`${R.standardButton} ${R.standardButtonDanger}`,children:"Delete Business"})]})]})}),Se&&i.jsx("div",{className:R.modalOverlay,children:i.jsxs("div",{className:R.modalDialog,children:[i.jsx("h2",{className:R.modalDialogTitle,children:"Delete Sale"}),i.jsx("p",{className:R.deleteConfirmationWarning,children:"Are you sure you want to delete this sale?"}),i.jsxs("div",{style:{background:"#f8f9fa",padding:"12px",borderRadius:"8px",margin:"16px 0",border:"1px solid #e9ecef"},children:[i.jsx("p",{style:{margin:"0 0 8px 0",fontWeight:"600"},children:Se.side_business_items?.name||"Unknown Item"}),i.jsx("p",{style:{margin:"0 0 4px 0",color:"#6c757d",fontSize:"14px"},children:Se.side_business_items?.side_businesses?.name||"Unknown Business"}),i.jsxs("p",{style:{margin:"0 0 4px 0",color:"#6c757d",fontSize:"14px"},children:["Quantity: ",Se.quantity,"  Total: ",Se.total_amount]}),i.jsxs("p",{style:{margin:"0",color:"#6c757d",fontSize:"14px"},children:[new Date(Se.date_time).toLocaleDateString()," at ",new Date(Se.date_time).toLocaleTimeString()]})]}),i.jsx("p",{className:R.deleteConfirmationWarningText,children:"This will permanently delete the sale record. This action cannot be undone."}),i.jsxs("div",{className:R.modalDialogActions,children:[i.jsx("button",{type:"button",onClick:()=>k(null),className:`${R.standardButton} ${R.standardButtonSecondary}`,children:"Cancel"}),i.jsx("button",{type:"button",onClick:()=>St(Se.sale_id),className:`${R.standardButton} ${R.standardButtonDanger}`,children:"Delete Sale"})]})]})}),K&&H.item_id&&i.jsx("div",{className:R.modalOverlay,style:{zIndex:2e3},children:i.jsxs("div",{className:R.modalDialog,children:[i.jsx("h2",{className:R.modalDialogTitle,children:"Restock Item"}),i.jsxs("div",{className:R.restockInfo,children:[i.jsx("p",{className:R.restockItemName,children:a.find(se=>se.item_id===H.item_id)?.name}),i.jsxs("p",{className:R.restockCurrentStock,children:["Current Stock: ",i.jsx("strong",{children:H.current_stock})]})]}),i.jsxs("form",{onSubmit:oe,className:R.modalDialogForm,children:[i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Restock Quantity"}),i.jsx("input",{type:"number",min:"1",required:!0,value:H.restock_quantity,onChange:se=>pe(_e=>({..._e,restock_quantity:se.target.value})),className:R.formFieldInput,placeholder:"Enter quantity to add"})]}),i.jsx("div",{className:R.restockPreview,children:i.jsxs("p",{className:R.restockPreviewText,children:["New stock will be: ",i.jsx("strong",{children:H.current_stock+(parseInt(H.restock_quantity)||0)})]})}),i.jsxs("div",{className:R.modalDialogActions,children:[i.jsx("button",{type:"button",onClick:()=>Y(!1),className:`${R.standardButton} ${R.standardButtonSecondary}`,children:"Cancel"}),i.jsxs("button",{type:"submit",className:`${R.standardButton} ${R.standardButtonSuccess}`,children:[i.jsx("i",{className:"fas fa-boxes-stacked",style:{marginRight:"8px"}}),"Restock Item"]})]})]})]})}),Ge&&De&&i.jsx("div",{className:R.modalOverlay,style:{zIndex:2e3},children:i.jsxs("div",{className:R.modalDialog,children:[i.jsx("h2",{className:R.modalDialogTitle,children:"Edit Item"}),i.jsxs("form",{onSubmit:Ct,className:R.modalDialogForm,children:[i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Item Name"}),i.jsx("input",{type:"text",required:!0,value:De.name,onChange:se=>Be(_e=>_e?{..._e,name:se.target.value}:null),className:R.formFieldInput,placeholder:"Enter item name"})]}),i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Price ()"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:De.price||"",onChange:se=>Be(_e=>_e?{..._e,price:se.target.value?parseFloat(se.target.value):null}:null),className:R.formFieldInput,placeholder:"Enter price (leave empty for custom pricing)"}),i.jsx("small",{className:R.formFieldHelp,children:"Leave empty for service items with custom pricing"})]}),i.jsxs("div",{className:R.formFieldGroup,children:[i.jsx("label",{className:R.formFieldLabel,children:"Notes"}),i.jsx("textarea",{value:De.notes||"",onChange:se=>Be(_e=>_e?{..._e,notes:se.target.value}:null),className:R.formFieldTextarea,rows:3,placeholder:"Add notes, instructions, or details...",maxLength:500}),i.jsx("small",{className:R.formFieldHelp,children:"Optional: Add any special instructions, requirements, or details"})]}),i.jsxs("div",{className:R.modalDialogActions,children:[i.jsx("button",{type:"button",onClick:()=>He(!1),className:`${R.standardButton} ${R.standardButtonSecondary}`,children:"Cancel"}),i.jsxs("button",{type:"submit",className:`${R.standardButton} ${R.standardButtonPrimary}`,children:[i.jsx("i",{className:"fas fa-save",style:{marginRight:"8px"}}),"Update Item"]})]})]})]})})]})},TE=()=>{const[e,t]=j.useState([]),[r,a]=j.useState(!0),[o,c]=j.useState(null),d=async()=>{try{a(!0),c(null);const{data:h,error:x}=await Oe.from("sales").select(`
          *,
          customers (name),
          users (username)
        `).order("datetime",{ascending:!1});if(x)throw x;const y=h?.map(b=>{const v=b.notes&&(b.notes.includes("PARTIAL PAYMENT")||b.notes.includes("Amount Paid Today")||b.notes.includes("Remaining Balance"));let w=0,_=0,T="";if(v&&b.notes){const F=b.notes,A=F.match(/Amount Paid Today:\s*(\d+\.?\d*)/i);A&&(w=parseFloat(A[1]));const U=F.match(/Remaining Balance:\s*(\d+\.?\d*)/i);U&&(_=parseFloat(U[1]));const V=F.match(/Partial Payment Notes:\s*(.+?)(?:\n\n|\n---|$)/is);V&&(T=V[1].trim())}const M=v?w+_:b.total_amount;return{...b,total_amount:M,customer_name:b.customers?.name||"Walk-in Customer",cashier_name:b.users?.username||"Unknown",partial_payment:v,partial_amount:w,remaining_amount:_,partial_notes:T}})||[];t(y)}catch(h){c(h instanceof Error?h.message:"Failed to fetch transactions")}finally{a(!1)}},f=async h=>{try{const{data:x,error:y}=await Oe.from("sales").select("*").eq("sale_id",h).single();if(y)throw y;if(!x)throw new Error("Transaction not found");if(!(x.notes&&(x.notes.includes("PARTIAL PAYMENT")||x.notes.includes("Amount Paid Today")||x.notes.includes("Remaining Balance"))))throw new Error("This transaction is not a partial payment");let v=x.total_amount;if(x.notes){const T=x.notes.match(/Amount Paid Today:\s*(\d+\.?\d*)/i),M=x.notes.match(/Remaining Balance:\s*(\d+\.?\d*)/i);if(T&&M){const F=parseFloat(T[1]),A=parseFloat(M[1]);v=F+A}}const w=x.notes?x.notes.replace(/PARTIAL PAYMENT.*$/s,"PAYMENT COMPLETED - Full amount paid"):"PAYMENT COMPLETED - Full amount paid",{error:_}=await Oe.from("sales").update({total_amount:v,notes:w}).eq("sale_id",h);if(_)throw _;return await d(),!0}catch(x){return c(x instanceof Error?x.message:"Failed to resolve partial payment"),!1}},p=async h=>{try{const{data:x,error:y}=await Oe.from("sale_items").select(`
          *,
          products (stock_quantity)
        `).eq("sale_id",h);if(y)throw y;for(const w of x||[]){const _=(w.products?.stock_quantity||0)+w.quantity,{error:T}=await Oe.from("products").update({stock_quantity:_}).eq("product_id",w.product_id);if(T)throw T;await Oe.from("inventory_movements").insert({product_id:w.product_id,quantity_change:w.quantity,movement_type:"Restock",reference_id:h})}const{error:b}=await Oe.from("sale_items").delete().eq("sale_id",h);if(b)throw b;const{error:v}=await Oe.from("sales").delete().eq("sale_id",h);if(v)throw v;return await d(),!0}catch(x){return c(x instanceof Error?x.message:"Failed to delete transaction"),!1}};return j.useEffect(()=>{d()},[]),{transactions:e,loading:r,error:o,fetchTransactions:d,deleteTransaction:p,resolvePartialPayment:f}},i0=({children:e,maxWidth:t="1400px"})=>i.jsx("div",{style:{minHeight:"100vh",background:"#f8fafc",fontFamily:"Poppins, sans-serif",padding:"20px"},children:i.jsx("div",{style:{maxWidth:t,margin:"0 auto",background:"#ffffff",borderRadius:"12px",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.05)"},children:e})}),EE=({title:e,subtitle:t,icon:r,children:a})=>i.jsx("div",{style:{padding:"24px 32px",borderBottom:"1px solid #e5e7eb",background:"#f9fafb"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:a?"16px":"0"},children:[i.jsxs("div",{children:[i.jsxs("h1",{style:{fontSize:"28px",fontWeight:"600",color:"#1f2937",margin:"0 0 8px 0"},children:[r&&i.jsx("i",{className:r,style:{marginRight:"12px",color:"#7d8d86"}}),e]}),t&&i.jsx("p",{style:{fontSize:"16px",color:"#6b7280",margin:"0"},children:t})]}),a]})}),ny=({children:e,className:t="",style:r={},padding:a="md",background:o="white",hover:c=!1})=>{const d={borderRadius:"12px",border:"1px solid #e5e7eb",transition:c?"all 0.2s ease":"none",...r},f={white:{background:"#ffffff"},gray:{background:"#f9fafb"}},p={sm:{padding:"12px"},md:{padding:"20px"},lg:{padding:"24px"}},h={...d,...f[o],...p[a]};return i.jsx("div",{className:t,style:h,onMouseEnter:x=>{c&&(x.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.1)",x.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:x=>{c&&(x.currentTarget.style.boxShadow="none",x.currentTarget.style.transform="translateY(0)")},children:e})},kE=({searchTerm:e,setSearchTerm:t,paymentFilter:r,setPaymentFilter:a,dateFilter:o,setDateFilter:c,selectedDate:d,showCalendar:f,setShowCalendar:p,itemsPerPage:h,setItemsPerPage:x,onCalendarDateSelect:y,generateCalendarDays:b,calendarDate:v,setCalendarDate:w,partialPaymentFilter:_,setPartialPaymentFilter:T})=>i.jsxs(ny,{background:"gray",padding:"md",children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"16px",alignItems:"end"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"6px"},children:"Search Transactions"}),i.jsx("input",{type:"text",placeholder:"Search by ID, customer, cashier...",value:e,onChange:M=>t(M.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"#ffffff"}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"6px"},children:"Payment Method"}),i.jsxs("select",{value:r,onChange:M=>a(M.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"#ffffff"},children:[i.jsx("option",{value:"all",children:"All Methods"}),i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"mobile_money",children:"Mobile Money"})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"6px"},children:"Payment Type"}),i.jsxs("select",{value:_,onChange:M=>T(M.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"#ffffff"},children:[i.jsx("option",{value:"all",children:"All Payments"}),i.jsx("option",{value:"full",children:"Full Payments"}),i.jsx("option",{value:"partial",children:"Partial Payments"})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"6px"},children:"Date Range"}),i.jsxs("select",{value:o,onChange:M=>c(M.target.value),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"#ffffff"},children:[i.jsx("option",{value:"all",children:"All Time"}),i.jsx("option",{value:"today",children:"Today"}),i.jsx("option",{value:"week",children:"Last 7 Days"}),i.jsx("option",{value:"month",children:"Last 30 Days"}),i.jsx("option",{value:"custom",children:"Custom Date"})]})]}),o==="custom"&&i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"6px"},children:"Select Date"}),i.jsx("button",{onClick:()=>p(!f),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"#ffffff",cursor:"pointer",textAlign:"left"},children:d?new Date(d).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}):"Select a date"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#374151",marginBottom:"6px"},children:"Items Per Page"}),i.jsxs("select",{value:h,onChange:M=>x(Number(M.target.value)),style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"14px",background:"#ffffff"},children:[i.jsx("option",{value:10,children:"10"}),i.jsx("option",{value:25,children:"25"}),i.jsx("option",{value:50,children:"50"}),i.jsx("option",{value:100,children:"100"})]})]})]}),f&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[i.jsx("button",{onClick:()=>w(new Date(v.getFullYear(),v.getMonth()-1,1)),style:{background:"none",border:"none",fontSize:"18px",cursor:"pointer",color:"#7d8d86"},children:i.jsx("i",{className:"fa-solid fa-chevron-left"})}),i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#1f2937",margin:0},children:v.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:()=>w(new Date(v.getFullYear(),v.getMonth()+1,1)),style:{background:"none",border:"none",fontSize:"18px",cursor:"pointer",color:"#7d8d86"},children:i.jsx("i",{className:"fa-solid fa-chevron-right"})})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px",marginBottom:"8px"},children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(M=>i.jsx("div",{style:{textAlign:"center",fontSize:"12px",fontWeight:"600",color:"#6b7280",padding:"8px 4px"},children:M},M))}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px"},children:b().map((M,F)=>{const A=M.getMonth()===v.getMonth(),U=M.toDateString()===new Date().toDateString(),V=d&&M.toDateString()===new Date(d).toDateString();return i.jsx("button",{onClick:()=>y(M),style:{background:V?"#7d8d86":"transparent",color:V?"#f1f0e4":A?"#3e3f29":"#bca88d",border:U?"2px solid #7d8d86":"1px solid transparent",borderRadius:"8px",padding:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",opacity:A?1:.5},children:M.getDate()},F)})}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"16px"},children:i.jsx("button",{onClick:()=>y(new Date),style:{background:"#7d8d86",color:"#ffffff",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",cursor:"pointer"},children:"Today"})})]})})]}),xl=({children:e,onClick:t,type:r="button",variant:a="primary",size:o="md",disabled:c=!1,className:d="",style:f={}})=>{const p={border:"none",borderRadius:"6px",cursor:c?"not-allowed":"pointer",transition:"all 0.2s ease",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"8px",fontWeight:"500",...f},h={primary:{background:"#7d8d86",color:"#ffffff"},secondary:{background:"#f3f4f6",color:"#374151",border:"1px solid #d1d5db"},danger:{background:"#3e3f29",color:"#f1f0e4"},success:{background:"#10b981",color:"#ffffff"}},x={primary:{background:"#6a7a73"},secondary:{background:"#e5e7eb"},danger:{background:"#2a2b1f"},success:{background:"#059669"}},y={sm:{padding:"6px 12px",fontSize:"12px"},md:{padding:"8px 16px",fontSize:"14px"},lg:{padding:"12px 24px",fontSize:"16px"}},b={...p,...h[a],...y[o],opacity:c?.6:1};return i.jsx("button",{type:r,onClick:t,disabled:c,className:d,style:b,onMouseEnter:v=>{c||Object.assign(v.currentTarget.style,x[a])},onMouseLeave:v=>{c||Object.assign(v.currentTarget.style,h[a])},children:e})},jE=({transaction:e,onTransactionClick:t,onDeleteTransaction:r,onResolvePartialPayment:a})=>{const o=f=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(f),c=f=>new Date(f).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),d=f=>{switch(f.toLowerCase()){case"cash":return"fa-solid fa-money-bill";case"card":return"fa-solid fa-credit-card";case"mobile_money":return"fa-solid fa-mobile";default:return"fa-solid fa-money-bill"}};return i.jsxs("div",{className:"transaction-card",onClick:()=>t(e.sale_id),style:{display:"flex",alignItems:"center",gap:"16px",padding:"16px",background:e.partial_payment?"#fef2f2":"#ffffff",borderRadius:"8px",border:e.partial_payment?"2px solid #dc2626":"2px solid #374151",cursor:"pointer",transition:"all 0.2s ease",position:"relative",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)",marginBottom:"12px"},onMouseEnter:f=>{const p=f.currentTarget;p.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.1)",p.style.transform="translateY(-2px)",p.style.border=e.partial_payment?"2px solid #dc2626":"2px solid #374151"},onMouseLeave:f=>{const p=f.currentTarget;p.style.boxShadow="0 2px 8px rgba(0, 0, 0, 0.15)",p.style.transform="translateY(0)",p.style.border=e.partial_payment?"2px solid #dc2626":"2px solid #374151"},children:[i.jsxs("div",{style:{width:"60px",textAlign:"center"},children:[i.jsxs("div",{style:{fontSize:"12px",fontWeight:"600",color:"#7d8d86",background:"#f3f4f6",padding:"4px 8px",borderRadius:"4px",display:"inline-block"},children:["#",e.sale_id.toString().slice(-6)]}),e.partial_payment&&i.jsx("div",{style:{fontSize:"10px",fontWeight:"600",color:"#ffffff",background:"#dc2626",padding:"2px 6px",borderRadius:"3px",marginTop:"4px",display:"inline-block"},children:"PARTIAL"})]}),i.jsx("div",{style:{minWidth:"140px",fontSize:"14px",color:"#6b7280"},children:c(e.datetime)}),i.jsx("div",{style:{flex:1,minWidth:"120px",fontSize:"14px",color:"#374151",fontWeight:"500"},children:e.customer_name}),i.jsx("div",{style:{minWidth:"100px",fontSize:"14px",color:"#6b7280"},children:e.cashier_name}),i.jsxs("div",{style:{minWidth:"120px",display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",color:"#374151"},children:[i.jsx("i",{className:d(e.payment_method),style:{color:"#7d8d86"}}),i.jsx("span",{style:{textTransform:"capitalize"},children:e.payment_method.replace("_"," ")})]}),i.jsx("div",{style:{minWidth:"120px",textAlign:"right",fontSize:"16px",fontWeight:"600",color:e.partial_payment?"#dc2626":"#059669"},children:e.partial_payment?i.jsxs("div",{children:[i.jsxs("div",{style:{fontSize:"14px",color:"#dc2626"},children:["Paid: ",o(e.partial_amount||0)]}),i.jsxs("div",{style:{fontSize:"12px",color:"#dc2626"},children:["Owed: ",o(e.remaining_amount||0)]})]}):o(e.total_amount)}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.partial_payment&&a&&i.jsxs(xl,{variant:"primary",size:"sm",onClick:f=>{f.stopPropagation(),a(e.sale_id)},children:[i.jsx("i",{className:"fa-solid fa-check",style:{fontSize:"10px"}}),"Resolve"]}),i.jsxs(xl,{variant:"danger",size:"sm",onClick:f=>{f.stopPropagation(),r(e.sale_id)},children:[i.jsx("i",{className:"fa-solid fa-trash",style:{fontSize:"10px"}}),"Delete"]}),i.jsx("div",{style:{color:"#7d8d86"},children:i.jsx("i",{className:"fa-solid fa-chevron-right"})})]})]})},CE=({currentPage:e,totalPages:t,onPageChange:r,startIndex:a,endIndex:o,totalItems:c})=>{if(t<=1)return null;const d=()=>{const f=[];if(t<=5)for(let h=1;h<=t;h++)f.push(h);else if(e<=3){for(let h=1;h<=4;h++)f.push(h);f.push("..."),f.push(t)}else if(e>=t-2){f.push(1),f.push("...");for(let h=t-3;h<=t;h++)f.push(h)}else{f.push(1),f.push("...");for(let h=e-1;h<=e+1;h++)f.push(h);f.push("..."),f.push(t)}return f};return i.jsxs("div",{style:{background:"#f9fafb",borderRadius:"12px",padding:"20px",marginBottom:"24px",border:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"16px"},children:[i.jsxs("div",{style:{fontSize:"14px",color:"#7d8d86",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-list"}),i.jsxs("span",{children:["Showing ",a+1,"-",Math.min(o,c)," of ",c," transactions"]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsxs(xl,{variant:"secondary",size:"sm",onClick:()=>r(e-1),disabled:e===1,children:[i.jsx("i",{className:"fa-solid fa-chevron-left"}),"Previous"]}),i.jsx("div",{style:{display:"flex",alignItems:"center",gap:"4px"},children:d().map((f,p)=>i.jsx(_1.Fragment,{children:f==="..."?i.jsx("span",{style:{padding:"8px 12px",color:"#6b7280",fontSize:"14px"},children:"..."}):i.jsx(xl,{variant:e===f?"primary":"secondary",size:"sm",onClick:()=>r(f),style:{minWidth:"40px"},children:f})},p))}),i.jsxs(xl,{variant:"secondary",size:"sm",onClick:()=>r(e+1),disabled:e===t,children:["Next",i.jsx("i",{className:"fa-solid fa-chevron-right"})]})]})]})},AE=({isOpen:e,onClose:t,selectedDate:r,onDateSelect:a,onTodaySelect:o,calendarDate:c,onCalendarDateChange:d})=>{const f=(p,h)=>{const x=new Date(p,h,1),y=new Date(x);y.setDate(y.getDate()-x.getDay());const b=[],v=new Date(y);for(let w=0;w<42;w++)b.push(new Date(v)),v.setDate(v.getDate()+1);return b};return e?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"24px",maxWidth:"400px",width:"90%",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[i.jsx("h2",{style:{fontSize:"20px",fontWeight:"600",color:"#1f2937",margin:0},children:c.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),i.jsxs("div",{style:{display:"flex",gap:"8px"},children:[i.jsx("button",{onClick:()=>d(new Date(c.getFullYear(),c.getMonth()-1,1)),style:{background:"none",border:"none",fontSize:"16px",color:"#7d8d86",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:p=>{const h=p.currentTarget;h.style.background="#f3f4f6",h.style.color="#3e3f29"},onMouseLeave:p=>{const h=p.currentTarget;h.style.background="none",h.style.color="#7d8d86"},children:i.jsx("i",{className:"fa-solid fa-chevron-left"})}),i.jsx("button",{onClick:()=>d(new Date(c.getFullYear(),c.getMonth()+1,1)),style:{background:"none",border:"none",fontSize:"16px",color:"#7d8d86",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:p=>{const h=p.currentTarget;h.style.background="#f3f4f6",h.style.color="#3e3f29"},onMouseLeave:p=>{const h=p.currentTarget;h.style.background="none",h.style.color="#7d8d86"},children:i.jsx("i",{className:"fa-solid fa-chevron-right"})}),i.jsx("button",{onClick:t,style:{background:"none",border:"none",fontSize:"20px",color:"#7d8d86",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.2s ease"},onMouseEnter:p=>{const h=p.currentTarget;h.style.background="#f3f4f6",h.style.color="#3e3f29"},onMouseLeave:p=>{const h=p.currentTarget;h.style.background="none",h.style.color="#7d8d86"},children:""})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px",marginBottom:"16px"},children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(p=>i.jsx("div",{style:{textAlign:"center",fontSize:"12px",fontWeight:"600",color:"#6b7280",padding:"8px 4px"},children:p},p)),f(c.getFullYear(),c.getMonth()).map((p,h)=>{const x=p.getMonth()===c.getMonth(),y=new Date,b=new Date(y.getFullYear(),y.getMonth(),y.getDate()),v=new Date(p.getFullYear(),p.getMonth(),p.getDate()),w=new Date(r.getFullYear(),r.getMonth(),r.getDate()),_=v.getTime()===b.getTime(),T=v.getTime()===w.getTime();return i.jsx("button",{onClick:()=>a(p),style:{background:T?"#7d8d86":"transparent",color:T?"#ffffff":x?"#1f2937":"#9ca3af",border:_?"2px solid #7d8d86":"1px solid transparent",borderRadius:"8px",padding:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",opacity:x?1:.5},onMouseEnter:M=>{if(!T){const F=M.currentTarget;F.style.background="#f3f4f6",F.style.color="#1f2937"}},onMouseLeave:M=>{if(!T){const F=M.currentTarget;F.style.background="transparent",F.style.color=x?"#1f2937":"#9ca3af"}},children:p.getDate()},h)})]}),i.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:"16px"},children:i.jsx("button",{onClick:o,style:{background:"#7d8d86",color:"#ffffff",border:"none",borderRadius:"6px",padding:"8px 16px",fontSize:"14px",cursor:"pointer",transition:"all 0.2s ease"},onMouseEnter:p=>{const h=p.currentTarget;h.style.background="#6a7a73"},onMouseLeave:p=>{const h=p.currentTarget;h.style.background="#7d8d86"},children:"Today"})})]})}):null},RE=()=>{const e=Ks(),{user:t}=xa(),{transactions:r,loading:a,error:o,deleteTransaction:c,resolvePartialPayment:d}=TE(),[f,p]=j.useState(""),[h,x]=j.useState("all"),[y,b]=j.useState("all"),[v,w]=j.useState(null),[_,T]=j.useState("all"),[M,F]=j.useState(!1),[A,U]=j.useState(new Date),[V,te]=j.useState(()=>{const De=new Date;return new Date(De.getFullYear(),De.getMonth(),De.getDate())}),[N,re]=j.useState(1),[L,X]=j.useState(25),[le]=j.useState("datetime"),[ge]=j.useState("desc"),Re=De=>De.filter(Be=>{const rt=!f||Be.sale_id.toString().includes(f)||Be.customer_name?.toLowerCase().includes(f.toLowerCase())||Be.cashier_name?.toLowerCase().includes(f.toLowerCase()),de=h==="all"||Be.payment_method===h,$e=()=>_==="all"?!0:_==="partial"?Be.partial_payment===!0:_==="full"?!Be.partial_payment:!0,z=()=>{if(v){const We=new Date(Be.datetime),ot=new Date(We.getFullYear(),We.getMonth(),We.getDate()),[Ne,tt,mt]=v.split("-").map(Number),ht=new Date(Ne,tt-1,mt);return ot.getTime()===ht.getTime()}if(y==="all")return!0;const be=new Date,Ke=new Date(Be.datetime),je=new Date(be.getFullYear(),be.getMonth(),be.getDate()),dt=new Date(Ke.getFullYear(),Ke.getMonth(),Ke.getDate());switch(y){case"today":return dt.getTime()===je.getTime();case"week":const We=new Date(be.getTime()-10080*60*1e3);return Ke>=We;case"month":const ot=new Date(be.getTime()-720*60*60*1e3);return Ke>=ot;default:return!0}};return rt&&de&&$e()&&z()}),fe=De=>[...De].sort((Be,rt)=>{let de=Be[le],$e=rt[le];return le==="datetime"&&(de=new Date(de).getTime(),$e=new Date($e).getTime()),ge==="asc"?de>$e?1:-1:de<$e?1:-1}),Ae=Re(r),ee=fe(Ae),ye=Math.ceil(ee.length/L),ae=(N-1)*L,Se=ae+L,k=ee.slice(ae,Se),J=()=>{const De=A.getFullYear(),Be=A.getMonth(),rt=new Date(De,Be,1),de=new Date(rt);de.setDate(de.getDate()-rt.getDay());const $e=[];for(let z=0;z<42;z++){const be=new Date(de);be.setDate(de.getDate()+z),$e.push(be)}return $e},O=De=>{const Be=new Date(De.getFullYear(),De.getMonth(),De.getDate());te(Be);const rt=Be.getFullYear(),de=String(Be.getMonth()+1).padStart(2,"0"),$e=String(Be.getDate()).padStart(2,"0"),z=`${rt}-${de}-${$e}`;w(z),b("custom"),F(!1)},K=()=>{const De=new Date,Be=new Date(De.getFullYear(),De.getMonth(),De.getDate());te(Be);const rt=Be.getFullYear(),de=String(Be.getMonth()+1).padStart(2,"0"),$e=String(Be.getDate()).padStart(2,"0"),z=`${rt}-${de}-${$e}`;w(z),b("custom"),F(!1)},Y=De=>{e(`/transaction/${De}`)},H=async De=>{window.confirm("Are you sure you want to delete this transaction? This action cannot be undone and will restore the stock for all items in this transaction.")&&await c(De)&&alert("Transaction deleted successfully!")},pe=async De=>{window.confirm("Are you sure you want to mark this partial payment as resolved? This will update the transaction to show it as fully paid.")&&await d(De)&&alert("Partial payment resolved successfully!")},Ge=De=>{re(De),window.scrollTo({top:0,behavior:"smooth"})},He=De=>{X(De),re(1)};return j.useEffect(()=>{re(1)},[f,h,y,v,le,ge]),a?i.jsx(i0,{children:i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:i.jsxs("div",{style:{fontSize:"20px",color:"#1a1a1a",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite",fontSize:"24px"}}),"Loading transactions..."]})})}):o?i.jsx(i0,{children:i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:i.jsxs("div",{style:{fontSize:"18px",color:"#ef4444",textAlign:"center"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{fontSize:"24px",marginBottom:"12px",display:"block"}}),o]})})}):i.jsxs(i0,{children:[i.jsx(EE,{title:"Transactions",subtitle:"View and manage all sales transactions",icon:"fa-solid fa-receipt",children:i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px",flexWrap:"wrap"},children:[i.jsxs("div",{onClick:()=>F(!0),style:{background:"#3e3f29",border:"1px solid #1a1a1a",borderRadius:"8px",padding:"12px 16px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px",color:"#f1f0e4",fontSize:"14px",fontWeight:"500"},children:[i.jsx("i",{className:"fa-solid fa-calendar",style:{fontSize:"16px",color:"#bca88d"}}),i.jsx("span",{style:{color:"#bca88d"},children:V.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"numeric"})})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",color:"#1a1a1a",fontSize:"14px",flexWrap:"wrap"},children:[i.jsx("i",{className:"fa-solid fa-receipt"}),i.jsxs("span",{children:["Showing ",ae+1,"-",Math.min(Se,ee.length)," of ",ee.length," transactions",v&&i.jsxs("span",{style:{color:"#3b82f6",fontWeight:"500"},children:[" ","on ",new Date(v).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]}),y!=="all"&&!v&&i.jsxs("span",{style:{color:"#3b82f6",fontWeight:"500"},children:[" ","(",y==="today"?"Today":y==="week"?"Last 7 days":y==="month"?"Last 30 days":y,")"]})]})]})]})}),i.jsxs("div",{style:{padding:"24px 32px",flex:1},children:[i.jsx(kE,{searchTerm:f,setSearchTerm:p,paymentFilter:h,setPaymentFilter:x,dateFilter:y,setDateFilter:b,selectedDate:v,showCalendar:M,setShowCalendar:F,itemsPerPage:L,setItemsPerPage:He,onCalendarDateSelect:O,generateCalendarDays:J,calendarDate:A,setCalendarDate:U,partialPaymentFilter:_,setPartialPaymentFilter:T}),i.jsx(ny,{children:k.length>0?i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:k.map(De=>i.jsx(jE,{transaction:De,onTransactionClick:Y,onDeleteTransaction:H,onResolvePartialPayment:pe},De.sale_id))}):i.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#6b7280"},children:[i.jsx("i",{className:"fa-solid fa-receipt",style:{fontSize:"48px",marginBottom:"16px",display:"block",color:"#d1d5db"}}),i.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#374151",margin:"0 0 8px 0"},children:"No transactions found"}),i.jsx("p",{style:{fontSize:"14px",margin:0},children:f||h!=="all"||_!=="all"||y!=="all"||V?"Try adjusting your filters to see more results.":"No transactions have been recorded yet."})]})}),i.jsx(CE,{currentPage:N,totalPages:ye,onPageChange:Ge,startIndex:ae,endIndex:Se,totalItems:ee.length}),i.jsx(AE,{isOpen:M,onClose:()=>F(!1),selectedDate:V,onDateSelect:O,onTodaySelect:K,calendarDate:A,onCalendarDateChange:U})]})]})},DE=()=>{const{transactionId:e}=C_(),t=Ks(),[r,a]=j.useState(null),[o,c]=j.useState([]),[d,f]=j.useState(!0),[p,h]=j.useState(!1),[x,y]=j.useState(!1),[b,v]=j.useState({payment_method:"",customer_id:null,notes:""}),[w,_]=j.useState([]),[T,M]=j.useState({});j.useEffect(()=>{e&&(F(),A())},[e]);const F=async()=>{try{f(!0);const fe=parseInt(e?.replace("TXN-","")||"0");if(!fe){console.error("Invalid transaction ID"),t("/sales");return}const{data:Ae,error:ee}=await Oe.from("sales").select(`
          *,
          customers (name),
          users (username)
        `).eq("sale_id",fe).single();if(ee){console.error("Error fetching transaction:",ee),t("/sales");return}const ye={...Ae,customer_name:Ae.customers?.name||null,cashier_name:Ae.users?.username||null};a(ye);const{data:ae,error:Se}=await Oe.from("sale_items").select(`
          *,
          products (
            name,
            category,
            weight_unit,
            price_per_unit,
            is_weighted,
            image_url
          )
        `).eq("sale_id",fe);if(Se)console.error("Error fetching transaction items:",Se);else{const k=(ae||[]).map(J=>(J.products?.is_weighted&&console.log("Weighted item data:",{name:J.products.name,weight:J.weight,weight_unit:J.products.weight_unit,price_per_unit:J.products.price_per_unit,calculated_price:J.calculated_price,price_each:J.price_each}),{sale_item_id:J.sale_item_id,product_id:J.product_id,quantity:J.quantity,unit_price:J.price_each,total_price:J.calculated_price||(J.products?.is_weighted&&J.weight&&J.products?.price_per_unit?J.weight*J.products.price_per_unit:J.quantity*J.price_each),product_name:J.products?.name||"Unknown Product",product_category:J.products?.category||"Unknown Category",product_image:J.products?.image_url||null,weight:J.weight||void 0,weight_unit:J.products?.weight_unit||void 0,price_per_unit:J.products?.price_per_unit||void 0,is_weighted:J.products?.is_weighted||!1}));c(k)}}catch(fe){console.error("Error fetching transaction details:",fe),t("/sales")}finally{f(!1)}},A=async()=>{try{const{data:fe,error:Ae}=await Oe.from("customers").select("id, name").order("name");Ae?console.error("Error fetching customers:",Ae):_(fe||[])}catch(fe){console.error("Error fetching customers:",fe)}},U=()=>{t("/")},V=()=>{t(`/sales?transaction=${e}`)},te=async()=>{if(r)try{y(!0);const fe=parseInt(e?.replace("TXN-","")||"0"),{error:Ae}=await Oe.from("sales").update({payment_method:b.payment_method,customer_id:b.customer_id,notes:b.notes}).eq("sale_id",fe);if(Ae){console.error("Error updating transaction:",Ae),alert("Failed to update transaction. Please try again.");return}await F(),h(!1),alert("Transaction updated successfully!")}catch(fe){console.error("Error saving transaction:",fe),alert("Failed to save changes. Please try again.")}finally{y(!1)}},N=()=>{h(!1),v({payment_method:"",customer_id:null,notes:""}),M({})},re=(fe,Ae)=>{Ae<0||M(ee=>({...ee,[fe]:Ae}))},L=async fe=>{if(confirm("Are you sure you want to remove this item from the transaction?"))try{const{error:Ae}=await Oe.from("sale_items").delete().eq("sale_item_id",fe);if(Ae){console.error("Error removing item:",Ae),alert("Failed to remove item. Please try again.");return}await F(),alert("Item removed successfully!")}catch(Ae){console.error("Error removing item:",Ae),alert("Failed to remove item. Please try again.")}},X=async(fe,Ae)=>{if(Ae<=0){L(fe);return}try{const ee=o.find(Se=>Se.sale_item_id===fe);if(!ee)return;const ye=Ae*ee.unit_price,{error:ae}=await Oe.from("sale_items").update({quantity:Ae,total_price:ye}).eq("sale_item_id",fe);if(ae){console.error("Error updating item quantity:",ae),alert("Failed to update item quantity. Please try again.");return}await F(),M(Se=>{const k={...Se};return delete k[fe],k}),alert("Item quantity updated successfully!")}catch(ee){console.error("Error updating item quantity:",ee),alert("Failed to update item quantity. Please try again.")}},le=async()=>{if(!(!r||!r.partial_payment||!window.confirm(`Complete payment for Transaction #${e}?

This will mark the remaining balance of ${r.remaining_amount?.toFixed(2)||"0.00"} as paid.

The transaction will be marked as fully paid.`)))try{const Ae=parseInt(e?.replace("TXN-","")||"0"),{error:ee}=await Oe.from("sales").update({partial_payment:!1,partial_amount:null,remaining_amount:null,partial_notes:null,notes:r.notes?`${r.notes}

Payment completed on ${new Date().toLocaleString()}`:`Payment completed on ${new Date().toLocaleString()}`}).eq("sale_id",Ae);if(ee){console.error("Error completing payment:",ee),alert("Failed to complete payment. Please try again.");return}alert("Payment completed successfully!"),await F()}catch(Ae){console.error("Error completing payment:",Ae),alert("Failed to complete payment. Please try again.")}},ge=async()=>{if(!(!r||!window.confirm(`Are you sure you want to delete Transaction #${e}?

This will:
 Remove all items from this transaction
 Restore stock quantities for all items
 Delete the transaction record

This action cannot be undone!`)))try{const Ae=parseInt(e?.replace("TXN-","")||"0");for(const ae of o){const{data:Se,error:k}=await Oe.from("products").select("stock_quantity").eq("product_id",ae.product_id).single();if(k){console.error("Error fetching product stock:",k);continue}const{error:J}=await Oe.from("products").update({stock_quantity:Se.stock_quantity+ae.quantity,last_updated:new Date().toISOString()}).eq("product_id",ae.product_id);J&&console.error("Error restoring stock:",J);const{error:O}=await Oe.from("inventory_movements").insert([{product_id:ae.product_id,quantity_change:ae.quantity,movement_type:"Transaction Deletion",reference_id:Ae,notes:`Stock restored from deleted transaction #${e}`}]);O&&console.error("Error creating inventory movement:",O)}const{error:ee}=await Oe.from("sale_items").delete().eq("sale_id",Ae);if(ee){console.error("Error deleting sale items:",ee),alert("Failed to delete transaction items. Please try again.");return}const{error:ye}=await Oe.from("sales").delete().eq("sale_id",Ae);if(ye){console.error("Error deleting sale:",ye),alert("Failed to delete transaction. Please try again.");return}alert("Transaction deleted successfully!"),t("/")}catch(Ae){console.error("Error deleting transaction:",Ae),alert("Failed to delete transaction. Please try again.")}},Re=fe=>new Date(fe).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return d?i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:i.jsxs("div",{style:{fontSize:"20px",color:"#7d8d86",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("i",{className:"fa-solid fa-spinner",style:{animation:"spin 1s linear infinite",fontSize:"24px"}}),"Loading transaction details..."]})}):r?i.jsxs("div",{style:{padding:"0"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[i.jsx("button",{onClick:U,style:{background:"none",border:"none",fontSize:"24px",color:"#7d8d86",cursor:"pointer",padding:"8px",borderRadius:"8px",transition:"all 0.2s ease"},onMouseEnter:fe=>{fe.target.style.background="#7d8d86",fe.target.style.color="#f1f0e4"},onMouseLeave:fe=>{fe.target.style.background="none",fe.target.style.color="#7d8d86"},children:i.jsx("i",{className:"fa-solid fa-arrow-left"})}),i.jsxs("div",{children:[i.jsxs("h1",{style:{fontSize:"32px",fontWeight:"bold",color:"#3e3f29",margin:"0 0 8px 0"},children:["Transaction #",e]}),i.jsx("p",{style:{fontSize:"16px",color:"#7d8d86",margin:0},children:Re(r.datetime)})]})]}),i.jsxs("div",{style:{display:"flex",gap:"12px"},children:[i.jsxs("button",{onClick:ge,style:{background:"#ef4444",color:"#f1f0e4",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:fe=>{fe.target.style.background="#dc2626"},onMouseLeave:fe=>{fe.target.style.background="#ef4444"},children:[i.jsx("i",{className:"fa-solid fa-trash",style:{fontSize:"14px"}}),"Delete Transaction"]}),p?i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:te,disabled:x,style:{background:x?"#9ca3af":"#10b981",color:"#f1f0e4",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:x?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:fe=>{x||(fe.target.style.background="#059669")},onMouseLeave:fe=>{x||(fe.target.style.background="#10b981")},children:[i.jsx("i",{className:`fa-solid ${x?"fa-spinner":"fa-save"}`,style:{fontSize:"14px",animation:x?"spin 1s linear infinite":"none"}}),x?"Saving...":"Save"]}),i.jsxs("button",{onClick:N,disabled:x,style:{background:"#ef4444",color:"#f1f0e4",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:x?"not-allowed":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:fe=>{x||(fe.target.style.background="#dc2626")},onMouseLeave:fe=>{x||(fe.target.style.background="#ef4444")},children:[i.jsx("i",{className:"fa-solid fa-times",style:{fontSize:"14px"}}),"Cancel"]})]}):i.jsxs("button",{onClick:V,style:{background:"#7d8d86",color:"#f1f0e4",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:fe=>{fe.target.style.background="#bca88d"},onMouseLeave:fe=>{fe.target.style.background="#7d8d86"},children:[i.jsx("i",{className:"fa-solid fa-edit",style:{fontSize:"14px"}}),"Edit"]})]})]}),i.jsxs("div",{style:{background:"#ffffff",borderRadius:"16px",padding:"24px",marginBottom:"24px",border:"1px solid rgba(125, 141, 134, 0.2)",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)"},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"24px"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#7d8d86",margin:"0 0 8px 0"},children:"Total Amount"}),i.jsxs("p",{style:{fontSize:"28px",fontWeight:"bold",color:"#3e3f29",margin:0},children:["",r.total_amount.toFixed(2)]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#7d8d86",margin:"0 0 8px 0"},children:"Payment Method"}),p?i.jsxs("select",{value:b.payment_method,onChange:fe=>v({...b,payment_method:fe.target.value}),style:{fontSize:"16px",fontWeight:"600",color:"#3e3f29",background:"#f9fafb",border:"2px solid #e5e7eb",borderRadius:"8px",padding:"8px 12px",width:"100%",cursor:"pointer"},children:[i.jsx("option",{value:"cash",children:"Cash"}),i.jsx("option",{value:"card",children:"Card"}),i.jsx("option",{value:"credit",children:"Credit"})]}):i.jsx("p",{style:{fontSize:"18px",fontWeight:"600",color:"#3e3f29",margin:0,textTransform:"capitalize"},children:r.payment_method})]}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#7d8d86",margin:"0 0 8px 0"},children:"Customer"}),p?i.jsxs("select",{value:b.customer_id||"",onChange:fe=>v({...b,customer_id:fe.target.value?parseInt(fe.target.value):null}),style:{fontSize:"16px",fontWeight:"600",color:"#3e3f29",background:"#f9fafb",border:"2px solid #e5e7eb",borderRadius:"8px",padding:"8px 12px",width:"100%",cursor:"pointer"},children:[i.jsx("option",{value:"",children:"Walk-in Customer"}),w.map(fe=>i.jsx("option",{value:fe.id,children:fe.name},fe.id))]}):i.jsx("p",{style:{fontSize:"18px",fontWeight:"600",color:"#3e3f29",margin:0},children:r.customer_name||"Walk-in Customer"})]}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#7d8d86",margin:"0 0 8px 0"},children:"Cashier"}),i.jsx("p",{style:{fontSize:"18px",fontWeight:"600",color:"#3e3f29",margin:0},children:r.cashier_name||"System"})]}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#7d8d86",margin:"0 0 8px 0"},children:"Items Count"}),i.jsxs("p",{style:{fontSize:"18px",fontWeight:"600",color:"#3e3f29",margin:0},children:[o.length," items"]})]}),r.discount_applied&&r.discount_applied>0&&i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#7d8d86",margin:"0 0 8px 0"},children:"Discount Applied"}),i.jsxs("p",{style:{fontSize:"18px",fontWeight:"600",color:"#ef4444",margin:0},children:["-",r.discount_applied.toFixed(2)]})]})]}),r.partial_payment&&i.jsxs("div",{style:{background:"#fef3c7",border:"1px solid #f59e0b",borderRadius:"12px",padding:"16px",marginTop:"24px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-credit-card",style:{color:"#f59e0b",fontSize:"16px"}}),i.jsx("h3",{style:{fontSize:"16px",fontWeight:"600",color:"#92400e",margin:0},children:"Partial Payment Transaction"})]}),i.jsxs("button",{onClick:le,style:{background:"#7d8d86",color:"#ffffff",border:"none",padding:"8px 16px",borderRadius:"8px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:fe=>{fe.target.style.background="#6b7280"},onMouseLeave:fe=>{fe.target.style.background="#7d8d86"},children:[i.jsx("i",{className:"fa-solid fa-check",style:{fontSize:"12px"}}),"Complete Payment"]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"16px"},children:[i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"12px",fontWeight:"500",color:"#92400e",margin:"0 0 4px 0"},children:"Amount Paid"}),i.jsxs("p",{style:{fontSize:"18px",fontWeight:"600",color:"#059669",margin:0},children:["",r.partial_amount?.toFixed(2)||"0.00"]})]}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"12px",fontWeight:"500",color:"#92400e",margin:"0 0 4px 0"},children:"Remaining Balance"}),i.jsxs("p",{style:{fontSize:"18px",fontWeight:"600",color:"#dc2626",margin:0},children:["",r.remaining_amount?.toFixed(2)||"0.00"]})]}),r.partial_notes&&i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx("p",{style:{fontSize:"12px",fontWeight:"500",color:"#92400e",margin:"0 0 4px 0"},children:"Notes"}),i.jsx("p",{style:{fontSize:"14px",color:"#92400e",margin:0,fontStyle:"italic"},children:r.partial_notes})]})]})]}),i.jsxs("div",{style:{marginTop:"24px"},children:[i.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#7d8d86",margin:"0 0 8px 0"},children:"Notes"}),p?i.jsx("textarea",{value:b.notes,onChange:fe=>v({...b,notes:fe.target.value}),placeholder:"Add transaction notes...",style:{width:"100%",minHeight:"80px",fontSize:"14px",color:"#3e3f29",background:"#f9fafb",border:"2px solid #e5e7eb",borderRadius:"8px",padding:"12px",resize:"vertical",fontFamily:"inherit"}}):i.jsx("p",{style:{fontSize:"16px",color:"#3e3f29",margin:0,fontStyle:r.notes?"normal":"italic",opacity:r.notes?1:.6},children:r.notes||"No notes added"})]})]}),i.jsxs("div",{style:{background:"#ffffff",borderRadius:"16px",padding:"24px",border:"1px solid rgba(125, 141, 134, 0.2)",boxShadow:"0 4px 12px rgba(62, 63, 41, 0.1)"},children:[i.jsxs("h2",{style:{fontSize:"24px",fontWeight:"600",color:"#3e3f29",margin:"0 0 24px 0",display:"flex",alignItems:"center",gap:"12px"},children:[i.jsx("i",{className:"fa-solid fa-shopping-cart",style:{fontSize:"20px"}}),"Transaction Items"]}),o.length>0?i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:o.map((fe,Ae)=>{const ee=T[fe.sale_item_id]!==void 0,ye=ee?T[fe.sale_item_id]:fe.quantity,ae=fe.is_weighted&&fe.weight?fe.total_price||fe.weight*(fe.price_per_unit||0):ye*fe.unit_price;return i.jsxs("div",{style:{background:"white",borderRadius:"12px",padding:"16px",border:"1px solid rgba(125, 141, 134, 0.1)",display:"flex",justifyContent:"space-between",alignItems:"center",transition:"all 0.2s ease"},onMouseEnter:Se=>{Se.target.style.boxShadow="0 4px 12px rgba(62, 63, 41, 0.1)",Se.target.style.transform="translateY(-2px)"},onMouseLeave:Se=>{Se.target.style.boxShadow="none",Se.target.style.transform="translateY(0)"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[i.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"12px",background:fe.product_image?`url(${fe.product_image})`:fe.is_weighted?"#f59e0b":"#7d8d86",backgroundSize:"cover",backgroundPosition:"center",display:"flex",alignItems:"center",justifyContent:"center",color:"#f1f0e4",fontSize:"18px",fontWeight:"bold",position:"relative",border:"2px solid rgba(125, 141, 134, 0.2)"},children:!fe.product_image&&i.jsxs(i.Fragment,{children:[fe.is_weighted&&fe.weight?`${fe.weight}${fe.weight_unit}`:fe.quantity,fe.is_weighted&&i.jsx("div",{style:{position:"absolute",top:"-8px",right:"-8px",width:"16px",height:"16px",borderRadius:"50%",background:"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",color:"#ffffff"},children:""})]})}),p&&!fe.is_weighted&&i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("button",{onClick:()=>re(fe.sale_item_id,ye-1),style:{width:"32px",height:"32px",borderRadius:"8px",background:"#ef4444",color:"#f1f0e4",border:"none",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"-"}),i.jsx("div",{style:{minWidth:"48px",height:"48px",borderRadius:"12px",background:ee?"#fef3c7":"#7d8d86",display:"flex",alignItems:"center",justifyContent:"center",color:ee?"#92400e":"#f1f0e4",fontSize:"18px",fontWeight:"bold",border:ee?"2px solid #f59e0b":"none"},children:ye}),i.jsx("button",{onClick:()=>re(fe.sale_item_id,ye+1),style:{width:"32px",height:"32px",borderRadius:"8px",background:"#10b981",color:"#f1f0e4",border:"none",fontSize:"16px",fontWeight:"bold",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:"+"}),ee&&i.jsx("button",{onClick:()=>X(fe.sale_item_id,ye),style:{padding:"6px 12px",borderRadius:"6px",background:"#3b82f6",color:"#f1f0e4",border:"none",fontSize:"12px",fontWeight:"500",cursor:"pointer"},children:"Save"}),i.jsx("button",{onClick:()=>L(fe.sale_item_id),style:{padding:"6px 12px",borderRadius:"6px",background:"#ef4444",color:"#f1f0e4",border:"none",fontSize:"12px",fontWeight:"500",cursor:"pointer",marginLeft:"8px"},children:"Remove"})]}),i.jsxs("div",{children:[i.jsx("p",{style:{fontSize:"16px",fontWeight:"600",color:"#3e3f29",margin:"0 0 4px 0"},children:fe.product_name}),i.jsxs("p",{style:{fontSize:"14px",color:"#7d8d86",margin:0},children:[fe.product_category,"  ",fe.is_weighted&&fe.weight&&fe.weight_unit&&fe.price_per_unit?`${fe.weight} ${fe.weight_unit}  ${fe.price_per_unit.toFixed(2)}/${fe.weight_unit}`:`${fe.unit_price.toFixed(2)} each`]}),fe.is_weighted&&p&&i.jsx("p",{style:{fontSize:"12px",color:"#f59e0b",margin:"4px 0 0 0",fontStyle:"italic"},children:"Weighted items cannot be edited after sale"})]})]}),i.jsxs("div",{style:{fontSize:"18px",fontWeight:"600",color:ee?"#f59e0b":"#3e3f29"},children:["",ae.toFixed(2)]})]},Ae)})}):i.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#7d8d86"},children:[i.jsx("i",{className:"fa-solid fa-box",style:{fontSize:"48px",marginBottom:"16px",opacity:.5}}),i.jsx("p",{style:{fontSize:"16px",margin:0},children:"No items found for this transaction"})]})]})]}):i.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px"},children:i.jsxs("div",{style:{textAlign:"center",color:"#7d8d86"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{fontSize:"48px",marginBottom:"16px",opacity:.5}}),i.jsx("p",{style:{fontSize:"16px",margin:0},children:"Transaction not found"})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var pd={};pd.version="0.18.5";var ay=1252,NE=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],sy=function(e){NE.indexOf(e)!=-1&&(ay=e)};function OE(){sy(1252)}var El=function(e){sy(e)};function ME(){El(1200),OE()}var td=function(t){return String.fromCharCode(t)},Bm=function(t){return String.fromCharCode(t)},gd,ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kl(e){for(var t="",r=0,a=0,o=0,c=0,d=0,f=0,p=0,h=0;h<e.length;)r=e.charCodeAt(h++),c=r>>2,a=e.charCodeAt(h++),d=(r&3)<<4|a>>4,o=e.charCodeAt(h++),f=(a&15)<<2|o>>6,p=o&63,isNaN(a)?f=p=64:isNaN(o)&&(p=64),t+=ys.charAt(c)+ys.charAt(d)+ys.charAt(f)+ys.charAt(p);return t}function $a(e){var t="",r=0,a=0,o=0,c=0,d=0,f=0,p=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)c=ys.indexOf(e.charAt(h++)),d=ys.indexOf(e.charAt(h++)),r=c<<2|d>>4,t+=String.fromCharCode(r),f=ys.indexOf(e.charAt(h++)),a=(d&15)<<4|f>>2,f!==64&&(t+=String.fromCharCode(a)),p=ys.indexOf(e.charAt(h++)),o=(f&3)<<6|p,p!==64&&(t+=String.fromCharCode(o));return t}var Ht=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),qa=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Ys(e){return Ht?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Im(e){return Ht?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ta=function(t){return Ht?qa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Nd(e){if(typeof ArrayBuffer>"u")return ta(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Il(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function BE(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Jr=Ht?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:qa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),o=0;for(t=0,r=0;t<e.length;r+=o,++t)if(o=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(c){return Array.isArray(c)?c:[].slice.call(c)}))};function IE(e){for(var t=[],r=0,a=e.length+250,o=Ys(e.length+255),c=0;c<e.length;++c){var d=e.charCodeAt(c);if(d<128)o[r++]=d;else if(d<2048)o[r++]=192|d>>6&31,o[r++]=128|d&63;else if(d>=55296&&d<57344){d=(d&1023)+64;var f=e.charCodeAt(++c)&1023;o[r++]=240|d>>8&7,o[r++]=128|d>>2&63,o[r++]=128|f>>6&15|(d&3)<<4,o[r++]=128|f&63}else o[r++]=224|d>>12&15,o[r++]=128|d>>6&63,o[r++]=128|d&63;r>a&&(t.push(o.slice(0,r)),r=0,o=Ys(65535),a=65530)}return t.push(o.slice(0,r)),Jr(t)}var ml=/\u0000/g,rd=/[\u0001-\u0006]/g;function Zi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ra(e,t){var r=""+e;return r.length>=t?r:_r("0",t-r.length)+r}function Q0(e,t){var r=""+e;return r.length>=t?r:_r(" ",t-r.length)+r}function xd(e,t){var r=""+e;return r.length>=t?r:r+_r(" ",t-r.length)}function FE(e,t){var r=""+Math.round(e);return r.length>=t?r:_r("0",t-r.length)+r}function LE(e,t){var r=""+e;return r.length>=t?r:_r("0",t-r.length)+r}var Fm=Math.pow(2,32);function Gi(e,t){if(e>Fm||e<-Fm)return FE(e,t);var r=Math.round(e);return LE(r,t)}function md(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Lm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],o0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function PE(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Sr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Pm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},zE={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function yd(e,t,r){for(var a=e<0?-1:1,o=e*a,c=0,d=1,f=0,p=1,h=0,x=0,y=Math.floor(o);h<t&&(y=Math.floor(o),f=y*d+c,x=y*h+p,!(o-y<5e-8));)o=1/(o-y),c=d,d=f,p=h,h=x;if(x>t&&(h>t?(x=p,f=c):(x=h,f=d)),!r)return[0,a*f,x];var b=Math.floor(a*f/x);return[b,a*f-b*x,x]}function nd(e,t,r){if(e>2958465||e<0)return null;var a=e|0,o=Math.floor(86400*(e-a)),c=0,d=[],f={D:a,T:o,u:86400*(e-a)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),t&&t.date1904&&(a+=1462),f.u>.9999&&(f.u=0,++o==86400&&(f.T=o=0,++a,++f.D)),a===60)d=r?[1317,10,29]:[1900,2,29],c=3;else if(a===0)d=r?[1317,8,29]:[1900,1,0],c=6;else{a>60&&--a;var p=new Date(1900,0,1);p.setDate(p.getDate()+a-1),d=[p.getFullYear(),p.getMonth()+1,p.getDate()],c=p.getDay(),a<60&&(c=(c+6)%7),r&&(c=YE(p,d))}return f.y=d[0],f.m=d[1],f.d=d[2],f.S=o%60,o=Math.floor(o/60),f.M=o%60,o=Math.floor(o/60),f.H=o,f.q=c,f}var iy=new Date(1899,11,31,0,0,0),UE=iy.getTime(),WE=new Date(1900,2,1,0,0,0);function oy(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=WE&&(r+=1440*60*1e3),(r-(UE+(e.getTimezoneOffset()-iy.getTimezoneOffset())*6e4))/(1440*60*1e3)}function J0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function $E(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function HE(e){var t=e<0?12:11,r=J0(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function qE(e){var t=J0(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function GE(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=HE(e):t===10?r=e.toFixed(10).substr(0,12):r=qE(e),J0($E(r.toUpperCase()))}function R0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):GE(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return bs(14,oy(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function YE(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function VE(e,t,r,a){var o="",c=0,d=0,f=r.y,p,h=0;switch(e){case 98:f=r.y+543;case 121:switch(t.length){case 1:case 2:p=f%100,h=2;break;default:p=f%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:p=r.m,h=t.length;break;case 3:return o0[r.m-1][1];case 5:return o0[r.m-1][0];default:return o0[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:p=r.d,h=t.length;break;case 3:return Lm[r.q][0];default:return Lm[r.q][1]}break;case 104:switch(t.length){case 1:case 2:p=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:p=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:p=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ra(r.S,t.length):(a>=2?d=a===3?1e3:100:d=a===1?10:1,c=Math.round(d*(r.S+r.u)),c>=60*d&&(c=0),t==="s"?c===0?"0":""+c/d:(o=ra(c,2+a),t==="ss"?o.substr(0,2):"."+o.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":p=r.D*24+r.H;break;case"[m]":case"[mm]":p=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":p=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:p=f,h=1;break}var x=h>0?ra(p,h):"";return x}function vs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var ly=/%/g;function XE(e,t,r){var a=t.replace(ly,""),o=t.length-a.length;return Pa(e,a,r*Math.pow(10,2*o))+_r("%",o)}function KE(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Pa(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function cy(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+cy(e,-t);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var c=Math.floor(Math.log(t)*Math.LOG10E)%o;if(c<0&&(c+=o),r=(t/Math.pow(10,c)).toPrecision(a+1+(o+c)%o),r.indexOf("e")===-1){var d=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(d-r.length+c):r+="E+"+(d-c);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,o)+"."+r.substr(2+o),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,p,h,x){return p+h+x.substr(0,(o+c)%o)+"."+x.substr(c)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var dy=/# (\?+)( ?)\/( ?)(\d+)/;function QE(e,t,r){var a=parseInt(e[4],10),o=Math.round(t*a),c=Math.floor(o/a),d=o-c*a,f=a;return r+(c===0?"":""+c)+" "+(d===0?_r(" ",e[1].length+1+e[4].length):Q0(d,e[1].length)+e[2]+"/"+e[3]+ra(f,e[4].length))}function JE(e,t,r){return r+(t===0?"":""+t)+_r(" ",e[1].length+2+e[4].length)}var uy=/^#*0*\.([0#]+)/,fy=/\).*[0#]/,hy=/\(###\) ###\\?-####/;function fn(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function zm(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Um(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function ZE(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ek(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Hn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(fy)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hn("n",a,r):"("+Hn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return KE(e,t,r);if(t.indexOf("%")!==-1)return XE(e,t,r);if(t.indexOf("E")!==-1)return cy(t,r);if(t.charCodeAt(0)===36)return"$"+Hn(e,t.substr(t.charAt(1)==" "?2:1),r);var o,c,d,f,p=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+Gi(p,t.length);if(t.match(/^[#?]+$/))return o=Gi(r,0),o==="0"&&(o=""),o.length>t.length?o:fn(t.substr(0,t.length-o.length))+o;if(c=t.match(dy))return QE(c,p,h);if(t.match(/^#+0+$/))return h+Gi(p,t.length-t.indexOf("0"));if(c=t.match(uy))return o=zm(r,c[1].length).replace(/^([^\.]+)$/,"$1."+fn(c[1])).replace(/\.$/,"."+fn(c[1])).replace(/\.(\d*)$/,function(w,_){return"."+_+_r("0",fn(c[1]).length-_.length)}),t.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),c=t.match(/^(0*)\.(#*)$/))return h+zm(p,c[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=t.match(/^#{1,3},##0(\.?)$/))return h+vs(Gi(p,0));if(c=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hn(e,t,-r):vs(""+(Math.floor(r)+ZE(r,c[1].length)))+"."+ra(Um(r,c[1].length),c[1].length);if(c=t.match(/^#,#*,#0/))return Hn(e,t.replace(/^#,#*,/,""),r);if(c=t.match(/^([0#]+)(\\?-([0#]+))+$/))return o=Zi(Hn(e,t.replace(/[\\-]/g,""),r)),d=0,Zi(Zi(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return d<o.length?o.charAt(d++):w==="0"?"0":""}));if(t.match(hy))return o=Hn(e,"##########",r),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var x="";if(c=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(c[4].length,7),f=yd(p,Math.pow(10,d)-1,!1),o=""+h,x=Pa("n",c[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),o+=x+c[2]+"/"+c[3],x=xd(f[2],d),x.length<c[4].length&&(x=fn(c[4].substr(c[4].length-x.length))+x),o+=x,o;if(c=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(c[1].length,c[4].length),7),f=yd(p,Math.pow(10,d)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?Q0(f[1],d)+c[2]+"/"+c[3]+xd(f[2],d):_r(" ",2*d+1+c[2].length+c[3].length));if(c=t.match(/^[#0?]+$/))return o=Gi(r,0),t.length<=o.length?o:fn(t.substr(0,t.length-o.length))+o;if(c=t.match(/^([#0?]+)\.([#0]+)$/)){o=""+r.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),d=o.indexOf(".");var y=t.indexOf(".")-d,b=t.length-o.length-y;return fn(t.substr(0,y)+o+t.substr(t.length-b))}if(c=t.match(/^00,000\.([#0]*0)$/))return d=Um(r,c[1].length),r<0?"-"+Hn(e,t,-r):vs(ek(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ra(0,3-w.length):"")+w})+"."+ra(d,c[1].length);switch(t){case"###,##0.00":return Hn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=vs(Gi(p,0));return v!=="0"?h+v:"";case"###,###.00":return Hn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Hn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function tk(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Pa(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function rk(e,t,r){var a=t.replace(ly,""),o=t.length-a.length;return Pa(e,a,r*Math.pow(10,2*o))+_r("%",o)}function py(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+py(e,-t);var o=e.indexOf(".");o===-1&&(o=e.indexOf("E"));var c=Math.floor(Math.log(t)*Math.LOG10E)%o;if(c<0&&(c+=o),r=(t/Math.pow(10,c)).toPrecision(a+1+(o+c)%o),!r.match(/[Ee]/)){var d=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(d-r.length+c):r+="E+"+(d-c),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,p,h,x){return p+h+x.substr(0,(o+c)%o)+"."+x.substr(c)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function fa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(fy)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?fa("n",a,r):"("+fa("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return tk(e,t,r);if(t.indexOf("%")!==-1)return rk(e,t,r);if(t.indexOf("E")!==-1)return py(t,r);if(t.charCodeAt(0)===36)return"$"+fa(e,t.substr(t.charAt(1)==" "?2:1),r);var o,c,d,f,p=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+ra(p,t.length);if(t.match(/^[#?]+$/))return o=""+r,r===0&&(o=""),o.length>t.length?o:fn(t.substr(0,t.length-o.length))+o;if(c=t.match(dy))return JE(c,p,h);if(t.match(/^#+0+$/))return h+ra(p,t.length-t.indexOf("0"));if(c=t.match(uy))return o=(""+r).replace(/^([^\.]+)$/,"$1."+fn(c[1])).replace(/\.$/,"."+fn(c[1])),o=o.replace(/\.(\d*)$/,function(w,_){return"."+_+_r("0",fn(c[1]).length-_.length)}),t.indexOf("0.")!==-1?o:o.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),c=t.match(/^(0*)\.(#*)$/))return h+(""+p).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=t.match(/^#{1,3},##0(\.?)$/))return h+vs(""+p);if(c=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+fa(e,t,-r):vs(""+r)+"."+_r("0",c[1].length);if(c=t.match(/^#,#*,#0/))return fa(e,t.replace(/^#,#*,/,""),r);if(c=t.match(/^([0#]+)(\\?-([0#]+))+$/))return o=Zi(fa(e,t.replace(/[\\-]/g,""),r)),d=0,Zi(Zi(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return d<o.length?o.charAt(d++):w==="0"?"0":""}));if(t.match(hy))return o=fa(e,"##########",r),"("+o.substr(0,3)+") "+o.substr(3,3)+"-"+o.substr(6);var x="";if(c=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(c[4].length,7),f=yd(p,Math.pow(10,d)-1,!1),o=""+h,x=Pa("n",c[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),o+=x+c[2]+"/"+c[3],x=xd(f[2],d),x.length<c[4].length&&(x=fn(c[4].substr(c[4].length-x.length))+x),o+=x,o;if(c=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return d=Math.min(Math.max(c[1].length,c[4].length),7),f=yd(p,Math.pow(10,d)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?Q0(f[1],d)+c[2]+"/"+c[3]+xd(f[2],d):_r(" ",2*d+1+c[2].length+c[3].length));if(c=t.match(/^[#0?]+$/))return o=""+r,t.length<=o.length?o:fn(t.substr(0,t.length-o.length))+o;if(c=t.match(/^([#0]+)\.([#0]+)$/)){o=""+r.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),d=o.indexOf(".");var y=t.indexOf(".")-d,b=t.length-o.length-y;return fn(t.substr(0,y)+o+t.substr(t.length-b))}if(c=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+fa(e,t,-r):vs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ra(0,3-w.length):"")+w})+"."+ra(0,c[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=vs(""+p);return v!=="0"?h+v:"";default:if(t.match(/\.[0#?]*$/))return fa(e,t.slice(0,t.lastIndexOf(".")),r)+fn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Pa(e,t,r){return(r|0)===r?fa(e,t,r):Hn(e,t,r)}function nk(e){for(var t=[],r=!1,a=0,o=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(o,a-o),o=a+1}if(t[t.length]=e.substr(o),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var gy=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xy(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":md(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(gy))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function ak(e,t,r,a){for(var o=[],c="",d=0,f="",p="t",h,x,y,b="H";d<e.length;)switch(f=e.charAt(d)){case"G":if(!md(e,d))throw new Error("unrecognized character "+f+" in "+e);o[o.length]={t:"G",v:"General"},d+=7;break;case'"':for(c="";(y=e.charCodeAt(++d))!==34&&d<e.length;)c+=String.fromCharCode(y);o[o.length]={t:"t",v:c},++d;break;case"\\":var v=e.charAt(++d),w=v==="("||v===")"?v:"t";o[o.length]={t:w,v},++d;break;case"_":o[o.length]={t:"t",v:" "},d+=2;break;case"@":o[o.length]={t:"T",v:t},++d;break;case"B":case"b":if(e.charAt(d+1)==="1"||e.charAt(d+1)==="2"){if(h==null&&(h=nd(t,r,e.charAt(d+1)==="2"),h==null))return"";o[o.length]={t:"X",v:e.substr(d,2)},p=f,d+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=nd(t,r),h==null))return"";for(c=f;++d<e.length&&e.charAt(d).toLowerCase()===f;)c+=f;f==="m"&&p.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=b),o[o.length]={t:f,v:c},p=f;break;case"A":case"a":case"":var _={t:f,v:f};if(h==null&&(h=nd(t,r)),e.substr(d,3).toUpperCase()==="A/P"?(h!=null&&(_.v=h.H>=12?"P":"A"),_.t="T",b="h",d+=3):e.substr(d,5).toUpperCase()==="AM/PM"?(h!=null&&(_.v=h.H>=12?"PM":"AM"),_.t="T",d+=5,b="h"):e.substr(d,5).toUpperCase()==="/"?(h!=null&&(_.v=h.H>=12?"":""),_.t="T",d+=5,b="h"):(_.t="t",++d),h==null&&_.t==="T")return"";o[o.length]=_,p=f;break;case"[":for(c=f;e.charAt(d++)!=="]"&&d<e.length;)c+=e.charAt(d);if(c.slice(-1)!=="]")throw'unterminated "[" block: |'+c+"|";if(c.match(gy)){if(h==null&&(h=nd(t,r),h==null))return"";o[o.length]={t:"Z",v:c.toLowerCase()},p=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",xy(e)||(o[o.length]={t:"t",v:c}));break;case".":if(h!=null){for(c=f;++d<e.length&&(f=e.charAt(d))==="0";)c+=f;o[o.length]={t:"s",v:c};break}case"0":case"#":for(c=f;++d<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(d))>-1;)c+=f;o[o.length]={t:"n",v:c};break;case"?":for(c=f;e.charAt(++d)===f;)c+=f;o[o.length]={t:f,v:c},p=f;break;case"*":++d,(e.charAt(d)==" "||e.charAt(d)=="*")&&++d;break;case"(":case")":o[o.length]={t:a===1?"t":f,v:f},++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=f;d<e.length&&"0123456789".indexOf(e.charAt(++d))>-1;)c+=e.charAt(d);o[o.length]={t:"D",v:c};break;case" ":o[o.length]={t:f,v:f},++d;break;case"$":o[o.length]={t:"t",v:"$"},++d;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);o[o.length]={t:"t",v:f},++d;break}var T=0,M=0,F;for(d=o.length-1,p="t";d>=0;--d)switch(o[d].t){case"h":case"H":o[d].t=b,p="h",T<1&&(T=1);break;case"s":(F=o[d].v.match(/\.0+$/))&&(M=Math.max(M,F[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":p=o[d].t;break;case"m":p==="s"&&(o[d].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&o[d].v.match(/[Hh]/)&&(T=1),T<2&&o[d].v.match(/[Mm]/)&&(T=2),T<3&&o[d].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var A="",U;for(d=0;d<o.length;++d)switch(o[d].t){case"t":case"T":case" ":case"D":break;case"X":o[d].v="",o[d].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[d].v=VE(o[d].t.charCodeAt(0),o[d].v,h,M),o[d].t="t";break;case"n":case"?":for(U=d+1;o[U]!=null&&((f=o[U].t)==="?"||f==="D"||(f===" "||f==="t")&&o[U+1]!=null&&(o[U+1].t==="?"||o[U+1].t==="t"&&o[U+1].v==="/")||o[d].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(o[U].v==="/"||o[U].v===" "&&o[U+1]!=null&&o[U+1].t=="?"));)o[d].v+=o[U].v,o[U]={v:"",t:";"},++U;A+=o[d].v,d=U-1;break;case"G":o[d].t="t",o[d].v=R0(t,r);break}var V="",te,N;if(A.length>0){A.charCodeAt(0)==40?(te=t<0&&A.charCodeAt(0)===45?-t:t,N=Pa("n",A,te)):(te=t<0&&a>1?-t:t,N=Pa("n",A,te),te<0&&o[0]&&o[0].t=="t"&&(N=N.substr(1),o[0].v="-"+o[0].v)),U=N.length-1;var re=o.length;for(d=0;d<o.length;++d)if(o[d]!=null&&o[d].t!="t"&&o[d].v.indexOf(".")>-1){re=d;break}var L=o.length;if(re===o.length&&N.indexOf("E")===-1){for(d=o.length-1;d>=0;--d)o[d]==null||"n?".indexOf(o[d].t)===-1||(U>=o[d].v.length-1?(U-=o[d].v.length,o[d].v=N.substr(U+1,o[d].v.length)):U<0?o[d].v="":(o[d].v=N.substr(0,U+1),U=-1),o[d].t="t",L=d);U>=0&&L<o.length&&(o[L].v=N.substr(0,U+1)+o[L].v)}else if(re!==o.length&&N.indexOf("E")===-1){for(U=N.indexOf(".")-1,d=re;d>=0;--d)if(!(o[d]==null||"n?".indexOf(o[d].t)===-1)){for(x=o[d].v.indexOf(".")>-1&&d===re?o[d].v.indexOf(".")-1:o[d].v.length-1,V=o[d].v.substr(x+1);x>=0;--x)U>=0&&(o[d].v.charAt(x)==="0"||o[d].v.charAt(x)==="#")&&(V=N.charAt(U--)+V);o[d].v=V,o[d].t="t",L=d}for(U>=0&&L<o.length&&(o[L].v=N.substr(0,U+1)+o[L].v),U=N.indexOf(".")+1,d=re;d<o.length;++d)if(!(o[d]==null||"n?(".indexOf(o[d].t)===-1&&d!==re)){for(x=o[d].v.indexOf(".")>-1&&d===re?o[d].v.indexOf(".")+1:0,V=o[d].v.substr(0,x);x<o[d].v.length;++x)U<N.length&&(V+=N.charAt(U++));o[d].v=V,o[d].t="t",L=d}}}for(d=0;d<o.length;++d)o[d]!=null&&"n?".indexOf(o[d].t)>-1&&(te=a>1&&t<0&&d>0&&o[d-1].v==="-"?-t:t,o[d].v=Pa(o[d].t,o[d].v,te),o[d].t="t");var X="";for(d=0;d!==o.length;++d)o[d]!=null&&(X+=o[d].v);return X}var Wm=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $m(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function sk(e,t){var r=nk(e),a=r.length,o=r[a-1].indexOf("@");if(a<4&&o>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||o>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=o>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=o>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=o>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var c=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,c];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var d=r[0].match(Wm),f=r[1].match(Wm);return $m(t,d)?[a,r[0]]:$m(t,f)?[a,r[1]]:[a,r[d!=null&&f!=null?2:1]]}return[a,c]}function bs(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Sr)[e],a==null&&(a=r.table&&r.table[Pm[e]]||Sr[Pm[e]]),a==null&&(a=zE[e]||"General");break}if(md(a,0))return R0(t,r);t instanceof Date&&(t=oy(t,r.date1904));var o=sk(a,t);if(md(o[1]))return R0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return ak(o[1],t,r,o[0])}function my(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Sr[r]==null){t<0&&(t=r);continue}if(Sr[r]==e){t=r;break}}t<0&&(t=391)}return Sr[t]=e,t}function Od(e){for(var t=0;t!=392;++t)e[t]!==void 0&&my(e[t],t)}function Md(){Sr=PE()}var yy=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ik(e){var t=typeof e=="number"?Sr[e]:e;return t=t.replace(yy,"(\\d+)"),new RegExp("^"+t+"$")}function ok(e,t,r){var a=-1,o=-1,c=-1,d=-1,f=-1,p=-1;(t.match(yy)||[]).forEach(function(y,b){var v=parseInt(r[b+1],10);switch(y.toLowerCase().charAt(0)){case"y":a=v;break;case"d":c=v;break;case"h":d=v;break;case"s":p=v;break;case"m":d>=0?f=v:o=v;break}}),p>=0&&f==-1&&o>=0&&(f=o,o=-1);var h=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(o>=1?o:1)).slice(-2)+"-"+("00"+(c>=1?c:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var x=("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(p>=0?p:0)).slice(-2);return d==-1&&f==-1&&p==-1?h:a==-1&&o==-1&&c==-1?x:h+"T"+x}var lk=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,re=new Array(256),L=0;L!=256;++L)N=L,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,re[L]=N;return typeof Int32Array<"u"?new Int32Array(re):re}var r=t();function a(N){var re=0,L=0,X=0,le=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)le[X]=N[X];for(X=0;X!=256;++X)for(L=N[X],re=256+X;re<4096;re+=256)L=le[re]=L>>>8^N[L&255];var ge=[];for(X=1;X!=16;++X)ge[X-1]=typeof Int32Array<"u"?le.subarray(X*256,X*256+256):le.slice(X*256,X*256+256);return ge}var o=a(r),c=o[0],d=o[1],f=o[2],p=o[3],h=o[4],x=o[5],y=o[6],b=o[7],v=o[8],w=o[9],_=o[10],T=o[11],M=o[12],F=o[13],A=o[14];function U(N,re){for(var L=re^-1,X=0,le=N.length;X<le;)L=L>>>8^r[(L^N.charCodeAt(X++))&255];return~L}function V(N,re){for(var L=re^-1,X=N.length-15,le=0;le<X;)L=A[N[le++]^L&255]^F[N[le++]^L>>8&255]^M[N[le++]^L>>16&255]^T[N[le++]^L>>>24]^_[N[le++]]^w[N[le++]]^v[N[le++]]^b[N[le++]]^y[N[le++]]^x[N[le++]]^h[N[le++]]^p[N[le++]]^f[N[le++]]^d[N[le++]]^c[N[le++]]^r[N[le++]];for(X+=15;le<X;)L=L>>>8^r[(L^N[le++])&255];return~L}function te(N,re){for(var L=re^-1,X=0,le=N.length,ge=0,Re=0;X<le;)ge=N.charCodeAt(X++),ge<128?L=L>>>8^r[(L^ge)&255]:ge<2048?(L=L>>>8^r[(L^(192|ge>>6&31))&255],L=L>>>8^r[(L^(128|ge&63))&255]):ge>=55296&&ge<57344?(ge=(ge&1023)+64,Re=N.charCodeAt(X++)&1023,L=L>>>8^r[(L^(240|ge>>8&7))&255],L=L>>>8^r[(L^(128|ge>>2&63))&255],L=L>>>8^r[(L^(128|Re>>6&15|(ge&3)<<4))&255],L=L>>>8^r[(L^(128|Re&63))&255]):(L=L>>>8^r[(L^(224|ge>>12&15))&255],L=L>>>8^r[(L^(128|ge>>6&63))&255],L=L>>>8^r[(L^(128|ge&63))&255]);return~L}return e.table=r,e.bstr=U,e.buf=V,e.str=te,e})(),sr=(function(){var t={};t.version="1.2.1";function r(C,q){for(var I=C.split("/"),P=q.split("/"),W=0,G=0,me=Math.min(I.length,P.length);W<me;++W){if(G=I[W].length-P[W].length)return G;if(I[W]!=P[W])return I[W]<P[W]?-1:1}return I.length-P.length}function a(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:a(C.slice(0,-1));var q=C.lastIndexOf("/");return q===-1?C:C.slice(0,q+1)}function o(C){if(C.charAt(C.length-1)=="/")return o(C.slice(0,-1));var q=C.lastIndexOf("/");return q===-1?C:C.slice(q+1)}function c(C,q){typeof q=="string"&&(q=new Date(q));var I=q.getHours();I=I<<6|q.getMinutes(),I=I<<5|q.getSeconds()>>>1,C.write_shift(2,I);var P=q.getFullYear()-1980;P=P<<4|q.getMonth()+1,P=P<<5|q.getDate(),C.write_shift(2,P)}function d(C){var q=C.read_shift(2)&65535,I=C.read_shift(2)&65535,P=new Date,W=I&31;I>>>=5;var G=I&15;I>>>=4,P.setMilliseconds(0),P.setFullYear(I+1980),P.setMonth(G-1),P.setDate(W);var me=q&31;q>>>=5;var Me=q&63;return q>>>=6,P.setHours(q),P.setMinutes(Me),P.setSeconds(me<<1),P}function f(C){Nn(C,0);for(var q={},I=0;C.l<=C.length-4;){var P=C.read_shift(2),W=C.read_shift(2),G=C.l+W,me={};switch(P){case 21589:I=C.read_shift(1),I&1&&(me.mtime=C.read_shift(4)),W>5&&(I&2&&(me.atime=C.read_shift(4)),I&4&&(me.ctime=C.read_shift(4))),me.mtime&&(me.mt=new Date(me.mtime*1e3));break}C.l=G,q[P]=me}return q}var p;function h(){return p||(p={})}function x(C,q){if(C[0]==80&&C[1]==75)return _e(C,q);if((C[0]|32)==109&&(C[1]|32)==105)return fr(C,q);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var I=3,P=512,W=0,G=0,me=0,Me=0,ce=0,we=[],Te=C.slice(0,512);Nn(Te,0);var Ye=y(Te);switch(I=Ye[0],I){case 3:P=512;break;case 4:P=4096;break;case 0:if(Ye[1]==0)return _e(C,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+I)}P!==512&&(Te=C.slice(0,P),Nn(Te,28));var Je=C.slice(0,P);b(Te,I);var ct=Te.read_shift(4,"i");if(I===3&&ct!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ct);Te.l+=4,me=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Me=Te.read_shift(4,"i"),W=Te.read_shift(4,"i"),ce=Te.read_shift(4,"i"),G=Te.read_shift(4,"i");for(var Qe=-1,at=0;at<109&&(Qe=Te.read_shift(4,"i"),!(Qe<0));++at)we[at]=Qe;var bt=v(C,P);T(ce,G,bt,P,we);var B=F(bt,me,we,P);B[me].name="!Directory",W>0&&Me!==Re&&(B[Me].name="!MiniFAT"),B[we[0]].name="!FAT",B.fat_addrs=we,B.ssz=P;var S={},Q=[],ne=[],Ce=[];A(me,B,bt,Q,W,S,ne,Me),w(ne,Ce,Q),Q.shift();var Ve={FileIndex:ne,FullPaths:Ce};return q&&q.raw&&(Ve.raw={header:Je,sectors:bt}),Ve}function y(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(fe,"Header Signature: "),C.l+=16;var q=C.read_shift(2,"u");return[C.read_shift(2,"u"),q]}function b(C,q){var I=9;switch(C.l+=2,I=C.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+I);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+I);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+I)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function v(C,q){for(var I=Math.ceil(C.length/q)-1,P=[],W=1;W<I;++W)P[W-1]=C.slice(W*q,(W+1)*q);return P[I-1]=C.slice(I*q),P}function w(C,q,I){for(var P=0,W=0,G=0,me=0,Me=0,ce=I.length,we=[],Te=[];P<ce;++P)we[P]=Te[P]=P,q[P]=I[P];for(;Me<Te.length;++Me)P=Te[Me],W=C[P].L,G=C[P].R,me=C[P].C,we[P]===P&&(W!==-1&&we[W]!==W&&(we[P]=we[W]),G!==-1&&we[G]!==G&&(we[P]=we[G])),me!==-1&&(we[me]=P),W!==-1&&P!=we[P]&&(we[W]=we[P],Te.lastIndexOf(W)<Me&&Te.push(W)),G!==-1&&P!=we[P]&&(we[G]=we[P],Te.lastIndexOf(G)<Me&&Te.push(G));for(P=1;P<ce;++P)we[P]===P&&(G!==-1&&we[G]!==G?we[P]=we[G]:W!==-1&&we[W]!==W&&(we[P]=we[W]));for(P=1;P<ce;++P)if(C[P].type!==0){if(Me=P,Me!=we[Me])do Me=we[Me],q[P]=q[Me]+"/"+q[P];while(Me!==0&&we[Me]!==-1&&Me!=we[Me]);we[P]=-1}for(q[0]+="/",P=1;P<ce;++P)C[P].type!==2&&(q[P]+="/")}function _(C,q,I){for(var P=C.start,W=C.size,G=[],me=P;I&&W>0&&me>=0;)G.push(q.slice(me*ge,me*ge+ge)),W-=ge,me=qs(I,me*4);return G.length===0?Ie(0):Jr(G).slice(0,C.size)}function T(C,q,I,P,W){var G=Re;if(C===Re){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var me=I[C],Me=(P>>>2)-1;if(!me)return;for(var ce=0;ce<Me&&(G=qs(me,ce*4))!==Re;++ce)W.push(G);T(qs(me,P-4),q-1,I,P,W)}}function M(C,q,I,P,W){var G=[],me=[];W||(W=[]);var Me=P-1,ce=0,we=0;for(ce=q;ce>=0;){W[ce]=!0,G[G.length]=ce,me.push(C[ce]);var Te=I[Math.floor(ce*4/P)];if(we=ce*4&Me,P<4+we)throw new Error("FAT boundary crossed: "+ce+" 4 "+P);if(!C[Te])break;ce=qs(C[Te],we)}return{nodes:G,data:Qm([me])}}function F(C,q,I,P){var W=C.length,G=[],me=[],Me=[],ce=[],we=P-1,Te=0,Ye=0,Je=0,ct=0;for(Te=0;Te<W;++Te)if(Me=[],Je=Te+q,Je>=W&&(Je-=W),!me[Je]){ce=[];var Qe=[];for(Ye=Je;Ye>=0;){Qe[Ye]=!0,me[Ye]=!0,Me[Me.length]=Ye,ce.push(C[Ye]);var at=I[Math.floor(Ye*4/P)];if(ct=Ye*4&we,P<4+ct)throw new Error("FAT boundary crossed: "+Ye+" 4 "+P);if(!C[at]||(Ye=qs(C[at],ct),Qe[Ye]))break}G[Je]={nodes:Me,data:Qm([ce])}}return G}function A(C,q,I,P,W,G,me,Me){for(var ce=0,we=P.length?2:0,Te=q[C].data,Ye=0,Je=0,ct;Ye<Te.length;Ye+=128){var Qe=Te.slice(Ye,Ye+128);Nn(Qe,64),Je=Qe.read_shift(2),ct=nh(Qe,0,Je-we),P.push(ct);var at={name:ct,type:Qe.read_shift(1),color:Qe.read_shift(1),L:Qe.read_shift(4,"i"),R:Qe.read_shift(4,"i"),C:Qe.read_shift(4,"i"),clsid:Qe.read_shift(16),state:Qe.read_shift(4,"i"),start:0,size:0},bt=Qe.read_shift(2)+Qe.read_shift(2)+Qe.read_shift(2)+Qe.read_shift(2);bt!==0&&(at.ct=U(Qe,Qe.l-8));var B=Qe.read_shift(2)+Qe.read_shift(2)+Qe.read_shift(2)+Qe.read_shift(2);B!==0&&(at.mt=U(Qe,Qe.l-8)),at.start=Qe.read_shift(4,"i"),at.size=Qe.read_shift(4,"i"),at.size<0&&at.start<0&&(at.size=at.type=0,at.start=Re,at.name=""),at.type===5?(ce=at.start,W>0&&ce!==Re&&(q[ce].name="!StreamData")):at.size>=4096?(at.storage="fat",q[at.start]===void 0&&(q[at.start]=M(I,at.start,q.fat_addrs,q.ssz)),q[at.start].name=at.name,at.content=q[at.start].data.slice(0,at.size)):(at.storage="minifat",at.size<0?at.size=0:ce!==Re&&at.start!==Re&&q[ce]&&(at.content=_(at,q[ce].data,(q[Me]||{}).data))),at.content&&Nn(at.content,0),G[ct]=at,me.push(at)}}function U(C,q){return new Date((Mn(C,q+4)/1e7*Math.pow(2,32)+Mn(C,q)/1e7-11644473600)*1e3)}function V(C,q){return h(),x(p.readFileSync(C),q)}function te(C,q){var I=q&&q.type;switch(I||Ht&&Buffer.isBuffer(C)&&(I="buffer"),I||"base64"){case"file":return V(C,q);case"base64":return x(ta($a(C)),q);case"binary":return x(ta(C),q)}return x(C,q)}function N(C,q){var I=q||{},P=I.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=P+"/",C.FileIndex[0]={name:P,type:5}),I.CLSID&&(C.FileIndex[0].clsid=I.CLSID),re(C)}function re(C){var q="Sh33tJ5";if(!sr.find(C,"/"+q)){var I=Ie(4);I[0]=55,I[1]=I[3]=50,I[2]=54,C.FileIndex.push({name:q,type:2,content:I,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+q),L(C)}}function L(C,q){N(C);for(var I=!1,P=!1,W=C.FullPaths.length-1;W>=0;--W){var G=C.FileIndex[W];switch(G.type){case 0:P?I=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(G.R*G.L*G.C)&&(I=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(I=!0);break;default:I=!0;break}}if(!(!I&&!q)){var me=new Date(1987,1,19),Me=0,ce=Object.create?Object.create(null):{},we=[];for(W=0;W<C.FullPaths.length;++W)ce[C.FullPaths[W]]=!0,C.FileIndex[W].type!==0&&we.push([C.FullPaths[W],C.FileIndex[W]]);for(W=0;W<we.length;++W){var Te=a(we[W][0]);P=ce[Te],P||(we.push([Te,{name:o(Te).replace("/",""),type:1,clsid:ee,ct:me,mt:me,content:null}]),ce[Te]=!0)}for(we.sort(function(ct,Qe){return r(ct[0],Qe[0])}),C.FullPaths=[],C.FileIndex=[],W=0;W<we.length;++W)C.FullPaths[W]=we[W][0],C.FileIndex[W]=we[W][1];for(W=0;W<we.length;++W){var Ye=C.FileIndex[W],Je=C.FullPaths[W];if(Ye.name=o(Je).replace("/",""),Ye.L=Ye.R=Ye.C=-(Ye.color=1),Ye.size=Ye.content?Ye.content.length:0,Ye.start=0,Ye.clsid=Ye.clsid||ee,W===0)Ye.C=we.length>1?1:-1,Ye.size=0,Ye.type=5;else if(Je.slice(-1)=="/"){for(Me=W+1;Me<we.length&&a(C.FullPaths[Me])!=Je;++Me);for(Ye.C=Me>=we.length?-1:Me,Me=W+1;Me<we.length&&a(C.FullPaths[Me])!=a(Je);++Me);Ye.R=Me>=we.length?-1:Me,Ye.type=1}else a(C.FullPaths[W+1]||"")==a(Je)&&(Ye.R=W+1),Ye.type=2}}}function X(C,q){var I=q||{};if(I.fileType=="mad")return hr(C,I);switch(L(C),I.fileType){case"zip":return pt(C,I)}var P=(function(ct){for(var Qe=0,at=0,bt=0;bt<ct.FileIndex.length;++bt){var B=ct.FileIndex[bt];if(B.content){var S=B.content.length;S>0&&(S<4096?Qe+=S+63>>6:at+=S+511>>9)}}for(var Q=ct.FullPaths.length+3>>2,ne=Qe+7>>3,Ce=Qe+127>>7,Ve=ne+at+Q+Ce,ze=Ve+127>>7,Xe=ze<=109?0:Math.ceil((ze-109)/127);Ve+ze+Xe+127>>7>ze;)Xe=++ze<=109?0:Math.ceil((ze-109)/127);var nt=[1,Xe,ze,Ce,Q,at,Qe,0];return ct.FileIndex[0].size=Qe<<6,nt[7]=(ct.FileIndex[0].start=nt[0]+nt[1]+nt[2]+nt[3]+nt[4]+nt[5])+(nt[6]+7>>3),nt})(C),W=Ie(P[7]<<9),G=0,me=0;{for(G=0;G<8;++G)W.write_shift(1,Ae[G]);for(G=0;G<8;++G)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),G=0;G<3;++G)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,P[2]),W.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:Re),W.write_shift(4,P[3]),W.write_shift(-4,P[1]?P[0]-1:Re),W.write_shift(4,P[1]),G=0;G<109;++G)W.write_shift(-4,G<P[2]?P[1]+G:-1)}if(P[1])for(me=0;me<P[1];++me){for(;G<236+me*127;++G)W.write_shift(-4,G<P[2]?P[1]+G:-1);W.write_shift(-4,me===P[1]-1?Re:me+1)}var Me=function(ct){for(me+=ct;G<me-1;++G)W.write_shift(-4,G+1);ct&&(++G,W.write_shift(-4,Re))};for(me=G=0,me+=P[1];G<me;++G)W.write_shift(-4,ye.DIFSECT);for(me+=P[2];G<me;++G)W.write_shift(-4,ye.FATSECT);Me(P[3]),Me(P[4]);for(var ce=0,we=0,Te=C.FileIndex[0];ce<C.FileIndex.length;++ce)Te=C.FileIndex[ce],Te.content&&(we=Te.content.length,!(we<4096)&&(Te.start=me,Me(we+511>>9)));for(Me(P[6]+7>>3);W.l&511;)W.write_shift(-4,ye.ENDOFCHAIN);for(me=G=0,ce=0;ce<C.FileIndex.length;++ce)Te=C.FileIndex[ce],Te.content&&(we=Te.content.length,!(!we||we>=4096)&&(Te.start=me,Me(we+63>>6)));for(;W.l&511;)W.write_shift(-4,ye.ENDOFCHAIN);for(G=0;G<P[4]<<2;++G){var Ye=C.FullPaths[G];if(!Ye||Ye.length===0){for(ce=0;ce<17;++ce)W.write_shift(4,0);for(ce=0;ce<3;++ce)W.write_shift(4,-1);for(ce=0;ce<12;++ce)W.write_shift(4,0);continue}Te=C.FileIndex[G],G===0&&(Te.start=Te.size?Te.start-1:Re);var Je=G===0&&I.root||Te.name;if(we=2*(Je.length+1),W.write_shift(64,Je,"utf16le"),W.write_shift(2,we),W.write_shift(1,Te.type),W.write_shift(1,Te.color),W.write_shift(-4,Te.L),W.write_shift(-4,Te.R),W.write_shift(-4,Te.C),Te.clsid)W.write_shift(16,Te.clsid,"hex");else for(ce=0;ce<4;++ce)W.write_shift(4,0);W.write_shift(4,Te.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,Te.start),W.write_shift(4,Te.size),W.write_shift(4,0)}for(G=1;G<C.FileIndex.length;++G)if(Te=C.FileIndex[G],Te.size>=4096)if(W.l=Te.start+1<<9,Ht&&Buffer.isBuffer(Te.content))Te.content.copy(W,W.l,0,Te.size),W.l+=Te.size+511&-512;else{for(ce=0;ce<Te.size;++ce)W.write_shift(1,Te.content[ce]);for(;ce&511;++ce)W.write_shift(1,0)}for(G=1;G<C.FileIndex.length;++G)if(Te=C.FileIndex[G],Te.size>0&&Te.size<4096)if(Ht&&Buffer.isBuffer(Te.content))Te.content.copy(W,W.l,0,Te.size),W.l+=Te.size+63&-64;else{for(ce=0;ce<Te.size;++ce)W.write_shift(1,Te.content[ce]);for(;ce&63;++ce)W.write_shift(1,0)}if(Ht)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function le(C,q){var I=C.FullPaths.map(function(ce){return ce.toUpperCase()}),P=I.map(function(ce){var we=ce.split("/");return we[we.length-(ce.slice(-1)=="/"?2:1)]}),W=!1;q.charCodeAt(0)===47?(W=!0,q=I[0].slice(0,-1)+q):W=q.indexOf("/")!==-1;var G=q.toUpperCase(),me=W===!0?I.indexOf(G):P.indexOf(G);if(me!==-1)return C.FileIndex[me];var Me=!G.match(rd);for(G=G.replace(ml,""),Me&&(G=G.replace(rd,"!")),me=0;me<I.length;++me)if((Me?I[me].replace(rd,"!"):I[me]).replace(ml,"")==G||(Me?P[me].replace(rd,"!"):P[me]).replace(ml,"")==G)return C.FileIndex[me];return null}var ge=64,Re=-2,fe="d0cf11e0a1b11ae1",Ae=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",ye={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Re,FREESECT:-1,HEADER_SIGNATURE:fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ae(C,q,I){h();var P=X(C,I);p.writeFileSync(q,P)}function Se(C){for(var q=new Array(C.length),I=0;I<C.length;++I)q[I]=String.fromCharCode(C[I]);return q.join("")}function k(C,q){var I=X(C,q);switch(q&&q.type||"buffer"){case"file":return h(),p.writeFileSync(q.filename,I),I;case"binary":return typeof I=="string"?I:Se(I);case"base64":return kl(typeof I=="string"?I:Se(I));case"buffer":if(Ht)return Buffer.isBuffer(I)?I:qa(I);case"array":return typeof I=="string"?ta(I):I}return I}var J;function O(C){try{var q=C.InflateRaw,I=new q;if(I._processChunk(new Uint8Array([3,0]),I._finishFlushFlag),I.bytesRead)J=C;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function K(C,q){if(!J)return wt(C,q);var I=J.InflateRaw,P=new I,W=P._processChunk(C.slice(C.l),P._finishFlushFlag);return C.l+=P.bytesRead,W}function Y(C){return J?J.deflateRawSync(C):lt(C)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],pe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function He(C){var q=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(q>>16|q>>8|q)&255}for(var De=typeof Uint8Array<"u",Be=De?new Uint8Array(256):[],rt=0;rt<256;++rt)Be[rt]=He(rt);function de(C,q){var I=Be[C&255];return q<=8?I>>>8-q:(I=I<<8|Be[C>>8&255],q<=16?I>>>16-q:(I=I<<8|Be[C>>16&255],I>>>24-q))}function $e(C,q){var I=q&7,P=q>>>3;return(C[P]|(I<=6?0:C[P+1]<<8))>>>I&3}function z(C,q){var I=q&7,P=q>>>3;return(C[P]|(I<=5?0:C[P+1]<<8))>>>I&7}function be(C,q){var I=q&7,P=q>>>3;return(C[P]|(I<=4?0:C[P+1]<<8))>>>I&15}function Ke(C,q){var I=q&7,P=q>>>3;return(C[P]|(I<=3?0:C[P+1]<<8))>>>I&31}function je(C,q){var I=q&7,P=q>>>3;return(C[P]|(I<=1?0:C[P+1]<<8))>>>I&127}function dt(C,q,I){var P=q&7,W=q>>>3,G=(1<<I)-1,me=C[W]>>>P;return I<8-P||(me|=C[W+1]<<8-P,I<16-P)||(me|=C[W+2]<<16-P,I<24-P)||(me|=C[W+3]<<24-P),me&G}function We(C,q,I){var P=q&7,W=q>>>3;return P<=5?C[W]|=(I&7)<<P:(C[W]|=I<<P&255,C[W+1]=(I&7)>>8-P),q+3}function ot(C,q,I){var P=q&7,W=q>>>3;return I=(I&1)<<P,C[W]|=I,q+1}function Ne(C,q,I){var P=q&7,W=q>>>3;return I<<=P,C[W]|=I&255,I>>>=8,C[W+1]=I,q+8}function tt(C,q,I){var P=q&7,W=q>>>3;return I<<=P,C[W]|=I&255,I>>>=8,C[W+1]=I&255,C[W+2]=I>>>8,q+16}function mt(C,q){var I=C.length,P=2*I>q?2*I:q+5,W=0;if(I>=q)return C;if(Ht){var G=Im(P);if(C.copy)C.copy(G);else for(;W<C.length;++W)G[W]=C[W];return G}else if(De){var me=new Uint8Array(P);if(me.set)me.set(C);else for(;W<I;++W)me[W]=C[W];return me}return C.length=P,C}function ht(C){for(var q=new Array(C),I=0;I<C;++I)q[I]=0;return q}function St(C,q,I){var P=1,W=0,G=0,me=0,Me=0,ce=C.length,we=De?new Uint16Array(32):ht(32);for(G=0;G<32;++G)we[G]=0;for(G=ce;G<I;++G)C[G]=0;ce=C.length;var Te=De?new Uint16Array(ce):ht(ce);for(G=0;G<ce;++G)we[W=C[G]]++,P<W&&(P=W),Te[G]=0;for(we[0]=0,G=1;G<=P;++G)we[G+16]=Me=Me+we[G-1]<<1;for(G=0;G<ce;++G)Me=C[G],Me!=0&&(Te[G]=we[Me+16]++);var Ye=0;for(G=0;G<ce;++G)if(Ye=C[G],Ye!=0)for(Me=de(Te[G],P)>>P-Ye,me=(1<<P+4-Ye)-1;me>=0;--me)q[Me|me<<Ye]=Ye&15|G<<4;return P}var It=De?new Uint16Array(512):ht(512),Tt=De?new Uint16Array(32):ht(32);if(!De){for(var oe=0;oe<512;++oe)It[oe]=0;for(oe=0;oe<32;++oe)Tt[oe]=0}(function(){for(var C=[],q=0;q<32;q++)C.push(5);St(C,Tt,32);var I=[];for(q=0;q<=143;q++)I.push(8);for(;q<=255;q++)I.push(9);for(;q<=279;q++)I.push(7);for(;q<=287;q++)I.push(8);St(I,It,288)})();var Le=(function(){for(var q=De?new Uint8Array(32768):[],I=0,P=0;I<Ge.length-1;++I)for(;P<Ge[I+1];++P)q[P]=I;for(;P<32768;++P)q[P]=29;var W=De?new Uint8Array(259):[];for(I=0,P=0;I<pe.length-1;++I)for(;P<pe[I+1];++P)W[P]=I;function G(Me,ce){for(var we=0;we<Me.length;){var Te=Math.min(65535,Me.length-we),Ye=we+Te==Me.length;for(ce.write_shift(1,+Ye),ce.write_shift(2,Te),ce.write_shift(2,~Te&65535);Te-- >0;)ce[ce.l++]=Me[we++]}return ce.l}function me(Me,ce){for(var we=0,Te=0,Ye=De?new Uint16Array(32768):[];Te<Me.length;){var Je=Math.min(65535,Me.length-Te);if(Je<10){for(we=We(ce,we,+(Te+Je==Me.length)),we&7&&(we+=8-(we&7)),ce.l=we/8|0,ce.write_shift(2,Je),ce.write_shift(2,~Je&65535);Je-- >0;)ce[ce.l++]=Me[Te++];we=ce.l*8;continue}we=We(ce,we,+(Te+Je==Me.length)+2);for(var ct=0;Je-- >0;){var Qe=Me[Te];ct=(ct<<5^Qe)&32767;var at=-1,bt=0;if((at=Ye[ct])&&(at|=Te&-32768,at>Te&&(at-=32768),at<Te))for(;Me[at+bt]==Me[Te+bt]&&bt<250;)++bt;if(bt>2){Qe=W[bt],Qe<=22?we=Ne(ce,we,Be[Qe+1]>>1)-1:(Ne(ce,we,3),we+=5,Ne(ce,we,Be[Qe-23]>>5),we+=3);var B=Qe<8?0:Qe-4>>2;B>0&&(tt(ce,we,bt-pe[Qe]),we+=B),Qe=q[Te-at],we=Ne(ce,we,Be[Qe]>>3),we-=3;var S=Qe<4?0:Qe-2>>1;S>0&&(tt(ce,we,Te-at-Ge[Qe]),we+=S);for(var Q=0;Q<bt;++Q)Ye[ct]=Te&32767,ct=(ct<<5^Me[Te])&32767,++Te;Je-=bt-1}else Qe<=143?Qe=Qe+48:we=ot(ce,we,1),we=Ne(ce,we,Be[Qe]),Ye[ct]=Te&32767,++Te}we=Ne(ce,we,0)-1}return ce.l=(we+7)/8|0,ce.l}return function(ce,we){return ce.length<8?G(ce,we):me(ce,we)}})();function lt(C){var q=Ie(50+Math.floor(C.length*1.1)),I=Le(C,q);return q.slice(0,I)}var Ct=De?new Uint16Array(32768):ht(32768),qt=De?new Uint16Array(32768):ht(32768),dr=De?new Uint16Array(128):ht(128),er=1,Pt=1;function ut(C,q){var I=Ke(C,q)+257;q+=5;var P=Ke(C,q)+1;q+=5;var W=be(C,q)+4;q+=4;for(var G=0,me=De?new Uint8Array(19):ht(19),Me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,we=De?new Uint8Array(8):ht(8),Te=De?new Uint8Array(8):ht(8),Ye=me.length,Je=0;Je<W;++Je)me[H[Je]]=G=z(C,q),ce<G&&(ce=G),we[G]++,q+=3;var ct=0;for(we[0]=0,Je=1;Je<=ce;++Je)Te[Je]=ct=ct+we[Je-1]<<1;for(Je=0;Je<Ye;++Je)(ct=me[Je])!=0&&(Me[Je]=Te[ct]++);var Qe=0;for(Je=0;Je<Ye;++Je)if(Qe=me[Je],Qe!=0){ct=Be[Me[Je]]>>8-Qe;for(var at=(1<<7-Qe)-1;at>=0;--at)dr[ct|at<<Qe]=Qe&7|Je<<3}var bt=[];for(ce=1;bt.length<I+P;)switch(ct=dr[je(C,q)],q+=ct&7,ct>>>=3){case 16:for(G=3+$e(C,q),q+=2,ct=bt[bt.length-1];G-- >0;)bt.push(ct);break;case 17:for(G=3+z(C,q),q+=3;G-- >0;)bt.push(0);break;case 18:for(G=11+je(C,q),q+=7;G-- >0;)bt.push(0);break;default:bt.push(ct),ce<ct&&(ce=ct);break}var B=bt.slice(0,I),S=bt.slice(I);for(Je=I;Je<286;++Je)B[Je]=0;for(Je=P;Je<30;++Je)S[Je]=0;return er=St(B,Ct,286),Pt=St(S,qt,30),q}function Yt(C,q){if(C[0]==3&&!(C[1]&3))return[Ys(q),2];for(var I=0,P=0,W=Im(q||1<<18),G=0,me=W.length>>>0,Me=0,ce=0;(P&1)==0;){if(P=z(C,I),I+=3,P>>>1)P>>1==1?(Me=9,ce=5):(I=ut(C,I),Me=er,ce=Pt);else{I&7&&(I+=8-(I&7));var we=C[I>>>3]|C[(I>>>3)+1]<<8;if(I+=32,we>0)for(!q&&me<G+we&&(W=mt(W,G+we),me=W.length);we-- >0;)W[G++]=C[I>>>3],I+=8;continue}for(;;){!q&&me<G+32767&&(W=mt(W,G+32767),me=W.length);var Te=dt(C,I,Me),Ye=P>>>1==1?It[Te]:Ct[Te];if(I+=Ye&15,Ye>>>=4,(Ye>>>8&255)===0)W[G++]=Ye;else{if(Ye==256)break;Ye-=257;var Je=Ye<8?0:Ye-4>>2;Je>5&&(Je=0);var ct=G+pe[Ye];Je>0&&(ct+=dt(C,I,Je),I+=Je),Te=dt(C,I,ce),Ye=P>>>1==1?Tt[Te]:qt[Te],I+=Ye&15,Ye>>>=4;var Qe=Ye<4?0:Ye-2>>1,at=Ge[Ye];for(Qe>0&&(at+=dt(C,I,Qe),I+=Qe),!q&&me<ct&&(W=mt(W,ct+100),me=W.length);G<ct;)W[G]=W[G-at],++G}}}return q?[W,I+7>>>3]:[W.slice(0,G),I+7>>>3]}function wt(C,q){var I=C.slice(C.l||0),P=Yt(I,q);return C.l+=P[1],P[0]}function se(C,q){if(C)typeof console<"u"&&console.error(q);else throw new Error(q)}function _e(C,q){var I=C;Nn(I,0);var P=[],W=[],G={FileIndex:P,FullPaths:W};N(G,{root:q.root});for(var me=I.length-4;(I[me]!=80||I[me+1]!=75||I[me+2]!=5||I[me+3]!=6)&&me>=0;)--me;I.l=me+4,I.l+=4;var Me=I.read_shift(2);I.l+=6;var ce=I.read_shift(4);for(I.l=ce,me=0;me<Me;++me){I.l+=20;var we=I.read_shift(4),Te=I.read_shift(4),Ye=I.read_shift(2),Je=I.read_shift(2),ct=I.read_shift(2);I.l+=8;var Qe=I.read_shift(4),at=f(I.slice(I.l+Ye,I.l+Ye+Je));I.l+=Ye+Je+ct;var bt=I.l;I.l=Qe+4,gt(I,we,Te,G,at),I.l=bt}return G}function gt(C,q,I,P,W){C.l+=2;var G=C.read_shift(2),me=C.read_shift(2),Me=d(C);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var ce=C.read_shift(4),we=C.read_shift(4),Te=C.read_shift(4),Ye=C.read_shift(2),Je=C.read_shift(2),ct="",Qe=0;Qe<Ye;++Qe)ct+=String.fromCharCode(C[C.l++]);if(Je){var at=f(C.slice(C.l,C.l+Je));(at[21589]||{}).mt&&(Me=at[21589].mt),((W||{})[21589]||{}).mt&&(Me=W[21589].mt)}C.l+=Je;var bt=C.slice(C.l,C.l+we);switch(me){case 8:bt=K(C,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+me)}var B=!1;G&8&&(ce=C.read_shift(4),ce==134695760&&(ce=C.read_shift(4),B=!0),we=C.read_shift(4),Te=C.read_shift(4)),we!=q&&se(B,"Bad compressed size: "+q+" != "+we),Te!=I&&se(B,"Bad uncompressed size: "+I+" != "+Te),yr(P,ct,bt,{unsafe:!0,mt:Me})}function pt(C,q){var I=q||{},P=[],W=[],G=Ie(1),me=I.compression?8:0,Me=0,ce=0,we=0,Te=0,Ye=0,Je=C.FullPaths[0],ct=Je,Qe=C.FileIndex[0],at=[],bt=0;for(ce=1;ce<C.FullPaths.length;++ce)if(ct=C.FullPaths[ce].slice(Je.length),Qe=C.FileIndex[ce],!(!Qe.size||!Qe.content||ct=="Sh33tJ5")){var B=Te,S=Ie(ct.length);for(we=0;we<ct.length;++we)S.write_shift(1,ct.charCodeAt(we)&127);S=S.slice(0,S.l),at[Ye]=lk.buf(Qe.content,0);var Q=Qe.content;me==8&&(Q=Y(Q)),G=Ie(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,Me),G.write_shift(2,me),Qe.mt?c(G,Qe.mt):G.write_shift(4,0),G.write_shift(-4,at[Ye]),G.write_shift(4,Q.length),G.write_shift(4,Qe.content.length),G.write_shift(2,S.length),G.write_shift(2,0),Te+=G.length,P.push(G),Te+=S.length,P.push(S),Te+=Q.length,P.push(Q),G=Ie(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,Me),G.write_shift(2,me),G.write_shift(4,0),G.write_shift(-4,at[Ye]),G.write_shift(4,Q.length),G.write_shift(4,Qe.content.length),G.write_shift(2,S.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,B),bt+=G.l,W.push(G),bt+=S.length,W.push(S),++Ye}return G=Ie(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,Ye),G.write_shift(2,Ye),G.write_shift(4,bt),G.write_shift(4,Te),G.write_shift(2,0),Jr([Jr(P),Jr(W),G])}var Lt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zt(C,q){if(C.ctype)return C.ctype;var I=C.name||"",P=I.match(/\.([^\.]+)$/);return P&&Lt[P[1]]||q&&(P=(I=q).match(/[\.\\]([^\.\\])+$/),P&&Lt[P[1]])?Lt[P[1]]:"application/octet-stream"}function Et(C){for(var q=kl(C),I=[],P=0;P<q.length;P+=76)I.push(q.slice(P,P+76));return I.join(`\r
`)+`\r
`}function Lr(C){var q=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(we){var Te=we.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var I=[],P=q.split(`\r
`),W=0;W<P.length;++W){var G=P[W];if(G.length==0){I.push("");continue}for(var me=0;me<G.length;){var Me=76,ce=G.slice(me,me+Me);ce.charAt(Me-1)=="="?Me--:ce.charAt(Me-2)=="="?Me-=2:ce.charAt(Me-3)=="="&&(Me-=3),ce=G.slice(me,me+Me),me+=Me,me<G.length&&(ce+="="),I.push(ce)}}return I.join(`\r
`)}function In(C){for(var q=[],I=0;I<C.length;++I){for(var P=C[I];I<=C.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+C[++I];q.push(P)}for(var W=0;W<q.length;++W)q[W]=q[W].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return ta(q.join(`\r
`))}function Dr(C,q,I){for(var P="",W="",G="",me,Me=0;Me<10;++Me){var ce=q[Me];if(!ce||ce.match(/^\s*$/))break;var we=ce.match(/^(.*?):\s*([^\s].*)$/);if(we)switch(we[1].toLowerCase()){case"content-location":P=we[2].trim();break;case"content-type":G=we[2].trim();break;case"content-transfer-encoding":W=we[2].trim();break}}switch(++Me,W.toLowerCase()){case"base64":me=ta($a(q.slice(Me).join("")));break;case"quoted-printable":me=In(q.slice(Me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var Te=yr(C,P.slice(I.length),me,{unsafe:!0});G&&(Te.ctype=G)}function fr(C,q){if(Se(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var I=q&&q.root||"",P=(Ht&&Buffer.isBuffer(C)?C.toString("binary"):Se(C)).split(`\r
`),W=0,G="";for(W=0;W<P.length;++W)if(G=P[W],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),I||(I=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,I.length)!=I))for(;I.length>0&&(I=I.slice(0,I.length-1),I=I.slice(0,I.lastIndexOf("/")+1),G.slice(0,I.length)!=I););var me=(P[1]||"").match(/boundary="(.*?)"/);if(!me)throw new Error("MAD cannot find boundary");var Me="--"+(me[1]||""),ce=[],we=[],Te={FileIndex:ce,FullPaths:we};N(Te);var Ye,Je=0;for(W=0;W<P.length;++W){var ct=P[W];ct!==Me&&ct!==Me+"--"||(Je++&&Dr(Te,P.slice(Ye,W),I),Ye=W)}return Te}function hr(C,q){var I=q||{},P=I.boundary||"SheetJS";P="------="+P;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],G=C.FullPaths[0],me=G,Me=C.FileIndex[0],ce=1;ce<C.FullPaths.length;++ce)if(me=C.FullPaths[ce].slice(G.length),Me=C.FileIndex[ce],!(!Me.size||!Me.content||me=="Sh33tJ5")){me=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(bt){return"_x"+bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(bt){return"_u"+bt.charCodeAt(0).toString(16)+"_"});for(var we=Me.content,Te=Ht&&Buffer.isBuffer(we)?we.toString("binary"):Se(we),Ye=0,Je=Math.min(1024,Te.length),ct=0,Qe=0;Qe<=Je;++Qe)(ct=Te.charCodeAt(Qe))>=32&&ct<128&&++Ye;var at=Ye>=Je*4/5;W.push(P),W.push("Content-Location: "+(I.root||"file:///C:/SheetJS/")+me),W.push("Content-Transfer-Encoding: "+(at?"quoted-printable":"base64")),W.push("Content-Type: "+zt(Me,me)),W.push(""),W.push(at?Lr(Te):Et(Te))}return W.push(P+`--\r
`),W.join(`\r
`)}function Gt(C){var q={};return N(q,C),q}function yr(C,q,I,P){var W=P&&P.unsafe;W||N(C);var G=!W&&sr.find(C,q);if(!G){var me=C.FullPaths[0];q.slice(0,me.length)==me?me=q:(me.slice(-1)!="/"&&(me+="/"),me=(me+q).replace("//","/")),G={name:o(q),type:2},C.FileIndex.push(G),C.FullPaths.push(me),W||sr.utils.cfb_gc(C)}return G.content=I,G.size=I?I.length:0,P&&(P.CLSID&&(G.clsid=P.CLSID),P.mt&&(G.mt=P.mt),P.ct&&(G.ct=P.ct)),G}function Gr(C,q){N(C);var I=sr.find(C,q);if(I){for(var P=0;P<C.FileIndex.length;++P)if(C.FileIndex[P]==I)return C.FileIndex.splice(P,1),C.FullPaths.splice(P,1),!0}return!1}function ma(C,q,I){N(C);var P=sr.find(C,q);if(P){for(var W=0;W<C.FileIndex.length;++W)if(C.FileIndex[W]==P)return C.FileIndex[W].name=o(I),C.FullPaths[W]=I,!0}return!1}function ya(C){L(C,!0)}return t.find=le,t.read=te,t.parse=x,t.write=k,t.writeFile=ae,t.utils={cfb_new:Gt,cfb_add:yr,cfb_del:Gr,cfb_mov:ma,cfb_gc:ya,ReadShift:vl,CheckField:Iy,prep_blob:Nn,bconcat:Jr,use_zlib:O,_deflateRaw:lt,_inflateRaw:wt,consts:ye},t})();function ck(e){return typeof e=="string"?Nd(e):Array.isArray(e)?BE(e):e}function Fl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Nd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Cl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var o=new Blob([ck(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(o,e);if(typeof saveAs<"u")return saveAs(o,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var c=URL.createObjectURL(o);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),chrome.downloads.download({url:c,filename:e,saveAs:!0});var d=document.createElement("a");if(d.download!=null)return d.download=e,d.href=c,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(c)},6e4),c}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(e);return f.open("w"),f.encoding="binary",Array.isArray(t)&&(t=Il(t)),f.write(t),f.close(),t}catch(p){if(!p.message||!p.message.match(/onstruct/))throw p}throw new Error("cannot save file "+e)}function tn(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Hm(e,t){for(var r=[],a=tn(e),o=0;o!==a.length;++o)r[e[a[o]][t]]==null&&(r[e[a[o]][t]]=a[o]);return r}function Z0(e){for(var t=[],r=tn(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Bd(e){for(var t=[],r=tn(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function dk(e){for(var t=[],r=tn(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var vd=new Date(1899,11,30,0,0,0);function Sn(e,t){var r=e.getTime(),a=vd.getTime()+(e.getTimezoneOffset()-vd.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var vy=new Date,uk=vd.getTime()+(vy.getTimezoneOffset()-vd.getTimezoneOffset())*6e4,qm=vy.getTimezoneOffset();function by(e){var t=new Date;return t.setTime(e*24*60*60*1e3+uk),t.getTimezoneOffset()!==qm&&t.setTime(t.getTime()+(t.getTimezoneOffset()-qm)*6e4),t}var Gm=new Date("2017-02-19T19:06:09.000Z"),_y=isNaN(Gm.getFullYear())?new Date("2/19/17"):Gm,fk=_y.getFullYear()==2017;function pn(e,t){var r=new Date(e);if(fk)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(_y.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var o=e.match(/\d+/g)||["2017","2","19","0","0","0"],c=new Date(+o[0],+o[1]-1,+o[2],+o[3]||0,+o[4]||0,+o[5]||0);return e.indexOf("Z")>-1&&(c=new Date(c.getTime()-c.getTimezoneOffset()*60*1e3)),c}function Id(e,t){if(Ht&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(c){return r[c]||c})}catch{}for(var a=[],o=0;o!=e.length;++o)a.push(String.fromCharCode(e[o]));return a.join("")}function wn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=wn(e[r]));return t}function _r(e,t){for(var r="";r.length<t;)r+=e;return r}function za(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(o,c){return r=-r,c}),!isNaN(t=Number(a)))?t/r:t}var hk=["january","february","march","april","may","june","july","august","september","october","november","december"];function jl(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),o=t.getMonth(),c=t.getDate();if(isNaN(c))return r;var d=e.toLowerCase();if(d.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(d=d.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),d.length>3&&hk.indexOf(d)==-1)return r}else if(d.match(/[a-z]/))return r;return a<0||a>8099?r:(o>0||c>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function At(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Ht?a=qa(r):a=IE(r),sr.utils.cfb_add(e,t,a)}sr.utils.cfb_add(e,t,r)}else e.file(t,r)}function eh(){return sr.utils.cfb_new()}var Rr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,pk={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},th=Z0(pk),rh=/[&<>'"]/g,gk=/[\u0000-\u0008\u000b-\u001f]/g;function Jt(e){var t=e+"";return t.replace(rh,function(r){return th[r]}).replace(gk,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ym(e){return Jt(e).replace(/ /g,"_x0020_")}var Sy=/[\u0000-\u001f]/g;function xk(e){var t=e+"";return t.replace(rh,function(r){return th[r]}).replace(/\n/g,"<br/>").replace(Sy,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function mk(e){var t=e+"";return t.replace(rh,function(r){return th[r]}).replace(Sy,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function yk(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vk(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function l0(e){for(var t="",r=0,a=0,o=0,c=0,d=0,f=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(o=e.charCodeAt(r++),a>191&&a<224){d=(a&31)<<6,d|=o&63,t+=String.fromCharCode(d);continue}if(c=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(o&63)<<6|c&63);continue}d=e.charCodeAt(r++),f=((a&7)<<18|(o&63)<<12|(c&63)<<6|d&63)-65536,t+=String.fromCharCode(55296+(f>>>10&1023)),t+=String.fromCharCode(56320+(f&1023))}return t}function Vm(e){var t=Ys(2*e.length),r,a,o=1,c=0,d=0,f;for(a=0;a<e.length;a+=o)o=1,(f=e.charCodeAt(a))<128?r=f:f<224?(r=(f&31)*64+(e.charCodeAt(a+1)&63),o=2):f<240?(r=(f&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),o=3):(o=4,r=(f&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,d=55296+(r>>>10&1023),r=56320+(r&1023)),d!==0&&(t[c++]=d&255,t[c++]=d>>>8,d=0),t[c++]=r%256,t[c++]=r>>>8;return t.slice(0,c).toString("ucs2")}function Xm(e){return qa(e,"binary").toString("utf8")}var ad="foo bar baz",yl=Ht&&(Xm(ad)==l0(ad)&&Xm||Vm(ad)==l0(ad)&&Vm)||l0,Cl=Ht?function(e){return qa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,o=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,o=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(o>>18&7))),t.push(String.fromCharCode(144+(o>>12&63))),t.push(String.fromCharCode(128+(o>>6&63))),t.push(String.fromCharCode(128+(o&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},bk=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),o=0;o<e.length;++o)a=a.replace(e[o][0],e[o][1]);return a}})(),wy=/(^\s|\s$|\n)/;function Zr(e,t){return"<"+e+(t.match(wy)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Al(e){return tn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ze(e,t,r){return"<"+e+(r!=null?Al(r):"")+(t!=null?(t.match(wy)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function D0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function _k(e,t){switch(typeof e){case"string":var r=Ze("vt:lpwstr",Jt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ze((e|0)==e?"vt:i4":"vt:r8",Jt(String(e)));case"boolean":return Ze("vt:bool",e?"true":"false")}if(e instanceof Date)return Ze("vt:filetime",D0(e));throw new Error("Unable to serialize "+e)}var $r={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},co=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],On={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Sk(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),o=e[t+6]&15,c=5;c>=0;--c)o=o*256+e[t+c];return a==2047?o==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,o+=Math.pow(2,52)),r*Math.pow(2,a-52)*o)}function wk(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,o=0,c=0,d=a?-t:t;isFinite(d)?d==0?o=c=0:(o=Math.floor(Math.log(d)/Math.LN2),c=d*Math.pow(2,52-o),o<=-1023&&(!isFinite(c)||c<Math.pow(2,52))?o=-1022:(c-=Math.pow(2,52),o+=1023)):(o=2047,c=isNaN(t)?26985:0);for(var f=0;f<=5;++f,c/=256)e[r+f]=c&255;e[r+6]=(o&15)<<4|c&15,e[r+7]=o>>4|a}var Km=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var o=0,c=e[0][a].length;o<c;o+=r)t.push.apply(t,e[0][a].slice(o,o+r));return t},Qm=Ht?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:qa(t)})):Km(e)}:Km,Jm=function(e,t,r){for(var a=[],o=t;o<r;o+=2)a.push(String.fromCharCode(fl(e,o)));return a.join("").replace(ml,"")},nh=Ht?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ml,""):Jm(e,t,r)}:Jm,Zm=function(e,t,r){for(var a=[],o=t;o<t+r;++o)a.push(("0"+e[o].toString(16)).slice(-2));return a.join("")},Ty=Ht?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Zm(e,t,r)}:Zm,e1=function(e,t,r){for(var a=[],o=t;o<r;o++)a.push(String.fromCharCode(Qi(e,o)));return a.join("")},Ll=Ht?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):e1(t,r,a)}:e1,Ey=function(e,t){var r=Mn(e,t);return r>0?Ll(e,t+4,t+4+r-1):""},ky=Ey,jy=function(e,t){var r=Mn(e,t);return r>0?Ll(e,t+4,t+4+r-1):""},Cy=jy,Ay=function(e,t){var r=2*Mn(e,t);return r>0?Ll(e,t+4,t+4+r-1):""},Ry=Ay,Dy=function(t,r){var a=Mn(t,r);return a>0?nh(t,r+4,r+4+a):""},Ny=Dy,Oy=function(e,t){var r=Mn(e,t);return r>0?Ll(e,t+4,t+4+r):""},My=Oy,By=function(e,t){return Sk(e,t)},bd=By,ah=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ht&&(ky=function(t,r){if(!Buffer.isBuffer(t))return Ey(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Cy=function(t,r){if(!Buffer.isBuffer(t))return jy(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Ry=function(t,r){if(!Buffer.isBuffer(t))return Ay(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Ny=function(t,r){if(!Buffer.isBuffer(t))return Dy(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},My=function(t,r){if(!Buffer.isBuffer(t))return Oy(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},bd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):By(t,r)},ah=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Qi=function(e,t){return e[t]},fl=function(e,t){return e[t+1]*256+e[t]},Tk=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Mn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},qs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Ek=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function vl(e,t){var r="",a,o,c=[],d,f,p,h;switch(t){case"dbcs":if(h=this.l,Ht&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(p=0;p<e;++p)r+=String.fromCharCode(fl(this,h)),h+=2;e*=2;break;case"utf8":r=Ll(this,this.l,this.l+e);break;case"utf16le":e*=2,r=nh(this,this.l,this.l+e);break;case"wstr":return vl.call(this,e,"dbcs");case"lpstr-ansi":r=ky(this,this.l),e=4+Mn(this,this.l);break;case"lpstr-cp":r=Cy(this,this.l),e=4+Mn(this,this.l);break;case"lpwstr":r=Ry(this,this.l),e=4+2*Mn(this,this.l);break;case"lpp4":e=4+Mn(this,this.l),r=Ny(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Mn(this,this.l),r=My(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(d=Qi(this,this.l+e++))!==0;)c.push(td(d));r=c.join("");break;case"_wstr":for(e=0,r="";(d=fl(this,this.l+e))!==0;)c.push(td(d)),e+=2;e+=2,r=c.join("");break;case"dbcs-cont":for(r="",h=this.l,p=0;p<e;++p){if(this.lens&&this.lens.indexOf(h)!==-1)return d=Qi(this,h),this.l=h+1,f=vl.call(this,e-p,d?"dbcs-cont":"sbcs-cont"),c.join("")+f;c.push(td(fl(this,h))),h+=2}r=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,p=0;p!=e;++p){if(this.lens&&this.lens.indexOf(h)!==-1)return d=Qi(this,h),this.l=h+1,f=vl.call(this,e-p,d?"dbcs-cont":"sbcs-cont"),c.join("")+f;c.push(td(Qi(this,h))),h+=1}r=c.join("");break;default:switch(e){case 1:return a=Qi(this,this.l),this.l++,a;case 2:return a=(t==="i"?Tk:fl)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?qs:Ek)(this,this.l),this.l+=4,a):(o=Mn(this,this.l),this.l+=4,o);case 8:case-8:if(t==="f")return e==8?o=bd(this,this.l):o=bd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,o;e=8;case 16:r=Ty(this,this.l,e);break}}return this.l+=e,r}var kk=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},jk=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Ck=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Ak(e,t,r){var a=0,o=0;if(r==="dbcs"){for(o=0;o!=t.length;++o)Ck(this,t.charCodeAt(o),this.l+2*o);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),o=0;o!=t.length;++o)this[this.l+o]=t.charCodeAt(o)&255;a=t.length}else if(r==="hex"){for(;o<e;++o)this[this.l++]=parseInt(t.slice(2*o,2*o+2),16)||0;return this}else if(r==="utf16le"){var c=Math.min(this.l+e,this.length);for(o=0;o<Math.min(t.length,e);++o){var d=t.charCodeAt(o);this[this.l++]=d&255,this[this.l++]=d>>8}for(;this.l<c;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,kk(this,t,this.l);break;case 8:if(a=8,r==="f"){wk(this,t,this.l);break}case 16:break;case-4:a=4,jk(this,t,this.l);break}return this.l+=a,this}function Iy(e,t){var r=Ty(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Nn(e,t){e.l=t,e.read_shift=vl,e.chk=Iy,e.write_shift=Ak}function ga(e,t){e.l+=t}function Ie(e){var t=Ys(e);return Nn(t,0),t}function _n(){var e=[],t=Ht?256:2048,r=function(h){var x=Ie(h);return Nn(x,0),x},a=r(t),o=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},c=function(h){return a&&h<a.length-a.l?a:(o(),a=r(Math.max(h+1,t)))},d=function(){return o(),Jr(e)},f=function(h){o(),a=h,a.l==null&&(a.l=a.length),c(t)};return{next:c,push:f,end:d,_bufs:e}}function qe(e,t,r,a){var o=+t,c;if(!isNaN(o)){a||(a=S5[o].p||(r||[]).length||0),c=1+(o>=128?1:0)+1,a>=128&&++c,a>=16384&&++c,a>=2097152&&++c;var d=e.next(c);o<=127?d.write_shift(1,o):(d.write_shift(1,(o&127)+128),d.write_shift(1,o>>7));for(var f=0;f!=4;++f)if(a>=128)d.write_shift(1,(a&127)+128),a>>=7;else{d.write_shift(1,a);break}a>0&&ah(r)&&e.push(r)}}function bl(e,t,r){var a=wn(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function t1(e,t,r){var a=wn(e);return a.s=bl(a.s,t.s,r),a.e=bl(a.e,t.s,r),a}function _l(e,t){if(e.cRel&&e.c<0)for(e=wn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=wn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Zt(e);return!e.cRel&&e.cRel!=null&&(r=Nk(r)),!e.rRel&&e.rRel!=null&&(r=Rk(r)),r}function c0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sn(e.s.c)+":"+(e.e.cRel?"":"$")+sn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+en(e.s.r)+":"+(e.e.rRel?"":"$")+en(e.e.r):_l(e.s,t.biff)+":"+_l(e.e,t.biff)}function sh(e){return parseInt(Dk(e),10)-1}function en(e){return""+(e+1)}function Rk(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Dk(e){return e.replace(/\$(\d+)$/,"$1")}function ih(e){for(var t=Ok(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function sn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Nk(e){return e.replace(/^([A-Z])/,"$$$1")}function Ok(e){return e.replace(/^\$([A-Z])/,"$1")}function Mk(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Hr(e){for(var t=0,r=0,a=0;a<e.length;++a){var o=e.charCodeAt(a);o>=48&&o<=57?t=10*t+(o-48):o>=65&&o<=90&&(r=26*r+(o-64))}return{c:r-1,r:t-1}}function Zt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Bn(e){var t=e.indexOf(":");return t==-1?{s:Hr(e),e:Hr(e)}:{s:Hr(e.slice(0,t)),e:Hr(e.slice(t+1))}}function Ar(e,t){return typeof t>"u"||typeof t=="number"?Ar(e.s,e.e):(typeof e!="string"&&(e=Zt(e)),typeof t!="string"&&(t=Zt(t)),e==t?e:e+":"+t)}function ur(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,o=0,c=e.length;for(r=0;a<c&&!((o=e.charCodeAt(a)-64)<1||o>26);++a)r=26*r+o;for(t.s.c=--r,r=0;a<c&&!((o=e.charCodeAt(a)-48)<0||o>9);++a)r=10*r+o;if(t.s.r=--r,a===c||o!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=c&&!((o=e.charCodeAt(a)-64)<1||o>26);++a)r=26*r+o;for(t.e.c=--r,r=0;a!=c&&!((o=e.charCodeAt(a)-48)<0||o>9);++a)r=10*r+o;return t.e.r=--r,t}function r1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=bs(e.z,r?Sn(t):t)}catch{}try{return e.w=bs((e.XF||{}).numFmtId||(r?14:0),r?Sn(t):t)}catch{return""+t}}function Ha(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Pl[e.v]||e.v:t==null?r1(e,e.v):r1(e,t))}function Js(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Fy(e,t,r){var a=r||{},o=e?Array.isArray(e):a.dense,c=e||(o?[]:{}),d=0,f=0;if(c&&a.origin!=null){if(typeof a.origin=="number")d=a.origin;else{var p=typeof a.origin=="string"?Hr(a.origin):a.origin;d=p.r,f=p.c}c["!ref"]||(c["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(c["!ref"]){var x=ur(c["!ref"]);h.s.c=x.s.c,h.s.r=x.s.r,h.e.c=Math.max(h.e.c,x.e.c),h.e.r=Math.max(h.e.r,x.e.r),d==-1&&(h.e.r=d=x.e.r+1)}for(var y=0;y!=t.length;++y)if(t[y]){if(!Array.isArray(t[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var b=0;b!=t[y].length;++b)if(!(typeof t[y][b]>"u")){var v={v:t[y][b]},w=d+y,_=f+b;if(h.s.r>w&&(h.s.r=w),h.s.c>_&&(h.s.c=_),h.e.r<w&&(h.e.r=w),h.e.c<_&&(h.e.c=_),t[y][b]&&typeof t[y][b]=="object"&&!Array.isArray(t[y][b])&&!(t[y][b]instanceof Date))v=t[y][b];else if(Array.isArray(v.v)&&(v.f=t[y][b][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(a.nullError)v.t="e",v.v=0;else if(a.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=a.dateNF||Sr[14],a.cellDates?(v.t="d",v.w=bs(v.z,Sn(v.v))):(v.t="n",v.v=Sn(v.v),v.w=bs(v.z,v.v))):v.t="s";if(o)c[w]||(c[w]=[]),c[w][_]&&c[w][_].z&&(v.z=c[w][_].z),c[w][_]=v;else{var T=Zt({c:_,r:w});c[T]&&c[T].z&&(v.z=c[T].z),c[T]=v}}}return h.s.c<1e7&&(c["!ref"]=Ar(h)),c}function uo(e,t){return Fy(null,e,t)}function Bk(e){return e.read_shift(4,"i")}function na(e,t){return t||(t=Ie(4)),t.write_shift(4,e),t}function on(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function qr(e,t){var r=!1;return t==null&&(r=!0,t=Ie(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Ik(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Fk(e,t){return t||(t=Ie(4)),t.write_shift(2,0),t.write_shift(2,0),t}function oh(e,t){var r=e.l,a=e.read_shift(1),o=on(e),c=[],d={t:o,h:o};if((a&1)!==0){for(var f=e.read_shift(4),p=0;p!=f;++p)c.push(Ik(e));d.r=c}else d.r=[{ich:0,ifnt:0}];return e.l=r+t,d}function Lk(e,t){var r=!1;return t==null&&(r=!0,t=Ie(15+4*e.t.length)),t.write_shift(1,0),qr(e.t,t),r?t.slice(0,t.l):t}var Pk=oh;function zk(e,t){var r=!1;return t==null&&(r=!0,t=Ie(23+4*e.t.length)),t.write_shift(1,1),qr(e.t,t),t.write_shift(4,1),Fk({},t),r?t.slice(0,t.l):t}function Yn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Zs(e,t){return t==null&&(t=Ie(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ei(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ti(e,t){return t==null&&(t=Ie(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Uk=on,Ly=qr;function lh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function _d(e,t){var r=!1;return t==null&&(r=!0,t=Ie(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Wk=on,N0=lh,ch=_d;function Py(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var o=a===0?bd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):qs(t,0)>>2;return r?o/100:o}function zy(e,t){t==null&&(t=Ie(4));var r=0,a=0,o=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:o==(o|0)&&o>=-536870912&&o<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?o:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Uy(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function $k(e,t){return t||(t=Ie(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ri=Uy,fo=$k;function ho(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Vs(e,t){return(t||Ie(8)).write_shift(8,e,"f")}function Hk(e){var t={},r=e.read_shift(1),a=r>>>1,o=e.read_shift(1),c=e.read_shift(2,"i"),d=e.read_shift(1),f=e.read_shift(1),p=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=o;var h=Zk[o];h&&(t.rgb=h1(h));break;case 2:t.rgb=h1([d,f,p]);break;case 3:t.theme=o;break}return c!=0&&(t.tint=c>0?c/32767:c/32768),t}function Sd(e,t){if(t||(t=Ie(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function qk(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Gk(e,t){t||(t=Ie(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Wy=2,Dn=3,sd=11,wd=19,id=64,Yk=65,Vk=71,Xk=4108,Kk=4126,Qr=80,n1={1:{n:"CodePage",t:Wy},2:{n:"Category",t:Qr},3:{n:"PresentationFormat",t:Qr},4:{n:"ByteCount",t:Dn},5:{n:"LineCount",t:Dn},6:{n:"ParagraphCount",t:Dn},7:{n:"SlideCount",t:Dn},8:{n:"NoteCount",t:Dn},9:{n:"HiddenCount",t:Dn},10:{n:"MultimediaClipCount",t:Dn},11:{n:"ScaleCrop",t:sd},12:{n:"HeadingPairs",t:Xk},13:{n:"TitlesOfParts",t:Kk},14:{n:"Manager",t:Qr},15:{n:"Company",t:Qr},16:{n:"LinksUpToDate",t:sd},17:{n:"CharacterCount",t:Dn},19:{n:"SharedDoc",t:sd},22:{n:"HyperlinksChanged",t:sd},23:{n:"AppVersion",t:Dn,p:"version"},24:{n:"DigSig",t:Yk},26:{n:"ContentType",t:Qr},27:{n:"ContentStatus",t:Qr},28:{n:"Language",t:Qr},29:{n:"Version",t:Qr},255:{},2147483648:{n:"Locale",t:wd},2147483651:{n:"Behavior",t:wd},1919054434:{}},a1={1:{n:"CodePage",t:Wy},2:{n:"Title",t:Qr},3:{n:"Subject",t:Qr},4:{n:"Author",t:Qr},5:{n:"Keywords",t:Qr},6:{n:"Comments",t:Qr},7:{n:"Template",t:Qr},8:{n:"LastAuthor",t:Qr},9:{n:"RevNumber",t:Qr},10:{n:"EditTime",t:id},11:{n:"LastPrinted",t:id},12:{n:"CreatedDate",t:id},13:{n:"ModifiedDate",t:id},14:{n:"PageCount",t:Dn},15:{n:"WordCount",t:Dn},16:{n:"CharCount",t:Dn},17:{n:"Thumbnail",t:Vk},18:{n:"Application",t:Qr},19:{n:"DocSecurity",t:Dn},255:{},2147483648:{n:"Locale",t:wd},2147483651:{n:"Behavior",t:wd},1919054434:{}};function Qk(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Jk=Qk([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Zk=wn(Jk),Pl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},e8={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},od={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function $y(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Hy(e,t){var r=dk(e8),a=[],o;a[a.length]=Rr,a[a.length]=Ze("Types",null,{xmlns:$r.CT,"xmlns:xsd":$r.xsd,"xmlns:xsi":$r.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(p){return Ze("Default",null,{Extension:p[0],ContentType:p[1]})}));var c=function(p){e[p]&&e[p].length>0&&(o=e[p][0],a[a.length]=Ze("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:od[p][t.bookType]||od[p].xlsx}))},d=function(p){(e[p]||[]).forEach(function(h){a[a.length]=Ze("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:od[p][t.bookType]||od[p].xlsx})})},f=function(p){(e[p]||[]).forEach(function(h){a[a.length]=Ze("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[p][0]})})};return c("workbooks"),d("sheets"),d("charts"),f("themes"),["strs","styles"].forEach(c),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),d("metadata"),f("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qy(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function eo(e){var t=[Rr,Ze("Relationships",null,{xmlns:$r.RELS})];return tn(e["!id"]).forEach(function(r){t[t.length]=Ze("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Qt(e,t,r,a,o,c){if(o||(o={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,o.Id="rId"+t,o.Type=a,o.Target=r,[Wt.HLINK,Wt.XPATH,Wt.XMISS].indexOf(o.Type)>-1&&(o.TargetMode="External"),e["!id"][o.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][o.Id]=o,e[("/"+o.Target).replace("//","/")]=o,t}function t8(e){var t=[Rr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function s1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function r8(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function n8(e){var t=[Rr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(s1(e[r][0],e[r][1])),t.push(r8("",e[r][0]));return t.push(s1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Gy(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+pd.version+"</meta:generator></office:meta></office:document-meta>"}var Gs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function d0(e,t,r,a,o){o[e]!=null||t==null||t===""||(o[e]=t,t=Jt(t),a[a.length]=r?Ze(e,t,r):Zr(e,t))}function Yy(e,t){var r=t||{},a=[Rr,Ze("cp:coreProperties",null,{"xmlns:cp":$r.CORE_PROPS,"xmlns:dc":$r.dc,"xmlns:dcterms":$r.dcterms,"xmlns:dcmitype":$r.dcmitype,"xmlns:xsi":$r.xsi})],o={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&d0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:D0(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,o),e.ModifiedDate!=null&&d0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:D0(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,o));for(var c=0;c!=Gs.length;++c){var d=Gs[c],f=r.Props&&r.Props[d[1]]!=null?r.Props[d[1]]:e?e[d[1]]:null;f===!0?f="1":f===!1?f="0":typeof f=="number"&&(f=String(f)),f!=null&&d0(d[0],f,null,a,o)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var to=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Vy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Xy(e){var t=[],r=Ze;return e||(e={}),e.Application="SheetJS",t[t.length]=Rr,t[t.length]=Ze("Properties",null,{xmlns:$r.EXT_PROPS,"xmlns:vt":$r.vt}),to.forEach(function(a){if(e[a[1]]!==void 0){var o;switch(a[2]){case"string":o=Jt(String(e[a[1]]));break;case"bool":o=e[a[1]]?"true":"false";break}o!==void 0&&(t[t.length]=r(a[0],o))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Jt(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Ky(e){var t=[Rr,Ze("Properties",null,{xmlns:$r.CUST_PROPS,"xmlns:vt":$r.vt})];if(!e)return t.join("");var r=1;return tn(e).forEach(function(o){++r,t[t.length]=Ze("property",_k(e[o]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Jt(o)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var i1={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function a8(e,t){var r=[];return tn(i1).map(function(a){for(var o=0;o<Gs.length;++o)if(Gs[o][1]==a)return Gs[o];for(o=0;o<to.length;++o)if(to[o][1]==a)return to[o];throw a}).forEach(function(a){if(e[a[1]]!=null){var o=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":o=new Date(o).toISOString().replace(/\.\d*Z/,"Z");break}typeof o=="number"?o=String(o):o===!0||o===!1?o=o?"1":"0":o instanceof Date&&(o=new Date(o).toISOString().replace(/\.\d*Z/,"")),r.push(Zr(i1[a[1]]||a[1],o))}}),Ze("DocumentProperties",r.join(""),{xmlns:On.o})}function s8(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",o=[];return e&&tn(e).forEach(function(c){if(Object.prototype.hasOwnProperty.call(e,c)){for(var d=0;d<Gs.length;++d)if(c==Gs[d][1])return;for(d=0;d<to.length;++d)if(c==to[d][1])return;for(d=0;d<r.length;++d)if(c==r[d])return;var f=e[c],p="string";typeof f=="number"?(p="float",f=String(f)):f===!0||f===!1?(p="boolean",f=f?"1":"0"):f=String(f),o.push(Ze(Ym(c),f,{"dt:dt":p}))}}),t&&tn(t).forEach(function(c){if(Object.prototype.hasOwnProperty.call(t,c)&&!(e&&Object.prototype.hasOwnProperty.call(e,c))){var d=t[c],f="string";typeof d=="number"?(f="float",d=String(d)):d===!0||d===!1?(f="boolean",d=d?"1":"0"):d instanceof Date?(f="dateTime.tz",d=d.toISOString()):d=String(d),o.push(Ze(Ym(c),d,{"dt:dt":f}))}}),"<"+a+' xmlns="'+On.o+'">'+o.join("")+"</"+a+">"}function i8(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),o=(r-a)/Math.pow(2,32);a*=1e7,o*=1e7;var c=a/Math.pow(2,32)|0;c>0&&(a=a%Math.pow(2,32),o+=c);var d=Ie(8);return d.write_shift(4,a),d.write_shift(4,o),d}function o1(e,t){var r=Ie(4),a=Ie(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=Ie(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=i8(t);break;case 31:case 80:for(a=Ie(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Jr([r,a])}var Qy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function o8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function l1(e,t,r){var a=Ie(8),o=[],c=[],d=8,f=0,p=Ie(8),h=Ie(8);if(p.write_shift(4,2),p.write_shift(4,1200),h.write_shift(4,1),c.push(p),o.push(h),d+=8+p.length,!t){h=Ie(8),h.write_shift(4,0),o.unshift(h);var x=[Ie(4)];for(x[0].write_shift(4,e.length),f=0;f<e.length;++f){var y=e[f][0];for(p=Ie(8+2*(y.length+1)+(y.length%2?0:2)),p.write_shift(4,f+2),p.write_shift(4,y.length+1),p.write_shift(0,y,"dbcs");p.l!=p.length;)p.write_shift(1,0);x.push(p)}p=Jr(x),c.unshift(p),d+=8+p.length}for(f=0;f<e.length;++f)if(!(t&&!t[e[f][0]])&&!(Qy.indexOf(e[f][0])>-1||Vy.indexOf(e[f][0])>-1)&&e[f][1]!=null){var b=e[f][1],v=0;if(t){v=+t[e[f][0]];var w=r[v];if(w.p=="version"&&typeof b=="string"){var _=b.split(".");b=(+_[0]<<16)+(+_[1]||0)}p=o1(w.t,b)}else{var T=o8(b);T==-1&&(T=31,b=String(b)),p=o1(T,b)}c.push(p),h=Ie(8),h.write_shift(4,t?v:2+f),o.push(h),d+=8+p.length}var M=8*(c.length+1);for(f=0;f<c.length;++f)o[f].write_shift(4,M),M+=c[f].length;return a.write_shift(4,d),a.write_shift(4,c.length),Jr([a].concat(o).concat(c))}function c1(e,t,r,a,o,c){var d=Ie(o?68:48),f=[d];d.write_shift(2,65534),d.write_shift(2,0),d.write_shift(4,842412599),d.write_shift(16,sr.utils.consts.HEADER_CLSID,"hex"),d.write_shift(4,o?2:1),d.write_shift(16,t,"hex"),d.write_shift(4,o?68:48);var p=l1(e,r,a);if(f.push(p),o){var h=l1(o,null,null);d.write_shift(16,c,"hex"),d.write_shift(4,68+p.length),f.push(h)}return Jr(f)}function l8(e,t){t||(t=Ie(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function c8(e,t){return e.read_shift(t)===1}function hn(e,t){return t||(t=Ie(2)),t.write_shift(2,+!!e),t}function Jy(e){return e.read_shift(2,"u")}function qn(e,t){return t||(t=Ie(2)),t.write_shift(2,e),t}function Zy(e,t,r){return r||(r=Ie(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ev(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),o="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var c=e.read_shift(1);c&&(o="dbcs-cont")}else r.biff==12&&(o="wstr");r.biff>=2&&r.biff<=5&&(o="cpstr");var d=a?e.read_shift(a,o):"";return d}function d8(e){var t=e.t||"",r=Ie(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=Ie(2*t.length);a.write_shift(2*t.length,t,"utf16le");var o=[r,a];return Jr(o)}function u8(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var o=e.read_shift(1);return o===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function f8(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):u8(e,a,r)}function h8(e,t,r){if(r.biff>5)return f8(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function tv(e,t,r){return r||(r=Ie(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function d1(e,t){t||(t=Ie(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function p8(e){var t=Ie(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var o=a.indexOf("#"),c=o>-1?31:23;switch(a.charAt(0)){case"#":c=28;break;case".":c&=-3;break}t.write_shift(4,2),t.write_shift(4,c);var d=[8,6815827,6619237,4849780,83];for(r=0;r<d.length;++r)t.write_shift(4,d[r]);if(c==28)a=a.slice(1),d1(a,t);else if(c&2){for(d="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<d.length;++r)t.write_shift(1,parseInt(d[r],16));var f=o>-1?a.slice(0,o):a;for(t.write_shift(4,2*(f.length+1)),r=0;r<f.length;++r)t.write_shift(2,f.charCodeAt(r));t.write_shift(2,0),c&8&&d1(o>-1?a.slice(o+1):"",t)}else{for(d="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<d.length;++r)t.write_shift(1,parseInt(d[r],16));for(var p=0;a.slice(p*3,p*3+3)=="../"||a.slice(p*3,p*3+3)=="..\\";)++p;for(t.write_shift(2,p),t.write_shift(4,a.length-3*p+1),r=0;r<a.length-3*p;++r)t.write_shift(1,a.charCodeAt(r+3*p)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Xs(e,t,r,a){return a||(a=Ie(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function g8(e,t,r){var a=r.biff>8?4:2,o=e.read_shift(a),c=e.read_shift(a,"i"),d=e.read_shift(a,"i");return[o,c,d]}function x8(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);return{s:{c:a,r:t},e:{c:o,r}}}function rv(e,t){return t||(t=Ie(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function dh(e,t,r){var a=1536,o=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,o=8;break;case"biff4":a=4,o=6;break;case"biff3":a=3,o=6;break;case"biff2":a=2,o=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var c=Ie(o);return c.write_shift(2,a),c.write_shift(2,t),o>4&&c.write_shift(2,29282),o>6&&c.write_shift(2,1997),o>8&&(c.write_shift(2,49161),c.write_shift(2,1),c.write_shift(2,1798),c.write_shift(2,0)),c}function m8(e,t){var r=!t||t.biff==8,a=Ie(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function y8(e,t){var r=!t||t.biff>=8?2:1,a=Ie(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var o=a.slice(0,a.l);return o.l=a.l,o}function v8(e,t){var r=Ie(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],o=0;o<e.length;++o)a[o]=d8(e[o]);var c=Jr([r].concat(a));return c.parts=[r.length].concat(a.map(function(d){return d.length})),c}function b8(){var e=Ie(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function _8(e){var t=Ie(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function S8(e,t){var r=e.name||"Arial",a=t&&t.biff==5,o=a?15+r.length:16+2*r.length,c=Ie(o);return c.write_shift(2,e.sz*20),c.write_shift(4,0),c.write_shift(2,400),c.write_shift(4,0),c.write_shift(2,0),c.write_shift(1,r.length),a||c.write_shift(1,1),c.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),c}function w8(e,t,r,a){var o=Ie(10);return Xs(e,t,a,o),o.write_shift(4,r),o}function T8(e,t,r,a,o){var c=!o||o.biff==8,d=Ie(8+ +c+(1+c)*r.length);return Xs(e,t,a,d),d.write_shift(2,r.length),c&&d.write_shift(1,1),d.write_shift((1+c)*r.length,r,c?"utf16le":"sbcs"),d}function E8(e,t,r,a){var o=r&&r.biff==5;a||(a=Ie(o?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(o?1:2,t.length),o||a.write_shift(1,1),a.write_shift((o?1:2)*t.length,t,o?"sbcs":"utf16le");var c=a.length>a.l?a.slice(0,a.l):a;return c.l==null&&(c.l=c.length),c}function k8(e,t){var r=t.biff==8||!t.biff?4:2,a=Ie(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function u1(e,t,r,a){var o=r&&r.biff==5;a||(a=Ie(o?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var c=0;return e.numFmtId>0&&o&&(c|=1024),a.write_shift(4,c),a.write_shift(4,0),o||a.write_shift(4,0),a.write_shift(2,0),a}function j8(e){var t=Ie(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function C8(e,t,r,a,o,c){var d=Ie(8);return Xs(e,t,a,d),Zy(r,c,d),d}function A8(e,t,r,a){var o=Ie(14);return Xs(e,t,a,o),Vs(r,o),o}function R8(e,t,r){if(r.biff<8)return D8(e,t,r);for(var a=[],o=e.l+t,c=e.read_shift(r.biff>8?4:2);c--!==0;)a.push(g8(e,r.biff>8?12:6,r));if(e.l!=o)throw new Error("Bad ExternSheet: "+e.l+" != "+o);return a}function D8(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=ev(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function N8(e){var t=Ie(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)rv(e[r],t);return t}function O8(e){var t=Ie(24),r=Hr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),o=0;o<16;++o)t.write_shift(1,parseInt(a[o],16));return Jr([t,p8(e[1])])}function M8(e){var t=e[1].Tooltip,r=Ie(10+2*(t.length+1));r.write_shift(2,2048);var a=Hr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var o=0;o<t.length;++o)r.write_shift(2,t.charCodeAt(o));return r.write_shift(2,0),r}function B8(e){return e||(e=Ie(4)),e.write_shift(2,1),e.write_shift(2,1),e}function I8(e,t,r){if(!r.cellStyles)return ga(e,t);var a=r&&r.biff>=12?4:2,o=e.read_shift(a),c=e.read_shift(a),d=e.read_shift(a),f=e.read_shift(a),p=e.read_shift(2);a==2&&(e.l+=2);var h={s:o,e:c,w:d,ixfe:f,flags:p};return(r.biff>=5||!r.biff)&&(h.level=p>>8&7),h}function F8(e,t){var r=Ie(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function L8(e){for(var t=Ie(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function P8(e,t,r){var a=Ie(15);return Ul(a,e,t),a.write_shift(8,r,"f"),a}function z8(e,t,r){var a=Ie(9);return Ul(a,e,t),a.write_shift(2,r),a}var U8=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Z0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(f,p){var h=[],x=Ys(1);switch(p.type){case"base64":x=ta($a(f));break;case"binary":x=ta(f);break;case"buffer":case"array":x=f;break}Nn(x,0);var y=x.read_shift(1),b=!!(y&136),v=!1,w=!1;switch(y){case 2:break;case 3:break;case 48:v=!0,b=!0;break;case 49:v=!0,b=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var _=0,T=521;y==2&&(_=x.read_shift(2)),x.l+=3,y!=2&&(_=x.read_shift(4)),_>1048576&&(_=1e6),y!=2&&(T=x.read_shift(2));var M=x.read_shift(2),F=p.codepage||1252;y!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(F=e[x[x.l]]),x.l+=1,x.l+=2),w&&(x.l+=36);for(var A=[],U={},V=Math.min(x.length,y==2?521:T-10-(v?264:0)),te=w?32:11;x.l<V&&x[x.l]!=13;)switch(U={},U.name=gd.utils.decode(F,x.slice(x.l,x.l+te)).replace(/[\u0000\r\n].*$/g,""),x.l+=te,U.type=String.fromCharCode(x.read_shift(1)),y!=2&&!w&&(U.offset=x.read_shift(4)),U.len=x.read_shift(1),y==2&&(U.offset=x.read_shift(2)),U.dec=x.read_shift(1),U.name.length&&A.push(U),y!=2&&(x.l+=w?13:14),U.type){case"B":(!v||U.len!=8)&&p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":p.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(x[x.l]!==13&&(x.l=T-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=T;var N=0,re=0;for(h[0]=[],re=0;re!=A.length;++re)h[0][re]=A[re].name;for(;_-- >0;){if(x[x.l]===42){x.l+=M;continue}for(++x.l,h[++N]=[],re=0,re=0;re!=A.length;++re){var L=x.slice(x.l,x.l+A[re].len);x.l+=A[re].len,Nn(L,0);var X=gd.utils.decode(F,L);switch(A[re].type){case"C":X.trim().length&&(h[N][re]=X.replace(/\s+$/,""));break;case"D":X.length===8?h[N][re]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):h[N][re]=X;break;case"F":h[N][re]=parseFloat(X.trim());break;case"+":case"I":h[N][re]=w?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":h[N][re]=!0;break;case"N":case"F":h[N][re]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!b)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));h[N][re]="##MEMO##"+(w?parseInt(X.trim(),10):L.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(h[N][re]=+X||0);break;case"@":h[N][re]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":h[N][re]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":h[N][re]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[N][re]=-L.read_shift(-8,"f");break;case"B":if(v&&A[re].len==8){h[N][re]=L.read_shift(8,"f");break}case"G":case"P":L.l+=A[re].len;break;case"0":if(A[re].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[re].type)}}}if(y!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return p&&p.sheetRows&&(h=h.slice(0,p.sheetRows)),p.DBF=A,h}function a(f,p){var h=p||{};h.dateNF||(h.dateNF="yyyymmdd");var x=uo(r(f,h),h);return x["!cols"]=h.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete h.DBF,x}function o(f,p){try{return Js(a(f,p),p)}catch(h){if(p&&p.WTF)throw h}return{SheetNames:[],Sheets:{}}}var c={B:8,C:250,L:1,D:8,"?":0,"":0};function d(f,p){var h=p||{};if(+h.codepage>=0&&El(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var x=_n(),y=Cd(f,{header:1,raw:!0,cellDates:!0}),b=y[0],v=y.slice(1),w=f["!cols"]||[],_=0,T=0,M=0,F=1;for(_=0;_<b.length;++_){if(((w[_]||{}).DBF||{}).name){b[_]=w[_].DBF.name,++M;continue}if(b[_]!=null){if(++M,typeof b[_]=="number"&&(b[_]=b[_].toString(10)),typeof b[_]!="string")throw new Error("DBF Invalid column name "+b[_]+" |"+typeof b[_]+"|");if(b.indexOf(b[_])!==_){for(T=0;T<1024;++T)if(b.indexOf(b[_]+"_"+T)==-1){b[_]+="_"+T;break}}}}var A=ur(f["!ref"]),U=[],V=[],te=[];for(_=0;_<=A.e.c-A.s.c;++_){var N="",re="",L=0,X=[];for(T=0;T<v.length;++T)v[T][_]!=null&&X.push(v[T][_]);if(X.length==0||b[_]==null){U[_]="?";continue}for(T=0;T<X.length;++T){switch(typeof X[T]){case"number":re="B";break;case"string":re="C";break;case"boolean":re="L";break;case"object":re=X[T]instanceof Date?"D":"C";break;default:re="C"}L=Math.max(L,String(X[T]).length),N=N&&N!=re?"C":re}L>250&&(L=250),re=((w[_]||{}).DBF||{}).type,re=="C"&&w[_].DBF.len>L&&(L=w[_].DBF.len),N=="B"&&re=="N"&&(N="N",te[_]=w[_].DBF.dec,L=w[_].DBF.len),V[_]=N=="C"||re=="N"?L:c[N]||0,F+=V[_],U[_]=N}var le=x.next(32);for(le.write_shift(4,318902576),le.write_shift(4,v.length),le.write_shift(2,296+32*M),le.write_shift(2,F),_=0;_<4;++_)le.write_shift(4,0);for(le.write_shift(4,0|(+t[ay]||3)<<8),_=0,T=0;_<b.length;++_)if(b[_]!=null){var ge=x.next(32),Re=(b[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ge.write_shift(1,Re,"sbcs"),ge.write_shift(1,U[_]=="?"?"C":U[_],"sbcs"),ge.write_shift(4,T),ge.write_shift(1,V[_]||c[U[_]]||0),ge.write_shift(1,te[_]||0),ge.write_shift(1,2),ge.write_shift(4,0),ge.write_shift(1,0),ge.write_shift(4,0),ge.write_shift(4,0),T+=V[_]||c[U[_]]||0}var fe=x.next(264);for(fe.write_shift(4,13),_=0;_<65;++_)fe.write_shift(4,0);for(_=0;_<v.length;++_){var Ae=x.next(F);for(Ae.write_shift(1,0),T=0;T<b.length;++T)if(b[T]!=null)switch(U[T]){case"L":Ae.write_shift(1,v[_][T]==null?63:v[_][T]?84:70);break;case"B":Ae.write_shift(8,v[_][T]||0,"f");break;case"N":var ee="0";for(typeof v[_][T]=="number"&&(ee=v[_][T].toFixed(te[T]||0)),M=0;M<V[T]-ee.length;++M)Ae.write_shift(1,32);Ae.write_shift(1,ee,"sbcs");break;case"D":v[_][T]?(Ae.write_shift(4,("0000"+v[_][T].getFullYear()).slice(-4),"sbcs"),Ae.write_shift(2,("00"+(v[_][T].getMonth()+1)).slice(-2),"sbcs"),Ae.write_shift(2,("00"+v[_][T].getDate()).slice(-2),"sbcs")):Ae.write_shift(8,"00000000","sbcs");break;case"C":var ye=String(v[_][T]!=null?v[_][T]:"").slice(0,V[T]);for(Ae.write_shift(1,ye,"sbcs"),M=0;M<V[T]-ye.length;++M)Ae.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:o,to_sheet:a,from_sheet:d}})(),W8=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+tn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(b,v){var w=e[v];return typeof w=="number"?Bm(w):w},a=function(b,v,w){var _=v.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return _==59?b:Bm(_)};e["|"]=254;function o(b,v){switch(v.type){case"base64":return c($a(b),v);case"binary":return c(b,v);case"buffer":return c(Ht&&Buffer.isBuffer(b)?b.toString("binary"):Il(b),v);case"array":return c(Id(b),v)}throw new Error("Unrecognized type "+v.type)}function c(b,v){var w=b.split(/[\n\r]+/),_=-1,T=-1,M=0,F=0,A=[],U=[],V=null,te={},N=[],re=[],L=[],X=0,le;for(+v.codepage>=0&&El(+v.codepage);M!==w.length;++M){X=0;var ge=w[M].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),Re=ge.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),fe=Re[0],Ae;if(ge.length>0)switch(fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Re[1].charAt(0)=="P"&&U.push(ge.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,ye=!1,ae=!1,Se=!1,k=-1,J=-1;for(F=1;F<Re.length;++F)switch(Re[F].charAt(0)){case"A":break;case"X":T=parseInt(Re[F].slice(1))-1,ye=!0;break;case"Y":for(_=parseInt(Re[F].slice(1))-1,ye||(T=0),le=A.length;le<=_;++le)A[le]=[];break;case"K":Ae=Re[F].slice(1),Ae.charAt(0)==='"'?Ae=Ae.slice(1,Ae.length-1):Ae==="TRUE"?Ae=!0:Ae==="FALSE"?Ae=!1:isNaN(za(Ae))?isNaN(jl(Ae).getDate())||(Ae=pn(Ae)):(Ae=za(Ae),V!==null&&xy(V)&&(Ae=by(Ae))),ee=!0;break;case"E":Se=!0;var O=z6(Re[F].slice(1),{r:_,c:T});A[_][T]=[A[_][T],O];break;case"S":ae=!0,A[_][T]=[A[_][T],"S5S"];break;case"G":break;case"R":k=parseInt(Re[F].slice(1))-1;break;case"C":J=parseInt(Re[F].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+ge)}if(ee&&(A[_][T]&&A[_][T].length==2?A[_][T][0]=Ae:A[_][T]=Ae,V=null),ae){if(Se)throw new Error("SYLK shared formula cannot have own formula");var K=k>-1&&A[k][J];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");A[_][T][1]=U6(K[1],{r:_-k,c:T-J})}break;case"F":var Y=0;for(F=1;F<Re.length;++F)switch(Re[F].charAt(0)){case"X":T=parseInt(Re[F].slice(1))-1,++Y;break;case"Y":for(_=parseInt(Re[F].slice(1))-1,le=A.length;le<=_;++le)A[le]=[];break;case"M":X=parseInt(Re[F].slice(1))/20;break;case"F":break;case"G":break;case"P":V=U[parseInt(Re[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=Re[F].slice(1).split(" "),le=parseInt(L[0],10);le<=parseInt(L[1],10);++le)X=parseInt(L[2],10),re[le-1]=X===0?{hidden:!0}:{wch:X},uh(re[le-1]);break;case"C":T=parseInt(Re[F].slice(1))-1,re[T]||(re[T]={});break;case"R":_=parseInt(Re[F].slice(1))-1,N[_]||(N[_]={}),X>0?(N[_].hpt=X,N[_].hpx=ov(X)):X===0&&(N[_].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+ge)}Y<1&&(V=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+ge)}}return N.length>0&&(te["!rows"]=N),re.length>0&&(te["!cols"]=re),v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),[A,te]}function d(b,v){var w=o(b,v),_=w[0],T=w[1],M=uo(_,v);return tn(T).forEach(function(F){M[F]=T[F]}),M}function f(b,v){return Js(d(b,v),v)}function p(b,v,w,_){var T="C;Y"+(w+1)+";X"+(_+1)+";K";switch(b.t){case"n":T+=b.v||0,b.f&&!b.F&&(T+=";E"+hh(b.f,{r:w,c:_}));break;case"b":T+=b.v?"TRUE":"FALSE";break;case"e":T+=b.w||b.v;break;case"d":T+='"'+(b.w||b.v)+'"';break;case"s":T+='"'+b.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function h(b,v){v.forEach(function(w,_){var T="F;W"+(_+1)+" "+(_+1)+" ";w.hidden?T+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Td(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Ed(w.wpx)),typeof w.wch=="number"&&(T+=Math.round(w.wch))),T.charAt(T.length-1)!=" "&&b.push(T)})}function x(b,v){v.forEach(function(w,_){var T="F;";w.hidden?T+="M0;":w.hpt?T+="M"+20*w.hpt+";":w.hpx&&(T+="M"+20*kd(w.hpx)+";"),T.length>2&&b.push(T+"R"+(_+1))})}function y(b,v){var w=["ID;PWXL;N;E"],_=[],T=ur(b["!ref"]),M,F=Array.isArray(b),A=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),b["!cols"]&&h(w,b["!cols"]),b["!rows"]&&x(w,b["!rows"]),w.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var U=T.s.r;U<=T.e.r;++U)for(var V=T.s.c;V<=T.e.c;++V){var te=Zt({r:U,c:V});M=F?(b[U]||[])[V]:b[te],!(!M||M.v==null&&(!M.f||M.F))&&_.push(p(M,b,U,V))}return w.join(A)+A+_.join(A)+A+"E"+A}return{to_workbook:f,to_sheet:d,from_sheet:y}})(),$8=(function(){function e(c,d){switch(d.type){case"base64":return t($a(c),d);case"binary":return t(c,d);case"buffer":return t(Ht&&Buffer.isBuffer(c)?c.toString("binary"):Il(c),d);case"array":return t(Id(c),d)}throw new Error("Unrecognized type "+d.type)}function t(c,d){for(var f=c.split(`
`),p=-1,h=-1,x=0,y=[];x!==f.length;++x){if(f[x].trim()==="BOT"){y[++p]=[],h=0;continue}if(!(p<0)){var b=f[x].trim().split(","),v=b[0],w=b[1];++x;for(var _=f[x]||"";(_.match(/["]/g)||[]).length&1&&x<f.length-1;)_+=`
`+f[++x];switch(_=_.trim(),+v){case-1:if(_==="BOT"){y[++p]=[],h=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?y[p][h]=!0:_==="FALSE"?y[p][h]=!1:isNaN(za(w))?isNaN(jl(w).getDate())?y[p][h]=w:y[p][h]=pn(w):y[p][h]=za(w),++h;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),y[p][h++]=_!==""?_:null;break}if(_==="EOD")break}}return d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),y}function r(c,d){return uo(e(c,d),d)}function a(c,d){return Js(r(c,d),d)}var o=(function(){var c=function(p,h,x,y,b){p.push(h),p.push(x+","+y),p.push('"'+b.replace(/"/g,'""')+'"')},d=function(p,h,x,y){p.push(h+","+x),p.push(h==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(p){var h=[],x=ur(p["!ref"]),y,b=Array.isArray(p);c(h,"TABLE",0,1,"sheetjs"),c(h,"VECTORS",0,x.e.r-x.s.r+1,""),c(h,"TUPLES",0,x.e.c-x.s.c+1,""),c(h,"DATA",0,0,"");for(var v=x.s.r;v<=x.e.r;++v){d(h,-1,0,"BOT");for(var w=x.s.c;w<=x.e.c;++w){var _=Zt({r:v,c:w});if(y=b?(p[v]||[])[w]:p[_],!y){d(h,1,0,"");continue}switch(y.t){case"n":var T=y.w;!T&&y.v!=null&&(T=y.v),T==null?y.f&&!y.F?d(h,1,0,"="+y.f):d(h,1,0,""):d(h,0,T,"V");break;case"b":d(h,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":d(h,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=bs(y.z||Sr[14],Sn(pn(y.v)))),d(h,0,y.w,"V");break;default:d(h,1,0,"")}}}d(h,-1,0,"EOD");var M=`\r
`,F=h.join(M);return F}})();return{to_workbook:a,to_sheet:r,from_sheet:o}})(),nv=(function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(y,b){for(var v=y.split(`
`),w=-1,_=-1,T=0,M=[];T!==v.length;++T){var F=v[T].trim().split(":");if(F[0]==="cell"){var A=Hr(F[1]);if(M.length<=A.r)for(w=M.length;w<=A.r;++w)M[w]||(M[w]=[]);switch(w=A.r,_=A.c,F[2]){case"t":M[w][_]=e(F[3]);break;case"v":M[w][_]=+F[3];break;case"vtf":var U=F[F.length-1];case"vtc":switch(F[3]){case"nl":M[w][_]=!!+F[4];break;default:M[w][_]=+F[4];break}F[2]=="vtf"&&(M[w][_]=[M[w][_],U])}}}return b&&b.sheetRows&&(M=M.slice(0,b.sheetRows)),M}function a(y,b){return uo(r(y,b),b)}function o(y,b){return Js(a(y,b),b)}var c=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),d=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),p="--SocialCalcSpreadsheetControlSave--";function h(y){if(!y||!y["!ref"])return"";for(var b=[],v=[],w,_="",T=Bn(y["!ref"]),M=Array.isArray(y),F=T.s.r;F<=T.e.r;++F)for(var A=T.s.c;A<=T.e.c;++A)if(_=Zt({r:F,c:A}),w=M?(y[F]||[])[A]:y[_],!(!w||w.v==null||w.t==="z")){switch(v=["cell",_,"t"],w.t){case"s":case"str":v.push(t(w.v));break;case"n":w.f?(v[2]="vtf",v[3]="n",v[4]=w.v,v[5]=t(w.f)):(v[2]="v",v[3]=w.v);break;case"b":v[2]="vt"+(w.f?"f":"c"),v[3]="nl",v[4]=w.v?"1":"0",v[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var U=Sn(pn(w.v));v[2]="vtc",v[3]="nd",v[4]=""+U,v[5]=w.w||bs(w.z||Sr[14],U);break;case"e":continue}b.push(v.join(":"))}return b.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),b.push("valueformat:1:text-wiki"),b.join(`
`)}function x(y){return[c,d,f,d,h(y),p].join(`
`)}return{to_workbook:o,to_sheet:a,from_sheet:x}})(),H8=(function(){function e(x,y,b,v,w){w.raw?y[b][v]=x:x===""||(x==="TRUE"?y[b][v]=!0:x==="FALSE"?y[b][v]=!1:isNaN(za(x))?isNaN(jl(x).getDate())?y[b][v]=x:y[b][v]=pn(x):y[b][v]=za(x))}function t(x,y){var b=y||{},v=[];if(!x||x.length===0)return v;for(var w=x.split(/[\r\n]/),_=w.length-1;_>=0&&w[_].length===0;)--_;for(var T=10,M=0,F=0;F<=_;++F)M=w[F].indexOf(" "),M==-1?M=w[F].length:M++,T=Math.max(T,M);for(F=0;F<=_;++F){v[F]=[];var A=0;for(e(w[F].slice(0,T).trim(),v,F,A,b),A=1;A<=(w[F].length-T)/10+1;++A)e(w[F].slice(T+(A-1)*10,T+A*10).trim(),v,F,A,b)}return b.sheetRows&&(v=v.slice(0,b.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function o(x){for(var y={},b=!1,v=0,w=0;v<x.length;++v)(w=x.charCodeAt(v))==34?b=!b:!b&&w in r&&(y[w]=(y[w]||0)+1);w=[];for(v in y)Object.prototype.hasOwnProperty.call(y,v)&&w.push([y[v],v]);if(!w.length){y=a;for(v in y)Object.prototype.hasOwnProperty.call(y,v)&&w.push([y[v],v])}return w.sort(function(_,T){return _[0]-T[0]||a[_[1]]-a[T[1]]}),r[w.pop()[1]]||44}function c(x,y){var b=y||{},v="",w=b.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(v=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(v=x.charAt(4),x=x.slice(6)):v=o(x.slice(0,1024)):b&&b.FS?v=b.FS:v=o(x.slice(0,1024));var T=0,M=0,F=0,A=0,U=0,V=v.charCodeAt(0),te=!1,N=0,re=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var L=b.dateNF!=null?ik(b.dateNF):null;function X(){var le=x.slice(A,U),ge={};if(le.charAt(0)=='"'&&le.charAt(le.length-1)=='"'&&(le=le.slice(1,-1).replace(/""/g,'"')),le.length===0)ge.t="z";else if(b.raw)ge.t="s",ge.v=le;else if(le.trim().length===0)ge.t="s",ge.v=le;else if(le.charCodeAt(0)==61)le.charCodeAt(1)==34&&le.charCodeAt(le.length-1)==34?(ge.t="s",ge.v=le.slice(2,-1).replace(/""/g,'"')):W6(le)?(ge.t="n",ge.f=le.slice(1)):(ge.t="s",ge.v=le);else if(le=="TRUE")ge.t="b",ge.v=!0;else if(le=="FALSE")ge.t="b",ge.v=!1;else if(!isNaN(F=za(le)))ge.t="n",b.cellText!==!1&&(ge.w=le),ge.v=F;else if(!isNaN(jl(le).getDate())||L&&le.match(L)){ge.z=b.dateNF||Sr[14];var Re=0;L&&le.match(L)&&(le=ok(le,b.dateNF,le.match(L)||[]),Re=1),b.cellDates?(ge.t="d",ge.v=pn(le,Re)):(ge.t="n",ge.v=Sn(pn(le,Re))),b.cellText!==!1&&(ge.w=bs(ge.z,ge.v instanceof Date?Sn(ge.v):ge.v)),b.cellNF||delete ge.z}else ge.t="s",ge.v=le;if(ge.t=="z"||(b.dense?(w[T]||(w[T]=[]),w[T][M]=ge):w[Zt({c:M,r:T})]=ge),A=U+1,re=x.charCodeAt(A),_.e.c<M&&(_.e.c=M),_.e.r<T&&(_.e.r=T),N==V)++M;else if(M=0,++T,b.sheetRows&&b.sheetRows<=T)return!0}e:for(;U<x.length;++U)switch(N=x.charCodeAt(U)){case 34:re===34&&(te=!te);break;case V:case 10:case 13:if(!te&&X())break e;break}return U-A>0&&X(),w["!ref"]=Ar(_),w}function d(x,y){return!(y&&y.PRN)||y.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?c(x,y):uo(t(x,y),y)}function f(x,y){var b="",v=y.type=="string"?[0,0,0,0]:rR(x,y);switch(y.type){case"base64":b=$a(x);break;case"binary":b=x;break;case"buffer":y.codepage==65001?b=x.toString("utf8"):y.codepage&&typeof gd<"u"||(b=Ht&&Buffer.isBuffer(x)?x.toString("binary"):Il(x));break;case"array":b=Id(x);break;case"string":b=x;break;default:throw new Error("Unrecognized type "+y.type)}return v[0]==239&&v[1]==187&&v[2]==191?b=yl(b.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?b=yl(b):y.type=="binary"&&typeof gd<"u",b.slice(0,19)=="socialcalc:version:"?nv.to_sheet(y.type=="string"?b:yl(b),y):d(b,y)}function p(x,y){return Js(f(x,y),y)}function h(x){for(var y=[],b=ur(x["!ref"]),v,w=Array.isArray(x),_=b.s.r;_<=b.e.r;++_){for(var T=[],M=b.s.c;M<=b.e.c;++M){var F=Zt({r:_,c:M});if(v=w?(x[_]||[])[M]:x[F],!v||v.v==null){T.push("          ");continue}for(var A=(v.w||(Ha(v),v.w)||"").slice(0,10);A.length<10;)A+=" ";T.push(A+(M===0?" ":""))}y.push(T.join(""))}return y.join(`
`)}return{to_workbook:p,to_sheet:f,from_sheet:h}})(),f1=(function(){function e(O,K,Y){if(O){Nn(O,O.l||0);for(var H=Y.Enum||k;O.l<O.length;){var pe=O.read_shift(2),Ge=H[pe]||H[65535],He=O.read_shift(2),De=O.l+He,Be=Ge.f&&Ge.f(O,He,Y);if(O.l=De,K(Be,Ge,pe))return}}}function t(O,K){switch(K.type){case"base64":return r(ta($a(O)),K);case"binary":return r(ta(O),K);case"buffer":case"array":return r(O,K)}throw"Unsupported type "+K.type}function r(O,K){if(!O)return O;var Y=K||{},H=Y.dense?[]:{},pe="Sheet1",Ge="",He=0,De={},Be=[],rt=[],de={s:{r:0,c:0},e:{r:0,c:0}},$e=Y.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)Y.Enum=k,e(O,function(je,dt,We){switch(We){case 0:Y.vers=je,je>=4096&&(Y.qpro=!0);break;case 6:de=je;break;case 204:je&&(Ge=je);break;case 222:Ge=je;break;case 15:case 51:Y.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:We==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=Y.dateNF||Sr[14],Y.cellDates&&(je[1].t="d",je[1].v=by(je[1].v))),Y.qpro&&je[3]>He&&(H["!ref"]=Ar(de),De[pe]=H,Be.push(pe),H=Y.dense?[]:{},de={s:{r:0,c:0},e:{r:0,c:0}},He=je[3],pe=Ge||"Sheet"+(He+1),Ge="");var ot=Y.dense?(H[je[0].r]||[])[je[0].c]:H[Zt(je[0])];if(ot){ot.t=je[1].t,ot.v=je[1].v,je[1].z!=null&&(ot.z=je[1].z),je[1].f!=null&&(ot.f=je[1].f);break}Y.dense?(H[je[0].r]||(H[je[0].r]=[]),H[je[0].r][je[0].c]=je[1]):H[Zt(je[0])]=je[1];break}},Y);else if(O[2]==26||O[2]==14)Y.Enum=J,O[2]==14&&(Y.qpro=!0,O.l=0),e(O,function(je,dt,We){switch(We){case 204:pe=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>He&&(H["!ref"]=Ar(de),De[pe]=H,Be.push(pe),H=Y.dense?[]:{},de={s:{r:0,c:0},e:{r:0,c:0}},He=je[3],pe="Sheet"+(He+1)),$e>0&&je[0].r>=$e)break;Y.dense?(H[je[0].r]||(H[je[0].r]=[]),H[je[0].r][je[0].c]=je[1]):H[Zt(je[0])]=je[1],de.e.c<je[0].c&&(de.e.c=je[0].c),de.e.r<je[0].r&&(de.e.r=je[0].r);break;case 27:je[14e3]&&(rt[je[14e3][0]]=je[14e3][1]);break;case 1537:rt[je[0]]=je[1],je[0]==He&&(pe=je[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(H["!ref"]=Ar(de),De[Ge||pe]=H,Be.push(Ge||pe),!rt.length)return{SheetNames:Be,Sheets:De};for(var z={},be=[],Ke=0;Ke<rt.length;++Ke)De[Be[Ke]]?(be.push(rt[Ke]||Be[Ke]),z[rt[Ke]]=De[rt[Ke]]||De[Be[Ke]]):(be.push(rt[Ke]),z[rt[Ke]]={"!ref":"A1"});return{SheetNames:be,Sheets:z}}function a(O,K){var Y=K||{};if(+Y.codepage>=0&&El(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var H=_n(),pe=ur(O["!ref"]),Ge=Array.isArray(O),He=[];et(H,0,c(1030)),et(H,6,p(pe));for(var De=Math.min(pe.e.r,8191),Be=pe.s.r;Be<=De;++Be)for(var rt=en(Be),de=pe.s.c;de<=pe.e.c;++de){Be===pe.s.r&&(He[de]=sn(de));var $e=He[de]+rt,z=Ge?(O[Be]||[])[de]:O[$e];if(!(!z||z.t=="z"))if(z.t=="n")(z.v|0)==z.v&&z.v>=-32768&&z.v<=32767?et(H,13,v(Be,de,z.v)):et(H,14,_(Be,de,z.v));else{var be=Ha(z);et(H,15,y(Be,de,be.slice(0,239)))}}return et(H,1),H.end()}function o(O,K){var Y=K||{};if(+Y.codepage>=0&&El(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var H=_n();et(H,0,d(O));for(var pe=0,Ge=0;pe<O.SheetNames.length;++pe)(O.Sheets[O.SheetNames[pe]]||{})["!ref"]&&et(H,27,Se(O.SheetNames[pe],Ge++));var He=0;for(pe=0;pe<O.SheetNames.length;++pe){var De=O.Sheets[O.SheetNames[pe]];if(!(!De||!De["!ref"])){for(var Be=ur(De["!ref"]),rt=Array.isArray(De),de=[],$e=Math.min(Be.e.r,8191),z=Be.s.r;z<=$e;++z)for(var be=en(z),Ke=Be.s.c;Ke<=Be.e.c;++Ke){z===Be.s.r&&(de[Ke]=sn(Ke));var je=de[Ke]+be,dt=rt?(De[z]||[])[Ke]:De[je];if(!(!dt||dt.t=="z"))if(dt.t=="n")et(H,23,X(z,Ke,He,dt.v));else{var We=Ha(dt);et(H,22,N(z,Ke,He,We.slice(0,239)))}}++He}}return et(H,1),H.end()}function c(O){var K=Ie(2);return K.write_shift(2,O),K}function d(O){var K=Ie(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var Y=0,H=0,pe=0,Ge=0;Ge<O.SheetNames.length;++Ge){var He=O.SheetNames[Ge],De=O.Sheets[He];if(!(!De||!De["!ref"])){++pe;var Be=Bn(De["!ref"]);Y<Be.e.r&&(Y=Be.e.r),H<Be.e.c&&(H=Be.e.c)}}return Y>8191&&(Y=8191),K.write_shift(2,Y),K.write_shift(1,pe),K.write_shift(1,H),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function f(O,K,Y){var H={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&Y.qpro?(H.s.c=O.read_shift(1),O.l++,H.s.r=O.read_shift(2),H.e.c=O.read_shift(1),O.l++,H.e.r=O.read_shift(2),H):(H.s.c=O.read_shift(2),H.s.r=O.read_shift(2),K==12&&Y.qpro&&(O.l+=2),H.e.c=O.read_shift(2),H.e.r=O.read_shift(2),K==12&&Y.qpro&&(O.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function p(O){var K=Ie(8);return K.write_shift(2,O.s.c),K.write_shift(2,O.s.r),K.write_shift(2,O.e.c),K.write_shift(2,O.e.r),K}function h(O,K,Y){var H=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(H[0].c=O.read_shift(1),H[3]=O.read_shift(1),H[0].r=O.read_shift(2),O.l+=2):(H[2]=O.read_shift(1),H[0].c=O.read_shift(2),H[0].r=O.read_shift(2)),H}function x(O,K,Y){var H=O.l+K,pe=h(O,K,Y);if(pe[1].t="s",Y.vers==20768){O.l++;var Ge=O.read_shift(1);return pe[1].v=O.read_shift(Ge,"utf8"),pe}return Y.qpro&&O.l++,pe[1].v=O.read_shift(H-O.l,"cstr"),pe}function y(O,K,Y){var H=Ie(7+Y.length);H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,O),H.write_shift(1,39);for(var pe=0;pe<H.length;++pe){var Ge=Y.charCodeAt(pe);H.write_shift(1,Ge>=128?95:Ge)}return H.write_shift(1,0),H}function b(O,K,Y){var H=h(O,K,Y);return H[1].v=O.read_shift(2,"i"),H}function v(O,K,Y){var H=Ie(7);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,O),H.write_shift(2,Y,"i"),H}function w(O,K,Y){var H=h(O,K,Y);return H[1].v=O.read_shift(8,"f"),H}function _(O,K,Y){var H=Ie(13);return H.write_shift(1,255),H.write_shift(2,K),H.write_shift(2,O),H.write_shift(8,Y,"f"),H}function T(O,K,Y){var H=O.l+K,pe=h(O,K,Y);if(pe[1].v=O.read_shift(8,"f"),Y.qpro)O.l=H;else{var Ge=O.read_shift(2);U(O.slice(O.l,O.l+Ge),pe),O.l+=Ge}return pe}function M(O,K,Y){var H=K&32768;return K&=-32769,K=(H?O:0)+(K>=8192?K-16384:K),(H?"":"$")+(Y?sn(K):en(K))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(O,K){Nn(O,0);for(var Y=[],H=0,pe="",Ge="",He="",De="";O.l<O.length;){var Be=O[O.l++];switch(Be){case 0:Y.push(O.read_shift(8,"f"));break;case 1:Ge=M(K[0].c,O.read_shift(2),!0),pe=M(K[0].r,O.read_shift(2),!1),Y.push(Ge+pe);break;case 2:{var rt=M(K[0].c,O.read_shift(2),!0),de=M(K[0].r,O.read_shift(2),!1);Ge=M(K[0].c,O.read_shift(2),!0),pe=M(K[0].r,O.read_shift(2),!1),Y.push(rt+de+":"+Ge+pe)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(O.read_shift(2));break;case 6:{for(var $e="";Be=O[O.l++];)$e+=String.fromCharCode(Be);Y.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:De=Y.pop(),He=Y.pop(),Y.push(["AND","OR"][Be-20]+"("+He+","+De+")");break;default:if(Be<32&&A[Be])De=Y.pop(),He=Y.pop(),Y.push(He+A[Be]+De);else if(F[Be]){if(H=F[Be][1],H==69&&(H=O[O.l++]),H>Y.length){console.error("WK1 bad formula parse 0x"+Be.toString(16)+":|"+Y.join("|")+"|");return}var z=Y.slice(-H);Y.length-=H,Y.push(F[Be][0]+"("+z.join(",")+")")}else return Be<=7?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=24?console.error("WK1 unsupported op "+Be.toString(16)):Be<=30?console.error("WK1 invalid opcode "+Be.toString(16)):Be<=115?console.error("WK1 unsupported function opcode "+Be.toString(16)):console.error("WK1 unrecognized opcode "+Be.toString(16))}}Y.length==1?K[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function V(O){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=O.read_shift(2),K[3]=O[O.l++],K[0].c=O[O.l++],K}function te(O,K){var Y=V(O);return Y[1].t="s",Y[1].v=O.read_shift(K-4,"cstr"),Y}function N(O,K,Y,H){var pe=Ie(6+H.length);pe.write_shift(2,O),pe.write_shift(1,Y),pe.write_shift(1,K),pe.write_shift(1,39);for(var Ge=0;Ge<H.length;++Ge){var He=H.charCodeAt(Ge);pe.write_shift(1,He>=128?95:He)}return pe.write_shift(1,0),pe}function re(O,K){var Y=V(O);Y[1].v=O.read_shift(2);var H=Y[1].v>>1;if(Y[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return Y[1].v=H,Y}function L(O,K){var Y=V(O),H=O.read_shift(4),pe=O.read_shift(4),Ge=O.read_shift(2);if(Ge==65535)return H===0&&pe===3221225472?(Y[1].t="e",Y[1].v=15):H===0&&pe===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var He=Ge&32768;return Ge=(Ge&32767)-16446,Y[1].v=(1-He*2)*(pe*Math.pow(2,Ge+32)+H*Math.pow(2,Ge)),Y}function X(O,K,Y,H){var pe=Ie(14);if(pe.write_shift(2,O),pe.write_shift(1,Y),pe.write_shift(1,K),H==0)return pe.write_shift(4,0),pe.write_shift(4,0),pe.write_shift(2,65535),pe;var Ge=0,He=0,De=0,Be=0;return H<0&&(Ge=1,H=-H),He=Math.log2(H)|0,H/=Math.pow(2,He-31),Be=H>>>0,(Be&2147483648)==0&&(H/=2,++He,Be=H>>>0),H-=Be,Be|=2147483648,Be>>>=0,H*=Math.pow(2,32),De=H>>>0,pe.write_shift(4,De),pe.write_shift(4,Be),He+=16383+(Ge?32768:0),pe.write_shift(2,He),pe}function le(O,K){var Y=L(O);return O.l+=K-14,Y}function ge(O,K){var Y=V(O),H=O.read_shift(4);return Y[1].v=H>>6,Y}function Re(O,K){var Y=V(O),H=O.read_shift(8,"f");return Y[1].v=H,Y}function fe(O,K){var Y=Re(O);return O.l+=K-10,Y}function Ae(O,K){return O[O.l+K-1]==0?O.read_shift(K,"cstr"):""}function ee(O,K){var Y=O[O.l++];Y>K-1&&(Y=K-1);for(var H="";H.length<Y;)H+=String.fromCharCode(O[O.l++]);return H}function ye(O,K,Y){if(!(!Y.qpro||K<21)){var H=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var pe=O.read_shift(K-21,"cstr");return[H,pe]}}function ae(O,K){for(var Y={},H=O.l+K;O.l<H;){var pe=O.read_shift(2);if(pe==14e3){for(Y[pe]=[0,""],Y[pe][0]=O.read_shift(2);O[O.l];)Y[pe][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return Y}function Se(O,K){var Y=Ie(5+O.length);Y.write_shift(2,14e3),Y.write_shift(2,K);for(var H=0;H<O.length;++H){var pe=O.charCodeAt(H);Y[Y.l++]=pe>127?95:pe}return Y[Y.l++]=0,Y}var k={0:{n:"BOF",f:Jy},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:b},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ae},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:te},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:re},25:{n:"FORMULA19",f:le},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ae},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ge},38:{n:"??"},39:{n:"NUMBER27",f:Re},40:{n:"FORMULA28",f:fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ae},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ye},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:o,to_workbook:t}})(),q8=/^\s|\s$|[\t\n\r]/;function av(e,t){if(!t.bookSST)return"";var r=[Rr];r[r.length]=Ze("sst",null,{xmlns:co[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var o=e[a],c="<si>";o.r?c+=o.r:(c+="<t",o.t||(o.t=""),o.t.match(q8)&&(c+=' xml:space="preserve"'),c+=">"+Jt(o.t)+"</t>"),c+="</si>",r[r.length]=c}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function G8(e){return[e.read_shift(4),e.read_shift(4)]}function Y8(e,t){return t||(t=Ie(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var V8=Lk;function X8(e){var t=_n();qe(t,159,Y8(e));for(var r=0;r<e.length;++r)qe(t,19,V8(e[r]));return qe(t,160),t.end()}function K8(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function sv(e){var t=0,r,a=K8(e),o=a.length+1,c,d,f,p,h;for(r=Ys(o),r[0]=a.length,c=1;c!=o;++c)r[c]=a[c-1];for(c=o-1;c>=0;--c)d=r[c],f=(t&16384)===0?0:1,p=t<<1&32767,h=f|p,t=h^d;return t^52811}var Q8=(function(){function e(o,c){switch(c.type){case"base64":return t($a(o),c);case"binary":return t(o,c);case"buffer":return t(Ht&&Buffer.isBuffer(o)?o.toString("binary"):Il(o),c);case"array":return t(Id(o),c)}throw new Error("Unrecognized type "+c.type)}function t(o,c){var d=c||{},f=d.dense?[]:{},p=o.match(/\\trowd.*?\\row\b/g);if(!p.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:p.length-1}};return p.forEach(function(x,y){Array.isArray(f)&&(f[y]=[]);for(var b=/\\\w+\b/g,v=0,w,_=-1;w=b.exec(x);){switch(w[0]){case"\\cell":var T=x.slice(v,b.lastIndex-w[0].length);if(T[0]==" "&&(T=T.slice(1)),++_,T.length){var M={v:T,t:"s"};Array.isArray(f)?f[y][_]=M:f[Zt({r:y,c:_})]=M}break}v=b.lastIndex}_>h.e.c&&(h.e.c=_)}),f["!ref"]=Ar(h),f}function r(o,c){return Js(e(o,c),c)}function a(o){for(var c=["{\\rtf1\\ansi"],d=ur(o["!ref"]),f,p=Array.isArray(o),h=d.s.r;h<=d.e.r;++h){c.push("\\trowd\\trautofit1");for(var x=d.s.c;x<=d.e.c;++x)c.push("\\cellx"+(x+1));for(c.push("\\pard\\intbl"),x=d.s.c;x<=d.e.c;++x){var y=Zt({r:h,c:x});f=p?(o[h]||[])[x]:o[y],!(!f||f.v==null&&(!f.f||f.F))&&(c.push(" "+(f.w||(Ha(f),f.w))),c.push("\\cell"))}c.push("\\pard\\intbl\\row")}return c.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function h1(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var J8=6,Ua=J8;function Td(e){return Math.floor((e+Math.round(128/Ua)/256)*Ua)}function Ed(e){return Math.floor((e-5)/Ua*100+.5)/100}function O0(e){return Math.round((e*Ua+5)/Ua*256)/256}function uh(e){e.width?(e.wpx=Td(e.width),e.wch=Ed(e.wpx),e.MDW=Ua):e.wpx?(e.wch=Ed(e.wpx),e.width=O0(e.wch),e.MDW=Ua):typeof e.wch=="number"&&(e.width=O0(e.wch),e.wpx=Td(e.width),e.MDW=Ua),e.customWidth&&delete e.customWidth}var Z8=96,iv=Z8;function kd(e){return e*96/iv}function ov(e){return e*iv/96}function e6(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Ze("numFmt",null,{numFmtId:a,formatCode:Jt(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ze("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function t6(e){var t=[];return t[t.length]=Ze("cellXfs",null),e.forEach(function(r){t[t.length]=Ze("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ze("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function lv(e,t){var r=[Rr,Ze("styleSheet",null,{xmlns:co[0],"xmlns:vt":$r.vt})],a;return e.SSF&&(a=e6(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=t6(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function r6(e,t){var r=e.read_shift(2),a=on(e);return[r,a]}function n6(e,t,r){r||(r=Ie(6+4*t.length)),r.write_shift(2,e),qr(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function a6(e,t,r){var a={};a.sz=e.read_shift(2)/20;var o=qk(e);o.fItalic&&(a.italic=1),o.fCondense&&(a.condense=1),o.fExtend&&(a.extend=1),o.fShadow&&(a.shadow=1),o.fOutline&&(a.outline=1),o.fStrikeout&&(a.strike=1);var c=e.read_shift(2);switch(c===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var d=e.read_shift(1);d!=0&&(a.underline=d);var f=e.read_shift(1);f>0&&(a.family=f);var p=e.read_shift(1);switch(p>0&&(a.charset=p),e.l++,a.color=Hk(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=on(e),a}function s6(e,t){t||(t=Ie(153)),t.write_shift(2,e.sz*20),Gk(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Sd(e.color,t);var a=0;return a=2,t.write_shift(1,a),qr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var i6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],u0,o6=ga;function p1(e,t){t||(t=Ie(84)),u0||(u0=Z0(i6));var r=u0[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Sd({auto:1},t),Sd({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function l6(e,t){var r=e.l+t,a=e.read_shift(2),o=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:o}}function cv(e,t,r){r||(r=Ie(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function dl(e,t){return t||(t=Ie(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var c6=ga;function d6(e,t){return t||(t=Ie(51)),t.write_shift(1,0),dl(null,t),dl(null,t),dl(null,t),dl(null,t),dl(null,t),t.length>t.l?t.slice(0,t.l):t}function u6(e,t){return t||(t=Ie(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),_d(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function f6(e,t,r){var a=Ie(2052);return a.write_shift(4,e),_d(t,a),_d(r,a),a.length>a.l?a.slice(0,a.l):a}function h6(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var o=a[0];o<=a[1];++o)t[o]!=null&&++r}),r!=0&&(qe(e,615,na(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var o=a[0];o<=a[1];++o)t[o]!=null&&qe(e,44,n6(o,t[o]))}),qe(e,616))}}function p6(e){var t=1;qe(e,611,na(t)),qe(e,43,s6({sz:12,color:{theme:1},name:"Calibri",family:2})),qe(e,612)}function g6(e){var t=2;qe(e,603,na(t)),qe(e,45,p1({patternType:"none"})),qe(e,45,p1({patternType:"gray125"})),qe(e,604)}function x6(e){var t=1;qe(e,613,na(t)),qe(e,46,d6()),qe(e,614)}function m6(e){var t=1;qe(e,626,na(t)),qe(e,47,cv({numFmtId:0},65535)),qe(e,627)}function y6(e,t){qe(e,617,na(t.length)),t.forEach(function(r){qe(e,47,cv(r,0))}),qe(e,618)}function v6(e){var t=1;qe(e,619,na(t)),qe(e,48,u6({xfId:0,name:"Normal"})),qe(e,620)}function b6(e){var t=0;qe(e,505,na(t)),qe(e,506)}function _6(e){var t=0;qe(e,508,f6(t,"TableStyleMedium9","PivotStyleMedium4")),qe(e,509)}function S6(e,t){var r=_n();return qe(r,278),h6(r,e.SSF),p6(r),g6(r),x6(r),m6(r),y6(r,t.cellXfs),v6(r),b6(r),_6(r),qe(r,279),r.end()}function dv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Rr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function w6(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:on(e)}}function T6(e){var t=Ie(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),qr(e.name,t),t.slice(0,t.l)}function E6(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function k6(e){var t=Ie(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function j6(e,t){var r=Ie(8+2*t.length);return r.write_shift(4,e),qr(t,r),r.slice(0,r.l)}function C6(e){return e.l+=4,e.read_shift(4)!=0}function A6(e,t){var r=Ie(8);return r.write_shift(4,e),r.write_shift(4,1),r}function R6(){var e=_n();return qe(e,332),qe(e,334,na(1)),qe(e,335,T6({name:"XLDAPR",version:12e4,flags:3496657072})),qe(e,336),qe(e,339,j6(1,"XLDAPR")),qe(e,52),qe(e,35,na(514)),qe(e,4096,na(0)),qe(e,4097,qn(1)),qe(e,36),qe(e,53),qe(e,340),qe(e,337,A6(1)),qe(e,51,k6([[1,0]])),qe(e,338),qe(e,333),e.end()}function uv(){var e=[Rr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function D6(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Zt(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}var Ji=1024;function fv(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),o=[Ze("xml",null,{"xmlns:v":On.v,"xmlns:o":On.o,"xmlns:x":On.x,"xmlns:mv":On.mv}).replace(/\/>/,">"),Ze("o:shapelayout",Ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ze("v:shapetype",[Ze("v:stroke",null,{joinstyle:"miter"}),Ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Ji<e*1e3;)Ji+=1e3;return t.forEach(function(c){var d=Hr(c[0]),f={color2:"#BEFF82",type:"gradient"};f.type=="gradient"&&(f.angle="-180");var p=f.type=="gradient"?Ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ze("v:fill",p,f),x={on:"t",obscured:"t"};++Ji,o=o.concat(["<v:shape"+Al({id:"_x0000_s"+Ji,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(c[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ze("v:shadow",null,x),Ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Zr("x:Anchor",[d.c+1,0,d.r+1,0,d.c+3,20,d.r+5,20].join(",")),Zr("x:AutoFill","False"),Zr("x:Row",String(d.r)),Zr("x:Column",String(d.c)),c[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),o.push("</xml>"),o.join("")}function hv(e){var t=[Rr,Ze("comments",null,{xmlns:co[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(o){var c=Jt(o.a);r.indexOf(c)==-1&&(r.push(c),t.push("<author>"+c+"</author>")),o.T&&o.ID&&r.indexOf("tc="+o.ID)==-1&&(r.push("tc="+o.ID),t.push("<author>tc="+o.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var o=0,c=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?o=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(p){p.a&&(o=r.indexOf(Jt(p.a))),c.push(p.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+o+'"><text>'),c.length<=1)t.push(Zr("t",Jt(c[0]||"")));else{for(var d=`Comment:
    `+c[0]+`
`,f=1;f<c.length;++f)d+=`Reply:
    `+c[f]+`
`;t.push(Zr("t",Jt(d)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function N6(e,t,r){var a=[Rr,Ze("ThreadedComments",null,{xmlns:$r.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(o){var c="";(o[1]||[]).forEach(function(d,f){if(!d.T){delete d.ID;return}d.a&&t.indexOf(d.a)==-1&&t.push(d.a);var p={ref:o[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};f==0?c=p.id:p.parentId=c,d.ID=p.id,d.a&&(p.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(d.a)).slice(-12)+"}"),a.push(Ze("threadedComment",Zr("text",d.t||""),p))})}),a.push("</ThreadedComments>"),a.join("")}function O6(e){var t=[Rr,Ze("personList",null,{xmlns:$r.TCMNT,"xmlns:x":co[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function M6(e){var t={};t.iauthor=e.read_shift(4);var r=ri(e);return t.rfx=r.s,t.ref=Zt(r.s),e.l+=16,t}function B6(e,t){return t==null&&(t=Ie(36)),t.write_shift(4,e[1].iauthor),fo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var I6=on;function F6(e){return qr(e.slice(0,54))}function L6(e){var t=_n(),r=[];return qe(t,628),qe(t,630),e.forEach(function(a){a[1].forEach(function(o){r.indexOf(o.a)>-1||(r.push(o.a.slice(0,54)),qe(t,632,F6(o.a)))})}),qe(t,631),qe(t,633),e.forEach(function(a){a[1].forEach(function(o){o.iauthor=r.indexOf(o.a);var c={s:Hr(a[0]),e:Hr(a[0])};qe(t,635,B6([c,o])),o.t&&o.t.length>0&&qe(t,637,zk(o)),qe(t,636),delete o.iauthor})}),qe(t,634),qe(t,629),t.end()}function P6(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var o=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");o.slice(-1)!=="/"&&sr.utils.cfb_add(e,o,t.FileIndex[a].content)}})}var pv=["xlsb","xlsm","xlam","biff8","xla"],z6=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,o,c,d){var f=!1,p=!1;c.length==0?p=!0:c.charAt(0)=="["&&(p=!0,c=c.slice(1,-1)),d.length==0?f=!0:d.charAt(0)=="["&&(f=!0,d=d.slice(1,-1));var h=c.length>0?parseInt(c,10)|0:0,x=d.length>0?parseInt(d,10)|0:0;return f?x+=t.c:--x,p?h+=t.r:--h,o+(f?"":"$")+sn(x)+(p?"":"$")+en(h)}return function(o,c){return t=c,o.replace(e,r)}})(),fh=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,hh=(function(){return function(t,r){return t.replace(fh,function(a,o,c,d,f,p){var h=ih(d)-(c?0:r.c),x=sh(p)-(f?0:r.r),y=x==0?"":f?x+1:"["+x+"]",b=h==0?"":c?h+1:"["+h+"]";return o+"R"+y+"C"+b})}})();function U6(e,t){return e.replace(fh,function(r,a,o,c,d,f){return a+(o=="$"?o+c:sn(ih(c)+t.c))+(d=="$"?d+f:en(sh(f)+t.r))})}function W6(e){return e.length!=1}function Cr(e){e.l+=1}function _s(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function gv(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return xv(e);r.biff==12&&(a=4)}var o=e.read_shift(a),c=e.read_shift(a),d=_s(e),f=_s(e);return{s:{r:o,c:d[0],cRel:d[1],rRel:d[2]},e:{r:c,c:f[0],cRel:f[1],rRel:f[2]}}}function xv(e){var t=_s(e),r=_s(e),a=e.read_shift(1),o=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:o,cRel:r[1],rRel:r[2]}}}function $6(e,t,r){if(r.biff<8)return xv(e);var a=e.read_shift(r.biff==12?4:2),o=e.read_shift(r.biff==12?4:2),c=_s(e),d=_s(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:d[0],cRel:d[1],rRel:d[2]}}}function mv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return H6(e);var a=e.read_shift(r&&r.biff==12?4:2),o=_s(e);return{r:a,c:o[0],cRel:o[1],rRel:o[2]}}function H6(e){var t=_s(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function q6(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function G6(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return Y6(e);var o=e.read_shift(a>=12?4:2),c=e.read_shift(2),d=(c&16384)>>14,f=(c&32768)>>15;if(c&=16383,f==1)for(;o>524287;)o-=1048576;if(d==1)for(;c>8191;)c=c-16384;return{r:o,c,cRel:d,rRel:f}}function Y6(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,o=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),o==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:o,rRel:a}}function V6(e,t,r){var a=(e[e.l++]&96)>>5,o=gv(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,o]}function X6(e,t,r){var a=(e[e.l++]&96)>>5,o=e.read_shift(2,"i"),c=8;if(r)switch(r.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}var d=gv(e,c,r);return[a,o,d]}function K6(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Q6(e,t,r){var a=(e[e.l++]&96)>>5,o=e.read_shift(2),c=8;if(r)switch(r.biff){case 5:e.l+=12,c=6;break;case 12:c=12;break}return e.l+=c,[a,o]}function J6(e,t,r){var a=(e[e.l++]&96)>>5,o=$6(e,t-1,r);return[a,o]}function Z6(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function g1(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function ej(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),o=[],c=0;c<=a;++c)o.push(e.read_shift(r&&r.biff==2?1:2));return o}function tj(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function rj(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function nj(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function aj(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function yv(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function sj(e){return e.read_shift(2),yv(e)}function ij(e){return e.read_shift(2),yv(e)}function oj(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var o=mv(e,0,r);return[a,o]}function lj(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var o=G6(e,0,r);return[a,o]}function cj(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var c=mv(e,0,r);return[a,o,c]}function dj(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var o=e.read_shift(r&&r.biff<=3?1:2);return[dC[o],_v[o],a]}function uj(e,t,r){var a=e[e.l++],o=e.read_shift(1),c=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:fj(e);return[o,(c[0]===0?_v:cC)[c[1]]]}function fj(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function hj(e,t,r){e.l+=r&&r.biff==2?3:4}function pj(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),o=e.read_shift(r&&r.biff==2?1:2);return[a,o]}function gj(e){return e.l++,Pl[e.read_shift(1)]}function xj(e){return e.l++,e.read_shift(2)}function mj(e){return e.l++,e.read_shift(1)!==0}function yj(e){return e.l++,ho(e)}function vj(e,t,r){return e.l++,ev(e,t-1,r)}function bj(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=c8(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Pl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ho(e);break;case 2:r[1]=h8(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function _j(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),o=[],c=0;c!=a;++c)o.push((r.biff==12?ri:x8)(e));return o}function Sj(e,t,r){var a=0,o=0;r.biff==12?(a=e.read_shift(4),o=e.read_shift(4)):(o=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--o==0&&(o=256));for(var c=0,d=[];c!=a&&(d[c]=[]);++c)for(var f=0;f!=o;++f)d[c][f]=bj(e,r.biff);return d}function wj(e,t,r){var a=e.read_shift(1)>>>5&3,o=!r||r.biff>=8?4:2,c=e.read_shift(o);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,c]}function Tj(e,t,r){if(r.biff==5)return Ej(e);var a=e.read_shift(1)>>>5&3,o=e.read_shift(2),c=e.read_shift(4);return[a,o,c]}function Ej(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function kj(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var o=e.read_shift(r&&r.biff==2?1:2);return[a,o]}function jj(e,t,r){var a=e.read_shift(1)>>>5&3,o=e.read_shift(r&&r.biff==2?1:2);return[a,o]}function Cj(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function Aj(e,t,r){var a=(e[e.l++]&96)>>5,o=e.read_shift(2),c=4;if(r)switch(r.biff){case 5:c=15;break;case 12:c=6;break}return e.l+=c,[a,o]}var Rj=ga,Dj=ga,Nj=ga;function zl(e,t,r){return e.l+=2,[q6(e)]}function ph(e){return e.l+=6,[]}var Oj=zl,Mj=ph,Bj=ph,Ij=zl;function vv(e){return e.l+=2,[Jy(e),e.read_shift(2)&1]}var Fj=zl,Lj=vv,Pj=ph,zj=zl,Uj=zl,Wj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $j(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),o=e.read_shift(2),c=e.read_shift(2),d=Wj[r>>2&31];return{ixti:t,coltype:r&3,rt:d,idx:a,c:o,C:c}}function Hj(e){return e.l+=2,[e.read_shift(4)]}function qj(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Gj(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Yj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Vj(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Xj(e){return e.l+=4,[0,0]}var x1={1:{n:"PtgExp",f:pj},2:{n:"PtgTbl",f:Nj},3:{n:"PtgAdd",f:Cr},4:{n:"PtgSub",f:Cr},5:{n:"PtgMul",f:Cr},6:{n:"PtgDiv",f:Cr},7:{n:"PtgPower",f:Cr},8:{n:"PtgConcat",f:Cr},9:{n:"PtgLt",f:Cr},10:{n:"PtgLe",f:Cr},11:{n:"PtgEq",f:Cr},12:{n:"PtgGe",f:Cr},13:{n:"PtgGt",f:Cr},14:{n:"PtgNe",f:Cr},15:{n:"PtgIsect",f:Cr},16:{n:"PtgUnion",f:Cr},17:{n:"PtgRange",f:Cr},18:{n:"PtgUplus",f:Cr},19:{n:"PtgUminus",f:Cr},20:{n:"PtgPercent",f:Cr},21:{n:"PtgParen",f:Cr},22:{n:"PtgMissArg",f:Cr},23:{n:"PtgStr",f:vj},26:{n:"PtgSheet",f:qj},27:{n:"PtgEndSheet",f:Gj},28:{n:"PtgErr",f:gj},29:{n:"PtgBool",f:mj},30:{n:"PtgInt",f:xj},31:{n:"PtgNum",f:yj},32:{n:"PtgArray",f:Z6},33:{n:"PtgFunc",f:dj},34:{n:"PtgFuncVar",f:uj},35:{n:"PtgName",f:wj},36:{n:"PtgRef",f:oj},37:{n:"PtgArea",f:V6},38:{n:"PtgMemArea",f:kj},39:{n:"PtgMemErr",f:Rj},40:{n:"PtgMemNoMem",f:Dj},41:{n:"PtgMemFunc",f:jj},42:{n:"PtgRefErr",f:Cj},43:{n:"PtgAreaErr",f:K6},44:{n:"PtgRefN",f:lj},45:{n:"PtgAreaN",f:J6},46:{n:"PtgMemAreaN",f:Yj},47:{n:"PtgMemNoMemN",f:Vj},57:{n:"PtgNameX",f:Tj},58:{n:"PtgRef3d",f:cj},59:{n:"PtgArea3d",f:X6},60:{n:"PtgRefErr3d",f:Aj},61:{n:"PtgAreaErr3d",f:Q6},255:{}},Kj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Qj={1:{n:"PtgElfLel",f:vv},2:{n:"PtgElfRw",f:zj},3:{n:"PtgElfCol",f:Oj},6:{n:"PtgElfRwV",f:Uj},7:{n:"PtgElfColV",f:Ij},10:{n:"PtgElfRadical",f:Fj},11:{n:"PtgElfRadicalS",f:Pj},13:{n:"PtgElfColS",f:Mj},15:{n:"PtgElfColSV",f:Bj},16:{n:"PtgElfRadicalLel",f:Lj},25:{n:"PtgList",f:$j},29:{n:"PtgSxName",f:Hj},255:{}},Jj={0:{n:"PtgAttrNoop",f:Xj},1:{n:"PtgAttrSemi",f:aj},2:{n:"PtgAttrIf",f:rj},4:{n:"PtgAttrChoose",f:ej},8:{n:"PtgAttrGoto",f:tj},16:{n:"PtgAttrSum",f:hj},32:{n:"PtgAttrBaxcel",f:g1},33:{n:"PtgAttrBaxcel",f:g1},64:{n:"PtgAttrSpace",f:sj},65:{n:"PtgAttrSpaceSemi",f:ij},128:{n:"PtgAttrIfError",f:nj},255:{}};function Zj(e,t,r,a){if(a.biff<8)return ga(e,t);for(var o=e.l+t,c=[],d=0;d!==r.length;++d)switch(r[d][0]){case"PtgArray":r[d][1]=Sj(e,0,a),c.push(r[d][1]);break;case"PtgMemArea":r[d][2]=_j(e,r[d][1],a),c.push(r[d][2]);break;case"PtgExp":a&&a.biff==12&&(r[d][1][1]=e.read_shift(4),c.push(r[d][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[d][0]}return t=o-e.l,t!==0&&c.push(ga(e,t)),c}function eC(e,t,r){for(var a=e.l+t,o,c,d=[];a!=e.l;)t=a-e.l,c=e[e.l],o=x1[c]||x1[Kj[c]],(c===24||c===25)&&(o=(c===24?Qj:Jj)[e[e.l+1]]),!o||!o.f?ga(e,t):d.push([o.n,o.f(e,t,r)]);return d}function tC(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],o=[],c=0;c<a.length;++c){var d=a[c];if(d)switch(d[0]){case 2:o.push('"'+d[1].replace(/"/g,'""')+'"');break;default:o.push(d[1])}else o.push("")}t.push(o.join(","))}return t.join(";")}var rC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nC(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function bv(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var o="";if(r.biff>8)switch(e[a[0]][0]){case 357:return o=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?o:o+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return o=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?o:o+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(c){return c.Name}).join(";;");default:return e[a[0]][0][3]?(o=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?o:o+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function m1(e,t,r){var a=bv(e,t,r);return a=="#REF"?a:nC(a,r)}function ao(e,t,r,a,o){var c=o&&o.biff||8,d={s:{c:0,r:0}},f=[],p,h,x,y=0,b=0,v,w="";if(!e[0]||!e[0][0])return"";for(var _=-1,T="",M=0,F=e[0].length;M<F;++M){var A=e[0][M];switch(A[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(p=f.pop(),h=f.pop(),_>=0){switch(e[0][_][1][0]){case 0:T=_r(" ",e[0][_][1][1]);break;case 1:T=_r("\r",e[0][_][1][1]);break;default:if(T="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}h=h+T,_=-1}f.push(h+rC[A[0]]+p);break;case"PtgIsect":p=f.pop(),h=f.pop(),f.push(h+" "+p);break;case"PtgUnion":p=f.pop(),h=f.pop(),f.push(h+","+p);break;case"PtgRange":p=f.pop(),h=f.pop(),f.push(h+":"+p);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=bl(A[1][1],d,o),f.push(_l(x,c));break;case"PtgRefN":x=r?bl(A[1][1],r,o):A[1][1],f.push(_l(x,c));break;case"PtgRef3d":y=A[1][1],x=bl(A[1][2],d,o),w=m1(a,y,o),f.push(w+"!"+_l(x,c));break;case"PtgFunc":case"PtgFuncVar":var U=A[1][0],V=A[1][1];U||(U=0),U&=127;var te=U==0?[]:f.slice(-U);f.length-=U,V==="User"&&(V=te.shift()),f.push(V+"("+te.join(",")+")");break;case"PtgBool":f.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(A[1]);break;case"PtgNum":f.push(String(A[1]));break;case"PtgStr":f.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(A[1]);break;case"PtgAreaN":v=t1(A[1][1],r?{s:r}:d,o),f.push(c0(v,o));break;case"PtgArea":v=t1(A[1][1],d,o),f.push(c0(v,o));break;case"PtgArea3d":y=A[1][1],v=A[1][2],w=m1(a,y,o),f.push(w+"!"+c0(v,o));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":b=A[1][2];var N=(a.names||[])[b-1]||(a[0]||[])[b],re=N?N.Name:"SH33TJSNAME"+String(b);re&&re.slice(0,6)=="_xlfn."&&!o.xlfn&&(re=re.slice(6)),f.push(re);break;case"PtgNameX":var L=A[1][1];b=A[1][2];var X;if(o.biff<=5)L<0&&(L=-L),a[L]&&(X=a[L][b]);else{var le="";if(((a[L]||[])[0]||[])[0]==14849||(((a[L]||[])[0]||[])[0]==1025?a[L][b]&&a[L][b].itab>0&&(le=a.SheetNames[a[L][b].itab-1]+"!"):le=a.SheetNames[b-1]+"!"),a[L]&&a[L][b])le+=a[L][b].Name;else if(a[0]&&a[0][b])le+=a[0][b].Name;else{var ge=(bv(a,L,o)||"").split(";;");ge[b-1]?le=ge[b-1]:le+="SH33TJSERRX"}f.push(le);break}X||(X={Name:"SH33TJSERRY"}),f.push(X.Name);break;case"PtgParen":var Re="(",fe=")";if(_>=0){switch(T="",e[0][_][1][0]){case 2:Re=_r(" ",e[0][_][1][1])+Re;break;case 3:Re=_r("\r",e[0][_][1][1])+Re;break;case 4:fe=_r(" ",e[0][_][1][1])+fe;break;case 5:fe=_r("\r",e[0][_][1][1])+fe;break;default:if(o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}f.push(Re+f.pop()+fe);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":x={c:A[1][1],r:A[1][0]};var Ae={c:r.c,r:r.r};if(a.sharedf[Zt(x)]){var ee=a.sharedf[Zt(x)];f.push(ao(ee,d,Ae,a,o))}else{var ye=!1;for(p=0;p!=a.arrayf.length;++p)if(h=a.arrayf[p],!(x.c<h[0].s.c||x.c>h[0].e.c)&&!(x.r<h[0].s.r||x.r>h[0].e.r)){f.push(ao(h[1],d,Ae,a,o)),ye=!0;break}ye||f.push(A[1])}break;case"PtgArray":f.push("{"+tC(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=M;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var ae=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(o.biff!=3&&_>=0&&ae.indexOf(e[0][M][0])==-1){A=e[0][_];var Se=!0;switch(A[1][0]){case 4:Se=!1;case 0:T=_r(" ",A[1][1]);break;case 5:Se=!1;case 1:T=_r("\r",A[1][1]);break;default:if(T="",o.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}f.push((Se?T:"")+f.pop()+(Se?"":T)),_=-1}}if(f.length>1&&o.WTF)throw new Error("bad formula stack");return f[0]}function aC(e){if(e==null){var t=Ie(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Vs(e);return Vs(0)}function sC(e,t,r,a,o){var c=Xs(t,r,o),d=aC(e.v),f=Ie(6),p=33;f.write_shift(2,p),f.write_shift(4,0);for(var h=Ie(e.bf.length),x=0;x<e.bf.length;++x)h[x]=e.bf[x];var y=Jr([c,d,f,h]);return y}function Fd(e,t,r){var a=e.read_shift(4),o=eC(e,a,r),c=e.read_shift(4),d=c>0?Zj(e,c,o,r):null;return[o,d]}var iC=Fd,Ld=Fd,oC=Fd,lC=Fd,cC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_v={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uC(e){var t="of:="+e.replace(fh,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function fC(e){return e.replace(/\./,"!")}var Sl=typeof Map<"u";function gh(e,t,r){var a=0,o=e.length;if(r){if(Sl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var c=Sl?r.get(t):r[t];a<c.length;++a)if(e[c[a]].t===t)return e.Count++,c[a]}}else for(;a<o;++a)if(e[a].t===t)return e.Count++,a;return e[o]={t},e.Count++,e.Unique++,r&&(Sl?(r.has(t)||r.set(t,[]),r.get(t).push(o)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(o))),o}function Pd(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Ua=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=Ed(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=O0(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Sv(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ts(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],o=60,c=e.length;if(a==null&&r.ssf){for(;o<392;++o)if(r.ssf[o]==null){my(t.z,o),r.ssf[o]=t.z,r.revssf[t.z]=a=o;break}}for(o=0;o!=c;++o)if(e[o].numFmtId===a)return o;return e[c]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},c}function hC(e,t,r){if(e&&e["!ref"]){var a=ur(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function pC(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ar(e[r])+'"/>';return t+"</mergeCells>"}function gC(e,t,r,a,o){var c=!1,d={},f=null;if(a.bookType!=="xlsx"&&t.vbaraw){var p=t.SheetNames[r];try{t.Workbook&&(p=t.Workbook.Sheets[r].CodeName||p)}catch{}c=!0,d.codeName=Cl(Jt(p))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),f=(f||"")+Ze("outlinePr",null,h)}!c&&!f||(o[o.length]=Ze("sheetPr",f,d))}var xC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],mC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yC(e){var t={sheet:1};return xC.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),mC.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=sv(e.password).toString(16).toUpperCase()),Ze("sheetProtection",null,t)}function vC(e){return Sv(e),Ze("pageMargins",null,e)}function bC(e,t){for(var r=["<cols>"],a,o=0;o!=t.length;++o)(a=t[o])&&(r[r.length]=Ze("col",null,Pd(o,a)));return r[r.length]="</cols>",r.join("")}function _C(e,t,r,a){var o=typeof e.ref=="string"?e.ref:Ar(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var c=r.Workbook.Names,d=Bn(o);d.s.r==d.e.r&&(d.e.r=Bn(t["!ref"]).e.r,o=Ar(d));for(var f=0;f<c.length;++f){var p=c[f];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==a){p.Ref="'"+r.SheetNames[a]+"'!"+o;break}}return f==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+o}),Ze("autoFilter",null,{ref:o})}function SC(e,t,r,a){var o={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(o.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ze("sheetViews",Ze("sheetView",null,o),{})}function wC(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var o="",c=e.t,d=e.v;if(e.t!=="z")switch(e.t){case"b":o=e.v?"1":"0";break;case"n":o=""+e.v;break;case"e":o=Pl[e.v];break;case"d":a&&a.cellDates?o=pn(e.v,-1).toISOString():(e=wn(e),e.t="n",o=""+(e.v=Sn(pn(e.v)))),typeof e.z>"u"&&(e.z=Sr[14]);break;default:o=e.v;break}var f=Zr("v",Jt(o)),p={r:t},h=Ts(a.cellXfs,e,a);switch(h!==0&&(p.s=h),e.t){case"n":break;case"d":p.t="d";break;case"b":p.t="b";break;case"e":p.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){f=Zr("v",""+gh(a.Strings,e.v,a.revStrings)),p.t="s";break}p.t="str";break}if(e.t!=c&&(e.t=c,e.v=d),typeof e.f=="string"&&e.f){var x=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;f=Ze("f",Jt(e.f),x)+(e.v!=null?f:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(p.cm=1),Ze("c",f,p)}function TC(e,t,r,a){var o=[],c=[],d=ur(e["!ref"]),f="",p,h="",x=[],y=0,b=0,v=e["!rows"],w=Array.isArray(e),_={r:h},T,M=-1;for(b=d.s.c;b<=d.e.c;++b)x[b]=sn(b);for(y=d.s.r;y<=d.e.r;++y){for(c=[],h=en(y),b=d.s.c;b<=d.e.c;++b){p=x[b]+h;var F=w?(e[y]||[])[b]:e[p];F!==void 0&&(f=wC(F,p,e,t))!=null&&c.push(f)}(c.length>0||v&&v[y])&&(_={r:h},v&&v[y]&&(T=v[y],T.hidden&&(_.hidden=1),M=-1,T.hpx?M=kd(T.hpx):T.hpt&&(M=T.hpt),M>-1&&(_.ht=M,_.customHeight=1),T.level&&(_.outlineLevel=T.level)),o[o.length]=Ze("row",c.join(""),_))}if(v)for(;y<v.length;++y)v&&v[y]&&(_={r:y+1},T=v[y],T.hidden&&(_.hidden=1),M=-1,T.hpx?M=kd(T.hpx):T.hpt&&(M=T.hpt),M>-1&&(_.ht=M,_.customHeight=1),T.level&&(_.outlineLevel=T.level),o[o.length]=Ze("row","",_));return o.join("")}function wv(e,t,r,a){var o=[Rr,Ze("worksheet",null,{xmlns:co[0],"xmlns:r":$r.r})],c=r.SheetNames[e],d=0,f="",p=r.Sheets[c];p==null&&(p={});var h=p["!ref"]||"A1",x=ur(h);if(x.e.c>16383||x.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");x.e.c=Math.min(x.e.c,16383),x.e.r=Math.min(x.e.c,1048575),h=Ar(x)}a||(a={}),p["!comments"]=[];var y=[];gC(p,r,e,t,o),o[o.length]=Ze("dimension",null,{ref:h}),o[o.length]=SC(p,t,e,r),t.sheetFormat&&(o[o.length]=Ze("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),p["!cols"]!=null&&p["!cols"].length>0&&(o[o.length]=bC(p,p["!cols"])),o[d=o.length]="<sheetData/>",p["!links"]=[],p["!ref"]!=null&&(f=TC(p,t),f.length>0&&(o[o.length]=f)),o.length>d+1&&(o[o.length]="</sheetData>",o[d]=o[d].replace("/>",">")),p["!protect"]&&(o[o.length]=yC(p["!protect"])),p["!autofilter"]!=null&&(o[o.length]=_C(p["!autofilter"],p,r,e)),p["!merges"]!=null&&p["!merges"].length>0&&(o[o.length]=pC(p["!merges"]));var b=-1,v,w=-1;return p["!links"].length>0&&(o[o.length]="<hyperlinks>",p["!links"].forEach(function(_){_[1].Target&&(v={ref:_[0]},_[1].Target.charAt(0)!="#"&&(w=Qt(a,-1,Jt(_[1].Target).replace(/#.*$/,""),Wt.HLINK),v["r:id"]="rId"+w),(b=_[1].Target.indexOf("#"))>-1&&(v.location=Jt(_[1].Target.slice(b+1))),_[1].Tooltip&&(v.tooltip=Jt(_[1].Tooltip)),o[o.length]=Ze("hyperlink",null,v))}),o[o.length]="</hyperlinks>"),delete p["!links"],p["!margins"]!=null&&(o[o.length]=vC(p["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(o[o.length]=Zr("ignoredErrors",Ze("ignoredError",null,{numberStoredAsText:1,sqref:h}))),y.length>0&&(w=Qt(a,-1,"../drawings/drawing"+(e+1)+".xml",Wt.DRAW),o[o.length]=Ze("drawing",null,{"r:id":"rId"+w}),p["!drawing"]=y),p["!comments"].length>0&&(w=Qt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Wt.VML),o[o.length]=Ze("legacyDrawing",null,{"r:id":"rId"+w}),p["!legacy"]=w),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function EC(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var o=e.read_shift(2);e.l+=1;var c=e.read_shift(1);return e.l=a,c&7&&(r.level=c&7),c&16&&(r.hidden=!0),c&32&&(r.hpt=o/20),r}function kC(e,t,r){var a=Ie(145),o=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var c=320;o.hpx?c=kd(o.hpx)*20:o.hpt&&(c=o.hpt*20),a.write_shift(2,c),a.write_shift(1,0);var d=0;o.level&&(d|=o.level),o.hidden&&(d|=16),(o.hpx||o.hpt)&&(d|=32),a.write_shift(1,d),a.write_shift(1,0);var f=0,p=a.l;a.l+=4;for(var h={r:e,c:0},x=0;x<16;++x)if(!(t.s.c>x+1<<10||t.e.c<x<<10)){for(var y=-1,b=-1,v=x<<10;v<x+1<<10;++v){h.c=v;var w=Array.isArray(r)?(r[h.r]||[])[h.c]:r[Zt(h)];w&&(y<0&&(y=v),b=v)}y<0||(++f,a.write_shift(4,y),a.write_shift(4,b))}var _=a.l;return a.l=p,a.write_shift(4,f),a.l=_,a.length>a.l?a.slice(0,a.l):a}function jC(e,t,r,a){var o=kC(a,r,t);(o.length>17||(t["!rows"]||[])[a])&&qe(e,0,o)}var CC=ri,AC=fo;function RC(){}function DC(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=Uk(e),r}function NC(e,t,r){r==null&&(r=Ie(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var o=1;o<3;++o)r.write_shift(1,0);return Sd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Ly(e,r),r.slice(0,r.l)}function OC(e){var t=Yn(e);return[t]}function MC(e,t,r){return r==null&&(r=Ie(8)),Zs(t,r)}function BC(e){var t=ei(e);return[t]}function IC(e,t,r){return r==null&&(r=Ie(4)),ti(t,r)}function FC(e){var t=Yn(e),r=e.read_shift(1);return[t,r,"b"]}function LC(e,t,r){return r==null&&(r=Ie(9)),Zs(t,r),r.write_shift(1,e.v?1:0),r}function PC(e){var t=ei(e),r=e.read_shift(1);return[t,r,"b"]}function zC(e,t,r){return r==null&&(r=Ie(5)),ti(t,r),r.write_shift(1,e.v?1:0),r}function UC(e){var t=Yn(e),r=e.read_shift(1);return[t,r,"e"]}function WC(e,t,r){return r==null&&(r=Ie(9)),Zs(t,r),r.write_shift(1,e.v),r}function $C(e){var t=ei(e),r=e.read_shift(1);return[t,r,"e"]}function HC(e,t,r){return r==null&&(r=Ie(8)),ti(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function qC(e){var t=Yn(e),r=e.read_shift(4);return[t,r,"s"]}function GC(e,t,r){return r==null&&(r=Ie(12)),Zs(t,r),r.write_shift(4,t.v),r}function YC(e){var t=ei(e),r=e.read_shift(4);return[t,r,"s"]}function VC(e,t,r){return r==null&&(r=Ie(8)),ti(t,r),r.write_shift(4,t.v),r}function XC(e){var t=Yn(e),r=ho(e);return[t,r,"n"]}function KC(e,t,r){return r==null&&(r=Ie(16)),Zs(t,r),Vs(e.v,r),r}function QC(e){var t=ei(e),r=ho(e);return[t,r,"n"]}function JC(e,t,r){return r==null&&(r=Ie(12)),ti(t,r),Vs(e.v,r),r}function ZC(e){var t=Yn(e),r=Py(e);return[t,r,"n"]}function eA(e,t,r){return r==null&&(r=Ie(12)),Zs(t,r),zy(e.v,r),r}function tA(e){var t=ei(e),r=Py(e);return[t,r,"n"]}function rA(e,t,r){return r==null&&(r=Ie(8)),ti(t,r),zy(e.v,r),r}function nA(e){var t=Yn(e),r=oh(e);return[t,r,"is"]}function aA(e){var t=Yn(e),r=on(e);return[t,r,"str"]}function sA(e,t,r){return r==null&&(r=Ie(12+4*e.v.length)),Zs(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function iA(e){var t=ei(e),r=on(e);return[t,r,"str"]}function oA(e,t,r){return r==null&&(r=Ie(8+4*e.v.length)),ti(t,r),qr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function lA(e,t,r){var a=e.l+t,o=Yn(e);o.r=r["!row"];var c=e.read_shift(1),d=[o,c,"b"];if(r.cellFormula){e.l+=2;var f=Ld(e,a-e.l,r);d[3]=ao(f,null,o,r.supbooks,r)}else e.l=a;return d}function cA(e,t,r){var a=e.l+t,o=Yn(e);o.r=r["!row"];var c=e.read_shift(1),d=[o,c,"e"];if(r.cellFormula){e.l+=2;var f=Ld(e,a-e.l,r);d[3]=ao(f,null,o,r.supbooks,r)}else e.l=a;return d}function dA(e,t,r){var a=e.l+t,o=Yn(e);o.r=r["!row"];var c=ho(e),d=[o,c,"n"];if(r.cellFormula){e.l+=2;var f=Ld(e,a-e.l,r);d[3]=ao(f,null,o,r.supbooks,r)}else e.l=a;return d}function uA(e,t,r){var a=e.l+t,o=Yn(e);o.r=r["!row"];var c=on(e),d=[o,c,"str"];if(r.cellFormula){e.l+=2;var f=Ld(e,a-e.l,r);d[3]=ao(f,null,o,r.supbooks,r)}else e.l=a;return d}var fA=ri,hA=fo;function pA(e,t){return t==null&&(t=Ie(4)),t.write_shift(4,e),t}function gA(e,t){var r=e.l+t,a=ri(e),o=lh(e),c=on(e),d=on(e),f=on(e);e.l=r;var p={rfx:a,relId:o,loc:c,display:f};return d&&(p.Tooltip=d),p}function xA(e,t){var r=Ie(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));fo({s:Hr(e[0]),e:Hr(e[0])},r),ch("rId"+t,r);var a=e[1].Target.indexOf("#"),o=a==-1?"":e[1].Target.slice(a+1);return qr(o||"",r),qr(e[1].Tooltip||"",r),qr("",r),r.slice(0,r.l)}function mA(){}function yA(e,t,r){var a=e.l+t,o=Uy(e),c=e.read_shift(1),d=[o];if(d[2]=c,r.cellFormula){var f=iC(e,a-e.l,r);d[1]=f}else e.l=a;return d}function vA(e,t,r){var a=e.l+t,o=ri(e),c=[o];if(r.cellFormula){var d=lC(e,a-e.l,r);c[1]=d,e.l=a}else e.l=a;return c}function bA(e,t,r){r==null&&(r=Ie(18));var a=Pd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var o=0;return t.hidden&&(o|=1),typeof a.width=="number"&&(o|=2),t.level&&(o|=t.level<<8),r.write_shift(2,o),r}var Tv=["left","right","top","bottom","header","footer"];function _A(e){var t={};return Tv.forEach(function(r){t[r]=ho(e)}),t}function SA(e,t){return t==null&&(t=Ie(48)),Sv(e),Tv.forEach(function(r){Vs(e[r],t)}),t}function wA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function TA(e,t,r){r==null&&(r=Ie(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function EA(e){var t=Ie(24);return t.write_shift(4,4),t.write_shift(4,1),fo(e,t),t}function kA(e,t){return t==null&&(t=Ie(66)),t.write_shift(2,e.password?sv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function jA(){}function CA(){}function AA(e,t,r,a,o,c,d){if(t.v===void 0)return!1;var f="";switch(t.t){case"b":f=t.v?"1":"0";break;case"d":t=wn(t),t.z=t.z||Sr[14],t.v=Sn(pn(t.v)),t.t="n";break;case"n":case"e":f=""+t.v;break;default:f=t.v;break}var p={r,c:a};switch(p.s=Ts(o.cellXfs,t,o),t.l&&c["!links"].push([Zt(p),t.l]),t.c&&c["!comments"].push([Zt(p),t.c]),t.t){case"s":case"str":return o.bookSST?(f=gh(o.Strings,t.v,o.revStrings),p.t="s",p.v=f,d?qe(e,18,VC(t,p)):qe(e,7,GC(t,p))):(p.t="str",d?qe(e,17,oA(t,p)):qe(e,6,sA(t,p))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?d?qe(e,13,rA(t,p)):qe(e,2,eA(t,p)):d?qe(e,16,JC(t,p)):qe(e,5,KC(t,p)),!0;case"b":return p.t="b",d?qe(e,15,zC(t,p)):qe(e,4,LC(t,p)),!0;case"e":return p.t="e",d?qe(e,14,HC(t,p)):qe(e,3,WC(t,p)),!0}return d?qe(e,12,IC(t,p)):qe(e,1,MC(t,p)),!0}function RA(e,t,r,a){var o=ur(t["!ref"]||"A1"),c,d="",f=[];qe(e,145);var p=Array.isArray(t),h=o.e.r;t["!rows"]&&(h=Math.max(o.e.r,t["!rows"].length-1));for(var x=o.s.r;x<=h;++x){d=en(x),jC(e,t,o,x);var y=!1;if(x<=o.e.r)for(var b=o.s.c;b<=o.e.c;++b){x===o.s.r&&(f[b]=sn(b)),c=f[b]+d;var v=p?(t[x]||[])[b]:t[c];if(!v){y=!1;continue}y=AA(e,v,x,b,a,t,y)}}qe(e,146)}function DA(e,t){!t||!t["!merges"]||(qe(e,177,pA(t["!merges"].length)),t["!merges"].forEach(function(r){qe(e,176,hA(r))}),qe(e,178))}function NA(e,t){!t||!t["!cols"]||(qe(e,390),t["!cols"].forEach(function(r,a){r&&qe(e,60,bA(a,r))}),qe(e,391))}function OA(e,t){!t||!t["!ref"]||(qe(e,648),qe(e,649,EA(ur(t["!ref"]))),qe(e,650))}function MA(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var o=Qt(r,-1,a[1].Target.replace(/#.*$/,""),Wt.HLINK);qe(e,494,xA(a,o))}}),delete t["!links"]}function BA(e,t,r,a){if(t["!comments"].length>0){var o=Qt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Wt.VML);qe(e,551,ch("rId"+o)),t["!legacy"]=o}}function IA(e,t,r,a){if(t["!autofilter"]){var o=t["!autofilter"],c=typeof o.ref=="string"?o.ref:Ar(o.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var d=r.Workbook.Names,f=Bn(c);f.s.r==f.e.r&&(f.e.r=Bn(t["!ref"]).e.r,c=Ar(f));for(var p=0;p<d.length;++p){var h=d[p];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+c;break}}p==d.length&&d.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+c}),qe(e,161,fo(ur(c))),qe(e,162)}}function FA(e,t,r){qe(e,133),qe(e,137,TA(t,r)),qe(e,138),qe(e,134)}function LA(e,t){t["!protect"]&&qe(e,535,kA(t["!protect"]))}function PA(e,t,r,a){var o=_n(),c=r.SheetNames[e],d=r.Sheets[c]||{},f=c;try{r&&r.Workbook&&(f=r.Workbook.Sheets[e].CodeName||f)}catch{}var p=ur(d["!ref"]||"A1");if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+(d["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575)}return d["!links"]=[],d["!comments"]=[],qe(o,129),(r.vbaraw||d["!outline"])&&qe(o,147,NC(f,d["!outline"])),qe(o,148,AC(p)),FA(o,d,r.Workbook),NA(o,d),RA(o,d,e,t),LA(o,d),IA(o,d,r,e),DA(o,d),MA(o,d,a),d["!margins"]&&qe(o,476,SA(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&OA(o,d),BA(o,d,e,a),qe(o,130),o.end()}function zA(e,t){e.l+=10;var r=on(e);return{name:r}}var UA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function WA(e){return!e.Workbook||!e.Workbook.WBProps?"false":vk(e.Workbook.WBProps.date1904)?"true":"false"}var $A="][*?/\\".split("");function Ev(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $A.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function HA(e,t,r){e.forEach(function(a,o){Ev(a);for(var c=0;c<o;++c)if(a==e[c])throw new Error("Duplicate Sheet Name: "+a);if(r){var d=t&&t[o]&&t[o].CodeName||a;if(d.charCodeAt(0)==95&&d.length>22)throw new Error("Bad Code Name: Worksheet"+d)}})}function qA(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];HA(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)hC(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function kv(e){var t=[Rr];t[t.length]=Ze("workbook",null,{xmlns:co[0],"xmlns:r":$r.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(UA.forEach(function(f){e.Workbook.WBProps[f[0]]!=null&&e.Workbook.WBProps[f[0]]!=f[1]&&(a[f[0]]=e.Workbook.WBProps[f[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Ze("workbookPr",null,a);var o=e.Workbook&&e.Workbook.Sheets||[],c=0;if(o&&o[0]&&o[0].Hidden){for(t[t.length]="<bookViews>",c=0;c!=e.SheetNames.length&&!(!o[c]||!o[c].Hidden);++c);c==e.SheetNames.length&&(c=0),t[t.length]='<workbookView firstSheet="'+c+'" activeTab="'+c+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",c=0;c!=e.SheetNames.length;++c){var d={name:Jt(e.SheetNames[c].slice(0,31))};if(d.sheetId=""+(c+1),d["r:id"]="rId"+(c+1),o[c])switch(o[c].Hidden){case 1:d.state="hidden";break;case 2:d.state="veryHidden";break}t[t.length]=Ze("sheet",null,d)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(f){var p={name:f.Name};f.Comment&&(p.comment=f.Comment),f.Sheet!=null&&(p.localSheetId=""+f.Sheet),f.Hidden&&(p.hidden="1"),f.Ref&&(t[t.length]=Ze("definedName",Jt(f.Ref),p))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function GA(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=N0(e),r.name=on(e),r}function YA(e,t){return t||(t=Ie(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ch(e.strRelID,t),qr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function VA(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var o=t>8?on(e):"";return o.length>0&&(r.CodeName=o),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function XA(e,t){t||(t=Ie(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Ly(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function KA(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var o=e.read_shift(4),c=Wk(e),d=oC(e,0,r),f=lh(e);e.l=a;var p={Name:c,Ptg:d};return o<268435455&&(p.Sheet=o),f&&(p.Comment=f),p}function QA(e,t){qe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,o={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};qe(e,156,YA(o))}qe(e,144)}function JA(e,t){t||(t=Ie(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return qr("SheetJS",t),qr(pd.version,t),qr(pd.version,t),qr("7262",t),t.length>t.l?t.slice(0,t.l):t}function ZA(e,t){t||(t=Ie(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function e5(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,o=-1,c=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&o==-1?o=a:r[a].Hidden==1&&c==-1&&(c=a);c>o||(qe(e,135),qe(e,158,ZA(o)),qe(e,136))}}function t5(e,t){var r=_n();return qe(r,131),qe(r,128,JA()),qe(r,153,XA(e.Workbook&&e.Workbook.WBProps||null)),e5(r,e),QA(r,e),qe(r,132),r.end()}function r5(e,t,r){return(t.slice(-4)===".bin"?t5:kv)(e)}function n5(e,t,r,a,o){return(t.slice(-4)===".bin"?PA:wv)(e,r,a,o)}function a5(e,t,r){return(t.slice(-4)===".bin"?S6:lv)(e,r)}function s5(e,t,r){return(t.slice(-4)===".bin"?X8:av)(e,r)}function i5(e,t,r){return(t.slice(-4)===".bin"?L6:hv)(e)}function o5(e){return(e.slice(-4)===".bin"?R6:uv)()}function l5(e,t){var r=[];return e.Props&&r.push(a8(e.Props,t)),e.Custprops&&r.push(s8(e.Props,e.Custprops)),r.join("")}function c5(){return""}function d5(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,o){var c=[];c.push(Ze("NumberFormat",null,{"ss:Format":Jt(Sr[a.numFmtId])}));var d={"ss:ID":"s"+(21+o)};r.push(Ze("Style",c.join(""),d))}),Ze("Styles",r.join(""))}function jv(e){return Ze("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+hh(e.Ref,{r:0,c:0})})}function u5(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var o=t[a];o.Sheet==null&&(o.Name.match(/^_xlfn\./)||r.push(jv(o)))}return Ze("Names",r.join(""))}function f5(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var o=a.Workbook.Names,c=[],d=0;d<o.length;++d){var f=o[d];f.Sheet==r&&(f.Name.match(/^_xlfn\./)||c.push(jv(f)))}return c.join("")}function h5(e,t,r,a){if(!e)return"";var o=[];if(e["!margins"]&&(o.push("<PageSetup>"),e["!margins"].header&&o.push(Ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&o.push(Ze("Footer",null,{"x:Margin":e["!margins"].footer})),o.push(Ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),o.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)o.push(Ze("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var c=0;c<r&&!(a.Workbook.Sheets[c]&&!a.Workbook.Sheets[c].Hidden);++c);c==r&&o.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&o.push("<DisplayRightToLeft/>"),e["!protect"]&&(o.push(Zr("ProtectContents","True")),e["!protect"].objects&&o.push(Zr("ProtectObjects","True")),e["!protect"].scenarios&&o.push(Zr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?o.push(Zr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&o.push(Zr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(d){e["!protect"][d[0]]&&o.push("<"+d[1]+"/>")})),o.length==0?"":Ze("WorksheetOptions",o.join(""),{xmlns:On.x})}function p5(e){return e.map(function(t){var r=yk(t.t||""),a=Ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ze("Comment",a,{"ss:Author":t.a})}).join("")}function g5(e,t,r,a,o,c,d){if(!e||e.v==null&&e.f==null)return"";var f={};if(e.f&&(f["ss:Formula"]="="+Jt(hh(e.f,d))),e.F&&e.F.slice(0,t.length)==t){var p=Hr(e.F.slice(t.length+1));f["ss:ArrayRange"]="RC:R"+(p.r==d.r?"":"["+(p.r-d.r)+"]")+"C"+(p.c==d.c?"":"["+(p.c-d.c)+"]")}if(e.l&&e.l.Target&&(f["ss:HRef"]=Jt(e.l.Target),e.l.Tooltip&&(f["x:HRefScreenTip"]=Jt(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],x=0;x!=h.length;++x)h[x].s.c!=d.c||h[x].s.r!=d.r||(h[x].e.c>h[x].s.c&&(f["ss:MergeAcross"]=h[x].e.c-h[x].s.c),h[x].e.r>h[x].s.r&&(f["ss:MergeDown"]=h[x].e.r-h[x].s.r));var y="",b="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":y="Number",b=String(e.v);break;case"b":y="Boolean",b=e.v?"1":"0";break;case"e":y="Error",b=Pl[e.v];break;case"d":y="DateTime",b=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Sr[14]);break;case"s":y="String",b=mk(e.v||"");break}var v=Ts(a.cellXfs,e,a);f["ss:StyleID"]="s"+(21+v),f["ss:Index"]=d.c+1;var w=e.v!=null?b:"",_=e.t=="z"?"":'<Data ss:Type="'+y+'">'+w+"</Data>";return(e.c||[]).length>0&&(_+=p5(e.c)),Ze("Cell",_,f)}function x5(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ov(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function m5(e,t,r,a){if(!e["!ref"])return"";var o=ur(e["!ref"]),c=e["!merges"]||[],d=0,f=[];e["!cols"]&&e["!cols"].forEach(function(T,M){uh(T);var F=!!T.width,A=Pd(M,T),U={"ss:Index":M+1};F&&(U["ss:Width"]=Td(A.width)),T.hidden&&(U["ss:Hidden"]="1"),f.push(Ze("Column",null,U))});for(var p=Array.isArray(e),h=o.s.r;h<=o.e.r;++h){for(var x=[x5(h,(e["!rows"]||[])[h])],y=o.s.c;y<=o.e.c;++y){var b=!1;for(d=0;d!=c.length;++d)if(!(c[d].s.c>y)&&!(c[d].s.r>h)&&!(c[d].e.c<y)&&!(c[d].e.r<h)){(c[d].s.c!=y||c[d].s.r!=h)&&(b=!0);break}if(!b){var v={r:h,c:y},w=Zt(v),_=p?(e[h]||[])[y]:e[w];x.push(g5(_,w,e,t,r,a,v))}}x.push("</Row>"),x.length>2&&f.push(x.join(""))}return f.join("")}function y5(e,t,r){var a=[],o=r.SheetNames[e],c=r.Sheets[o],d=c?f5(c,t,e,r):"";return d.length>0&&a.push("<Names>"+d+"</Names>"),d=c?m5(c,t,e,r):"",d.length>0&&a.push("<Table>"+d+"</Table>"),a.push(h5(c,t,e,r)),a.join("")}function v5(e,t){t||(t={}),e.SSF||(e.SSF=wn(Sr)),e.SSF&&(Md(),Od(e.SSF),t.revssf=Bd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ts(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(l5(e,t)),r.push(c5()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Ze("Worksheet",y5(a,t,e),{"ss:Name":Jt(e.SheetNames[a])}));return r[2]=d5(e,t),r[3]=u5(e),Rr+Ze("Workbook",r.join(""),{xmlns:On.ss,"xmlns:o":On.o,"xmlns:x":On.x,"xmlns:ss":On.ss,"xmlns:dt":On.dt,"xmlns:html":On.html})}var f0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function b5(e,t){var r=[],a=[],o=[],c=0,d,f=Hm(n1,"n"),p=Hm(a1,"n");if(e.Props)for(d=tn(e.Props),c=0;c<d.length;++c)(Object.prototype.hasOwnProperty.call(f,d[c])?r:Object.prototype.hasOwnProperty.call(p,d[c])?a:o).push([d[c],e.Props[d[c]]]);if(e.Custprops)for(d=tn(e.Custprops),c=0;c<d.length;++c)Object.prototype.hasOwnProperty.call(e.Props||{},d[c])||(Object.prototype.hasOwnProperty.call(f,d[c])?r:Object.prototype.hasOwnProperty.call(p,d[c])?a:o).push([d[c],e.Custprops[d[c]]]);var h=[];for(c=0;c<o.length;++c)Qy.indexOf(o[c][0])>-1||Vy.indexOf(o[c][0])>-1||o[c][1]!=null&&h.push(o[c]);a.length&&sr.utils.cfb_add(t,"/SummaryInformation",c1(a,f0.SI,p,a1)),(r.length||h.length)&&sr.utils.cfb_add(t,"/DocumentSummaryInformation",c1(r,f0.DSI,f,n1,h.length?h:null,f0.UDI))}function _5(e,t){var r=t||{},a=sr.utils.cfb_new({root:"R"}),o="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":o="/Workbook",r.biff=8;break;case"biff5":o="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return sr.utils.cfb_add(a,o,Cv(e,r)),r.biff==8&&(e.Props||e.Custprops)&&b5(e,a),r.biff==8&&e.vbaraw&&P6(a,sr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var S5={0:{f:EC},1:{f:OC},2:{f:ZC},3:{f:UC},4:{f:FC},5:{f:XC},6:{f:aA},7:{f:qC},8:{f:uA},9:{f:dA},10:{f:lA},11:{f:cA},12:{f:BC},13:{f:tA},14:{f:$C},15:{f:PC},16:{f:QC},17:{f:iA},18:{f:YC},19:{f:oh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:KA},40:{},42:{},43:{f:a6},44:{f:r6},45:{f:o6},46:{f:c6},47:{f:l6},48:{},49:{f:Bk},50:{},51:{f:E6},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:I8},62:{f:nA},63:{f:D6},64:{f:jA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ga,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:wA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:DC},148:{f:CC,p:16},151:{f:mA},152:{},153:{f:VA},154:{},155:{},156:{f:GA},157:{},158:{},159:{T:1,f:G8},160:{T:-1},161:{T:1,f:ri},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fA},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:w6},336:{T:-1},337:{f:C6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:N0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:R8},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:yA},427:{f:vA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_A},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:RC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:gA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:N0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:I6},633:{T:1},634:{T:-1},635:{T:1,f:M6},636:{T:-1},637:{f:Pk},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:zA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:CA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function et(e,t,r,a){var o=t;if(!isNaN(o)){var c=a||(r||[]).length||0,d=e.next(4);d.write_shift(2,o),d.write_shift(2,c),c>0&&ah(r)&&e.push(r)}}function w5(e,t,r,a){var o=(r||[]).length||0;if(o<=8224)return et(e,t,r,o);var c=t;if(!isNaN(c)){for(var d=r.parts||[],f=0,p=0,h=0;h+(d[f]||8224)<=8224;)h+=d[f]||8224,f++;var x=e.next(4);for(x.write_shift(2,c),x.write_shift(2,h),e.push(r.slice(p,p+h)),p+=h;p<o;){for(x=e.next(4),x.write_shift(2,60),h=0;h+(d[f]||8224)<=8224;)h+=d[f]||8224,f++;x.write_shift(2,h),e.push(r.slice(p,p+h)),p+=h}}}function Ul(e,t,r){return e||(e=Ie(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function T5(e,t,r,a){var o=Ie(9);return Ul(o,e,t),Zy(r,a||"b",o),o}function E5(e,t,r){var a=Ie(8+2*r.length);return Ul(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function k5(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var o=t.t=="d"?Sn(pn(t.v)):t.v;o==(o|0)&&o>=0&&o<65536?et(e,2,z8(r,a,o)):et(e,3,P8(r,a,o));return;case"b":case"e":et(e,5,T5(r,a,t.v,t.t));return;case"s":case"str":et(e,4,E5(r,a,(t.v||"").slice(0,255)));return}et(e,1,Ul(null,r,a))}function j5(e,t,r,a){var o=Array.isArray(t),c=ur(t["!ref"]||"A1"),d,f="",p=[];if(c.e.c>255||c.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");c.e.c=Math.min(c.e.c,255),c.e.r=Math.min(c.e.c,16383),d=Ar(c)}for(var h=c.s.r;h<=c.e.r;++h){f=en(h);for(var x=c.s.c;x<=c.e.c;++x){h===c.s.r&&(p[x]=sn(x)),d=p[x]+f;var y=o?(t[h]||[])[x]:t[d];y&&k5(e,y,h,x)}}}function C5(e,t){for(var r=t||{},a=_n(),o=0,c=0;c<e.SheetNames.length;++c)e.SheetNames[c]==r.sheet&&(o=c);if(o==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return et(a,r.biff==4?1033:r.biff==3?521:9,dh(e,16,r)),j5(a,e.Sheets[e.SheetNames[o]],o,r),et(a,10),a.end()}function A5(e,t,r){et(e,49,S8({sz:12,name:"Arial"},r))}function R5(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var o=a[0];o<=a[1];++o)t[o]!=null&&et(e,1054,E8(o,t[o],r))})}function D5(e,t){var r=Ie(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),et(e,2151,r),r=Ie(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),rv(ur(t["!ref"]||"A1"),r),r.write_shift(4,4),et(e,2152,r)}function N5(e,t){for(var r=0;r<16;++r)et(e,224,u1({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){et(e,224,u1(a,0,t))})}function O5(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];et(e,440,O8(a)),a[1].Tooltip&&et(e,2048,M8(a))}delete t["!links"]}function M5(e,t){if(t){var r=0;t.forEach(function(a,o){++r<=256&&a&&et(e,125,F8(Pd(o,a),o))})}}function B5(e,t,r,a,o){var c=16+Ts(o.cellXfs,t,o);if(t.v==null&&!t.bf){et(e,513,Xs(r,a,c));return}if(t.bf)et(e,6,sC(t,r,a,o,c));else switch(t.t){case"d":case"n":var d=t.t=="d"?Sn(pn(t.v)):t.v;et(e,515,A8(r,a,d,c));break;case"b":case"e":et(e,517,C8(r,a,t.v,c,o,t.t));break;case"s":case"str":if(o.bookSST){var f=gh(o.Strings,t.v,o.revStrings);et(e,253,w8(r,a,f,c))}else et(e,516,T8(r,a,(t.v||"").slice(0,255),c,o));break;default:et(e,513,Xs(r,a,c))}}function I5(e,t,r){var a=_n(),o=r.SheetNames[e],c=r.Sheets[o]||{},d=(r||{}).Workbook||{},f=(d.Sheets||[])[e]||{},p=Array.isArray(c),h=t.biff==8,x,y="",b=[],v=ur(c["!ref"]||"A1"),w=h?65536:16384;if(v.e.c>255||v.e.r>=w){if(t.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,w-1)}et(a,2057,dh(r,16,t)),et(a,13,qn(1)),et(a,12,qn(100)),et(a,15,hn(!0)),et(a,17,hn(!1)),et(a,16,Vs(.001)),et(a,95,hn(!0)),et(a,42,hn(!1)),et(a,43,hn(!1)),et(a,130,qn(1)),et(a,128,j8()),et(a,131,hn(!1)),et(a,132,hn(!1)),h&&M5(a,c["!cols"]),et(a,512,k8(v,t)),h&&(c["!links"]=[]);for(var _=v.s.r;_<=v.e.r;++_){y=en(_);for(var T=v.s.c;T<=v.e.c;++T){_===v.s.r&&(b[T]=sn(T)),x=b[T]+y;var M=p?(c[_]||[])[T]:c[x];M&&(B5(a,M,_,T,t),h&&M.l&&c["!links"].push([x,M.l]))}}var F=f.CodeName||f.name||o;return h&&et(a,574,_8((d.Views||[])[0])),h&&(c["!merges"]||[]).length&&et(a,229,N8(c["!merges"])),h&&O5(a,c),et(a,442,tv(F)),h&&D5(a,c),et(a,10),a.end()}function F5(e,t,r){var a=_n(),o=(e||{}).Workbook||{},c=o.Sheets||[],d=o.WBProps||{},f=r.biff==8,p=r.biff==5;if(et(a,2057,dh(e,5,r)),r.bookType=="xla"&&et(a,135),et(a,225,f?qn(1200):null),et(a,193,l8(2)),p&&et(a,191),p&&et(a,192),et(a,226),et(a,92,m8("SheetJS",r)),et(a,66,qn(f?1200:1252)),f&&et(a,353,qn(0)),f&&et(a,448),et(a,317,L8(e.SheetNames.length)),f&&e.vbaraw&&et(a,211),f&&e.vbaraw){var h=d.CodeName||"ThisWorkbook";et(a,442,tv(h))}et(a,156,qn(17)),et(a,25,hn(!1)),et(a,18,hn(!1)),et(a,19,qn(0)),f&&et(a,431,hn(!1)),f&&et(a,444,qn(0)),et(a,61,b8()),et(a,64,hn(!1)),et(a,141,qn(0)),et(a,34,hn(WA(e)=="true")),et(a,14,hn(!0)),f&&et(a,439,hn(!1)),et(a,218,qn(0)),A5(a,e,r),R5(a,e.SSF,r),N5(a,r),f&&et(a,352,hn(!1));var x=a.end(),y=_n();f&&et(y,140,B8()),f&&r.Strings&&w5(y,252,v8(r.Strings)),et(y,10);var b=y.end(),v=_n(),w=0,_=0;for(_=0;_<e.SheetNames.length;++_)w+=(f?12:11)+(f?2:1)*e.SheetNames[_].length;var T=x.length+w+b.length;for(_=0;_<e.SheetNames.length;++_){var M=c[_]||{};et(v,133,y8({pos:T,hs:M.Hidden||0,dt:0,name:e.SheetNames[_]},r)),T+=t[_].length}var F=v.end();if(w!=F.length)throw new Error("BS8 "+w+" != "+F.length);var A=[];return x.length&&A.push(x),F.length&&A.push(F),b.length&&A.push(b),Jr(A)}function L5(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=wn(Sr)),e&&e.SSF&&(Md(),Od(e.SSF),r.revssf=Bd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,xh(r),r.cellXfs=[],Ts(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var o=0;o<e.SheetNames.length;++o)a[a.length]=I5(o,r,e);return a.unshift(F5(e,a,r)),Jr(a)}function Cv(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var o=Bn(a["!ref"]);o.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var c=t||{};switch(c.biff||2){case 8:case 5:return L5(e,t);case 4:case 3:case 2:return C5(e,t)}throw new Error("invalid type "+c.bookType+" for BIFF")}function P5(e,t,r,a){for(var o=e["!merges"]||[],c=[],d=t.s.c;d<=t.e.c;++d){for(var f=0,p=0,h=0;h<o.length;++h)if(!(o[h].s.r>r||o[h].s.c>d)&&!(o[h].e.r<r||o[h].e.c<d)){if(o[h].s.r<r||o[h].s.c<d){f=-1;break}f=o[h].e.r-o[h].s.r+1,p=o[h].e.c-o[h].s.c+1;break}if(!(f<0)){var x=Zt({r,c:d}),y=a.dense?(e[r]||[])[d]:e[x],b=y&&y.v!=null&&(y.h||xk(y.w||(Ha(y),y.w)||""))||"",v={};f>1&&(v.rowspan=f),p>1&&(v.colspan=p),a.editable?b='<span contenteditable="true">'+b+"</span>":y&&(v["data-t"]=y&&y.t||"z",y.v!=null&&(v["data-v"]=y.v),y.z!=null&&(v["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+y.l.Target+'">'+b+"</a>")),v.id=(a.id||"sjs")+"-"+x,c.push(Ze("td",b,v))}}var w="<tr>";return w+c.join("")+"</tr>"}var z5='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',U5="</body></html>";function W5(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Av(e,t){var r=t||{},a=r.header!=null?r.header:z5,o=r.footer!=null?r.footer:U5,c=[a],d=Bn(e["!ref"]);r.dense=Array.isArray(e),c.push(W5(e,d,r));for(var f=d.s.r;f<=d.e.r;++f)c.push(P5(e,d,f,r));return c.push("</table>"+o),c.join("")}function Rv(e,t,r){var a=r||{},o=0,c=0;if(a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var d=typeof a.origin=="string"?Hr(a.origin):a.origin;o=d.r,c=d.c}var f=t.getElementsByTagName("tr"),p=Math.min(a.sheetRows||1e7,f.length),h={s:{r:0,c:0},e:{r:o,c}};if(e["!ref"]){var x=Bn(e["!ref"]);h.s.r=Math.min(h.s.r,x.s.r),h.s.c=Math.min(h.s.c,x.s.c),h.e.r=Math.max(h.e.r,x.e.r),h.e.c=Math.max(h.e.c,x.e.c),o==-1&&(h.e.r=o=x.e.r+1)}var y=[],b=0,v=e["!rows"]||(e["!rows"]=[]),w=0,_=0,T=0,M=0,F=0,A=0;for(e["!cols"]||(e["!cols"]=[]);w<f.length&&_<p;++w){var U=f[w];if(y1(U)){if(a.display)continue;v[_]={hidden:!0}}var V=U.children;for(T=M=0;T<V.length;++T){var te=V[T];if(!(a.display&&y1(te))){var N=te.hasAttribute("data-v")?te.getAttribute("data-v"):te.hasAttribute("v")?te.getAttribute("v"):bk(te.innerHTML),re=te.getAttribute("data-z")||te.getAttribute("z");for(b=0;b<y.length;++b){var L=y[b];L.s.c==M+c&&L.s.r<_+o&&_+o<=L.e.r&&(M=L.e.c+1-c,b=-1)}A=+te.getAttribute("colspan")||1,((F=+te.getAttribute("rowspan")||1)>1||A>1)&&y.push({s:{r:_+o,c:M+c},e:{r:_+o+(F||1)-1,c:M+c+(A||1)-1}});var X={t:"s",v:N},le=te.getAttribute("data-t")||te.getAttribute("t")||"";N!=null&&(N.length==0?X.t=le||"z":a.raw||N.trim().length==0||le=="s"||(N==="TRUE"?X={t:"b",v:!0}:N==="FALSE"?X={t:"b",v:!1}:isNaN(za(N))?isNaN(jl(N).getDate())||(X={t:"d",v:pn(N)},a.cellDates||(X={t:"n",v:Sn(X.v)}),X.z=a.dateNF||Sr[14]):X={t:"n",v:za(N)})),X.z===void 0&&re!=null&&(X.z=re);var ge="",Re=te.getElementsByTagName("A");if(Re&&Re.length)for(var fe=0;fe<Re.length&&!(Re[fe].hasAttribute("href")&&(ge=Re[fe].getAttribute("href"),ge.charAt(0)!="#"));++fe);ge&&ge.charAt(0)!="#"&&(X.l={Target:ge}),a.dense?(e[_+o]||(e[_+o]=[]),e[_+o][M+c]=X):e[Zt({c:M+c,r:_+o})]=X,h.e.c<M+c&&(h.e.c=M+c),M+=A}}++_}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),h.e.r=Math.max(h.e.r,_-1+o),e["!ref"]=Ar(h),_>=p&&(e["!fullref"]=Ar((h.e.r=f.length-w+_-1+o,h))),e}function Dv(e,t){var r=t||{},a=r.dense?[]:{};return Rv(a,e,t)}function $5(e,t){return Js(Dv(e,t),t)}function y1(e){var t="",r=H5(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function H5(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var q5=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Al({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Rr+t}})(),v1=(function(){var e=function(c){return Jt(c).replace(/  +/g,function(d){return'<text:s text:c="'+d.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(c,d,f){var p=[];p.push('      <table:table table:name="'+Jt(d.SheetNames[f])+`" table:style-name="ta1">
`);var h=0,x=0,y=Bn(c["!ref"]||"A1"),b=c["!merges"]||[],v=0,w=Array.isArray(c);if(c["!cols"])for(x=0;x<=y.e.c;++x)p.push("        <table:table-column"+(c["!cols"][x]?' table:style-name="co'+c["!cols"][x].ods+'"':"")+`></table:table-column>
`);var _="",T=c["!rows"]||[];for(h=0;h<y.s.r;++h)_=T[h]?' table:style-name="ro'+T[h].ods+'"':"",p.push("        <table:table-row"+_+`></table:table-row>
`);for(;h<=y.e.r;++h){for(_=T[h]?' table:style-name="ro'+T[h].ods+'"':"",p.push("        <table:table-row"+_+`>
`),x=0;x<y.s.c;++x)p.push(t);for(;x<=y.e.c;++x){var M=!1,F={},A="";for(v=0;v!=b.length;++v)if(!(b[v].s.c>x)&&!(b[v].s.r>h)&&!(b[v].e.c<x)&&!(b[v].e.r<h)){(b[v].s.c!=x||b[v].s.r!=h)&&(M=!0),F["table:number-columns-spanned"]=b[v].e.c-b[v].s.c+1,F["table:number-rows-spanned"]=b[v].e.r-b[v].s.r+1;break}if(M){p.push(r);continue}var U=Zt({r:h,c:x}),V=w?(c[h]||[])[x]:c[U];if(V&&V.f&&(F["table:formula"]=Jt(uC(V.f)),V.F&&V.F.slice(0,U.length)==U)){var te=Bn(V.F);F["table:number-matrix-columns-spanned"]=te.e.c-te.s.c+1,F["table:number-matrix-rows-spanned"]=te.e.r-te.s.r+1}if(!V){p.push(t);continue}switch(V.t){case"b":A=V.v?"TRUE":"FALSE",F["office:value-type"]="boolean",F["office:boolean-value"]=V.v?"true":"false";break;case"n":A=V.w||String(V.v||0),F["office:value-type"]="float",F["office:value"]=V.v||0;break;case"s":case"str":A=V.v==null?"":V.v,F["office:value-type"]="string";break;case"d":A=V.w||pn(V.v).toISOString(),F["office:value-type"]="date",F["office:date-value"]=pn(V.v).toISOString(),F["table:style-name"]="ce1";break;default:p.push(t);continue}var N=e(A);if(V.l&&V.l.Target){var re=V.l.Target;re=re.charAt(0)=="#"?"#"+fC(re.slice(1)):re,re.charAt(0)!="#"&&!re.match(/^\w+:/)&&(re="../"+re),N=Ze("text:a",N,{"xlink:href":re.replace(/&/g,"&amp;")})}p.push("          "+Ze("table:table-cell",Ze("text:p",N,{}),F)+`
`)}p.push(`        </table:table-row>
`)}return p.push(`      </table:table>
`),p.join("")},o=function(c,d){c.push(` <office:automatic-styles>
`),c.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),c.push(`   <number:month number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:day number:style="long"/>
`),c.push(`   <number:text>/</number:text>
`),c.push(`   <number:year/>
`),c.push(`  </number:date-style>
`);var f=0;d.SheetNames.map(function(h){return d.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var x=0;x<h["!cols"].length;++x)if(h["!cols"][x]){var y=h["!cols"][x];if(y.width==null&&y.wpx==null&&y.wch==null)continue;uh(y),y.ods=f;var b=h["!cols"][x].wpx+"px";c.push('  <style:style style:name="co'+f+`" style:family="table-column">
`),c.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+b+`"/>
`),c.push(`  </style:style>
`),++f}}});var p=0;d.SheetNames.map(function(h){return d.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var x=0;x<h["!rows"].length;++x)if(h["!rows"][x]){h["!rows"][x].ods=p;var y=h["!rows"][x].hpx+"px";c.push('  <style:style style:name="ro'+p+`" style:family="table-row">
`),c.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),c.push(`  </style:style>
`),++p}}}),c.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),c.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),c.push(`  </style:style>
`),c.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),c.push(` </office:automatic-styles>
`)};return function(d,f){var p=[Rr],h=Al({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),x=Al({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(p.push("<office:document"+h+x+`>
`),p.push(Gy().replace(/office:document-meta/g,"office:meta"))):p.push("<office:document-content"+h+`>
`),o(p,d),p.push(`  <office:body>
`),p.push(`    <office:spreadsheet>
`);for(var y=0;y!=d.SheetNames.length;++y)p.push(a(d.Sheets[d.SheetNames[y]],d,y));return p.push(`    </office:spreadsheet>
`),p.push(`  </office:body>
`),f.bookType=="fods"?p.push("</office:document>"):p.push("</office:document-content>"),p.join("")}})();function Nv(e,t){if(t.bookType=="fods")return v1(e,t);var r=eh(),a="",o=[],c=[];return a="mimetype",At(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",At(r,a,v1(e,t)),o.push([a,"text/xml"]),c.push([a,"ContentFile"]),a="styles.xml",At(r,a,q5(e,t)),o.push([a,"text/xml"]),c.push([a,"StylesFile"]),a="meta.xml",At(r,a,Rr+Gy()),o.push([a,"text/xml"]),c.push([a,"MetadataFile"]),a="manifest.rdf",At(r,a,n8(c)),o.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",At(r,a,t8(o)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function jd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function G5(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ta(Cl(e))}function Y5(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Ss(e){var t=e.reduce(function(o,c){return o+c.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(o){r.set(o,a),a+=o.length}),r}function V5(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,o=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var c=0;o>=1;++c,o/=256)e[t+c]=o&255;e[t+15]|=r>=0?0:128}function Rl(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Kt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ro(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ir(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],o=Rl(e,r),c=o&7;o=Math.floor(o/8);var d=0,f;if(o==0)break;switch(c){case 0:{for(var p=r[0];e[r[0]++]>=128;);f=e.slice(p,r[0])}break;case 5:d=4,f=e.slice(r[0],r[0]+d),r[0]+=d;break;case 1:d=8,f=e.slice(r[0],r[0]+d),r[0]+=d;break;case 2:d=Rl(e,r),f=e.slice(r[0],r[0]+d),r[0]+=d;break;case 3:case 4:default:throw new Error("PB Type ".concat(c," for Field ").concat(o," at offset ").concat(a))}var h={data:f,type:c};t[o]==null?t[o]=[h]:t[o].push(h)}return t}function Kr(e){var t=[];return e.forEach(function(r,a){r.forEach(function(o){o.data&&(t.push(Kt(a*8+o.type)),o.type==2&&t.push(Kt(o.data.length)),t.push(o.data))})}),Ss(t)}function Qn(e){for(var t,r=[],a=[0];a[0]<e.length;){var o=Rl(e,a),c=Ir(e.slice(a[0],a[0]+o));a[0]+=o;var d={id:ro(c[1][0].data),messages:[]};c[2].forEach(function(f){var p=Ir(f.data),h=ro(p[3][0].data);d.messages.push({meta:p,data:e.slice(a[0],a[0]+h)}),a[0]+=h}),(t=c[3])!=null&&t[0]&&(d.merge=ro(c[3][0].data)>>>0>0),r.push(d)}return r}function Yi(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Kt(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Kt(+!!r.merge),type:0}]);var o=[];r.messages.forEach(function(d){o.push(d.data),d.meta[3]=[{type:0,data:Kt(d.data.length)}],a[2].push({data:Kr(d.meta),type:2})});var c=Kr(a);t.push(Kt(c.length)),t.push(c),o.forEach(function(d){return t.push(d)})}),Ss(t)}function X5(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=Rl(t,r),o=[];r[0]<t.length;){var c=t[r[0]]&3;if(c==0){var d=t[r[0]++]>>2;if(d<60)++d;else{var f=d-59;d=t[r[0]],f>1&&(d|=t[r[0]+1]<<8),f>2&&(d|=t[r[0]+2]<<16),f>3&&(d|=t[r[0]+3]<<24),d>>>=0,d++,r[0]+=f}o.push(t.slice(r[0],r[0]+d)),r[0]+=d;continue}else{var p=0,h=0;if(c==1?(h=(t[r[0]]>>2&7)+4,p=(t[r[0]++]&224)<<3,p|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,c==2?(p=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(p=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),o=[Ss(o)],p==0)throw new Error("Invalid offset 0");if(p>o[0].length)throw new Error("Invalid offset beyond length");if(h>=p)for(o.push(o[0].slice(-p)),h-=p;h>=o[o.length-1].length;)o.push(o[o.length-1]),h-=o[o.length-1].length;o.push(o[0].slice(-p,-p+h))}}var x=Ss(o);if(x.length!=a)throw new Error("Unexpected length: ".concat(x.length," != ").concat(a));return x}function Jn(e){for(var t=[],r=0;r<e.length;){var a=e[r++],o=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(X5(a,e.slice(r,r+o))),r+=o}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ss(t)}function Vi(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),o=new Uint8Array(4);t.push(o);var c=Kt(a),d=c.length;t.push(c),a<=60?(d++,t.push(new Uint8Array([a-1<<2]))):a<=256?(d+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(d+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(d+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(d+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),d+=a,o[0]=0,o[1]=d&255,o[2]=d>>8&255,o[3]=d>>16&255,r+=a}return Ss(t)}function h0(e,t){var r=new Uint8Array(32),a=jd(r),o=12,c=0;switch(r[0]=5,e.t){case"n":r[1]=2,V5(r,o,e.v),c|=1,o+=16;break;case"b":r[1]=6,a.setFloat64(o,e.v?1:0,!0),c|=2,o+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(o,t.indexOf(e.v),!0),c|=8,o+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,c,!0),r.slice(0,o)}function p0(e,t){var r=new Uint8Array(32),a=jd(r),o=12,c=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(o,e.v,!0),c|=32,o+=8;break;case"b":r[2]=6,a.setFloat64(o,e.v?1:0,!0),c|=32,o+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(o,t.indexOf(e.v),!0),c|=16,o+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,c,!0),r.slice(0,o)}function gs(e){var t=Ir(e);return Rl(t[1][0].data)}function K5(e,t,r){var a,o,c,d;if(!((a=e[6])!=null&&a[0])||!((o=e[7])!=null&&o[0]))throw"Mutation only works on post-BNC storages!";var f=((d=(c=e[8])==null?void 0:c[0])==null?void 0:d.data)&&ro(e[8][0].data)>0||!1;if(f)throw"Math only works with normal offsets";for(var p=0,h=jd(e[7][0].data),x=0,y=[],b=jd(e[4][0].data),v=0,w=[],_=0;_<t.length;++_){if(t[_]==null){h.setUint16(_*2,65535,!0),b.setUint16(_*2,65535);continue}h.setUint16(_*2,x,!0),b.setUint16(_*2,v,!0);var T,M;switch(typeof t[_]){case"string":T=h0({t:"s",v:t[_]},r),M=p0({t:"s",v:t[_]},r);break;case"number":T=h0({t:"n",v:t[_]},r),M=p0({t:"n",v:t[_]},r);break;case"boolean":T=h0({t:"b",v:t[_]},r),M=p0({t:"b",v:t[_]},r);break;default:throw new Error("Unsupported value "+t[_])}y.push(T),x+=T.length,w.push(M),v+=M.length,++p}for(e[2][0].data=Kt(p);_<e[7][0].data.length/2;++_)h.setUint16(_*2,65535,!0),b.setUint16(_*2,65535,!0);return e[6][0].data=Ss(y),e[3][0].data=Ss(w),p}function Q5(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Bn(r["!ref"]);a.s.r=a.s.c=0;var o=!1;a.e.c>9&&(o=!0,a.e.c=9),a.e.r>49&&(o=!0,a.e.r=49),o&&console.error("The Numbers writer is currently limited to ".concat(Ar(a)));var c=Cd(r,{range:a,header:1}),d=["~Sh33tJ5~"];c.forEach(function(K){return K.forEach(function(Y){typeof Y=="string"&&d.push(Y)})});var f={},p=[],h=sr.read(t.numbers,{type:"base64"});h.FileIndex.map(function(K,Y){return[K,h.FullPaths[Y]]}).forEach(function(K){var Y=K[0],H=K[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var pe=Y.content,Ge=Jn(pe),He=Qn(Ge);He.forEach(function(De){p.push(De.id),f[De.id]={deps:[],location:H,type:ro(De.messages[0].meta[1][0].data)}})}}),p.sort(function(K,Y){return K-Y});var x=p.filter(function(K){return K>1}).map(function(K){return[K,Kt(K)]});h.FileIndex.map(function(K,Y){return[K,h.FullPaths[Y]]}).forEach(function(K){var Y=K[0];if(K[1],!!Y.name.match(/\.iwa/)){var H=Qn(Jn(Y.content));H.forEach(function(pe){pe.messages.forEach(function(Ge){x.forEach(function(He){pe.messages.some(function(De){return ro(De.meta[1][0].data)!=11006&&Y5(De.data,He[1])})&&f[He[0]].deps.push(pe.id)})})})}});for(var y=sr.find(h,f[1].location),b=Qn(Jn(y.content)),v,w=0;w<b.length;++w){var _=b[w];_.id==1&&(v=_)}var T=gs(Ir(v.messages[0].data)[1][0].data);for(y=sr.find(h,f[T].location),b=Qn(Jn(y.content)),w=0;w<b.length;++w)_=b[w],_.id==T&&(v=_);for(T=gs(Ir(v.messages[0].data)[2][0].data),y=sr.find(h,f[T].location),b=Qn(Jn(y.content)),w=0;w<b.length;++w)_=b[w],_.id==T&&(v=_);for(T=gs(Ir(v.messages[0].data)[2][0].data),y=sr.find(h,f[T].location),b=Qn(Jn(y.content)),w=0;w<b.length;++w)_=b[w],_.id==T&&(v=_);var M=Ir(v.messages[0].data);{M[6][0].data=Kt(a.e.r+1),M[7][0].data=Kt(a.e.c+1);var F=gs(M[46][0].data),A=sr.find(h,f[F].location),U=Qn(Jn(A.content));{for(var V=0;V<U.length&&U[V].id!=F;++V);if(U[V].id!=F)throw"Bad ColumnRowUIDMapArchive";var te=Ir(U[V].messages[0].data);te[1]=[],te[2]=[],te[3]=[];for(var N=0;N<=a.e.c;++N){var re=[];re[1]=re[2]=[{type:0,data:Kt(N+420690)}],te[1].push({type:2,data:Kr(re)}),te[2].push({type:0,data:Kt(N)}),te[3].push({type:0,data:Kt(N)})}te[4]=[],te[5]=[],te[6]=[];for(var L=0;L<=a.e.r;++L)re=[],re[1]=re[2]=[{type:0,data:Kt(L+726270)}],te[4].push({type:2,data:Kr(re)}),te[5].push({type:0,data:Kt(L)}),te[6].push({type:0,data:Kt(L)});U[V].messages[0].data=Kr(te)}A.content=Vi(Yi(U)),A.size=A.content.length,delete M[46];var X=Ir(M[4][0].data);{X[7][0].data=Kt(a.e.r+1);var le=Ir(X[1][0].data),ge=gs(le[2][0].data);A=sr.find(h,f[ge].location),U=Qn(Jn(A.content));{if(U[0].id!=ge)throw"Bad HeaderStorageBucket";var Re=Ir(U[0].messages[0].data);for(L=0;L<c.length;++L){var fe=Ir(Re[2][0].data);fe[1][0].data=Kt(L),fe[4][0].data=Kt(c[L].length),Re[2][L]={type:Re[2][0].type,data:Kr(fe)}}U[0].messages[0].data=Kr(Re)}A.content=Vi(Yi(U)),A.size=A.content.length;var Ae=gs(X[2][0].data);A=sr.find(h,f[Ae].location),U=Qn(Jn(A.content));{if(U[0].id!=Ae)throw"Bad HeaderStorageBucket";for(Re=Ir(U[0].messages[0].data),N=0;N<=a.e.c;++N)fe=Ir(Re[2][0].data),fe[1][0].data=Kt(N),fe[4][0].data=Kt(a.e.r+1),Re[2][N]={type:Re[2][0].type,data:Kr(fe)};U[0].messages[0].data=Kr(Re)}A.content=Vi(Yi(U)),A.size=A.content.length;var ee=gs(X[4][0].data);(function(){for(var K=sr.find(h,f[ee].location),Y=Qn(Jn(K.content)),H,pe=0;pe<Y.length;++pe){var Ge=Y[pe];Ge.id==ee&&(H=Ge)}var He=Ir(H.messages[0].data);{He[3]=[];var De=[];d.forEach(function(de,$e){De[1]=[{type:0,data:Kt($e)}],De[2]=[{type:0,data:Kt(1)}],De[3]=[{type:2,data:G5(de)}],He[3].push({type:2,data:Kr(De)})})}H.messages[0].data=Kr(He);var Be=Yi(Y),rt=Vi(Be);K.content=rt,K.size=K.content.length})();var ye=Ir(X[3][0].data);{var ae=ye[1][0];delete ye[2];var Se=Ir(ae.data);{var k=gs(Se[2][0].data);(function(){for(var K=sr.find(h,f[k].location),Y=Qn(Jn(K.content)),H,pe=0;pe<Y.length;++pe){var Ge=Y[pe];Ge.id==k&&(H=Ge)}var He=Ir(H.messages[0].data);{delete He[6],delete ye[7];var De=new Uint8Array(He[5][0].data);He[5]=[];for(var Be=0,rt=0;rt<=a.e.r;++rt){var de=Ir(De);Be+=K5(de,c[rt],d),de[1][0].data=Kt(rt),He[5].push({data:Kr(de),type:2})}He[1]=[{type:0,data:Kt(a.e.c+1)}],He[2]=[{type:0,data:Kt(a.e.r+1)}],He[3]=[{type:0,data:Kt(Be)}],He[4]=[{type:0,data:Kt(a.e.r+1)}]}H.messages[0].data=Kr(He);var $e=Yi(Y),z=Vi($e);K.content=z,K.size=K.content.length})()}ae.data=Kr(Se)}X[3][0].data=Kr(ye)}M[4][0].data=Kr(X)}v.messages[0].data=Kr(M);var J=Yi(b),O=Vi(J);return y.content=O,y.size=y.content.length,h}function J5(e){return function(r){for(var a=0;a!=e.length;++a){var o=e[a];r[o[0]]===void 0&&(r[o[0]]=o[1]),o[2]==="n"&&(r[o[0]]=Number(r[o[0]]))}}}function xh(e){J5([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Z5(e,t){return t.bookType=="ods"?Nv(e,t):t.bookType=="numbers"?Q5(e,t):t.bookType=="xlsb"?eR(e,t):tR(e,t)}function eR(e,t){Ji=1024,e&&!e.SSF&&(e.SSF=wn(Sr)),e&&e.SSF&&(Md(),Od(e.SSF),t.revssf=Bd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=pv.indexOf(t.bookType)>-1,o=$y();xh(t=t||{});var c=eh(),d="",f=0;if(t.cellXfs=[],Ts(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",At(c,d,Yy(e.Props,t)),o.coreprops.push(d),Qt(t.rels,2,d,Wt.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var p=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&p.push(e.SheetNames[h]);e.Props.SheetNames=p}for(e.Props.Worksheets=e.Props.SheetNames.length,At(c,d,Xy(e.Props)),o.extprops.push(d),Qt(t.rels,3,d,Wt.EXT_PROPS),e.Custprops!==e.Props&&tn(e.Custprops||{}).length>0&&(d="docProps/custom.xml",At(c,d,Ky(e.Custprops)),o.custprops.push(d),Qt(t.rels,4,d,Wt.CUST_PROPS)),f=1;f<=e.SheetNames.length;++f){var x={"!id":{}},y=e.Sheets[e.SheetNames[f-1]],b=(y||{})["!type"]||"sheet";switch(b){case"chart":default:d="xl/worksheets/sheet"+f+"."+r,At(c,d,n5(f-1,d,t,e,x)),o.sheets.push(d),Qt(t.wbrels,-1,"worksheets/sheet"+f+"."+r,Wt.WS[0])}if(y){var v=y["!comments"],w=!1,_="";v&&v.length>0&&(_="xl/comments"+f+"."+r,At(c,_,i5(v,_)),o.comments.push(_),Qt(x,-1,"../comments"+f+"."+r,Wt.CMNT),w=!0),y["!legacy"]&&w&&At(c,"xl/drawings/vmlDrawing"+f+".vml",fv(f,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&At(c,qy(d),eo(x))}return t.Strings!=null&&t.Strings.length>0&&(d="xl/sharedStrings."+r,At(c,d,s5(t.Strings,d,t)),o.strs.push(d),Qt(t.wbrels,-1,"sharedStrings."+r,Wt.SST)),d="xl/workbook."+r,At(c,d,r5(e,d)),o.workbooks.push(d),Qt(t.rels,1,d,Wt.WB),d="xl/theme/theme1.xml",At(c,d,dv(e.Themes,t)),o.themes.push(d),Qt(t.wbrels,-1,"theme/theme1.xml",Wt.THEME),d="xl/styles."+r,At(c,d,a5(e,d,t)),o.styles.push(d),Qt(t.wbrels,-1,"styles."+r,Wt.STY),e.vbaraw&&a&&(d="xl/vbaProject.bin",At(c,d,e.vbaraw),o.vba.push(d),Qt(t.wbrels,-1,"vbaProject.bin",Wt.VBA)),d="xl/metadata."+r,At(c,d,o5(d)),o.metadata.push(d),Qt(t.wbrels,-1,"metadata."+r,Wt.XLMETA),At(c,"[Content_Types].xml",Hy(o,t)),At(c,"_rels/.rels",eo(t.rels)),At(c,"xl/_rels/workbook."+r+".rels",eo(t.wbrels)),delete t.revssf,delete t.ssf,c}function tR(e,t){Ji=1024,e&&!e.SSF&&(e.SSF=wn(Sr)),e&&e.SSF&&(Md(),Od(e.SSF),t.revssf=Bd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=pv.indexOf(t.bookType)>-1,o=$y();xh(t=t||{});var c=eh(),d="",f=0;if(t.cellXfs=[],Ts(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),d="docProps/core.xml",At(c,d,Yy(e.Props,t)),o.coreprops.push(d),Qt(t.rels,2,d,Wt.CORE_PROPS),d="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var p=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&p.push(e.SheetNames[h]);e.Props.SheetNames=p}e.Props.Worksheets=e.Props.SheetNames.length,At(c,d,Xy(e.Props)),o.extprops.push(d),Qt(t.rels,3,d,Wt.EXT_PROPS),e.Custprops!==e.Props&&tn(e.Custprops||{}).length>0&&(d="docProps/custom.xml",At(c,d,Ky(e.Custprops)),o.custprops.push(d),Qt(t.rels,4,d,Wt.CUST_PROPS));var x=["SheetJ5"];for(t.tcid=0,f=1;f<=e.SheetNames.length;++f){var y={"!id":{}},b=e.Sheets[e.SheetNames[f-1]],v=(b||{})["!type"]||"sheet";switch(v){case"chart":default:d="xl/worksheets/sheet"+f+"."+r,At(c,d,wv(f-1,t,e,y)),o.sheets.push(d),Qt(t.wbrels,-1,"worksheets/sheet"+f+"."+r,Wt.WS[0])}if(b){var w=b["!comments"],_=!1,T="";if(w&&w.length>0){var M=!1;w.forEach(function(F){F[1].forEach(function(A){A.T==!0&&(M=!0)})}),M&&(T="xl/threadedComments/threadedComment"+f+"."+r,At(c,T,N6(w,x,t)),o.threadedcomments.push(T),Qt(y,-1,"../threadedComments/threadedComment"+f+"."+r,Wt.TCMNT)),T="xl/comments"+f+"."+r,At(c,T,hv(w)),o.comments.push(T),Qt(y,-1,"../comments"+f+"."+r,Wt.CMNT),_=!0}b["!legacy"]&&_&&At(c,"xl/drawings/vmlDrawing"+f+".vml",fv(f,b["!comments"])),delete b["!comments"],delete b["!legacy"]}y["!id"].rId1&&At(c,qy(d),eo(y))}return t.Strings!=null&&t.Strings.length>0&&(d="xl/sharedStrings."+r,At(c,d,av(t.Strings,t)),o.strs.push(d),Qt(t.wbrels,-1,"sharedStrings."+r,Wt.SST)),d="xl/workbook."+r,At(c,d,kv(e)),o.workbooks.push(d),Qt(t.rels,1,d,Wt.WB),d="xl/theme/theme1.xml",At(c,d,dv(e.Themes,t)),o.themes.push(d),Qt(t.wbrels,-1,"theme/theme1.xml",Wt.THEME),d="xl/styles."+r,At(c,d,lv(e,t)),o.styles.push(d),Qt(t.wbrels,-1,"styles."+r,Wt.STY),e.vbaraw&&a&&(d="xl/vbaProject.bin",At(c,d,e.vbaraw),o.vba.push(d),Qt(t.wbrels,-1,"vbaProject.bin",Wt.VBA)),d="xl/metadata."+r,At(c,d,uv()),o.metadata.push(d),Qt(t.wbrels,-1,"metadata."+r,Wt.XLMETA),x.length>1&&(d="xl/persons/person.xml",At(c,d,O6(x)),o.people.push(d),Qt(t.wbrels,-1,"persons/person.xml",Wt.PEOPLE)),At(c,"[Content_Types].xml",Hy(o,t)),At(c,"_rels/.rels",eo(t.rels)),At(c,"xl/_rels/workbook."+r+".rels",eo(t.wbrels)),delete t.revssf,delete t.ssf,c}function rR(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=$a(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ov(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Fl(t.file,sr.write(e,{type:Ht?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return sr.write(e,t)}function nR(e,t){var r=wn(t||{}),a=Z5(e,r);return aR(a,r)}function aR(e,t){var r={},a=Ht?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var o=e.FullPaths?sr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof o=="string"){if(t.type=="binary"||t.type=="base64")return o;o=new Uint8Array(Nd(o))}return t.password&&typeof encrypt_agile<"u"?Ov(encrypt_agile(o,t.password),t):t.type==="file"?Fl(t.file,o):t.type=="string"?yl(o):o}function sR(e,t){var r=t||{},a=_5(e,r);return Ov(a,r)}function ha(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return kl(Cl(a));case"binary":return Cl(a);case"string":return e;case"file":return Fl(t.file,a,"utf8");case"buffer":return Ht?qa(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ha(a,{type:"binary"}).split("").map(function(o){return o.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function iR(e,t){switch(t.type){case"base64":return kl(e);case"binary":return e;case"string":return e;case"file":return Fl(t.file,e,"binary");case"buffer":return Ht?qa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ld(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?kl(r):t.type=="string"?yl(r):r;case"file":return Fl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Mv(e,t){ME(),qA(e);var r=wn(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Mv(e,r);return r.type="array",Nd(a)}var o=0;if(r.sheet&&(typeof r.sheet=="number"?o=r.sheet:o=e.SheetNames.indexOf(r.sheet),!e.SheetNames[o]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ha(v5(e,r),r);case"slk":case"sylk":return ha(W8.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"htm":case"html":return ha(Av(e.Sheets[e.SheetNames[o]],r),r);case"txt":return iR(Bv(e.Sheets[e.SheetNames[o]],r),r);case"csv":return ha(mh(e.Sheets[e.SheetNames[o]],r),r,"\uFEFF");case"dif":return ha($8.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"dbf":return ld(U8.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"prn":return ha(H8.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"rtf":return ha(Q8.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"eth":return ha(nv.from_sheet(e.Sheets[e.SheetNames[o]],r),r);case"fods":return ha(Nv(e,r),r);case"wk1":return ld(f1.sheet_to_wk1(e.Sheets[e.SheetNames[o]],r),r);case"wk3":return ld(f1.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ld(Cv(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),sR(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return nR(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function oR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function lR(e,t,r){var a={};return a.type="file",a.file=t,oR(a),Mv(e,a)}function cR(e,t,r,a,o,c,d,f){var p=en(r),h=f.defval,x=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),y=!0,b=o===1?[]:{};if(o!==1)if(Object.defineProperty)try{Object.defineProperty(b,"__rowNum__",{value:r,enumerable:!1})}catch{b.__rowNum__=r}else b.__rowNum__=r;if(!d||e[r])for(var v=t.s.c;v<=t.e.c;++v){var w=d?e[r][v]:e[a[v]+p];if(w===void 0||w.t===void 0){if(h===void 0)continue;c[v]!=null&&(b[c[v]]=h);continue}var _=w.v;switch(w.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(c[v]!=null){if(_==null)if(w.t=="e"&&_===null)b[c[v]]=null;else if(h!==void 0)b[c[v]]=h;else if(x&&_===null)b[c[v]]=null;else continue;else b[c[v]]=x&&(w.t!=="n"||w.t==="n"&&f.rawNumbers!==!1)?_:Ha(w,_,f);_!=null&&(y=!1)}}return{row:b,isempty:y}}function Cd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,o=1,c=[],d=0,f="",p={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},x=h.range!=null?h.range:e["!ref"];switch(h.header===1?a=1:h.header==="A"?a=2:Array.isArray(h.header)?a=3:h.header==null&&(a=0),typeof x){case"string":p=ur(x);break;case"number":p=ur(e["!ref"]),p.s.r=x;break;default:p=x}a>0&&(o=0);var y=en(p.s.r),b=[],v=[],w=0,_=0,T=Array.isArray(e),M=p.s.r,F=0,A={};T&&!e[M]&&(e[M]=[]);var U=h.skipHidden&&e["!cols"]||[],V=h.skipHidden&&e["!rows"]||[];for(F=p.s.c;F<=p.e.c;++F)if(!(U[F]||{}).hidden)switch(b[F]=sn(F),r=T?e[M][F]:e[b[F]+y],a){case 1:c[F]=F-p.s.c;break;case 2:c[F]=b[F];break;case 3:c[F]=h.header[F-p.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),f=d=Ha(r,null,h),_=A[d]||0,!_)A[d]=1;else{do f=d+"_"+_++;while(A[f]);A[d]=_,A[f]=1}c[F]=f}for(M=p.s.r+o;M<=p.e.r;++M)if(!(V[M]||{}).hidden){var te=cR(e,p,M,b,a,c,T,h);(te.isempty===!1||(a===1?h.blankrows!==!1:h.blankrows))&&(v[w++]=te.row)}return v.length=w,v}var b1=/"/g;function dR(e,t,r,a,o,c,d,f){for(var p=!0,h=[],x="",y=en(r),b=t.s.c;b<=t.e.c;++b)if(a[b]){var v=f.dense?(e[r]||[])[b]:e[a[b]+y];if(v==null)x="";else if(v.v!=null){p=!1,x=""+(f.rawNumbers&&v.t=="n"?v.v:Ha(v,null,f));for(var w=0,_=0;w!==x.length;++w)if((_=x.charCodeAt(w))===o||_===c||_===34||f.forceQuotes){x='"'+x.replace(b1,'""')+'"';break}x=="ID"&&(x='"ID"')}else v.f!=null&&!v.F?(p=!1,x="="+v.f,x.indexOf(",")>=0&&(x='"'+x.replace(b1,'""')+'"')):x="";h.push(x)}return f.blankrows===!1&&p?null:h.join(d)}function mh(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var o=ur(e["!ref"]),c=a.FS!==void 0?a.FS:",",d=c.charCodeAt(0),f=a.RS!==void 0?a.RS:`
`,p=f.charCodeAt(0),h=new RegExp((c=="|"?"\\|":c)+"+$"),x="",y=[];a.dense=Array.isArray(e);for(var b=a.skipHidden&&e["!cols"]||[],v=a.skipHidden&&e["!rows"]||[],w=o.s.c;w<=o.e.c;++w)(b[w]||{}).hidden||(y[w]=sn(w));for(var _=0,T=o.s.r;T<=o.e.r;++T)(v[T]||{}).hidden||(x=dR(e,o,T,y,d,p,c,a),x!=null&&(a.strip&&(x=x.replace(h,"")),(x||a.blankrows!==!1)&&r.push((_++?f:"")+x)));return delete a.dense,r.join("")}function Bv(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=mh(e,t);return r}function uR(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var o=ur(e["!ref"]),c="",d=[],f,p=[],h=Array.isArray(e);for(f=o.s.c;f<=o.e.c;++f)d[f]=sn(f);for(var x=o.s.r;x<=o.e.r;++x)for(c=en(x),f=o.s.c;f<=o.e.c;++f)if(t=d[f]+c,r=h?(e[x]||[])[f]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}p[p.length]=t+"="+a}return p}function Iv(e,t,r){var a=r||{},o=+!a.skipHeader,c=e||{},d=0,f=0;if(c&&a.origin!=null)if(typeof a.origin=="number")d=a.origin;else{var p=typeof a.origin=="string"?Hr(a.origin):a.origin;d=p.r,f=p.c}var h,x={s:{c:0,r:0},e:{c:f,r:d+t.length-1+o}};if(c["!ref"]){var y=ur(c["!ref"]);x.e.c=Math.max(x.e.c,y.e.c),x.e.r=Math.max(x.e.r,y.e.r),d==-1&&(d=y.e.r+1,x.e.r=d+t.length-1+o)}else d==-1&&(d=0,x.e.r=t.length-1+o);var b=a.header||[],v=0;t.forEach(function(_,T){tn(_).forEach(function(M){(v=b.indexOf(M))==-1&&(b[v=b.length]=M);var F=_[M],A="z",U="",V=Zt({c:f+v,r:d+T+o});h=Dl(c,V),F&&typeof F=="object"&&!(F instanceof Date)?c[V]=F:(typeof F=="number"?A="n":typeof F=="boolean"?A="b":typeof F=="string"?A="s":F instanceof Date?(A="d",a.cellDates||(A="n",F=Sn(F)),U=a.dateNF||Sr[14]):F===null&&a.nullError&&(A="e",F=0),h?(h.t=A,h.v=F,delete h.w,delete h.R,U&&(h.z=U)):c[V]=h={t:A,v:F},U&&(h.z=U))})}),x.e.c=Math.max(x.e.c,f+b.length-1);var w=en(d);if(o)for(v=0;v<b.length;++v)c[sn(v+f)+w]={t:"s",v:b[v]};return c["!ref"]=Ar(x),c}function fR(e,t){return Iv(null,e,t)}function Dl(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Hr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Dl(e,Zt(t)):Dl(e,Zt({r:t,c:r||0}))}function hR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function pR(){return{SheetNames:[],Sheets:{}}}function gR(e,t,r,a){var o=1;if(!r)for(;o<=65535&&e.SheetNames.indexOf(r="Sheet"+o)!=-1;++o,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var c=r.match(/(^.*?)(\d+)$/);o=c&&+c[2]||0;var d=c&&c[1]||r;for(++o;o<=65535&&e.SheetNames.indexOf(r=d+o)!=-1;++o);}if(Ev(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function xR(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=hR(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function mR(e,t){return e.z=t,e}function Fv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function yR(e,t,r){return Fv(e,"#"+t,r)}function vR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function bR(e,t,r,a){for(var o=typeof t!="string"?t:ur(t),c=typeof t=="string"?t:Ar(t),d=o.s.r;d<=o.e.r;++d)for(var f=o.s.c;f<=o.e.c;++f){var p=Dl(e,d,f);p.t="n",p.F=c,delete p.v,d==o.s.r&&f==o.s.c&&(p.f=r,a&&(p.D=!0))}return e}var Ma={encode_col:sn,encode_row:en,encode_cell:Zt,encode_range:Ar,decode_col:ih,decode_row:sh,split_cell:Mk,decode_cell:Hr,decode_range:Bn,format_cell:Ha,sheet_add_aoa:Fy,sheet_add_json:Iv,sheet_add_dom:Rv,aoa_to_sheet:uo,json_to_sheet:fR,table_to_sheet:Dv,table_to_book:$5,sheet_to_csv:mh,sheet_to_txt:Bv,sheet_to_json:Cd,sheet_to_html:Av,sheet_to_formulae:uR,sheet_to_row_object_array:Cd,sheet_get_cell:Dl,book_new:pR,book_append_sheet:gR,book_set_sheet_visibility:xR,cell_set_number_format:mR,cell_set_hyperlink:Fv,cell_set_internal_link:yR,cell_add_comment:vR,sheet_set_array_formula:bR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function _R({isOpen:e,onClose:t,vaultEntries:r}){const[a,o]=j.useState("weekly"),[c,d]=j.useState("2025-W37"),[f,p]=j.useState(null),[h,x]=j.useState(!1),[y,b]=j.useState(!1),[v,w]=j.useState(""),[_,T]=j.useState(""),[M,F]=j.useState(!1),A=N=>`${N.toFixed(2)}`,U=async(N,re)=>{try{x(!0);let L,X;if(y&&N&&re)L=new Date(N),L.setHours(0,0,0,0),X=new Date(re),X.setHours(23,59,59,999);else if(a==="weekly"){const Ne=new Date,tt=Ne.getDay(),mt=Ne.getDate()-tt+(tt===0?-6:1);L=new Date(Ne.setDate(mt)),L.setHours(0,0,0,0),X=new Date(L),X.setDate(X.getDate()+6),X.setHours(23,59,59,999)}else{const Ne=new Date;L=new Date(Ne.getFullYear(),Ne.getMonth(),1),X=new Date(Ne.getFullYear(),Ne.getMonth()+1,0,23,59,59,999)}const{data:le,error:ge}=await Oe.from("sales").select("total_amount, discount_applied, cashier_id").gte("datetime",L.toISOString()).lte("datetime",X.toISOString());if(ge)throw ge;const Re=le?.reduce((Ne,tt)=>Ne+(tt.total_amount||0),0)||0,fe=le?.reduce((Ne,tt)=>Ne+(tt.discount_applied||0),0)||0,Ae=le?.length||0,ee=Ae>0?Re/Ae:0,{data:ye,error:ae}=await Oe.from("sale_items").select(`
          quantity,
          price_each,
          products!inner(category),
          sales!inner(datetime)
        `).gte("sales.datetime",L.toISOString()).lte("sales.datetime",X.toISOString());if(ae)throw ae;const Se=new Map;ye?.forEach(Ne=>{const tt=Ne.products?.category||"Other",mt=Ne.quantity*Ne.price_each,ht=Se.get(tt)||{revenue:0,units:0};Se.set(tt,{revenue:ht.revenue+mt,units:ht.units+Ne.quantity})});const k=Array.from(Se.entries()).map(([Ne,tt])=>({name:Ne,revenue:tt.revenue,percentage:Re>0?Number((tt.revenue/Re*100).toFixed(1)):0,units:tt.units})).sort((Ne,tt)=>tt.revenue-Ne.revenue),{data:J,error:O}=await Oe.from("sale_items").select(`
          quantity,
          price_each,
          products!inner(name),
          sales!inner(datetime)
        `).gte("sales.datetime",L.toISOString()).lte("sales.datetime",X.toISOString());if(O)throw O;const K=new Map;J?.forEach(Ne=>{const tt=Ne.products?.name||"Unknown Product",mt=Ne.quantity*Ne.price_each,ht=K.get(tt)||{units:0,revenue:0};K.set(tt,{units:ht.units+Ne.quantity,revenue:ht.revenue+mt})});const Y=Array.from(K.entries()).map(([Ne,tt])=>({name:Ne,...tt})).sort((Ne,tt)=>tt.revenue-Ne.revenue).slice(0,10).map((Ne,tt)=>({rank:tt+1,...Ne})),{data:H,error:pe}=await Oe.from("products").select("name");if(pe)throw pe;const He=(H?.map(Ne=>{const tt=K.get(Ne.name);return{name:Ne.name,units:tt?.units||0,revenue:tt?.revenue||0}})||[]).sort((Ne,tt)=>Ne.revenue-tt.revenue).slice(0,10).map((Ne,tt)=>({rank:tt+1,...Ne})),{data:De,error:Be}=await Oe.from("products").select("name, stock_quantity, reorder_level");if(Be)throw Be;const rt=De?.filter(Ne=>Ne.stock_quantity<=Ne.reorder_level).map(Ne=>({product:Ne.name,current:Ne.stock_quantity,reorder:Ne.reorder_level,urgent:Ne.stock_quantity<=Ne.reorder_level*.5}))||[],de=De?.filter(Ne=>Ne.stock_quantity===0).map(Ne=>({product:Ne.name,lastStock:"N/A",expectedDelivery:"TBD"}))||[],{data:$e,error:z}=await Oe.from("sales").select(`
          total_amount,
          cashier_id,
          users!inner(username)
        `).gte("datetime",L.toISOString()).lte("datetime",X.toISOString());if(z)throw z;const be=new Map;$e?.forEach(Ne=>{const tt=Ne.cashier_id,mt=Ne.users?.username||"Unknown",ht=be.get(tt)||{name:mt,revenue:0,transactions:0};be.set(tt,{name:mt,revenue:ht.revenue+(Ne.total_amount||0),transactions:ht.transactions+1})});const Ke=Array.from(be.values()).map(Ne=>({name:Ne.name,revenue:Ne.revenue,transactions:Ne.transactions,avgTransaction:Ne.transactions>0?Ne.revenue/Ne.transactions:0,hours:40,accuracy:99})),{data:je,error:dt}=await Oe.from("side_business_sales").select(`
          total_amount,
          quantity,
          side_business_items!inner(
            name,
            side_businesses!inner(name)
          )
        `).gte("date_time",L.toISOString()).lte("date_time",X.toISOString());dt&&console.error("Error fetching side business data:",dt);const We=new Map;je&&je.forEach(Ne=>{const tt=Ne.side_business_items.side_businesses.name,mt=Ne.side_business_items.name;We.has(tt)||We.set(tt,{name:tt,revenue:0,transactions:0,items:new Map});const ht=We.get(tt);ht.revenue+=Ne.total_amount,ht.transactions+=1,ht.items.has(mt)||ht.items.set(mt,{name:mt,units:0,revenue:0});const St=ht.items.get(mt);St.units+=Ne.quantity,St.revenue+=Ne.total_amount});const ot=Array.from(We.values()).map(Ne=>({name:Ne.name,revenue:Ne.revenue,transactions:Ne.transactions,avgTransaction:Ne.transactions>0?Ne.revenue/Ne.transactions:0,topItems:Array.from(Ne.items.values()).sort((tt,mt)=>mt.revenue-tt.revenue).slice(0,3)}));p({kpis:{totalSales:Re,transactions:Ae,avgTransaction:ee,discounts:fe},categories:k,topProducts:Y,leastSoldProducts:He,lowStock:rt,outOfStock:de,staff:Ke,sideBusinesses:ot})}catch(L){console.error("Error fetching report data:",L)}finally{x(!1)}};j.useEffect(()=>{e&&U()},[e,a,c]);const V=()=>{const N=window.open("","_blank"),re=document.getElementById("sales-report-content").innerHTML;N.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>LandM Store Sales Report</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 40px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
            th { background-color: #f5f5f5; }
            .urgent { color: red; font-weight: bold; }
            .kpi-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin: 20px 0; }
            .kpi-card { border: 1px solid #ddd; padding: 15px; border-radius: 5px; }
            h1, h2, h3 { color: #333; }
            .print-only { display: block; }
          </style>
        </head>
        <body>
          ${re}
          <script>window.print();<\/script>
        </body>
      </html>
    `)},te=async()=>{try{F(!0);const N=y?v:null,re=y?_:null;let L="";if(y&&N&&re){const k=new Date(N).toLocaleDateString("en-IE"),J=new Date(re).toLocaleDateString("en-IE");L=`${k}_to_${J}`}else if(a==="weekly")L=`Week_${c}`;else{const k=new Date;L=`${k.getFullYear()}_${String(k.getMonth()+1).padStart(2,"0")}`}const X=Ma.book_new(),le=[["LANDM STORE - FINANCIAL REPORT FOR ACCOUNTANT"],[""],["BUSINESS INFORMATION"],["Company Name:","LandM Store"],["Address:","Unit 2 Glenmore Park, Dundalk, Co. Louth"],["Phone:","087 797 0412"],["VAT Number:","IE1234567A"],["Business Type:","Retail Store"],[""],["REPORTING PERIOD"],["Period:",y?`${v} to ${_}`:a==="weekly"?`Week ${c}`:new Date().toLocaleDateString("en-IE",{year:"numeric",month:"long"})],["Report Generated:",new Date().toLocaleDateString("en-IE",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})],[""],["REVENUE SUMMARY (EXCLUDING VAT)"],["Gross Sales Revenue",f?.kpis.totalSales?f.kpis.totalSales:0],["Less: Customer Discounts",f?.kpis.discounts?f.kpis.discounts:0],["Net Sales Revenue (Before VAT)",f?.kpis.totalSales&&f?.kpis.discounts?f.kpis.totalSales-f.kpis.discounts:f?.kpis.totalSales?f.kpis.totalSales:0],[""],["TRANSACTION ANALYSIS"],["Total Number of Transactions",f?.kpis.transactions||0],["Average Transaction Value",f?.kpis.avgTransaction?f.kpis.avgTransaction:0],["Total Items Sold",f?.categories.reduce((k,J)=>k+J.units,0)||0],[""],["CATEGORY PERFORMANCE"],["Category","Revenue","Percentage of Sales","Units Sold","Average Price per Unit"],...f?.categories.map(k=>[k.name,k.revenue,`${k.percentage}%`,k.units,k.units>0?k.revenue/k.units:0])||[],[""],["TOP PERFORMING PRODUCTS"],["Product Name","Units Sold","Revenue Generated","Average Price per Unit"],...f?.topProducts.slice(0,15).map(k=>[k.name,k.units,k.revenue,k.units>0?k.revenue/k.units:0])||[],[""],["ACCOUNTING NOTES"],["1. All amounts are in Euro ()"],["2. Revenue figures are exclusive of VAT unless otherwise stated"],["3. Customer discounts are deducted from gross revenue"],["4. This report is generated automatically from POS system data"],["5. For VAT calculations, standard rate should be applied to net sales"],["6. Inventory movements and cost of goods sold are not included in this report"],["7. Report covers retail sales only - side business operations excluded"],[""],["VERIFICATION REQUIRED"],["- Cross-reference with bank deposits"],["- Verify VAT calculations and rates"],["- Confirm discount policies and approvals"],["- Reconcile with physical inventory counts"]],ge=Ma.aoa_to_sheet(le);Ma.book_append_sheet(X,ge,"Financial Summary");const Re=[["DETAILED SALES BREAKDOWN"],[""],["Product Name","Category","Units Sold","Revenue Generated","Average Price per Unit"],...f?.topProducts.map(k=>[k.name,f.categories.find(J=>f.topProducts.filter(O=>f.categories.some(K=>K.name==="Category"&&O.name===k.name)).length>0)?.name||"Other",k.units,k.revenue,k.units>0?k.revenue/k.units:0])||[],[""],["CATEGORY TOTALS"],["Category","Total Revenue","Total Units","Average Price per Unit","Percentage of Total Sales"],...f?.categories.map(k=>[k.name,k.revenue,k.units,k.units>0?k.revenue/k.units:0,`${k.percentage}%`])||[]],fe=Ma.aoa_to_sheet(Re);Ma.book_append_sheet(X,fe,"Sales Details");const Ae=[["TRANSACTION ANALYSIS"],[""],["Metric","Value","Notes"],["Total Transactions",f?.kpis.transactions||0,"Number of completed sales"],["Average Transaction Value",f?.kpis.avgTransaction?f.kpis.avgTransaction:0,"Revenue per transaction"],["Total Items Sold",f?.categories.reduce((k,J)=>k+J.units,0)||0,"Sum of all units sold"],["Average Items per Transaction",f?.kpis.transactions>0?f.categories.reduce((k,J)=>k+J.units,0)/f.kpis.transactions:0,"Items sold divided by transactions"],["Discount Rate",f?.kpis.totalSales>0?(f.kpis.discounts/f.kpis.totalSales*100).toFixed(2)+"%":"0%","Percentage of revenue given as discounts"],[""],["DAILY BREAKDOWN (ESTIMATED)"],["Note: Daily breakdown requires individual transaction data"],["Average Daily Revenue",f?.kpis.totalSales&&f?.kpis.transactions>0?f.kpis.totalSales/Math.max(1,f.kpis.transactions/10):0,"Estimated based on transaction volume"],["Average Daily Transactions",f?.kpis.transactions>0?f.kpis.transactions/Math.max(1,f.kpis.transactions/10):0,"Estimated daily transaction count"]],ee=Ma.aoa_to_sheet(Ae);Ma.book_append_sheet(X,ee,"Transaction Analysis");const ye=[["VAT CALCULATION WORKSHEET"],[""],["IMPORTANT: This is a template - verify VAT rates and calculations"],[""],["Net Sales Revenue (Before VAT)",f?.kpis.totalSales&&f?.kpis.discounts?f.kpis.totalSales-f.kpis.discounts:f?.kpis.totalSales?f.kpis.totalSales:0],[""],["VAT CALCULATIONS (Standard Rate 23%)"],["VAT on Net Sales",f?.kpis.totalSales&&f?.kpis.discounts?(f.kpis.totalSales-f.kpis.discounts)*.23:f?.kpis.totalSales?f.kpis.totalSales*.23:0],["Total Revenue Including VAT",f?.kpis.totalSales&&f?.kpis.discounts?(f.kpis.totalSales-f.kpis.discounts)*1.23:f?.kpis.totalSales?f.kpis.totalSales*1.23:0],[""],["VAT CALCULATIONS (Reduced Rate 13.5% - if applicable)"],["Note: Verify which products qualify for reduced rate"],["VAT on Reduced Rate Items",0,"To be calculated based on product categorization"],[""],["VAT SUMMARY"],["Standard Rate VAT (23%)",f?.kpis.totalSales&&f?.kpis.discounts?(f.kpis.totalSales-f.kpis.discounts)*.23:f?.kpis.totalSales?f.kpis.totalSales*.23:0],["Reduced Rate VAT (13.5%)",0,"Calculate based on qualifying products"],["Total VAT Collected",f?.kpis.totalSales&&f?.kpis.discounts?(f.kpis.totalSales-f.kpis.discounts)*.23:f?.kpis.totalSales?f.kpis.totalSales*.23:0],[""],["VERIFICATION CHECKLIST"],[" Verify current VAT rates"],[" Confirm product VAT categorization"],[" Cross-check with VAT returns"],[" Validate calculation methods"],[" Check for any exempt or zero-rated items"]],ae=Ma.aoa_to_sheet(ye);Ma.book_append_sheet(X,ae,"VAT Calculation");const Se=`LandM_Store_Accountant_Report_${L}_${new Date().toISOString().split("T")[0]}.xlsx`;lR(X,Se)}catch(N){console.error("Error exporting to Excel:",N),alert("Failed to export to Excel. Please try again.")}finally{F(!1)}};return e?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"20px",padding:"30px",border:"1px solid rgba(125, 141, 134, 0.2)",boxShadow:"0 20px 40px rgba(62, 63, 41, 0.15)",maxWidth:"900px",width:"95%",maxHeight:"80vh",overflowY:"auto",color:"#3e3f29"},children:[h&&i.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#3e3f29"},children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin",style:{fontSize:"24px",marginBottom:"20px"}}),i.jsx("p",{children:"Loading report data..."})]}),!h&&!f&&i.jsxs("div",{style:{textAlign:"center",padding:"40px",color:"#3e3f29"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{fontSize:"24px",marginBottom:"20px",color:"#dc3545"}}),i.jsx("p",{children:"Unable to load report data. Please try again."}),i.jsx("button",{onClick:t,style:{background:"#7d8d86",color:"#ffffff",border:"none",padding:"10px 20px",borderRadius:"8px",marginTop:"20px",cursor:"pointer"},children:"Close"})]}),!h&&f&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",paddingBottom:"20px",borderBottom:"2px solid rgba(125, 141, 134, 0.3)"},children:[i.jsxs("h2",{style:{color:"#3e3f29",fontSize:"24px",fontWeight:"700",margin:0},children:[i.jsx("i",{className:"fa-solid fa-chart-line",style:{marginRight:"10px",color:"#7d8d86"}}),"Sales Reports"]}),i.jsx("button",{onClick:t,style:{background:"none",border:"2px solid #7d8d86",color:"#3e3f29",width:"40px",height:"40px",borderRadius:"50%",cursor:"pointer",fontSize:"20px",transition:"all 0.3s ease"},onMouseEnter:N=>{N.currentTarget.style.background="#7d8d86",N.currentTarget.style.color="#ffffff",N.currentTarget.style.transform="rotate(90deg)"},onMouseLeave:N=>{N.currentTarget.style.background="none",N.currentTarget.style.color="#3e3f29",N.currentTarget.style.transform="rotate(0deg)"},children:""})]}),i.jsxs("div",{style:{display:"flex",gap:"15px",marginBottom:"30px",flexWrap:"wrap",alignItems:"center"},children:[i.jsxs("select",{style:{padding:"10px 15px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"14px",outline:"none"},value:a,onChange:N=>o(N.target.value),children:[i.jsx("option",{value:"weekly",children:"Weekly Report"}),i.jsx("option",{value:"monthly",children:"Monthly Report"}),i.jsx("option",{value:"custom",children:"Custom Date Range"})]}),a==="weekly"&&i.jsx("input",{type:"week",style:{padding:"10px 15px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"14px",outline:"none"},value:c,onChange:N=>d(N.target.value)}),a==="custom"&&i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[i.jsx("input",{type:"date",style:{padding:"10px 15px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"14px",outline:"none"},value:v,onChange:N=>w(N.target.value),placeholder:"Start Date"}),i.jsx("span",{style:{color:"#7d8d86",fontSize:"14px"},children:"to"}),i.jsx("input",{type:"date",style:{padding:"10px 15px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"14px",outline:"none"},value:_,onChange:N=>T(N.target.value),placeholder:"End Date"})]}),i.jsxs("button",{onClick:()=>U(v,_),disabled:h||a==="custom"&&(!v||!_),style:{background:h?"#cccccc":"#7d8d86",color:"#ffffff",border:"none",borderRadius:"10px",padding:"10px 20px",fontSize:"14px",fontWeight:"600",cursor:h?"not-allowed":"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:N=>{h||(N.currentTarget.style.background="#3e3f29",N.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:N=>{h||(N.currentTarget.style.background="#7d8d86",N.currentTarget.style.transform="translateY(0)")},children:[i.jsx("i",{className:`fa-solid ${h?"fa-spinner fa-spin":"fa-refresh"}`}),h?"Loading...":"Refresh Data"]}),i.jsxs("button",{onClick:V,style:{background:"#7d8d86",color:"#ffffff",border:"none",borderRadius:"10px",padding:"10px 20px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:N=>{N.currentTarget.style.background="#3e3f29",N.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:N=>{N.currentTarget.style.background="#7d8d86",N.currentTarget.style.transform="translateY(0)"},children:[i.jsx("i",{className:"fa-solid fa-print"}),"Print Report"]}),i.jsxs("button",{onClick:te,disabled:M||!f||a==="custom"&&(!v||!_),style:{background:M?"#cccccc":"#10b981",color:"#ffffff",border:"none",borderRadius:"10px",padding:"10px 20px",fontSize:"14px",fontWeight:"600",cursor:M?"not-allowed":"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:N=>{M||(N.currentTarget.style.background="#059669",N.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:N=>{M||(N.currentTarget.style.background="#10b981",N.currentTarget.style.transform="translateY(0)")},children:[i.jsx("i",{className:`fa-solid ${M?"fa-spinner fa-spin":"fa-file-excel"}`}),M?"Exporting...":"Export to Excel"]})]}),i.jsxs("div",{id:"sales-report-content",style:{color:"#3e3f29"},children:[i.jsxs("div",{style:{borderBottom:"2px solid rgba(125, 141, 134, 0.3)",paddingBottom:"20px",marginBottom:"30px"},children:[i.jsxs("h1",{style:{color:"#3e3f29",fontSize:"28px",fontWeight:"700",marginBottom:"10px"},children:[i.jsx("i",{className:"fa-solid fa-file-invoice",style:{marginRight:"10px"}}),"LandM Store Sales Report"]}),i.jsx("p",{style:{color:"#7d8d86",fontSize:"16px"},children:"Reporting Period: Week 37: 9-15 September 2025"})]}),i.jsxs("section",{style:{marginBottom:"40px"},children:[i.jsxs("h2",{style:{color:"#3e3f29",fontSize:"20px",fontWeight:"600",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx("i",{className:"fa-solid fa-chart-bar",style:{marginRight:"10px"}}),"1. Overview (KPIs)"]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"20px"},children:[i.jsxs("div",{style:{background:"rgba(125, 141, 134, 0.1)",padding:"20px",borderRadius:"10px",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsx("p",{style:{color:"#7d8d86",fontSize:"14px",fontWeight:"600",marginBottom:"5px"},children:"Total Sales"}),i.jsx("p",{style:{color:"#3e3f29",fontSize:"24px",fontWeight:"700",margin:0},children:A(f.kpis.totalSales)})]}),i.jsxs("div",{style:{background:"rgba(125, 141, 134, 0.1)",padding:"20px",borderRadius:"10px",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsx("p",{style:{color:"#7d8d86",fontSize:"14px",fontWeight:"600",marginBottom:"5px"},children:"Transactions"}),i.jsx("p",{style:{color:"#3e3f29",fontSize:"24px",fontWeight:"700",margin:0},children:f.kpis.transactions.toLocaleString()})]}),i.jsxs("div",{style:{background:"rgba(125, 141, 134, 0.1)",padding:"20px",borderRadius:"10px",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsx("p",{style:{color:"#7d8d86",fontSize:"14px",fontWeight:"600",marginBottom:"5px"},children:"Avg Transaction"}),i.jsx("p",{style:{color:"#3e3f29",fontSize:"24px",fontWeight:"700",margin:0},children:A(f.kpis.avgTransaction)})]}),i.jsxs("div",{style:{background:"rgba(125, 141, 134, 0.1)",padding:"20px",borderRadius:"10px",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsx("p",{style:{color:"#7d8d86",fontSize:"14px",fontWeight:"600",marginBottom:"5px"},children:"Total Discounts"}),i.jsx("p",{style:{color:"#3e3f29",fontSize:"24px",fontWeight:"700",margin:0},children:A(f.kpis.discounts)})]})]})]}),i.jsxs("section",{style:{marginBottom:"40px"},children:[i.jsxs("h2",{style:{color:"#3e3f29",fontSize:"20px",fontWeight:"600",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx("i",{className:"fa-solid fa-shopping-cart",style:{marginRight:"10px"}}),"2. Sales Breakdown"]}),i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsx("h3",{style:{color:"#3e3f29",fontSize:"18px",fontWeight:"600",marginBottom:"15px"},children:"Sales by Category"}),i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid rgba(125, 141, 134, 0.3)"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"rgba(125, 141, 134, 0.1)"},children:[i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Category"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Revenue"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"% of Total"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Units Sold"})]})}),i.jsx("tbody",{children:f.categories.map((N,re)=>i.jsxs("tr",{style:{background:re%2===0?"rgba(125, 141, 134, 0.05)":"transparent"},children:[i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29"},children:N.name}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:A(N.revenue)}),i.jsxs("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:[N.percentage,"%"]}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:N.units})]},re))})]})})]}),i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsx("h3",{style:{color:"#3e3f29",fontSize:"18px",fontWeight:"600",marginBottom:"15px"},children:"Top 10 Products Sold"}),i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid rgba(125, 141, 134, 0.3)"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"rgba(125, 141, 134, 0.1)"},children:[i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Rank"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Product"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Units Sold"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Revenue"})]})}),i.jsx("tbody",{children:f.topProducts.map(N=>i.jsxs("tr",{style:{background:N.rank%2===0?"rgba(125, 141, 134, 0.05)":"transparent"},children:[i.jsxs("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29",fontWeight:"600"},children:["#",N.rank]}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29"},children:N.name}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:N.units}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:A(N.revenue)})]},N.rank))})]})})]}),i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsx("h3",{style:{color:"#3e3f29",fontSize:"18px",fontWeight:"600",marginBottom:"15px"},children:"Least Sold Products"}),i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid rgba(125, 141, 134, 0.3)"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"rgba(125, 141, 134, 0.1)"},children:[i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Product"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Units Sold"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Revenue"})]})}),i.jsx("tbody",{children:f.leastSoldProducts.map((N,re)=>i.jsxs("tr",{style:{background:re%2===0?"rgba(125, 141, 134, 0.05)":"transparent"},children:[i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29"},children:N.name}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:N.units}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:A(N.revenue)})]},N.rank))})]})})]})]}),i.jsxs("section",{style:{marginBottom:"40px"},children:[i.jsxs("h2",{style:{color:"#3e3f29",fontSize:"20px",fontWeight:"600",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx("i",{className:"fa-solid fa-warehouse",style:{marginRight:"10px"}}),"3. Inventory Alerts"]}),i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsxs("h3",{style:{color:"#3e3f29",fontSize:"18px",fontWeight:"600",marginBottom:"15px",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{color:"#dc3545"}}),"Low Stock Products"]}),i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid rgba(125, 141, 134, 0.3)"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"rgba(125, 141, 134, 0.1)"},children:[i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Product"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Current Stock"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Reorder Level"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"center",color:"#3e3f29",fontWeight:"600"},children:"Status"})]})}),i.jsx("tbody",{children:f.lowStock.map((N,re)=>i.jsxs("tr",{style:{background:re%2===0?"rgba(125, 141, 134, 0.05)":"transparent"},children:[i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29"},children:N.product}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:N.current}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:N.reorder}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"center",color:"#3e3f29"},children:N.urgent&&i.jsx("span",{style:{color:"#dc3545",fontWeight:"bold"},children:"URGENT"})})]},re))})]})})]}),f.outOfStock.length>0&&i.jsxs("div",{style:{marginBottom:"30px"},children:[i.jsxs("h3",{style:{color:"#3e3f29",fontSize:"18px",fontWeight:"600",marginBottom:"15px",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-box",style:{color:"#dc3545"}}),"Out of Stock Products"]}),i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid rgba(125, 141, 134, 0.3)"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"rgba(125, 141, 134, 0.1)"},children:[i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Product"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"center",color:"#3e3f29",fontWeight:"600"},children:"Last Stock Date"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"center",color:"#3e3f29",fontWeight:"600"},children:"Expected Delivery"})]})}),i.jsx("tbody",{children:f.outOfStock.map((N,re)=>i.jsxs("tr",{style:{background:re%2===0?"rgba(125, 141, 134, 0.05)":"transparent"},children:[i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29"},children:N.product}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"center",color:"#7d8d86"},children:N.lastStock}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"center",color:"#7d8d86"},children:N.expectedDelivery})]},re))})]})})]})]}),i.jsxs("section",{style:{marginBottom:"40px"},children:[i.jsxs("h2",{style:{color:"#3e3f29",fontSize:"20px",fontWeight:"600",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx("i",{className:"fa-solid fa-users",style:{marginRight:"10px"}}),"4. Staff Performance"]}),i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid rgba(125, 141, 134, 0.3)"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"rgba(125, 141, 134, 0.1)"},children:[i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Cashier"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Revenue Handled"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Transactions"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Avg Transaction"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Hours"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Accuracy"})]})}),i.jsx("tbody",{children:f.staff.map((N,re)=>i.jsxs("tr",{style:{background:re%2===0?"rgba(125, 141, 134, 0.05)":"transparent"},children:[i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29",fontWeight:"600"},children:N.name}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:A(N.revenue)}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:N.transactions}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:A(N.avgTransaction)}),i.jsxs("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:[N.hours,"h"]}),i.jsxs("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:[N.accuracy,"%"]})]},re))})]})})]}),i.jsxs("section",{style:{marginBottom:"40px"},children:[i.jsxs("h2",{style:{color:"#3e3f29",fontSize:"20px",fontWeight:"600",marginBottom:"20px",display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx("i",{className:"fa-solid fa-store",style:{marginRight:"10px"}}),"5. Side Business Performance"]}),f.sideBusinesses.length>0?i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid rgba(125, 141, 134, 0.3)"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"rgba(125, 141, 134, 0.1)"},children:[i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Business Name"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Revenue"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Transactions"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29",fontWeight:"600"},children:"Avg Transaction"}),i.jsx("th",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"left",color:"#3e3f29",fontWeight:"600"},children:"Top Items"})]})}),i.jsx("tbody",{children:f.sideBusinesses.map((N,re)=>i.jsxs("tr",{style:{background:re%2===0?"rgba(125, 141, 134, 0.05)":"transparent"},children:[i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29",fontWeight:"600"},children:N.name}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:A(N.revenue)}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:N.transactions}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",textAlign:"right",color:"#3e3f29"},children:A(N.avgTransaction)}),i.jsx("td",{style:{border:"1px solid rgba(125, 141, 134, 0.3)",padding:"12px",color:"#3e3f29"},children:N.topItems.map((L,X)=>i.jsxs("div",{style:{fontSize:"12px",marginBottom:"2px",color:"#7d8d86"},children:[L.name,": ",L.units," units (",A(L.revenue),")"]},X))})]},re))})]})}):i.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#7d8d86",background:"rgba(125, 141, 134, 0.05)",borderRadius:"8px",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsx("i",{className:"fa-solid fa-store",style:{fontSize:"24px",marginBottom:"10px",display:"block"}}),"No side business sales data found for this period."]})]}),i.jsxs("section",{style:{borderTop:"2px solid rgba(125, 141, 134, 0.3)",paddingTop:"20px",marginTop:"40px"},children:[i.jsxs("h2",{style:{color:"#3e3f29",fontSize:"20px",fontWeight:"600",marginBottom:"20px"},children:[i.jsx("i",{className:"fa-solid fa-file-text",style:{marginRight:"10px"}}),"6. Report Footer"]}),i.jsxs("div",{style:{background:"rgba(125, 141, 134, 0.1)",padding:"20px",borderRadius:"10px",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"20px"},children:[i.jsxs("div",{children:[i.jsx("h3",{style:{color:"#3e3f29",fontWeight:"600",marginBottom:"10px"},children:"LandM Store"}),i.jsx("p",{style:{color:"#7d8d86",fontSize:"14px",margin:"5px 0"},children:"Unit 2 Glenmore Park, Dundalk, Co. Louth"}),i.jsx("p",{style:{color:"#7d8d86",fontSize:"14px",margin:"5px 0"},children:"Phone: 087 797 0412"}),i.jsx("p",{style:{color:"#7d8d86",fontSize:"14px",margin:"5px 0"},children:"VAT Number: IE1234567A"})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsxs("p",{style:{color:"#7d8d86",fontSize:"14px",margin:"5px 0"},children:[i.jsx("strong",{children:"Reporting Period:"})," Week 37: 9-15 September 2025"]}),i.jsxs("p",{style:{color:"#7d8d86",fontSize:"14px",margin:"5px 0"},children:[i.jsx("strong",{children:"Generated on:"})," ",new Date().toLocaleDateString("en-IE",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),i.jsx("div",{style:{marginTop:"20px",paddingTop:"20px",borderTop:"1px solid rgba(125, 141, 134, 0.2)"},children:i.jsx("p",{style:{fontSize:"12px",color:"#7d8d86",fontStyle:"italic",margin:0},children:"This report was automatically generated by the LandM Store POS System. For questions or clarifications, contact the store manager."})})]})]})]})]})]})}):null}const SR=({isOpen:e,onClose:t})=>{const{user:r}=xa(),[a,o]=j.useState(""),[c,d]=j.useState(""),[f,p]=j.useState(""),[h,x]=j.useState(!1),[y,b]=j.useState(null),[v,w]=j.useState([]),[_,T]=j.useState(!1),[M,F]=j.useState(!1),[A,U]=j.useState(!1),[V,te]=j.useState({title:"",username:"",password:"",website:""}),[N,re]=j.useState(new Set),[L,X]=j.useState(null),[le,ge]=j.useState(!1),[Re,fe]=j.useState(!1),[Ae,ee]=j.useState(""),[ye,ae]=j.useState(""),[Se,k]=j.useState(!1);j.useEffect(()=>{e&&(o(""),d(""),p(""),x(!1),b(null),w([]),T(!1),F(!1),U(!1),re(new Set),X(null),ge(!1),fe(!1),ee(""),ae(""),k(!1),te({title:"",username:"",password:"",website:""}))},[e]);const J=z=>{a.length<4&&(o(be=>be+z),d(""),p(""))},O=()=>{o(""),d(""),p("")},K=async z=>{if(r)try{const be=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(z)),Ke=Array.from(new Uint8Array(be)).map(We=>We.toString(16).padStart(2,"0")).join(""),{data:je,error:dt}=await Oe.from("vault").insert([{owner_id:r.user_id,pin_hash:Ke}]).select();if(dt)throw dt;b(je[0].vault_id),d(" Vault created successfully!"),p("success"),x(!0)}catch(be){console.error("Error creating vault:",be),d(" Failed to create vault. Try again."),p("error")}},Y=async z=>{if(r)try{const{data:be,error:Ke}=await Oe.from("vault").select("vault_id, pin_hash").eq("owner_id",r.user_id).single();if(Ke){if(Ke.code==="PGRST116"){F(!0),d("Creating your vault..."),p("success"),await K(z);return}throw Ke}const je=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(z)),dt=Array.from(new Uint8Array(je)).map(We=>We.toString(16).padStart(2,"0")).join("");be.pin_hash===dt?(b(be.vault_id),d(" Access Granted! Vault Unlocked"),p("success"),x(!0),await H(be.vault_id)):(d(" Incorrect PIN. Try again."),p("error"),setTimeout(()=>O(),1e3))}catch(be){console.error("Error verifying PIN:",be),d(" Failed to access vault. Try again."),p("error")}},H=async z=>{try{const{data:be,error:Ke}=await Oe.from("vault_entries").select("entry_id, label, email, password_enc, link, created_at").eq("vault_id",z).order("created_at",{ascending:!1});if(Ke)throw Ke;console.log("Raw data from database:",be),be.length>0&&(console.log("First entry password_enc:",be[0].password_enc),console.log("Type of password_enc:",typeof be[0].password_enc));const je=be.map(dt=>({...dt,password:dt.password_enc||"No password"}));w(je),T(!0)}catch(be){console.error("Error fetching vault entries:",be)}},pe=async()=>{if(!y||!V.title||!V.password){d(" Title and password are required"),p("error");return}try{const{data:z,error:be}=await Oe.from("vault_entries").insert([{vault_id:y,label:V.title,email:V.username,password_enc:V.password,link:V.website}]).select();if(be)throw be;await H(y),te({title:"",username:"",password:"",website:""}),U(!1),d(" Password saved successfully!"),p("success")}catch(z){console.error("Error saving entry:",z),d(" Failed to save password. Try again."),p("error")}},Ge=z=>{re(be=>{const Ke=new Set(be);return Ke.has(z)?Ke.delete(z):Ke.add(z),Ke})},He=async(z,be)=>{try{await navigator.clipboard.writeText(z),d(` ${be} copied to clipboard!`),p("success"),setTimeout(()=>{d(""),p("")},2e3)}catch{d(` Failed to copy ${be}`),p("error"),setTimeout(()=>{d(""),p("")},2e3)}},De=z=>{X(z)},Be=async z=>{if(y)try{const{error:be}=await Oe.from("vault_entries").delete().eq("entry_id",z).eq("vault_id",y);if(be)throw be;await H(y),X(null),d(" Password deleted successfully!"),p("success"),setTimeout(()=>{d(""),p("")},2e3)}catch(be){console.error("Error deleting entry:",be),d(" Failed to delete password. Try again."),p("error"),setTimeout(()=>{d(""),p("")},2e3)}},rt=()=>{a.length===4&&Y(a)},de=async()=>{if(Ae.length<4){d(" PIN must be at least 4 digits"),p("error");return}if(Ae!==ye){d(" PINs do not match"),p("error");return}if(!y){d(" No vault found"),p("error");return}k(!0),d("Updating vault PIN..."),p("success");try{const z=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(Ae)),be=Array.from(new Uint8Array(z)).map(je=>je.toString(16).padStart(2,"0")).join(""),{error:Ke}=await Oe.from("vault").update({pin_hash:be}).eq("vault_id",y);if(Ke)throw Ke;d(" Vault PIN updated successfully!"),p("success"),ee(""),ae(""),fe(!1)}catch(z){console.error("Error updating vault PIN:",z),d(" Failed to update vault PIN"),p("error")}finally{k(!1)}},$e=z=>{const be=z.key;be>="0"&&be<="9"?J(be):be==="Backspace"||be==="Delete"?a.length>0&&o(Ke=>Ke.slice(0,-1)):be==="Enter"?rt():be==="Escape"&&t()};return e?i.jsxs(i.Fragment,{children:[!h&&i.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,maxWidth:"400px",width:"90%",textAlign:"center"},onKeyDown:$e,tabIndex:-1,children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"20px",padding:"40px",boxShadow:"0 20px 40px rgba(62, 63, 41, 0.15)",border:"1px solid rgba(125, 141, 134, 0.2)",color:"#3e3f29"},children:[i.jsx("p",{style:{color:"#7d8d86",fontSize:"16px",marginBottom:"30px"},children:M?"Creating your vault...":"Enter your 4-digit PIN"}),i.jsx("div",{style:{display:"flex",justifyContent:"center",gap:"12px",marginBottom:"30px"},children:[0,1,2,3].map(z=>i.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"50%",border:"2px solid rgba(125, 141, 134, 0.3)",background:z<a.length?"linear-gradient(135deg, #7d8d86, #3e3f29)":"transparent",borderColor:z<a.length?"#3e3f29":"rgba(125, 141, 134, 0.3)",transform:z<a.length?"scale(1.1)":"scale(1)",transition:"all 0.3s ease"}},z))}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"15px",marginBottom:"20px"},children:[[1,2,3,4,5,6,7,8,9].map(z=>i.jsx("button",{onClick:()=>J(z.toString()),style:{width:"70px",height:"70px",border:"none",borderRadius:"50%",background:"#ffffff",border:"2px solid rgba(125, 141, 134, 0.2)",color:"#3e3f29",fontSize:"24px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 8px rgba(62, 63, 41, 0.1)"},onMouseEnter:be=>{be.currentTarget.style.background="linear-gradient(135deg, #7d8d86, #3e3f29)",be.currentTarget.style.color="#f1f0e4",be.currentTarget.style.transform="translateY(-2px)",be.currentTarget.style.boxShadow="0 6px 12px rgba(62, 63, 41, 0.15)"},onMouseLeave:be=>{be.currentTarget.style.background="#ffffff",be.currentTarget.style.color="#3e3f29",be.currentTarget.style.transform="translateY(0)",be.currentTarget.style.boxShadow="0 4px 8px rgba(62, 63, 41, 0.1)"},children:z},z)),i.jsx("button",{onClick:()=>J("0"),style:{width:"70px",height:"70px",border:"none",borderRadius:"50%",background:"#ffffff",border:"2px solid rgba(125, 141, 134, 0.2)",color:"#3e3f29",fontSize:"24px",fontWeight:"600",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 4px 8px rgba(62, 63, 41, 0.1)",gridColumn:"2"},onMouseEnter:z=>{z.currentTarget.style.background="linear-gradient(135deg, #7d8d86, #3e3f29)",z.currentTarget.style.color="#f1f0e4",z.currentTarget.style.transform="translateY(-2px)",z.currentTarget.style.boxShadow="0 6px 12px rgba(62, 63, 41, 0.15)"},onMouseLeave:z=>{z.currentTarget.style.background="#ffffff",z.currentTarget.style.color="#3e3f29",z.currentTarget.style.transform="translateY(0)",z.currentTarget.style.boxShadow="0 4px 8px rgba(62, 63, 41, 0.1)"},children:"0"})]}),i.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[i.jsx("button",{onClick:O,style:{padding:"12px 24px",border:"none",borderRadius:"25px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",background:"transparent",color:"#7d8d86",border:"2px solid rgba(125, 141, 134, 0.3)"},onMouseEnter:z=>{z.currentTarget.style.background="rgba(125, 141, 134, 0.1)",z.currentTarget.style.borderColor="#7d8d86"},onMouseLeave:z=>{z.currentTarget.style.background="transparent",z.currentTarget.style.borderColor="rgba(125, 141, 134, 0.3)"},children:"Clear"}),i.jsx("button",{onClick:rt,disabled:a.length!==4,style:{padding:"12px 24px",border:"none",borderRadius:"25px",fontSize:"16px",fontWeight:"600",cursor:a.length===4?"pointer":"not-allowed",transition:"all 0.3s ease",background:"linear-gradient(135deg, #7d8d86, #3e3f29)",color:"#f1f0e4",border:"2px solid transparent",opacity:a.length===4?1:.5},onMouseEnter:z=>{a.length===4&&(z.currentTarget.style.transform="translateY(-2px)",z.currentTarget.style.boxShadow="0 8px 16px rgba(62, 63, 41, 0.2)")},onMouseLeave:z=>{z.currentTarget.style.transform="translateY(0)",z.currentTarget.style.boxShadow="none"},children:M?"Creating...":"Unlock"})]}),c&&i.jsx("div",{style:{marginTop:"20px",padding:"12px",borderRadius:"10px",fontSize:"14px",fontWeight:"500",background:f==="success"?"rgba(125, 141, 134, 0.1)":"rgba(220, 53, 69, 0.1)",color:f==="success"?"#3e3f29":"#dc3545",border:f==="success"?"1px solid rgba(125, 141, 134, 0.3)":"1px solid rgba(220, 53, 69, 0.3)"},children:c})]})}),h&&i.jsx("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,maxWidth:"900px",width:"95%",maxHeight:"70vh",minHeight:"500px",overflowY:"auto",textAlign:"center"},onKeyDown:$e,tabIndex:-1,children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"20px",padding:"30px",border:"1px solid rgba(125, 141, 134, 0.2)",boxShadow:"0 20px 40px rgba(62, 63, 41, 0.15)",color:"#3e3f29"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px",paddingBottom:"20px",borderBottom:"2px solid rgba(125, 141, 134, 0.3)"},children:[i.jsxs("h2",{style:{color:"#3e3f29",fontSize:"24px",fontWeight:"700",margin:0},children:[i.jsx("i",{className:"fa-solid fa-vault",style:{marginRight:"10px",color:"#7d8d86"}}),"Password Vault"]}),i.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[i.jsxs("button",{onClick:()=>fe(!0),style:{background:"#dc3545",color:"#ffffff",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:z=>{z.currentTarget.style.background="#c82333",z.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:z=>{z.currentTarget.style.background="#dc3545",z.currentTarget.style.transform="translateY(0)"},children:[i.jsx("i",{className:"fa-solid fa-key"}),"Manage PIN"]}),i.jsxs("button",{onClick:()=>ge(!0),style:{background:"#7d8d86",color:"#ffffff",border:"none",borderRadius:"20px",padding:"8px 16px",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"6px"},onMouseEnter:z=>{z.currentTarget.style.background="#3e3f29",z.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:z=>{z.currentTarget.style.background="#7d8d86",z.currentTarget.style.transform="translateY(0)"},children:[i.jsx("i",{className:"fa-solid fa-chart-line"}),"Reports"]}),i.jsx("button",{onClick:t,style:{background:"none",border:"2px solid #7d8d86",color:"#3e3f29",width:"40px",height:"40px",borderRadius:"50%",cursor:"pointer",fontSize:"20px",transition:"all 0.3s ease"},onMouseEnter:z=>{z.currentTarget.style.background="#7d8d86",z.currentTarget.style.color="#ffffff",z.currentTarget.style.transform="rotate(90deg)"},onMouseLeave:z=>{z.currentTarget.style.background="none",z.currentTarget.style.color="#3e3f29",z.currentTarget.style.transform="rotate(0deg)"},children:""})]})]}),i.jsx("div",{style:{marginBottom:"20px"},children:i.jsxs("button",{onClick:()=>U(!A),style:{background:"#7d8d86",color:"#ffffff",border:"none",borderRadius:"25px",padding:"12px 24px",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px",margin:"0 auto"},onMouseEnter:z=>{z.currentTarget.style.background="#3e3f29",z.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:z=>{z.currentTarget.style.background="#7d8d86",z.currentTarget.style.transform="translateY(0)"},children:[i.jsx("i",{className:"fa-solid fa-plus"}),A?"Cancel":"Add Password"]})}),A&&i.jsxs("div",{style:{background:"rgba(125, 141, 134, 0.1)",borderRadius:"15px",padding:"20px",marginBottom:"20px",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsx("h3",{style:{color:"#3e3f29",fontSize:"18px",fontWeight:"600",marginBottom:"15px",textAlign:"center"},children:"Add New Password"}),i.jsxs("div",{style:{display:"grid",gap:"15px"},children:[i.jsx("input",{type:"text",placeholder:"Title (e.g., Facebook, Twitter)",value:V.title,onChange:z=>te({...V,title:z.target.value}),style:{padding:"12px 16px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"16px",outline:"none",transition:"all 0.3s ease"},onFocus:z=>{z.target.style.borderColor="#7d8d86",z.target.style.background="#ffffff"},onBlur:z=>{z.target.style.borderColor="rgba(125, 141, 134, 0.3)",z.target.style.background="#ffffff"}}),i.jsx("input",{type:"text",placeholder:"Username/Email",value:V.username,onChange:z=>te({...V,username:z.target.value}),style:{padding:"12px 16px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"16px",outline:"none",transition:"all 0.3s ease"},onFocus:z=>{z.target.style.borderColor="#7d8d86",z.target.style.background="#ffffff"},onBlur:z=>{z.target.style.borderColor="rgba(125, 141, 134, 0.3)",z.target.style.background="#ffffff"}}),i.jsx("input",{type:"password",placeholder:"Password",value:V.password,onChange:z=>te({...V,password:z.target.value}),style:{padding:"12px 16px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"16px",outline:"none",transition:"all 0.3s ease"},onFocus:z=>{z.target.style.borderColor="#7d8d86",z.target.style.background="#ffffff"},onBlur:z=>{z.target.style.borderColor="rgba(125, 141, 134, 0.3)",z.target.style.background="#ffffff"}}),i.jsx("input",{type:"url",placeholder:"Website (optional)",value:V.website,onChange:z=>te({...V,website:z.target.value}),style:{padding:"12px 16px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"16px",outline:"none",transition:"all 0.3s ease"},onFocus:z=>{z.target.style.borderColor="#7d8d86",z.target.style.background="#ffffff"},onBlur:z=>{z.target.style.borderColor="rgba(125, 141, 134, 0.3)",z.target.style.background="#ffffff"}}),i.jsxs("div",{style:{display:"flex",gap:"10px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>U(!1),style:{padding:"10px 20px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"20px",background:"transparent",color:"#7d8d86",fontSize:"14px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:z=>{z.currentTarget.style.background="rgba(125, 141, 134, 0.1)",z.currentTarget.style.borderColor="#7d8d86"},onMouseLeave:z=>{z.currentTarget.style.background="transparent",z.currentTarget.style.borderColor="rgba(125, 141, 134, 0.3)"},children:"Cancel"}),i.jsx("button",{onClick:pe,disabled:!V.title||!V.password,style:{padding:"10px 20px",border:"none",borderRadius:"20px",background:V.title&&V.password?"#7d8d86":"rgba(125, 141, 134, 0.3)",color:"#f1f0e4",fontSize:"14px",fontWeight:"600",cursor:V.title&&V.password?"pointer":"not-allowed",transition:"all 0.3s ease"},onMouseEnter:z=>{V.title&&V.password&&(z.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:z=>{z.currentTarget.style.transform="translateY(0)"},children:"Save Password"})]})]})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"20px"},children:i.jsxs("div",{style:{background:"rgba(125, 141, 134, 0.1)",borderRadius:"15px",padding:"20px",border:"1px solid rgba(125, 141, 134, 0.2)"},children:[i.jsxs("div",{style:{color:"#3e3f29",fontSize:"18px",fontWeight:"600",marginBottom:"15px",display:"flex",alignItems:"center",gap:"10px"},children:[i.jsx("i",{className:"fa-solid fa-shield-halved"}),"Saved Passwords"]}),v.length>0?i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:v.map(z=>i.jsxs("div",{style:{background:"#ffffff",borderRadius:"10px",padding:"15px",border:"1px solid rgba(125, 141, 134, 0.2)",transition:"all 0.3s ease",cursor:"pointer",position:"relative"},onMouseEnter:be=>{be.currentTarget.style.background="rgba(125, 141, 134, 0.1)",be.currentTarget.style.borderColor="#7d8d86",be.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:be=>{be.currentTarget.style.background="#ffffff",be.currentTarget.style.borderColor="rgba(125, 141, 134, 0.2)",be.currentTarget.style.transform="translateY(0)"},children:[i.jsx("button",{onClick:be=>{be.stopPropagation(),De(z.entry_id)},style:{position:"absolute",top:"8px",right:"8px",background:"none",border:"none",color:"#dc3545",fontSize:"16px",cursor:"pointer",padding:"4px",borderRadius:"4px",transition:"all 0.3s ease",width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:be=>{be.currentTarget.style.background="rgba(220, 53, 69, 0.1)",be.currentTarget.style.transform="scale(1.1)"},onMouseLeave:be=>{be.currentTarget.style.background="none",be.currentTarget.style.transform="scale(1)"},children:""}),i.jsx("div",{style:{color:"#3e3f29",fontWeight:"600",marginBottom:"5px",paddingRight:"30px"},children:z.label}),i.jsx("div",{style:{color:"#7d8d86",fontSize:"14px",marginBottom:"8px"},children:z.email}),i.jsx("div",{style:{color:"#3e3f29",fontSize:"14px",fontFamily:"monospace",marginBottom:"8px",padding:"4px 8px",background:"rgba(125, 141, 134, 0.1)",borderRadius:"4px",wordBreak:"break-all"},children:N.has(z.entry_id)?z.password:""}),i.jsxs("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap"},children:[i.jsxs("button",{onClick:()=>He(z.password,"Password"),style:{background:"#7d8d86",border:"none",color:"#ffffff",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:be=>{be.currentTarget.style.background="#3e3f29",be.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:be=>{be.currentTarget.style.background="#7d8d86",be.currentTarget.style.transform="translateY(0)"},children:[i.jsx("i",{className:"fa-solid fa-copy",style:{marginRight:"4px"}}),"Copy"]}),i.jsxs("button",{onClick:()=>He(z.email,"Email"),style:{background:"#7d8d86",border:"none",color:"#ffffff",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:be=>{be.currentTarget.style.background="#3e3f29",be.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:be=>{be.currentTarget.style.background="#7d8d86",be.currentTarget.style.transform="translateY(0)"},children:[i.jsx("i",{className:"fa-solid fa-envelope",style:{marginRight:"4px"}}),"Copy Email"]}),i.jsxs("button",{onClick:()=>Ge(z.entry_id),style:{background:N.has(z.entry_id)?"#3e3f29":"#7d8d86",border:"none",color:"#ffffff",padding:"6px 12px",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:be=>{be.currentTarget.style.background=N.has(z.entry_id)?"#7d8d86":"#3e3f29",be.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:be=>{be.currentTarget.style.background=N.has(z.entry_id)?"#3e3f29":"#7d8d86",be.currentTarget.style.transform="translateY(0)"},children:[i.jsx("i",{className:`fa-solid ${N.has(z.entry_id)?"fa-eye-slash":"fa-eye"}`,style:{marginRight:"4px"}}),N.has(z.entry_id)?"Hide":"Show"]})]})]},z.entry_id))}):i.jsxs("div",{style:{textAlign:"center",padding:"20px",color:"#bca88d",fontSize:"14px"},children:[i.jsx("i",{className:"fa-solid fa-folder-open",style:{fontSize:"24px",marginBottom:"8px",display:"block"}}),"No passwords saved yet"]})]})})]})}),L&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"20px",padding:"30px",border:"1px solid rgba(125, 141, 134, 0.2)",boxShadow:"0 20px 40px rgba(62, 63, 41, 0.15)",maxWidth:"400px",width:"90%",textAlign:"center",color:"#3e3f29"},children:[i.jsx("h3",{style:{color:"#3e3f29",fontSize:"20px",fontWeight:"600",marginBottom:"15px"},children:"Delete Password?"}),i.jsx("p",{style:{color:"#7d8d86",fontSize:"16px",marginBottom:"25px",lineHeight:"1.5"},children:"Are you sure you want to delete this password? This action cannot be undone."}),i.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>X(null),style:{padding:"12px 24px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"25px",background:"transparent",color:"#7d8d86",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:z=>{z.currentTarget.style.background="rgba(125, 141, 134, 0.1)",z.currentTarget.style.borderColor="#7d8d86"},onMouseLeave:z=>{z.currentTarget.style.background="transparent",z.currentTarget.style.borderColor="rgba(125, 141, 134, 0.3)"},children:"Cancel"}),i.jsx("button",{onClick:()=>Be(L),style:{padding:"12px 24px",border:"none",borderRadius:"25px",background:"#dc3545",color:"#ffffff",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:z=>{z.currentTarget.style.background="#c82333",z.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:z=>{z.currentTarget.style.background="#dc3545",z.currentTarget.style.transform="translateY(0)"},children:"Delete"})]})]})}),Re&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"20px",padding:"30px",border:"1px solid rgba(125, 141, 134, 0.2)",boxShadow:"0 20px 40px rgba(62, 63, 41, 0.15)",maxWidth:"500px",width:"90%",textAlign:"center",color:"#3e3f29"},children:[i.jsxs("h3",{style:{color:"#3e3f29",fontSize:"24px",fontWeight:"600",marginBottom:"20px",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[i.jsx("i",{className:"fa-solid fa-key",style:{color:"#dc3545"}}),"Manage System PIN"]}),i.jsx("p",{style:{color:"#7d8d86",fontSize:"16px",marginBottom:"30px",lineHeight:"1.5"},children:"Change the system access PIN. This PIN is required to access the POS system."}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"20px",marginBottom:"30px"},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#3e3f29",marginBottom:"8px",textAlign:"left"},children:"New PIN (minimum 4 digits)"}),i.jsx("input",{type:"password",value:Ae,onChange:z=>ee(z.target.value),placeholder:"Enter new PIN",style:{width:"100%",padding:"12px 16px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"16px",outline:"none",transition:"all 0.3s ease",fontFamily:"monospace",letterSpacing:"2px"},onFocus:z=>{z.target.style.borderColor="#dc3545"},onBlur:z=>{z.target.style.borderColor="rgba(125, 141, 134, 0.3)"},maxLength:10})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"600",color:"#3e3f29",marginBottom:"8px",textAlign:"left"},children:"Confirm PIN"}),i.jsx("input",{type:"password",value:ye,onChange:z=>ae(z.target.value),placeholder:"Confirm new PIN",style:{width:"100%",padding:"12px 16px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"10px",background:"#ffffff",color:"#3e3f29",fontSize:"16px",outline:"none",transition:"all 0.3s ease",fontFamily:"monospace",letterSpacing:"2px"},onFocus:z=>{z.target.style.borderColor="#dc3545"},onBlur:z=>{z.target.style.borderColor="rgba(125, 141, 134, 0.3)"},maxLength:10})]})]}),i.jsxs("div",{style:{display:"flex",gap:"15px",justifyContent:"center"},children:[i.jsx("button",{onClick:()=>fe(!1),style:{padding:"12px 24px",border:"2px solid rgba(125, 141, 134, 0.3)",borderRadius:"25px",background:"transparent",color:"#7d8d86",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},onMouseEnter:z=>{z.currentTarget.style.background="rgba(125, 141, 134, 0.1)",z.currentTarget.style.borderColor="#7d8d86"},onMouseLeave:z=>{z.currentTarget.style.background="transparent",z.currentTarget.style.borderColor="rgba(125, 141, 134, 0.3)"},children:"Cancel"}),i.jsx("button",{onClick:de,disabled:Se||Ae.length<4||Ae!==ye,style:{padding:"12px 24px",border:"none",borderRadius:"25px",background:Se||Ae.length<4||Ae!==ye?"rgba(220, 53, 69, 0.3)":"#dc3545",color:"#ffffff",fontSize:"16px",fontWeight:"600",cursor:Se||Ae.length<4||Ae!==ye?"not-allowed":"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:z=>{!Se&&Ae.length>=4&&Ae===ye&&(z.currentTarget.style.background="#c82333",z.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:z=>{z.currentTarget.style.background=Se||Ae.length<4||Ae!==ye?"rgba(220, 53, 69, 0.3)":"#dc3545",z.currentTarget.style.transform="translateY(0)"},children:Se?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin"}),"Updating..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-save"}),"Update PIN"]})})]})]})}),i.jsx(_R,{isOpen:le,onClose:()=>ge(!1),vaultEntries:v})]}):null},wR=()=>{const[e,t]=j.useState([]),[r,a]=j.useState(!1),[o,c]=j.useState(!1),[d,f]=j.useState(null),[p,h]=j.useState({username:"",password:"",role:"Cashier",icon:"ryu"}),x=[{name:"lily",label:"Lily"},{name:"chunli",label:"Chun-Li"},{name:"ken",label:"Ken"},{name:"kimberly",label:"Kimberly"},{name:"mai",label:"Mai"},{name:"manon",label:"Manon"},{name:"rashid",label:"Rashid"},{name:"ryu",label:"Ryu"},{name:"zangief",label:"Zangief"}],[y,b]=j.useState(!1),[v,w]=j.useState(""),[_,T]=j.useState(!0),[M,F]=j.useState(!1);j.useEffect(()=>{A()},[]);const A=async()=>{try{T(!0);const{data:X,error:le}=await Oe.from("users").select("*").order("user_id",{ascending:!1});if(le){console.error("Error fetching users:",le),w("Failed to fetch users");return}t(X||[])}catch(X){console.error("Error fetching users:",X),w("Failed to fetch users")}finally{T(!1)}},U=async X=>{X.preventDefault(),b(!0),w("");try{const le=A0(p.password),{error:ge}=await Oe.from("users").insert([{username:p.username,password_hash:le,role:p.role,active:!0,icon:p.icon}]).select();if(ge)throw console.error("Error adding user:",ge),ge;h({username:"",password:"",role:"Cashier",icon:"ryu"}),a(!1),A()}catch(le){console.error("Error adding user:",le),w(`Failed to add user: ${le instanceof Error?le.message:"Unknown error"}`)}finally{b(!1)}},V=async X=>{if(confirm("Are you sure you want to delete this user?"))try{const{error:le}=await Oe.from("users").delete().eq("user_id",X);if(le)throw console.error("Error deleting user:",le),le;A()}catch(le){console.error("Error deleting user:",le),w(`Failed to delete user: ${le instanceof Error?le.message:"Unknown error"}`)}},te=async(X,le)=>{try{const{error:ge}=await Oe.from("users").update({active:!le}).eq("user_id",X);if(ge)throw console.error("Error updating user status:",ge),ge;A()}catch(ge){console.error("Error updating user status:",ge),w(`Failed to update user: ${ge instanceof Error?ge.message:"Unknown error"}`)}},N=X=>{f(X),h({username:X.username,password:"",role:X.role,icon:X.icon||"ryu"}),c(!0)},re=async X=>{if(X.preventDefault(),!!d){b(!0),w("");try{const le={username:p.username,role:p.role,icon:p.icon};p.password.trim()&&(le.password_hash=A0(p.password));const{error:ge}=await Oe.from("users").update(le).eq("user_id",d.user_id);if(ge)throw console.error("Error updating user:",ge),ge;h({username:"",password:"",role:"Cashier",icon:"ryu"}),f(null),c(!1),A()}catch(le){console.error("Error updating user:",le),w(`Failed to update user: ${le instanceof Error?le.message:"Unknown error"}`)}finally{b(!1)}}},L=X=>{switch(X){case"Admin":return"#ef4444";case"Manager":return"#f59e0b";case"Cashier":return"#3b82f6";default:return"#1a1a1a"}};return _?i.jsxs("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"400px",fontSize:"18px",color:"#1a1a1a"},children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin",style:{marginRight:"12px"}}),"Loading users..."]}):i.jsxs("div",{style:{padding:"24px",maxWidth:"1200px",margin:"0 auto"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"32px"},children:[i.jsxs("div",{children:[i.jsxs("h1",{style:{fontSize:"32px",fontWeight:"600",color:"#1a1a1a",margin:"0 0 8px 0"},children:[i.jsx("i",{className:"fa-solid fa-users-cog",style:{marginRight:"12px",color:"#7d8d86"}}),"User Management"]}),i.jsx("p",{style:{color:"#1a1a1a",margin:"0",fontSize:"18px"},children:"Manage system users and their permissions"})]}),i.jsxs("button",{onClick:()=>a(!0),style:{background:"#7d8d86",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"18px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"8px",transition:"all 0.2s ease"},children:[i.jsx("i",{className:"fa-solid fa-plus"}),"Add User"]})]}),v&&i.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",color:"#dc2626",padding:"12px 16px",borderRadius:"8px",marginBottom:"24px",display:"flex",alignItems:"center",gap:"8px"},children:[i.jsx("i",{className:"fa-solid fa-triangle-exclamation"}),v]}),i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden"},children:[i.jsx("div",{style:{padding:"20px 24px",borderBottom:"2px solid #d1d5db",background:"#f9fafb"},children:i.jsxs("h3",{style:{margin:"0",fontSize:"20px",fontWeight:"600",color:"#1a1a1a"},children:[i.jsx("i",{className:"fa-solid fa-list",style:{marginRight:"8px",color:"#7d8d86"}}),"All Users (",e.length,")"]})}),e.length===0?i.jsxs("div",{style:{padding:"48px 24px",textAlign:"center",color:"#1a1a1a"},children:[i.jsx("i",{className:"fa-solid fa-users",style:{fontSize:"48px",marginBottom:"16px",opacity:.5}}),i.jsx("p",{style:{fontSize:"20px",margin:"0 0 8px 0"},children:"No users found"}),i.jsx("p",{style:{fontSize:"16px",margin:"0"},children:"Add your first user to get started"})]}):i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f9fafb"},children:[i.jsx("th",{style:{padding:"16px 24px",textAlign:"left",fontWeight:"600",color:"#1a1a1a",borderBottom:"2px solid #d1d5db",fontSize:"16px"},children:"User"}),i.jsx("th",{style:{padding:"16px 24px",textAlign:"center",fontWeight:"600",color:"#1a1a1a",borderBottom:"2px solid #d1d5db",fontSize:"16px"},children:"Icon"}),i.jsx("th",{style:{padding:"16px 24px",textAlign:"left",fontWeight:"600",color:"#1a1a1a",borderBottom:"2px solid #d1d5db",fontSize:"16px"},children:"Role"}),i.jsx("th",{style:{padding:"16px 24px",textAlign:"left",fontWeight:"600",color:"#1a1a1a",borderBottom:"2px solid #d1d5db",fontSize:"16px"},children:"Status"}),i.jsx("th",{style:{padding:"16px 24px",textAlign:"left",fontWeight:"600",color:"#1a1a1a",borderBottom:"2px solid #d1d5db",fontSize:"16px"},children:"User ID"}),i.jsx("th",{style:{padding:"16px 24px",textAlign:"center",fontWeight:"600",color:"#1a1a1a",borderBottom:"2px solid #d1d5db",fontSize:"16px"},children:"Actions"})]})}),i.jsx("tbody",{children:e.map((X,le)=>i.jsxs("tr",{style:{borderBottom:le<e.length-1?"1px solid #f3f4f6":"none"},children:[i.jsx("td",{style:{padding:"16px 24px"},children:i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:"500",color:"#1a1a1a",marginBottom:"4px",fontSize:"16px"},children:X.username}),i.jsxs("div",{style:{fontSize:"15px",color:"#1a1a1a"},children:["ID: ",X.user_id]})]})}),i.jsx("td",{style:{padding:"16px 24px",textAlign:"center"},children:i.jsx("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto",overflow:"hidden",border:"2px solid #e5e7eb"},children:X.icon?i.jsx("img",{src:`/images/icons/${X.icon}.png`,alt:X.icon,style:{width:"40px",height:"40px",objectFit:"cover",borderRadius:"50%"}}):i.jsx("i",{className:"fa-solid fa-user",style:{fontSize:"20px",color:"#9ca3af"}})})}),i.jsx("td",{style:{padding:"16px 24px"},children:i.jsx("span",{style:{background:`${L(X.role)}20`,color:L(X.role),padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"500",textTransform:"capitalize"},children:X.role})}),i.jsx("td",{style:{padding:"16px 24px"},children:i.jsx("span",{style:{background:X.active?"#dcfce720":"#fef2f220",color:X.active?"#16a34a":"#dc2626",padding:"4px 12px",borderRadius:"20px",fontSize:"14px",fontWeight:"500"},children:X.active?"Active":"Inactive"})}),i.jsxs("td",{style:{padding:"16px 24px",color:"#1a1a1a",fontSize:"15px"},children:["User #",X.user_id]}),i.jsx("td",{style:{padding:"16px 24px",textAlign:"center"},children:i.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[i.jsxs("button",{onClick:()=>N(X),style:{background:"#e0f2fe",color:"#0c4a6e",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},title:"Edit User",children:[i.jsx("i",{className:"fa-solid fa-pen-to-square"}),"Edit"]}),i.jsxs("button",{onClick:()=>te(X.user_id,X.active),style:{background:X.active?"#fef2f2":"#dcfce7",color:X.active?"#dc2626":"#16a34a",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},title:X.active?"Deactivate":"Activate",children:[i.jsx("i",{className:`fa-solid fa-${X.active?"ban":"check"}`}),X.active?"Deactivate":"Activate"]}),i.jsxs("button",{onClick:()=>V(X.user_id),style:{background:"#fef2f2",color:"#dc2626",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",display:"flex",alignItems:"center",gap:"4px"},title:"Delete User",children:[i.jsx("i",{className:"fa-solid fa-trash"}),"Delete"]})]})})]},X.user_id))})]})})]}),r&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"32px",width:"90%",maxWidth:"500px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[i.jsxs("h2",{style:{margin:"0",fontSize:"26px",fontWeight:"600",color:"#1a1a1a"},children:[i.jsx("i",{className:"fa-solid fa-user-plus",style:{marginRight:"8px",color:"#7d8d86"}}),"Add New User"]}),i.jsx("button",{onClick:()=>a(!1),style:{background:"none",border:"none",fontSize:"20px",color:"#1a1a1a",cursor:"pointer",padding:"4px"},children:i.jsx("i",{className:"fa-solid fa-xmark"})})]}),i.jsxs("form",{onSubmit:U,children:[i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#1a1a1a"},children:"Username *"}),i.jsx("input",{type:"text",value:p.username,onChange:X=>h({...p,username:X.target.value}),required:!0,style:{width:"100%",padding:"12px 16px",border:"2px solid #d1d5db",borderRadius:"8px",fontSize:"16px",boxSizing:"border-box"},placeholder:"Enter username"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#1a1a1a"},children:"Password *"}),i.jsx("input",{type:"password",value:p.password,onChange:X=>h({...p,password:X.target.value}),required:!0,style:{width:"100%",padding:"12px 16px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"16px",boxSizing:"border-box"},placeholder:"Enter password"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#1a1a1a"},children:"Role *"}),i.jsxs("select",{value:p.role,onChange:X=>h({...p,role:X.target.value}),required:!0,style:{width:"100%",padding:"12px 16px",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"16px",boxSizing:"border-box",background:"#ffffff"},children:[i.jsx("option",{value:"cashier",children:"Cashier"}),i.jsx("option",{value:"manager",children:"Manager"}),i.jsx("option",{value:"admin",children:"Admin"})]})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"16px",fontWeight:"600",color:"#1a1a1a",fontSize:"16px"},children:"Character Icon *"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",padding:"20px",border:"2px solid #e5e7eb",borderRadius:"16px",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.06)"},children:x.map(X=>i.jsxs("button",{type:"button",onClick:()=>h({...p,icon:X.name}),style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",border:p.icon===X.name?"3px solid #7d8d86":"2px solid #e5e7eb",borderRadius:"20px",background:p.icon===X.name?"linear-gradient(135deg, #7d8d86 0%, #5a6b5f 100%)":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:p.icon===X.name?"scale(1.05)":"scale(1)",boxShadow:p.icon===X.name?"0 8px 25px rgba(125, 141, 134, 0.3), 0 0 0 1px rgba(125, 141, 134, 0.1)":"0 2px 8px rgba(0, 0, 0, 0.1)",position:"relative",overflow:"hidden"},children:[i.jsx("div",{style:{position:"relative",width:"56px",height:"56px",borderRadius:"50%",overflow:"hidden",border:"3px solid rgba(255, 255, 255, 0.8)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"},children:i.jsx("img",{src:`/images/icons/${X.name}.png`,alt:X.label,style:{width:"100%",height:"100%",objectFit:"cover",filter:p.icon===X.name?"brightness(1.1) contrast(1.1)":"none"}})}),p.icon===X.name&&i.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",width:"20px",height:"20px",borderRadius:"50%",background:"#10b981",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",zIndex:10},children:i.jsx("i",{className:"fa-solid fa-check",style:{fontSize:"10px",color:"white"}})})]},X.name))})]}),i.jsxs("div",{style:{display:"flex",gap:"16px",justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:()=>a(!1),style:{background:"#f3f4f6",color:"#1a1a1a",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:y,style:{background:y?"#9ca3af":"linear-gradient(135deg, #7d8d86, #3e3f29)",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:y?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:y?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin"}),"Adding..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-plus"}),"Add User"]})})]})]})]})}),o&&d&&i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:i.jsxs("div",{style:{background:"#ffffff",borderRadius:"12px",padding:"32px",width:"90%",maxWidth:"500px",maxHeight:"90vh",overflowY:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"24px"},children:[i.jsxs("h2",{style:{margin:"0",fontSize:"24px",fontWeight:"600",color:"#1a1a1a"},children:[i.jsx("i",{className:"fa-solid fa-user-pen",style:{marginRight:"8px",color:"#7d8d86"}}),"Edit User"]}),i.jsx("button",{onClick:()=>{c(!1),f(null)},style:{background:"none",border:"none",fontSize:"20px",color:"#1a1a1a",cursor:"pointer",padding:"4px"},children:i.jsx("i",{className:"fa-solid fa-xmark"})})]}),i.jsxs("form",{onSubmit:re,children:[i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#1a1a1a"},children:"Username *"}),i.jsx("input",{type:"text",value:p.username,onChange:X=>h({...p,username:X.target.value}),required:!0,style:{width:"100%",padding:"12px 16px",border:"2px solid #d1d5db",borderRadius:"8px",fontSize:"16px",boxSizing:"border-box"},placeholder:"Enter username"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#1a1a1a"},children:"New Password (leave blank to keep current)"}),i.jsx("input",{type:"password",value:p.password,onChange:X=>h({...p,password:X.target.value}),style:{width:"100%",padding:"12px 16px",border:"2px solid #d1d5db",borderRadius:"8px",fontSize:"16px",boxSizing:"border-box"},placeholder:"Enter new password (optional)"})]}),i.jsxs("div",{style:{marginBottom:"20px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"500",color:"#1a1a1a"},children:"Role *"}),i.jsxs("select",{value:p.role,onChange:X=>h({...p,role:X.target.value}),required:!0,style:{width:"100%",padding:"12px 16px",border:"2px solid #d1d5db",borderRadius:"8px",fontSize:"16px",boxSizing:"border-box",background:"#ffffff"},children:[i.jsx("option",{value:"Cashier",children:"Cashier"}),i.jsx("option",{value:"Manager",children:"Manager"}),i.jsx("option",{value:"Admin",children:"Admin"})]})]}),i.jsxs("div",{style:{marginBottom:"24px"},children:[i.jsx("label",{style:{display:"block",marginBottom:"16px",fontWeight:"600",color:"#1a1a1a",fontSize:"16px"},children:"Character Icon *"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"16px",padding:"20px",border:"2px solid #e5e7eb",borderRadius:"16px",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)",boxShadow:"inset 0 2px 4px rgba(0, 0, 0, 0.06)"},children:x.map(X=>i.jsxs("button",{type:"button",onClick:()=>h({...p,icon:X.name}),style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px",border:p.icon===X.name?"3px solid #7d8d86":"2px solid #e5e7eb",borderRadius:"20px",background:p.icon===X.name?"linear-gradient(135deg, #7d8d86 0%, #5a6b5f 100%)":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:p.icon===X.name?"scale(1.05)":"scale(1)",boxShadow:p.icon===X.name?"0 8px 25px rgba(125, 141, 134, 0.3), 0 0 0 1px rgba(125, 141, 134, 0.1)":"0 2px 8px rgba(0, 0, 0, 0.1)",position:"relative",overflow:"hidden"},children:[i.jsx("div",{style:{position:"relative",width:"56px",height:"56px",borderRadius:"50%",overflow:"hidden",border:"3px solid rgba(255, 255, 255, 0.8)",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"},children:i.jsx("img",{src:`/images/icons/${X.name}.png`,alt:X.label,style:{width:"100%",height:"100%",objectFit:"cover",filter:p.icon===X.name?"brightness(1.1) contrast(1.1)":"none"}})}),p.icon===X.name&&i.jsx("div",{style:{position:"absolute",top:"4px",right:"4px",width:"20px",height:"20px",borderRadius:"50%",background:"#10b981",display:"flex",alignItems:"center",justifyContent:"center",border:"2px solid white",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",zIndex:10},children:i.jsx("i",{className:"fa-solid fa-check",style:{fontSize:"10px",color:"white"}})})]},X.name))})]}),i.jsxs("div",{style:{display:"flex",gap:"16px",justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",onClick:()=>{c(!1),f(null)},style:{background:"#f3f4f6",color:"#1a1a1a",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Cancel"}),i.jsx("button",{type:"submit",disabled:y,style:{background:y?"#9ca3af":"#7d8d86",color:"white",border:"none",borderRadius:"8px",padding:"12px 24px",fontSize:"16px",fontWeight:"500",cursor:y?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:"8px"},children:y?i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-spinner fa-spin"}),"Updating..."]}):i.jsxs(i.Fragment,{children:[i.jsx("i",{className:"fa-solid fa-floppy-disk"}),"Update User"]})})]})]})]})}),i.jsx("div",{onClick:()=>F(!0),title:"Access Secure Vault - Manage sensitive operations and settings",style:{position:"fixed",bottom:"24px",right:"24px",zIndex:50,width:"120px",height:"120px",borderRadius:"50%",background:"linear-gradient(135deg, #7d8d86, #3e3f29)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 24px rgba(125, 141, 134, 0.4)",cursor:"pointer",transition:"all 0.2s ease"},children:i.jsx("i",{className:"fa-solid fa-vault",style:{fontSize:"48px",color:"#f1f0e4"}})}),i.jsx(SR,{isOpen:M,onClose:()=>F(!1)})]})},TR="_container_k4aew_2",ER="_header_k4aew_10",kR="_title_k4aew_16",jR="_mainContent_k4aew_32",CR="_offlineNotice_k4aew_39",AR="_offlineNoticeContent_k4aew_51",RR="_dateNavigation_k4aew_62",DR="_navButton_k4aew_76",NR="_currentDate_k4aew_102",OR="_controls_k4aew_144",MR="_button_k4aew_151",BR="_buttonPrimary_k4aew_170",IR="_buttonSecondary_k4aew_179",FR="_buttonDanger_k4aew_192",LR="_notesContainer_k4aew_202",PR="_gridBackground_k4aew_218",zR="_gridPattern_k4aew_224",UR="_emptyState_k4aew_234",WR="_emptyStateContent_k4aew_242",$R="_emptyStateIcon_k4aew_247",HR="_emptyStateTitle_k4aew_252",qR="_dragIndicator_k4aew_258",GR="_footer_k4aew_271",YR="_stickyNote_k4aew_279",VR="_stickyNoteDragging_k4aew_286",XR="_note_k4aew_202",KR="_noteOverdue_k4aew_306",QR="_noteDueToday_k4aew_310",JR="_noteYellow_k4aew_315",ZR="_notePink_k4aew_321",eD="_noteBlue_k4aew_327",tD="_noteGreen_k4aew_333",rD="_notePurple_k4aew_339",nD="_noteOrange_k4aew_345",aD="_noteTopStrip_k4aew_351",sD="_noteContent_k4aew_433",iD="_noteContentEditing_k4aew_439",oD="_noteInput_k4aew_445",lD="_noteDateInput_k4aew_456",cD="_noteTextarea_k4aew_466",dD="_noteDisplay_k4aew_480",uD="_noteTitle_k4aew_486",fD="_noteTitleResolved_k4aew_494",hD="_noteDate_k4aew_456",pD="_noteDateOverdue_k4aew_505",gD="_noteDateToday_k4aew_510",xD="_noteBody_k4aew_515",mD="_noteBodyResolved_k4aew_524",yD="_noteCorner_k4aew_529",vD="_noteCornerEffect_k4aew_537",bD="_modalOverlay_k4aew_548",_D="_modal_k4aew_548",SD="_modalHeader_k4aew_569",wD="_modalTitle_k4aew_573",TD="_modalClose_k4aew_593",ED="_modalForm_k4aew_605",kD="_errorMessage_k4aew_611",jD="_errorContent_k4aew_619",CD="_formGroup_k4aew_628",AD="_formLabel_k4aew_633",RD="_formInput_k4aew_641",DD="_formTextarea_k4aew_655",ND="_colorSelection_k4aew_670",OD="_colorOption_k4aew_676",MD="_colorOptionSelected_k4aew_689",BD="_checkboxContainer_k4aew_694",ID="_formCheckbox_k4aew_700",FD="_checkboxLabel_k4aew_707",LD="_preview_k4aew_716",PD="_previewLabel_k4aew_720",zD="_previewNote_k4aew_728",UD="_previewTitle_k4aew_734",WD="_previewDate_k4aew_741",$D="_previewBody_k4aew_751",HD="_modalActions_k4aew_757",qD="_modalButton_k4aew_763",GD="_modalButtonCancel_k4aew_777",YD="_modalButtonSubmit_k4aew_786",VD="_modalButtonDanger_k4aew_795",XD="_loading_k4aew_805",KD="_loadingContent_k4aew_813",QD="_loadingIcon_k4aew_817",JD="_loadingText_k4aew_823",ZD="_confirmationDialog_k4aew_869",eN="_confirmationContent_k4aew_880",tN="_confirmationHeader_k4aew_889",rN="_confirmationIcon_k4aew_895",nN="_confirmationButton_k4aew_926",aN="_confirmationButtonCancel_k4aew_936",sN="_confirmationButtonConfirm_k4aew_945",iN="_calendarModal_k4aew_955",oN="_calendar_k4aew_955",lN="_calendarHeader_k4aew_981",cN="_calendarCloseButton_k4aew_989",dN="_calendarTitle_k4aew_1011",uN="_calendarNavButton_k4aew_1017",fN="_calendarGrid_k4aew_1035",hN="_calendarDayHeader_k4aew_1041",pN="_calendarDay_k4aew_1041",gN="_calendarDayOtherMonth_k4aew_1068",xN="_calendarDayToday_k4aew_1072",mN="_calendarDaySelected_k4aew_1082",yN="_calendarDayWithReminders_k4aew_1092",vN="_calendarDayWithRemindersToday_k4aew_1102",bN="_calendarDayWithRemindersSelected_k4aew_1111",_N="_calendarReminderCount_k4aew_1136",SN="_lilyMascot_k4aew_1178",wN="_lilySpeechBubble_k4aew_1188",TN="_lilySpeechTail_k4aew_1206",EN="_lilyImage_k4aew_1217",he={container:TR,header:ER,title:kR,mainContent:jR,offlineNotice:CR,offlineNoticeContent:AR,dateNavigation:RR,navButton:DR,currentDate:NR,controls:OR,button:MR,buttonPrimary:BR,buttonSecondary:IR,buttonDanger:FR,notesContainer:LR,gridBackground:PR,gridPattern:zR,emptyState:UR,emptyStateContent:WR,emptyStateIcon:$R,emptyStateTitle:HR,dragIndicator:qR,footer:GR,stickyNote:YR,stickyNoteDragging:VR,note:XR,noteOverdue:KR,noteDueToday:QR,noteYellow:JR,notePink:ZR,noteBlue:eD,noteGreen:tD,notePurple:rD,noteOrange:nD,noteTopStrip:aD,noteContent:sD,noteContentEditing:iD,noteInput:oD,noteDateInput:lD,noteTextarea:cD,noteDisplay:dD,noteTitle:uD,noteTitleResolved:fD,noteDate:hD,noteDateOverdue:pD,noteDateToday:gD,noteBody:xD,noteBodyResolved:mD,noteCorner:yD,noteCornerEffect:vD,modalOverlay:bD,modal:_D,modalHeader:SD,modalTitle:wD,modalClose:TD,modalForm:ED,errorMessage:kD,errorContent:jD,formGroup:CD,formLabel:AD,formInput:RD,formTextarea:DD,colorSelection:ND,colorOption:OD,colorOptionSelected:MD,checkboxContainer:BD,formCheckbox:ID,checkboxLabel:FD,preview:LD,previewLabel:PD,previewNote:zD,previewTitle:UD,previewDate:WD,previewBody:$D,modalActions:HD,modalButton:qD,modalButtonCancel:GD,modalButtonSubmit:YD,modalButtonDanger:VD,loading:XD,loadingContent:KD,loadingIcon:QD,loadingText:JD,confirmationDialog:ZD,confirmationContent:eN,confirmationHeader:tN,confirmationIcon:rN,confirmationButton:nN,confirmationButtonCancel:aN,confirmationButtonConfirm:sN,calendarModal:iN,calendar:oN,calendarHeader:lN,calendarCloseButton:cN,calendarTitle:dN,calendarNavButton:uN,calendarGrid:fN,calendarDayHeader:hN,calendarDay:pN,calendarDayOtherMonth:gN,calendarDayToday:xN,calendarDaySelected:mN,calendarDayWithReminders:yN,calendarDayWithRemindersToday:vN,calendarDayWithRemindersSelected:bN,calendarReminderCount:_N,lilyMascot:SN,lilySpeechBubble:wN,lilySpeechTail:TN,lilyImage:EN};function kN(){const{user:e,currentUserId:t}=xa(),[r,a]=j.useState([]),[o,c]=j.useState(!0),[d,f]=j.useState(null),[p,h]=j.useState({x:0,y:0}),[x,y]=j.useState(null),[b,v]=j.useState(!1),[w,_]=j.useState(!1),[T,M]=j.useState(!1),[F,A]=j.useState(null),[U,V]=j.useState({title:"",body:"",remind_date:new Date().toISOString().split("T")[0],color:"yellow"}),[te,N]=j.useState({title:"",body:"",remind_date:"",color:"yellow",resolved:!1}),[re,L]=j.useState(new Date),[X,le]=j.useState(!1),[ge,Re]=j.useState(!1),[fe,Ae]=j.useState(new Date),[ee,ye]=j.useState(!1),[ae,Se]=j.useState("Hi! I'm Lily, your reminder assistant! I can help you understand how to manage your reminders. Hover over different elements to learn more! Double-click me to disable me."),[k,J]=j.useState(()=>{const oe=localStorage.getItem("lilyEnabled");return oe!==null?JSON.parse(oe):!0}),[O,K]=j.useState(!0),Y={yellow:{bg:he.noteYellow,border:he.noteYellow,shadow:he.noteYellow},pink:{bg:he.notePink,border:he.notePink,shadow:he.notePink},blue:{bg:he.noteBlue,border:he.noteBlue,shadow:he.noteBlue},green:{bg:he.noteGreen,border:he.noteGreen,shadow:he.noteGreen},purple:{bg:he.notePurple,border:he.notePurple,shadow:he.notePurple},orange:{bg:he.noteOrange,border:he.noteOrange,shadow:he.noteOrange}},H=()=>{const oe=new Date(re);oe.setDate(oe.getDate()-1),L(oe)},pe=()=>{const oe=new Date(re);oe.setDate(oe.getDate()+1),L(oe)},Ge=oe=>{const Le=new Date(fe);oe==="prev"?Le.setMonth(Le.getMonth()-1):Le.setMonth(Le.getMonth()+1),Ae(Le)},He=oe=>{L(oe),Re(!1)},De=()=>{const oe=new Set;return r.forEach(Le=>{const lt=new Date(Le.remind_date);oe.add(lt.toDateString())}),oe},Be=()=>{const oe={};return r.forEach(Le=>{const Ct=new Date(Le.remind_date).toDateString();oe[Ct]=(oe[Ct]||0)+1}),oe},rt=()=>{const oe=fe.getFullYear(),Le=fe.getMonth(),lt=new Date(oe,Le,1),Ct=new Date(lt);Ct.setDate(Ct.getDate()-lt.getDay());const qt=[],dr=De(),er=Be(),Pt=new Date,ut=new Date(re);for(let Yt=0;Yt<42;Yt++){const wt=new Date(Ct);wt.setDate(Ct.getDate()+Yt);const se=wt.getMonth()===Le,_e=wt.toDateString()===Pt.toDateString(),gt=wt.toDateString()===ut.toDateString(),pt=dr.has(wt.toDateString()),Lt=er[wt.toDateString()]||0;qt.push({date:wt,isCurrentMonth:se,isToday:_e,isSelected:gt,hasReminders:pt,reminderCount:Lt})}return qt},de=()=>{const oe=!k;J(oe),localStorage.setItem("lilyEnabled",JSON.stringify(oe)),oe&&(Se("Hi! I'm back! I can help you understand how to manage your reminders. Hover over different elements to learn more! Double-click me to disable me."),ye(!0))},$e=()=>k?i.jsxs("div",{className:he.lilyMascot,children:[ee&&i.jsxs("div",{className:he.lilySpeechBubble,children:[i.jsx("p",{children:ae}),i.jsx("div",{className:he.lilySpeechTail})]}),i.jsx("div",{className:he.lilyImage,onClick:()=>{ye(!ee)},onDoubleClick:()=>{de()},children:i.jsx("img",{src:e?.icon?`/retailpos/images/icons/${e.icon}.png`:"/retailpos/images/backgrounds/lily.png",alt:e?.icon||"Lily"})})]}):null,z=()=>{const oe=new Date(re);return oe.setHours(0,0,0,0),r.filter(Le=>{const lt=new Date(Le.remind_date);lt.setHours(0,0,0,0);const Ct=lt.getTime()===oe.getTime(),qt=O||!Le.resolved;return Ct&&qt})},be=async()=>{if(a([]),le(!1),!b)try{const{error:oe}=await Oe.from("reminders").delete().neq("reminder_id",0);oe&&console.error("Error deleting all reminders from database:",oe)}catch(oe){console.error("Error deleting all reminders:",oe)}},Ke=async()=>{try{c(!0);const{data:oe,error:Le}=await Oe.from("reminders").select("*").order("remind_date",{ascending:!0});if(Le)throw console.error("Database fetch error:",Le),Le;console.log("Fetched reminders from database:",oe);const lt=oe?.map((Ct,qt)=>({...Ct,x:Math.random()*400+50,y:Math.random()*300+50,rotation:(Math.random()-.5)*6,isEditing:!1,color:Object.keys(Y)[qt%Object.keys(Y).length]}))||[];console.log("Reminders with UI properties:",lt),a(lt)}catch(oe){console.error("Error fetching reminders:",oe),y("Failed to load reminders. Please try again.")}finally{c(!1)}};j.useEffect(()=>{(async()=>{try{const{data:Le,error:lt}=await Oe.from("reminders").select("count",{count:"exact",head:!0});lt?(console.error("Table test error:",lt),y("Database table 'reminders' does not exist. Please run the SQL commands from database-schema.sql in your Supabase SQL editor."),v(!0),c(!1)):(console.log("Table exists, fetching reminders..."),Ke())}catch(Le){console.error("Table test failed:",Le),y("Failed to connect to database. Please check your connection.")}})()},[]);const je=()=>{V({title:"",body:"",remind_date:new Date().toISOString().split("T")[0],color:"yellow"}),y(null),_(!0)},dt=()=>{_(!1),V({title:"",body:"",remind_date:new Date().toISOString().split("T")[0],color:"yellow"})},We=()=>{M(!1),A(null),N({title:"",body:"",remind_date:"",color:"yellow",resolved:!1})},ot=async()=>{if(!F||!te.title.trim()||!te.body.trim()){y("Please fill in both title and body for the reminder.");return}await mt(F.reminder_id,{title:te.title.trim(),body:te.body.trim(),remind_date:te.remind_date,color:te.color,resolved:te.resolved}),We()},Ne=async()=>{if(!U.title.trim()||!U.body.trim()){y("Please fill in both title and body for the reminder.");return}const oe={title:U.title.trim(),body:U.body.trim(),remind_date:U.remind_date,owner_id:t?parseInt(t):1};if(b){const Le=Date.now();a([...r,{...oe,reminder_id:Le,created_at:new Date().toISOString()}]),dt();return}try{if(t)oe.owner_id=parseInt(t);else{const Ct=Date.now();a([...r,{...oe,reminder_id:Ct,created_at:new Date().toISOString()}]),dt();return}const{data:Le,error:lt}=await Oe.from("reminders").insert([{title:oe.title,body:oe.body,remind_date:oe.remind_date,owner_id:oe.owner_id}]).select().single();if(lt){const Ct=Date.now();a([...r,{...oe,reminder_id:Ct,created_at:new Date().toISOString()}]),dt();return}a([...r,{...oe,reminder_id:Le.reminder_id,created_at:new Date().toISOString()}]),dt()}catch(Le){console.error("Error adding reminder:",Le);const lt=Date.now();a([...r,{...oe,reminder_id:lt,created_at:new Date().toISOString()}]),dt()}},tt=async oe=>{if(a(r.filter(Le=>Le.reminder_id!==oe)),!b)try{const{error:Le}=await Oe.from("reminders").delete().eq("reminder_id",oe);Le&&console.error("Error deleting reminder from database:",Le)}catch(Le){console.error("Error deleting reminder:",Le)}},mt=async(oe,Le)=>{if(console.log("updateReminder called with:",{id:oe,updates:Le,offlineMode:b}),a(r.map(lt=>lt.reminder_id===oe?{...lt,...Le}:lt)),b){console.log("Offline mode - skipping database update");return}try{if(Le.title||Le.body||Le.remind_date||Le.resolved!==void 0){console.log("Updating database with:",{title:Le.title,body:Le.body,remind_date:Le.remind_date,resolved:Le.resolved});const{error:lt}=await Oe.from("reminders").update({title:Le.title,body:Le.body,remind_date:Le.remind_date,resolved:Le.resolved}).eq("reminder_id",oe);lt?console.error("Error updating reminder in database:",lt):console.log("Successfully updated reminder in database")}}catch(lt){console.error("Error updating reminder:",lt)}},ht=(oe,Le)=>{oe.preventDefault();const lt=oe.currentTarget.getBoundingClientRect();f(Le),h({x:oe.clientX-lt.left,y:oe.clientY-lt.top})},St=oe=>{if(d){const Le=document.getElementById("sticky-container");if(Le){const lt=Le.getBoundingClientRect(),Ct=Math.max(0,Math.min(oe.clientX-lt.left-p.x,lt.width-224)),qt=Math.max(0,Math.min(oe.clientY-lt.top-p.y,lt.height-224));a(r.map(dr=>dr.reminder_id===d.reminder_id?{...dr,x:Ct,y:qt}:dr))}}},It=()=>{f(null),h({x:0,y:0})};j.useEffect(()=>{if(d)return document.addEventListener("mousemove",St),document.addEventListener("mouseup",It),()=>{document.removeEventListener("mousemove",St),document.removeEventListener("mouseup",It)}},[d,p]);const Tt=({reminder:oe})=>{const[Le,lt]=j.useState(oe.title),[Ct,qt]=j.useState(oe.body),[dr,er]=j.useState(oe.remind_date),Pt=j.useRef(null);j.useEffect(()=>{oe.isEditing&&Pt.current&&(Pt.current.focus(),Pt.current.select())},[oe.isEditing]);const ut=Et=>{qt(Et.target.value),Et.target.style.height="auto",Et.target.style.height=Et.target.scrollHeight+"px"},Yt=()=>{Le.trim()&&Ct.trim()?mt(oe.reminder_id,{title:Le.trim(),body:Ct.trim(),remind_date:dr,isEditing:!1}):(lt(oe.title),qt(oe.body),er(oe.remind_date),mt(oe.reminder_id,{isEditing:!1}))},wt=Et=>{Et.key==="Enter"&&Et.shiftKey||(Et.key==="Enter"?(Et.preventDefault(),Yt()):Et.key==="Escape"&&(lt(oe.title),qt(oe.body),er(oe.remind_date),mt(oe.reminder_id,{isEditing:!1})))},se=Et=>{Et.key==="Enter"?(Et.preventDefault(),Yt()):Et.key==="Escape"&&(lt(oe.title),qt(oe.body),er(oe.remind_date),mt(oe.reminder_id,{isEditing:!1}))},_e=Y[oe.color]||Y.yellow,gt=new Date,pt=new Date(oe.remind_date),Lt=pt<gt&&pt.toDateString()!==gt.toDateString(),zt=pt.toDateString()===gt.toDateString();return i.jsx("div",{className:`${he.stickyNote} ${d?.reminder_id===oe.reminder_id?he.stickyNoteDragging:""}`,style:{left:`${oe.x}px`,top:`${oe.y}px`,transform:`rotate(${oe.rotation}deg)`},children:i.jsxs("div",{className:`${he.note} ${_e.bg} ${Lt?he.noteOverdue:zt?he.noteDueToday:""}`,onMouseDown:Et=>!oe.isEditing&&ht(Et,oe),children:[i.jsx("div",{className:`${he.noteTopStrip} ${_e.border}`}),i.jsx("div",{className:he.noteContent,children:oe.isEditing?i.jsxs("div",{className:he.noteContentEditing,children:[i.jsx("input",{type:"text",value:Le,onChange:Et=>lt(Et.target.value),onKeyDown:se,onBlur:Yt,className:he.noteInput,placeholder:"Reminder title..."}),i.jsx("input",{type:"date",value:dr,onChange:Et=>er(Et.target.value),onKeyDown:se,onBlur:Yt,className:he.noteDateInput}),i.jsx("textarea",{ref:Pt,value:Ct,onChange:ut,onBlur:Yt,onKeyDown:wt,className:he.noteTextarea,style:{fontFamily:"Comic Sans MS, cursive, sans-serif",minHeight:"80px"},placeholder:"Reminder details..."})]}):i.jsxs("div",{onContextMenu:Et=>{Et.preventDefault(),Et.stopPropagation(),console.log("Note right-clicked for reminder:",oe.reminder_id),A(oe),N({title:oe.title,body:oe.body,remind_date:oe.remind_date,color:oe.color||"yellow",resolved:oe.resolved||!1}),M(!0)},className:he.noteDisplay,children:[i.jsx("div",{className:he.noteTitle,children:i.jsx("span",{className:oe.resolved?he.noteTitleResolved:"",children:oe.title})}),i.jsxs("div",{className:`${he.noteDate} ${Lt?he.noteDateOverdue:zt?he.noteDateToday:""}`,children:[i.jsx("i",{className:"fa-solid fa-calendar",style:{marginRight:"0.25rem"}}),new Date(oe.remind_date).toLocaleDateString(),Lt&&i.jsx("span",{style:{color:"#dc2626",marginLeft:"0.5rem",fontWeight:"700"},children:"OVERDUE"}),zt&&!Lt&&i.jsx("span",{style:{color:"#d97706",marginLeft:"0.5rem",fontWeight:"700"},children:"TODAY"})]}),i.jsx("div",{className:`${he.noteBody} ${oe.resolved?he.noteBodyResolved:""}`,style:{fontFamily:"Comic Sans MS, cursive, sans-serif"},children:oe.body})]})}),i.jsx("div",{className:he.noteCorner,children:i.jsx("div",{className:`${he.noteCornerEffect} ${_e.bg}`})})]})})};return o?i.jsx("div",{className:he.loading,children:i.jsxs("div",{className:he.loadingContent,children:[i.jsx("i",{className:`fa-solid fa-spinner fa-spin ${he.loadingIcon}`}),i.jsx("p",{className:he.loadingText,children:"Loading reminders..."})]})}):i.jsxs("div",{className:he.container,children:[i.jsx("div",{className:he.header,children:i.jsxs("div",{className:he.title,children:[i.jsxs("h1",{children:[i.jsx("i",{className:"fa-solid fa-sticky-note",style:{marginRight:"0.75rem"}}),"Reminders"]}),i.jsx("p",{children:"Click and drag to move reminders around  Right-click to edit"})]})}),i.jsxs("div",{className:he.mainContent,children:[i.jsxs("div",{className:he.dateNavigation,children:[i.jsx("button",{onClick:H,className:he.navButton,onMouseEnter:()=>{k&&(Se("Click this arrow to go to the previous day! This helps you navigate through your reminders day by day."),ye(!0))},onMouseLeave:()=>{k&&ye(!1)},children:i.jsx("i",{className:"fa-solid fa-chevron-left"})}),i.jsx("div",{className:he.currentDate,onClick:()=>Re(!ge),style:{cursor:"pointer"},onMouseEnter:()=>{k&&(Se("Click on this date to open the calendar modal! You can see all your reminders and navigate to any date quickly."),ye(!0))},onMouseLeave:()=>{k&&ye(!1)},children:re.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),i.jsx("button",{onClick:pe,className:he.navButton,onMouseEnter:()=>{k&&(Se("Click this arrow to go to the next day! This helps you navigate through your reminders day by day."),ye(!0))},onMouseLeave:()=>{k&&ye(!1)},children:i.jsx("i",{className:"fa-solid fa-chevron-right"})})]}),ge&&i.jsx("div",{className:he.calendarModal,onClick:()=>Re(!1),children:i.jsxs("div",{className:he.calendar,onClick:oe=>oe.stopPropagation(),children:[i.jsxs("div",{className:he.calendarHeader,children:[i.jsx("button",{onClick:()=>Re(!1),className:he.calendarCloseButton,children:i.jsx("i",{className:"fa-solid fa-times"})}),i.jsx("button",{onClick:()=>Ge("prev"),className:he.calendarNavButton,children:i.jsx("i",{className:"fa-solid fa-chevron-left"})}),i.jsx("div",{className:he.calendarTitle,children:fe.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),i.jsx("button",{onClick:()=>Ge("next"),className:he.calendarNavButton,children:i.jsx("i",{className:"fa-solid fa-chevron-right"})})]}),i.jsxs("div",{className:he.calendarGrid,children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(oe=>i.jsx("div",{className:he.calendarDayHeader,children:oe},oe)),rt().map((oe,Le)=>{let lt=he.calendarDay;return oe.isCurrentMonth?oe.hasReminders&&oe.isToday?lt+=` ${he.calendarDayWithRemindersToday}`:oe.hasReminders&&oe.isSelected?lt+=` ${he.calendarDayWithRemindersSelected}`:oe.hasReminders?lt+=` ${he.calendarDayWithReminders}`:oe.isToday?lt+=` ${he.calendarDayToday}`:oe.isSelected&&(lt+=` ${he.calendarDaySelected}`):lt+=` ${he.calendarDayOtherMonth}`,i.jsxs("div",{className:lt,onClick:()=>He(oe.date),children:[oe.date.getDate(),oe.hasReminders&&i.jsx("div",{className:he.calendarReminderCount,children:oe.reminderCount})]},Le)})]})]})}),b&&i.jsx("div",{className:he.offlineNotice,children:i.jsxs("div",{className:he.offlineNoticeContent,children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{marginRight:"0.5rem"}}),i.jsxs("div",{children:[i.jsx("strong",{children:"Offline Mode:"})," The reminders table doesn't exist in your database yet. Reminders will work locally but won't be saved permanently.",i.jsx("a",{href:"#",onClick:()=>window.open("https://supabase.com/dashboard","_blank"),style:{textDecoration:"underline",marginLeft:"0.25rem"},children:"Create the table in Supabase"})]})]})}),i.jsxs("div",{className:he.controls,children:[i.jsxs("button",{onClick:je,className:`${he.button} ${he.buttonPrimary}`,onMouseEnter:()=>{k&&(Se("Click this button to add a new reminder! You can set the title, content, date, and color for your reminder."),ye(!0))},onMouseLeave:()=>{k&&ye(!1)},children:[i.jsx("i",{className:"fa-solid fa-plus-circle"}),i.jsx("span",{style:{marginLeft:"0.5rem"},children:"Add Reminder"})]}),i.jsxs("button",{onClick:()=>{const oe=document.getElementById("sticky-container");if(oe){const Le=oe.getBoundingClientRect();a(r.map(lt=>({...lt,x:Math.random()*(Le.width-224)+20,y:Math.random()*(Le.height-224)+20,rotation:(Math.random()-.5)*6})))}},className:`${he.button} ${he.buttonSecondary}`,onMouseEnter:()=>{k&&(Se("Click this button to shuffle all your reminders around! This gives them new random positions on the board."),ye(!0))},onMouseLeave:()=>{k&&ye(!1)},children:[i.jsx("i",{className:"fa-solid fa-random"}),i.jsx("span",{style:{marginLeft:"0.5rem"},children:"Shuffle"})]}),i.jsxs("button",{onClick:()=>K(!O),className:`${he.button} ${O?he.buttonPrimary:he.buttonSecondary}`,onMouseEnter:()=>{k&&(Se(O?"Click to hide completed reminders and focus on what's still pending!":"Click to show all reminders including completed ones!"),ye(!0))},onMouseLeave:()=>{k&&ye(!1)},children:[i.jsx("i",{className:`fa-solid ${O?"fa-eye":"fa-eye-slash"}`}),i.jsx("span",{style:{marginLeft:"0.5rem"},children:O?"Show All":"Hide Completed"})]}),r.length>0&&i.jsxs("button",{onClick:()=>le(!0),className:`${he.button} ${he.buttonDanger}`,onMouseEnter:()=>{k&&(Se("Click this button to remove all reminders at once! Be careful - this action cannot be undone."),ye(!0))},onMouseLeave:()=>{k&&ye(!1)},children:[i.jsx("i",{className:"fa-solid fa-trash-can"}),i.jsx("span",{style:{marginLeft:"0.5rem"},children:"Clear All"})]})]}),i.jsxs("div",{id:"sticky-container",className:he.notesContainer,style:{minHeight:"600px"},children:[i.jsx("div",{className:he.gridBackground,children:i.jsx("div",{className:he.gridPattern})}),z().map(oe=>i.jsx(Tt,{reminder:oe},oe.reminder_id)),z().length===0&&i.jsx("div",{className:he.emptyState,children:i.jsxs("div",{className:he.emptyStateContent,children:[i.jsx("div",{className:he.emptyStateIcon,children:i.jsx("i",{className:"fa-solid fa-sticky-note"})}),i.jsx("h3",{className:he.emptyStateTitle,children:"No reminders for this date"}),i.jsxs("p",{children:['Click "Add Reminder" to create your first reminder for ',re.toLocaleDateString()]})]})}),d&&i.jsxs("div",{className:he.dragIndicator,children:[i.jsx("i",{className:"fa-solid fa-arrows-up-down-left-right",style:{marginRight:"0.25rem"}}),"Dragging reminder..."]})]}),i.jsx("div",{className:he.footer,children:i.jsxs("p",{children:[i.jsx("i",{className:"fa-solid fa-lightbulb",style:{marginRight:"0.25rem"}}),"Tips: Shift+Enter for new lines  Escape to cancel editing  Right-click to edit  Drag reminders around freely"]})}),w&&i.jsx("div",{className:he.modalOverlay,children:i.jsx("div",{className:he.modal,children:i.jsxs("div",{className:he.modalHeader,children:[i.jsxs("div",{className:he.modalTitle,children:[i.jsxs("h2",{children:[i.jsx("i",{className:"fa-solid fa-sticky-note",style:{marginRight:"0.5rem",color:"#fbbf24"}}),"Create New Reminder"]}),i.jsx("button",{onClick:dt,className:he.modalClose,children:i.jsx("i",{className:"fa-solid fa-times",style:{fontSize:"1.25rem"}})})]}),i.jsxs("form",{onSubmit:oe=>{oe.preventDefault(),Ne()},className:he.modalForm,children:[x&&i.jsx("div",{className:he.errorMessage,children:i.jsxs("div",{className:he.errorContent,children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{marginRight:"0.5rem"}}),i.jsx("span",{style:{fontSize:"0.875rem"},children:x})]})}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{htmlFor:"title",className:he.formLabel,children:"Title *"}),i.jsx("input",{type:"text",id:"title",value:U.title,onChange:oe=>V({...U,title:oe.target.value}),className:he.formInput,placeholder:"Enter reminder title...",required:!0,autoFocus:!0})]}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{htmlFor:"remind_date",className:he.formLabel,children:"Remind Date *"}),i.jsx("input",{type:"date",id:"remind_date",value:U.remind_date,onChange:oe=>V({...U,remind_date:oe.target.value}),className:he.formInput,required:!0})]}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{className:he.formLabel,children:"Color"}),i.jsx("div",{className:he.colorSelection,children:Object.entries(Y).map(([oe,Le])=>i.jsx("button",{type:"button",onClick:()=>V({...U,color:oe}),className:`${he.colorOption} ${Le.bg} ${U.color===oe?he.colorOptionSelected:""}`,title:oe},oe))})]}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{htmlFor:"body",className:he.formLabel,children:"Details *"}),i.jsx("textarea",{id:"body",value:U.body,onChange:oe=>V({...U,body:oe.target.value}),className:he.formTextarea,rows:4,placeholder:"Enter reminder details...",required:!0})]}),U.title&&U.body&&i.jsxs("div",{className:he.preview,children:[i.jsx("label",{className:he.previewLabel,children:"Preview"}),i.jsxs("div",{className:`${he.previewNote} ${Y[U.color]?.bg} ${Y[U.color]?.border}`,children:[i.jsx("div",{className:he.previewTitle,children:U.title}),i.jsxs("div",{className:he.previewDate,children:[i.jsx("i",{className:"fa-solid fa-calendar",style:{marginRight:"0.25rem"}}),new Date(U.remind_date).toLocaleDateString()]}),i.jsx("div",{className:he.previewBody,children:U.body})]})]}),i.jsxs("div",{className:he.modalActions,children:[i.jsx("button",{type:"button",onClick:dt,className:`${he.modalButton} ${he.modalButtonCancel}`,children:"Cancel"}),i.jsxs("button",{type:"submit",className:`${he.modalButton} ${he.modalButtonSubmit}`,children:[i.jsx("i",{className:"fa-solid fa-plus"}),"Create Reminder"]})]})]})]})})}),T&&F&&i.jsx("div",{className:he.modalOverlay,children:i.jsx("div",{className:he.modal,children:i.jsxs("div",{className:he.modalHeader,children:[i.jsxs("div",{className:he.modalTitle,children:[i.jsxs("h2",{children:[i.jsx("i",{className:"fa-solid fa-edit",style:{marginRight:"0.5rem",color:"#fbbf24"}}),"Edit Reminder"]}),i.jsx("button",{onClick:We,className:he.modalClose,children:i.jsx("i",{className:"fa-solid fa-times",style:{fontSize:"1.25rem"}})})]}),i.jsxs("form",{onSubmit:oe=>{oe.preventDefault(),ot()},className:he.modalForm,children:[x&&i.jsx("div",{className:he.errorMessage,children:i.jsxs("div",{className:he.errorContent,children:[i.jsx("i",{className:"fa-solid fa-exclamation-triangle",style:{marginRight:"0.5rem"}}),i.jsx("span",{style:{fontSize:"0.875rem"},children:x})]})}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{htmlFor:"edit-title",className:he.formLabel,children:"Title *"}),i.jsx("input",{type:"text",id:"edit-title",value:te.title,onChange:oe=>N({...te,title:oe.target.value}),className:he.formInput,placeholder:"Enter reminder title...",required:!0,autoFocus:!0})]}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{htmlFor:"edit-remind_date",className:he.formLabel,children:"Remind Date *"}),i.jsx("input",{type:"date",id:"edit-remind_date",value:te.remind_date,onChange:oe=>N({...te,remind_date:oe.target.value}),className:he.formInput,required:!0})]}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{className:he.formLabel,children:"Color"}),i.jsx("div",{className:he.colorSelection,children:Object.entries(Y).map(([oe,Le])=>i.jsx("button",{type:"button",onClick:()=>N({...te,color:oe}),className:`${he.colorOption} ${Le.bg} ${te.color===oe?he.colorOptionSelected:""}`,title:oe},oe))})]}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{className:he.formLabel,children:"Status"}),i.jsxs("div",{className:he.checkboxContainer,children:[i.jsx("input",{type:"checkbox",id:"edit-resolved",checked:te.resolved,onChange:oe=>N({...te,resolved:oe.target.checked}),className:he.formCheckbox}),i.jsxs("label",{htmlFor:"edit-resolved",className:he.checkboxLabel,children:[i.jsx("i",{className:`fa-solid ${te.resolved?"fa-check-square":"fa-square"}`,style:{marginRight:"0.5rem"}}),"Mark as completed/resolved"]})]})]}),i.jsxs("div",{className:he.formGroup,children:[i.jsx("label",{htmlFor:"edit-body",className:he.formLabel,children:"Details *"}),i.jsx("textarea",{id:"edit-body",value:te.body,onChange:oe=>N({...te,body:oe.target.value}),className:he.formTextarea,rows:4,placeholder:"Enter reminder details...",required:!0})]}),te.title&&te.body&&i.jsxs("div",{className:he.preview,children:[i.jsx("label",{className:he.previewLabel,children:"Preview"}),i.jsxs("div",{className:`${he.previewNote} ${Y[te.color]?.bg} ${Y[te.color]?.border}`,children:[i.jsx("div",{className:he.previewTitle,children:te.title}),i.jsxs("div",{className:he.previewDate,children:[i.jsx("i",{className:"fa-solid fa-calendar",style:{marginRight:"0.25rem"}}),new Date(te.remind_date).toLocaleDateString()]}),i.jsx("div",{className:he.previewBody,children:te.body})]})]}),i.jsxs("div",{className:he.modalActions,children:[i.jsxs("button",{type:"button",onClick:()=>{tt(F.reminder_id),We()},className:`${he.modalButton} ${he.modalButtonDanger}`,children:[i.jsx("i",{className:"fa-solid fa-trash"}),"Delete"]}),i.jsx("button",{type:"button",onClick:We,className:`${he.modalButton} ${he.modalButtonCancel}`,children:"Cancel"}),i.jsxs("button",{type:"submit",className:`${he.modalButton} ${he.modalButtonSubmit}`,children:[i.jsx("i",{className:"fa-solid fa-save"}),"Update Reminder"]})]})]})]})})}),X&&i.jsx("div",{className:he.confirmationDialog,children:i.jsxs("div",{className:he.confirmationContent,children:[i.jsxs("div",{className:he.confirmationHeader,children:[i.jsx("div",{className:he.confirmationIcon,children:i.jsx("i",{className:"fa-solid fa-exclamation-triangle"})}),i.jsx("h3",{children:"Remove All Reminders"})]}),i.jsx("p",{children:"Are you sure you want to remove all reminders? This action cannot be undone."}),i.jsxs("div",{className:he.confirmationButtons,children:[i.jsxs("button",{onClick:()=>le(!1),className:`${he.confirmationButton} ${he.confirmationButtonCancel}`,children:[i.jsx("i",{className:"fa-solid fa-times",style:{marginRight:"0.5rem"}}),"Cancel"]}),i.jsxs("button",{onClick:be,className:`${he.confirmationButton} ${he.confirmationButtonConfirm}`,children:[i.jsx("i",{className:"fa-solid fa-trash",style:{marginRight:"0.5rem"}}),"Remove All"]})]})]})})]}),i.jsx($e,{})]})}const jN=()=>{const{isCollapsed:e}=X0();return B4(),i.jsxs("div",{style:{height:"100vh",background:"#f8f9fa",color:"#1a1a1a",display:"flex",overflow:"hidden",backgroundImage:"url(/images/backgrounds/appbg3.png)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",position:"relative"},children:[i.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.05)",zIndex:0}}),i.jsx(L4,{}),i.jsx("main",{style:{flex:1,marginLeft:e?"60px":"160px",padding:"24px",height:"100vh",overflow:"auto",transition:"margin-left 0.3s ease",position:"relative",zIndex:1},children:i.jsx("div",{style:{maxWidth:"1400px",margin:"0 auto",position:"relative",zIndex:1},children:i.jsxs($_,{children:[i.jsx(Ba,{path:"/",element:i.jsx(V4,{})}),i.jsx(Ba,{path:"/products",element:i.jsx(ed,{children:i.jsx(K4,{})})}),i.jsx(Ba,{path:"/sales",element:i.jsx(ed,{requiredPermission:"canProcessSales",children:i.jsx(eT,{})})}),i.jsx(Ba,{path:"/side-businesses",element:i.jsx(ed,{children:i.jsx(wE,{})})}),i.jsx(Ba,{path:"/transactions",element:i.jsx(ed,{children:i.jsx(RE,{})})}),i.jsx(Ba,{path:"/admin",element:i.jsx(wR,{})}),i.jsx(Ba,{path:"/reminders",element:i.jsx(kN,{})}),i.jsx(Ba,{path:"/transaction/:transactionId",element:i.jsx(DE,{})})]})})})]})};function CN(){return i.jsx(R4,{children:i.jsx(N4,{children:i.jsx(D4,{children:i.jsx(M4,{children:i.jsx(hS,{children:i.jsx(F4,{children:i.jsx(jN,{})})})})})})})}Jb.createRoot(document.getElementById("root")).render(i.jsx(_1.StrictMode,{children:i.jsx(CN,{})}));
